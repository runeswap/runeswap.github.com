!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e){return e&&e.__esModule?e.default:e}function r(e,t,r){Object.defineProperty(e,t,{get:r,enumerable:!0})}var i={};var n=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t};(function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)i[t[r]]=e[t[r]]})(JSON.parse('{"7pral":"index.bd257dbe.js","5eV8i":"terminal24x24.94766b68.png"}'));var a={};
/*!
  * jQuery JavaScript Library v2.2.4
  * http://jquery.com/
  *
  * Includes Sizzle.js
  * http://sizzlejs.com/
  *
  * Copyright jQuery Foundation and other contributors
  * Released under the MIT license
  * http://jquery.org/license
  *
  * Date: 2016-05-20T17:23Z
  */
!function(e,t){"object"==typeof a?a=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:a,(function(e,t){var r=[],i=e.document,n=r.slice,a=r.concat,o=r.push,s=r.indexOf,l={},h=l.toString,u=l.hasOwnProperty,c={},d="2.2.4",f=function(e,t){return new f.fn.init(e,t)},p=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,m=/^-ms-/,g=/-([\da-z])/gi,y=function(e,t){return t.toUpperCase()};function v(e){var t=!!e&&"length"in e&&e.length,r=f.type(e);return"function"!==r&&!f.isWindow(e)&&("array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e)}f.fn=f.prototype={jquery:d,constructor:f,selector:"",length:0,toArray:function(){return n.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:n.call(this)},pushStack:function(e){var t=f.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return f.each(this,e)},map:function(e){return this.pushStack(f.map(this,(function(t,r){return e.call(t,r,t)})))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:r.sort,splice:r.splice},f.extend=f.fn.extend=function(){var e,t,r,i,n,a,o=arguments[0]||{},s=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[s]||{},s++),"object"==typeof o||f.isFunction(o)||(o={}),s===l&&(o=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)r=o[t],o!==(i=e[t])&&(h&&i&&(f.isPlainObject(i)||(n=f.isArray(i)))?(n?(n=!1,a=r&&f.isArray(r)?r:[]):a=r&&f.isPlainObject(r)?r:{},o[t]=f.extend(h,a,i)):void 0!==i&&(o[t]=i));return o},f.extend({expando:"jQuery"+(d+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===f.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!f.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){var t;if("object"!==f.type(e)||e.nodeType||f.isWindow(e))return!1;if(e.constructor&&!u.call(e,"constructor")&&!u.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||u.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[h.call(e)]||"object":typeof e},globalEval:function(e){var t,r=eval;(e=f.trim(e))&&(1===e.indexOf("use strict")?((t=i.createElement("script")).text=e,i.head.appendChild(t).parentNode.removeChild(t)):r(e))},camelCase:function(e){return e.replace(m,"ms-").replace(g,y)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var r,i=0;if(v(e))for(r=e.length;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(p,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(v(Object(e))?f.merge(r,"string"==typeof e?[e]:e):o.call(r,e)),r},inArray:function(e,t,r){return null==t?-1:s.call(t,e,r)},merge:function(e,t){for(var r=+t.length,i=0,n=e.length;i<r;i++)e[n++]=t[i];return e.length=n,e},grep:function(e,t,r){for(var i=[],n=0,a=e.length,o=!r;n<a;n++)!t(e[n],n)!==o&&i.push(e[n]);return i},map:function(e,t,r){var i,n,o=0,s=[];if(v(e))for(i=e.length;o<i;o++)null!=(n=t(e[o],o,r))&&s.push(n);else for(o in e)null!=(n=t(e[o],o,r))&&s.push(n);return a.apply([],s)},guid:1,proxy:function(e,t){var r,i,a;if("string"==typeof t&&(r=e[t],t=e,e=r),f.isFunction(e))return i=n.call(arguments,2),(a=function(){return e.apply(t||this,i.concat(n.call(arguments)))}).guid=e.guid=e.guid||f.guid++,a},now:Date.now,support:c}),"function"==typeof Symbol&&(f.fn[Symbol.iterator]=r[Symbol.iterator]),f.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var b=
/*!
    * Sizzle CSS Selector Engine v2.2.1
    * http://sizzlejs.com/
    *
    * Copyright jQuery Foundation and other contributors
    * Released under the MIT license
    * http://jquery.org/license
    *
    * Date: 2015-10-17
    */
function(e){var t,r,i,n,a,o,s,l,h,u,c,d,f,p,m,g,y,v,b,x="sizzle"+1*new Date,_=e.document,T=0,E=0,A=ae(),w=ae(),k=ae(),S=function(e,t){return e===t&&(c=!0),0},M=1<<31,C={}.hasOwnProperty,P=[],O=P.pop,D=P.push,I=P.push,R=P.slice,N=function(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",U="\\[[\\x20\\t\\r\\n\\f]*("+B+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+F+"*\\]",z=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",H=new RegExp(F+"+","g"),j=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),G=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),K=new RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),W=new RegExp(z),Y=new RegExp("^"+B+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},q=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,ee=/'|\\/g,te=new RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),re=function(e,t,r){var i="0x"+t-65536;return i!=i||r?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},ie=function(){d()};try{I.apply(P=R.call(_.childNodes),_.childNodes),P[_.childNodes.length].nodeType}catch(e){I={apply:P.length?function(e,t){D.apply(e,R.call(t))}:function(e,t){for(var r=e.length,i=0;e[r++]=t[i++];);e.length=r-1}}}function ne(e,t,i,n){var a,s,h,u,c,p,y,v,T=t&&t.ownerDocument,E=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==E&&9!==E&&11!==E)return i;if(!n&&((t?t.ownerDocument||t:_)!==f&&d(t),t=t||f,m)){if(11!==E&&(p=Q.exec(e)))if(a=p[1]){if(9===E){if(!(h=t.getElementById(a)))return i;if(h.id===a)return i.push(h),i}else if(T&&(h=T.getElementById(a))&&b(t,h)&&h.id===a)return i.push(h),i}else{if(p[2])return I.apply(i,t.getElementsByTagName(e)),i;if((a=p[3])&&r.getElementsByClassName&&t.getElementsByClassName)return I.apply(i,t.getElementsByClassName(a)),i}if(r.qsa&&!k[e+" "]&&(!g||!g.test(e))){if(1!==E)T=t,v=e;else if("object"!==t.nodeName.toLowerCase()){for((u=t.getAttribute("id"))?u=u.replace(ee,"\\$&"):t.setAttribute("id",u=x),s=(y=o(e)).length,c=Y.test(u)?"#"+u:"[id='"+u+"']";s--;)y[s]=c+" "+me(y[s]);v=y.join(","),T=$.test(e)&&fe(t.parentNode)||t}if(v)try{return I.apply(i,T.querySelectorAll(v)),i}catch(e){}finally{u===x&&t.removeAttribute("id")}}}return l(e.replace(j,"$1"),t,i,n)}function ae(){var e=[];return function t(r,n){return e.push(r+" ")>i.cacheLength&&delete t[e.shift()],t[r+" "]=n}}function oe(e){return e[x]=!0,e}function se(e){var t=f.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var r=e.split("|"),n=r.length;n--;)i.attrHandle[r[n]]=t}function he(e,t){var r=t&&e,i=r&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||M)-(~e.sourceIndex||M);if(i)return i;if(r)for(;r=r.nextSibling;)if(r===t)return-1;return e?1:-1}function ue(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ce(e){return function(t){var r=t.nodeName.toLowerCase();return("input"===r||"button"===r)&&t.type===e}}function de(e){return oe((function(t){return t=+t,oe((function(r,i){for(var n,a=e([],r.length,t),o=a.length;o--;)r[n=a[o]]&&(r[n]=!(i[n]=r[n]))}))}))}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in r=ne.support={},a=ne.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},d=ne.setDocument=function(e){var t,n,o=e?e.ownerDocument||e:_;return o!==f&&9===o.nodeType&&o.documentElement?(p=(f=o).documentElement,m=!a(f),(n=f.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ie,!1):n.attachEvent&&n.attachEvent("onunload",ie)),r.attributes=se((function(e){return e.className="i",!e.getAttribute("className")})),r.getElementsByTagName=se((function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length})),r.getElementsByClassName=J.test(f.getElementsByClassName),r.getById=se((function(e){return p.appendChild(e).id=x,!f.getElementsByName||!f.getElementsByName(x).length})),r.getById?(i.find.ID=function(e,t){if(void 0!==t.getElementById&&m){var r=t.getElementById(e);return r?[r]:[]}},i.filter.ID=function(e){var t=e.replace(te,re);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(te,re);return function(e){var r=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return r&&r.value===t}}),i.find.TAG=r.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):r.qsa?t.querySelectorAll(e):void 0}:function(e,t){var r,i=[],n=0,a=t.getElementsByTagName(e);if("*"===e){for(;r=a[n++];)1===r.nodeType&&i.push(r);return i}return a},i.find.CLASS=r.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&m)return t.getElementsByClassName(e)},y=[],g=[],(r.qsa=J.test(f.querySelectorAll))&&(se((function(e){p.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+L+")"),e.querySelectorAll("[id~="+x+"-]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]")})),se((function(e){var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(r.matchesSelector=J.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&se((function(e){r.disconnectedMatch=v.call(e,"div"),v.call(e,"[s!='']:x"),y.push("!=",z)})),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),t=J.test(p.compareDocumentPosition),b=t||J.test(p.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(r.contains?r.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},S=t?function(e,t){if(e===t)return c=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===f||e.ownerDocument===_&&b(_,e)?-1:t===f||t.ownerDocument===_&&b(_,t)?1:u?N(u,e)-N(u,t):0:4&i?-1:1)}:function(e,t){if(e===t)return c=!0,0;var r,i=0,n=e.parentNode,a=t.parentNode,o=[e],s=[t];if(!n||!a)return e===f?-1:t===f?1:n?-1:a?1:u?N(u,e)-N(u,t):0;if(n===a)return he(e,t);for(r=e;r=r.parentNode;)o.unshift(r);for(r=t;r=r.parentNode;)s.unshift(r);for(;o[i]===s[i];)i++;return i?he(o[i],s[i]):o[i]===_?-1:s[i]===_?1:0},f):f},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&d(e),t=t.replace(K,"='$1']"),r.matchesSelector&&m&&!k[t+" "]&&(!y||!y.test(t))&&(!g||!g.test(t)))try{var i=v.call(e,t);if(i||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return ne(t,f,null,[e]).length>0},ne.contains=function(e,t){return(e.ownerDocument||e)!==f&&d(e),b(e,t)},ne.attr=function(e,t){(e.ownerDocument||e)!==f&&d(e);var n=i.attrHandle[t.toLowerCase()],a=n&&C.call(i.attrHandle,t.toLowerCase())?n(e,t,!m):void 0;return void 0!==a?a:r.attributes||!m?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,i=[],n=0,a=0;if(c=!r.detectDuplicates,u=!r.sortStable&&e.slice(0),e.sort(S),c){for(;t=e[a++];)t===e[a]&&(n=i.push(a));for(;n--;)e.splice(i[n],1)}return u=null,e},n=ne.getText=function(e){var t,r="",i=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=n(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[i++];)r+=n(t);return r},(i=ne.selectors={cacheLength:50,createPseudo:oe,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,re),e[3]=(e[3]||e[4]||e[5]||"").replace(te,re),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&W.test(r)&&(t=o(r,!0))&&(t=r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,re).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=A[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+F+"|$)"))&&A(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,r){return function(i){var n=ne.attr(i,e);return null==n?"!="===t:!t||(n+="","="===t?n===r:"!="===t?n!==r:"^="===t?r&&0===n.indexOf(r):"*="===t?r&&n.indexOf(r)>-1:"$="===t?r&&n.slice(-r.length)===r:"~="===t?(" "+n.replace(H," ")+" ").indexOf(r)>-1:"|="===t&&(n===r||n.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,r,i,n){var a="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===n?function(e){return!!e.parentNode}:function(t,r,l){var h,u,c,d,f,p,m=a!==o?"nextSibling":"previousSibling",g=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s,b=!1;if(g){if(a){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?g.firstChild:g.lastChild],o&&v){for(b=(f=(h=(u=(c=(d=g)[x]||(d[x]={}))[d.uniqueID]||(c[d.uniqueID]={}))[e]||[])[0]===T&&h[1])&&h[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){u[e]=[T,f,b];break}}else if(v&&(b=f=(h=(u=(c=(d=t)[x]||(d[x]={}))[d.uniqueID]||(c[d.uniqueID]={}))[e]||[])[0]===T&&h[1]),!1===b)for(;(d=++f&&d&&d[m]||(b=f=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++b||(v&&((u=(c=d[x]||(d[x]={}))[d.uniqueID]||(c[d.uniqueID]={}))[e]=[T,b]),d!==t)););return(b-=n)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var r,n=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return n[x]?n(t):n.length>1?(r=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?oe((function(e,r){for(var i,a=n(e,t),o=a.length;o--;)e[i=N(e,a[o])]=!(r[i]=a[o])})):function(e){return n(e,0,r)}):n}},pseudos:{not:oe((function(e){var t=[],r=[],i=s(e.replace(j,"$1"));return i[x]?oe((function(e,t,r,n){for(var a,o=i(e,null,n,[]),s=e.length;s--;)(a=o[s])&&(e[s]=!(t[s]=a))})):function(e,n,a){return t[0]=e,i(t,null,a,r),t[0]=null,!r.pop()}})),has:oe((function(e){return function(t){return ne(e,t).length>0}})),contains:oe((function(e){return e=e.replace(te,re),function(t){return(t.textContent||t.innerText||n(t)).indexOf(e)>-1}})),lang:oe((function(e){return Y.test(e||"")||ne.error("unsupported lang: "+e),e=e.replace(te,re).toLowerCase(),function(t){var r;do{if(r=m?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(r=r.toLowerCase())===e||0===r.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var r=e.location&&e.location.hash;return r&&r.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:de((function(){return[0]})),last:de((function(e,t){return[t-1]})),eq:de((function(e,t,r){return[r<0?r+t:r]})),even:de((function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e})),odd:de((function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e})),lt:de((function(e,t,r){for(var i=r<0?r+t:r;--i>=0;)e.push(i);return e})),gt:de((function(e,t,r){for(var i=r<0?r+t:r;++i<t;)e.push(i);return e}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=ue(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ce(t);function pe(){}function me(e){for(var t=0,r=e.length,i="";t<r;t++)i+=e[t].value;return i}function ge(e,t,r){var i=t.dir,n=r&&"parentNode"===i,a=E++;return t.first?function(t,r,a){for(;t=t[i];)if(1===t.nodeType||n)return e(t,r,a)}:function(t,r,o){var s,l,h,u=[T,a];if(o){for(;t=t[i];)if((1===t.nodeType||n)&&e(t,r,o))return!0}else for(;t=t[i];)if(1===t.nodeType||n){if((s=(l=(h=t[x]||(t[x]={}))[t.uniqueID]||(h[t.uniqueID]={}))[i])&&s[0]===T&&s[1]===a)return u[2]=s[2];if(l[i]=u,u[2]=e(t,r,o))return!0}}}function ye(e){return e.length>1?function(t,r,i){for(var n=e.length;n--;)if(!e[n](t,r,i))return!1;return!0}:e[0]}function ve(e,t,r,i,n){for(var a,o=[],s=0,l=e.length,h=null!=t;s<l;s++)(a=e[s])&&(r&&!r(a,i,n)||(o.push(a),h&&t.push(s)));return o}function be(e,t,r,i,n,a){return i&&!i[x]&&(i=be(i)),n&&!n[x]&&(n=be(n,a)),oe((function(a,o,s,l){var h,u,c,d=[],f=[],p=o.length,m=a||function(e,t,r){for(var i=0,n=t.length;i<n;i++)ne(e,t[i],r);return r}(t||"*",s.nodeType?[s]:s,[]),g=!e||!a&&t?m:ve(m,d,e,s,l),y=r?n||(a?e:p||i)?[]:o:g;if(r&&r(g,y,s,l),i)for(h=ve(y,f),i(h,[],s,l),u=h.length;u--;)(c=h[u])&&(y[f[u]]=!(g[f[u]]=c));if(a){if(n||e){if(n){for(h=[],u=y.length;u--;)(c=y[u])&&h.push(g[u]=c);n(null,y=[],h,l)}for(u=y.length;u--;)(c=y[u])&&(h=n?N(a,c):d[u])>-1&&(a[h]=!(o[h]=c))}}else y=ve(y===o?y.splice(p,y.length):y),n?n(null,o,y,l):I.apply(o,y)}))}function xe(e){for(var t,r,n,a=e.length,o=i.relative[e[0].type],s=o||i.relative[" "],l=o?1:0,u=ge((function(e){return e===t}),s,!0),c=ge((function(e){return N(t,e)>-1}),s,!0),d=[function(e,r,i){var n=!o&&(i||r!==h)||((t=r).nodeType?u(e,r,i):c(e,r,i));return t=null,n}];l<a;l++)if(r=i.relative[e[l].type])d=[ge(ye(d),r)];else{if((r=i.filter[e[l].type].apply(null,e[l].matches))[x]){for(n=++l;n<a&&!i.relative[e[n].type];n++);return be(l>1&&ye(d),l>1&&me(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(j,"$1"),r,l<n&&xe(e.slice(l,n)),n<a&&xe(e=e.slice(n)),n<a&&me(e))}d.push(r)}return ye(d)}return pe.prototype=i.filters=i.pseudos,i.setFilters=new pe,o=ne.tokenize=function(e,t){var r,n,a,o,s,l,h,u=w[e+" "];if(u)return t?0:u.slice(0);for(s=e,l=[],h=i.preFilter;s;){for(o in r&&!(n=V.exec(s))||(n&&(s=s.slice(n[0].length)||s),l.push(a=[])),r=!1,(n=G.exec(s))&&(r=n.shift(),a.push({value:r,type:n[0].replace(j," ")}),s=s.slice(r.length)),i.filter)!(n=X[o].exec(s))||h[o]&&!(n=h[o](n))||(r=n.shift(),a.push({value:r,type:o,matches:n}),s=s.slice(r.length));if(!r)break}return t?s.length:s?ne.error(e):w(e,l).slice(0)},s=ne.compile=function(e,t){var r,n=[],a=[],s=k[e+" "];if(!s){for(t||(t=o(e)),r=t.length;r--;)(s=xe(t[r]))[x]?n.push(s):a.push(s);(s=k(e,function(e,t){var r=t.length>0,n=e.length>0,a=function(a,o,s,l,u){var c,p,g,y=0,v="0",b=a&&[],x=[],_=h,E=a||n&&i.find.TAG("*",u),A=T+=null==_?1:Math.random()||.1,w=E.length;for(u&&(h=o===f||o||u);v!==w&&null!=(c=E[v]);v++){if(n&&c){for(p=0,o||c.ownerDocument===f||(d(c),s=!m);g=e[p++];)if(g(c,o||f,s)){l.push(c);break}u&&(T=A)}r&&((c=!g&&c)&&y--,a&&b.push(c))}if(y+=v,r&&v!==y){for(p=0;g=t[p++];)g(b,x,o,s);if(a){if(y>0)for(;v--;)b[v]||x[v]||(x[v]=O.call(l));x=ve(x)}I.apply(l,x),u&&!a&&x.length>0&&y+t.length>1&&ne.uniqueSort(l)}return u&&(T=A,h=_),b};return r?oe(a):a}(a,n))).selector=e}return s},l=ne.select=function(e,t,n,a){var l,h,u,c,d,f="function"==typeof e&&e,p=!a&&o(e=f.selector||e);if(n=n||[],1===p.length){if((h=p[0]=p[0].slice(0)).length>2&&"ID"===(u=h[0]).type&&r.getById&&9===t.nodeType&&m&&i.relative[h[1].type]){if(!(t=(i.find.ID(u.matches[0].replace(te,re),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(h.shift().value.length)}for(l=X.needsContext.test(e)?0:h.length;l--&&(u=h[l],!i.relative[c=u.type]);)if((d=i.find[c])&&(a=d(u.matches[0].replace(te,re),$.test(h[0].type)&&fe(t.parentNode)||t))){if(h.splice(l,1),!(e=a.length&&me(h)))return I.apply(n,a),n;break}}return(f||s(e,p))(a,t,!m,n,!t||$.test(e)&&fe(t.parentNode)||t),n},r.sortStable=x.split("").sort(S).join("")===x,r.detectDuplicates=!!c,d(),r.sortDetached=se((function(e){return 1&e.compareDocumentPosition(f.createElement("div"))})),se((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||le("type|href|height|width",(function(e,t,r){if(!r)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),r.attributes&&se((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||le("value",(function(e,t,r){if(!r&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),se((function(e){return null==e.getAttribute("disabled")}))||le(L,(function(e,t,r){var i;if(!r)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),ne}(e);f.find=b,f.expr=b.selectors,f.expr[":"]=f.expr.pseudos,f.uniqueSort=f.unique=b.uniqueSort,f.text=b.getText,f.isXMLDoc=b.isXML,f.contains=b.contains;var x=function(e,t,r){for(var i=[],n=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&f(e).is(r))break;i.push(e)}return i},_=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},T=f.expr.match.needsContext,E=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,A=/^.[^:#\[\.,]*$/;function w(e,t,r){if(f.isFunction(t))return f.grep(e,(function(e,i){return!!t.call(e,i,e)!==r}));if(t.nodeType)return f.grep(e,(function(e){return e===t!==r}));if("string"==typeof t){if(A.test(t))return f.filter(t,e,r);t=f.filter(t,e)}return f.grep(e,(function(e){return s.call(t,e)>-1!==r}))}f.filter=function(e,t,r){var i=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?f.find.matchesSelector(i,e)?[i]:[]:f.find.matches(e,f.grep(t,(function(e){return 1===e.nodeType})))},f.fn.extend({find:function(e){var t,r=this.length,i=[],n=this;if("string"!=typeof e)return this.pushStack(f(e).filter((function(){for(t=0;t<r;t++)if(f.contains(n[t],this))return!0})));for(t=0;t<r;t++)f.find(e,n[t],i);return(i=this.pushStack(r>1?f.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(w(this,e||[],!1))},not:function(e){return this.pushStack(w(this,e||[],!0))},is:function(e){return!!w(this,"string"==typeof e&&T.test(e)?f(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(f.fn.init=function(e,t,r){var n,a;if(!e)return this;if(r=r||k,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:S.exec(e))||!n[1]&&t)return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof f?t[0]:t,f.merge(this,f.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:i,!0)),E.test(n[1])&&f.isPlainObject(t))for(n in t)f.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(a=i.getElementById(n[2]))&&a.parentNode&&(this.length=1,this[0]=a),this.context=i,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):f.isFunction(e)?void 0!==r.ready?r.ready(e):e(f):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),f.makeArray(e,this))}).prototype=f.fn,k=f(i);var M=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};function P(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}f.fn.extend({has:function(e){var t=f(e,this),r=t.length;return this.filter((function(){for(var e=0;e<r;e++)if(f.contains(this,t[e]))return!0}))},closest:function(e,t){for(var r,i=0,n=this.length,a=[],o=T.test(e)||"string"!=typeof e?f(e,t||this.context):0;i<n;i++)for(r=this[i];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(o?o.index(r)>-1:1===r.nodeType&&f.find.matchesSelector(r,e))){a.push(r);break}return this.pushStack(a.length>1?f.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?s.call(f(e),this[0]):s.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(f.uniqueSort(f.merge(this.get(),f(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),f.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x(e,"parentNode")},parentsUntil:function(e,t,r){return x(e,"parentNode",r)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return x(e,"nextSibling")},prevAll:function(e){return x(e,"previousSibling")},nextUntil:function(e,t,r){return x(e,"nextSibling",r)},prevUntil:function(e,t,r){return x(e,"previousSibling",r)},siblings:function(e){return _((e.parentNode||{}).firstChild,e)},children:function(e){return _(e.firstChild)},contents:function(e){return e.contentDocument||f.merge([],e.childNodes)}},(function(e,t){f.fn[e]=function(r,i){var n=f.map(this,t,r);return"Until"!==e.slice(-5)&&(i=r),i&&"string"==typeof i&&(n=f.filter(i,n)),this.length>1&&(C[e]||f.uniqueSort(n),M.test(e)&&n.reverse()),this.pushStack(n)}}));var O,D=/\S+/g;function I(){i.removeEventListener("DOMContentLoaded",I),e.removeEventListener("load",I),f.ready()}f.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return f.each(e.match(D)||[],(function(e,r){t[r]=!0})),t}(e):f.extend({},e);var t,r,i,n,a=[],o=[],s=-1,l=function(){for(n=e.once,i=t=!0;o.length;s=-1)for(r=o.shift();++s<a.length;)!1===a[s].apply(r[0],r[1])&&e.stopOnFalse&&(s=a.length,r=!1);e.memory||(r=!1),t=!1,n&&(a=r?[]:"")},h={add:function(){return a&&(r&&!t&&(s=a.length-1,o.push(r)),function t(r){f.each(r,(function(r,i){f.isFunction(i)?e.unique&&h.has(i)||a.push(i):i&&i.length&&"string"!==f.type(i)&&t(i)}))}(arguments),r&&!t&&l()),this},remove:function(){return f.each(arguments,(function(e,t){for(var r;(r=f.inArray(t,a,r))>-1;)a.splice(r,1),r<=s&&s--})),this},has:function(e){return e?f.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return n=o=[],a=r="",this},disabled:function(){return!a},lock:function(){return n=o=[],r||(a=r=""),this},locked:function(){return!!n},fireWith:function(e,r){return n||(r=[e,(r=r||[]).slice?r.slice():r],o.push(r),t||l()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!i}};return h},f.extend({Deferred:function(e){var t=[["resolve","done",f.Callbacks("once memory"),"resolved"],["reject","fail",f.Callbacks("once memory"),"rejected"],["notify","progress",f.Callbacks("memory")]],r="pending",i={state:function(){return r},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return f.Deferred((function(r){f.each(t,(function(t,a){var o=f.isFunction(e[t])&&e[t];n[a[1]]((function(){var e=o&&o.apply(this,arguments);e&&f.isFunction(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[a[0]+"With"](this===i?r.promise():this,o?[e]:arguments)}))})),e=null})).promise()},promise:function(e){return null!=e?f.extend(e,i):i}},n={};return i.pipe=i.then,f.each(t,(function(e,a){var o=a[2],s=a[3];i[a[1]]=o.add,s&&o.add((function(){r=s}),t[1^e][2].disable,t[2][2].lock),n[a[0]]=function(){return n[a[0]+"With"](this===n?i:this,arguments),this},n[a[0]+"With"]=o.fireWith})),i.promise(n),e&&e.call(n,n),n},when:function(e){var t,r,i,a=0,o=n.call(arguments),s=o.length,l=1!==s||e&&f.isFunction(e.promise)?s:0,h=1===l?e:f.Deferred(),u=function(e,r,i){return function(a){r[e]=this,i[e]=arguments.length>1?n.call(arguments):a,i===t?h.notifyWith(r,i):--l||h.resolveWith(r,i)}};if(s>1)for(t=new Array(s),r=new Array(s),i=new Array(s);a<s;a++)o[a]&&f.isFunction(o[a].promise)?o[a].promise().progress(u(a,r,t)).done(u(a,i,o)).fail(h.reject):--l;return l||h.resolveWith(i,o),h.promise()}}),f.fn.ready=function(e){return f.ready.promise().done(e),this},f.extend({isReady:!1,readyWait:1,holdReady:function(e){e?f.readyWait++:f.ready(!0)},ready:function(e){(!0===e?--f.readyWait:f.isReady)||(f.isReady=!0,!0!==e&&--f.readyWait>0||(O.resolveWith(i,[f]),f.fn.triggerHandler&&(f(i).triggerHandler("ready"),f(i).off("ready"))))}}),f.ready.promise=function(t){return O||(O=f.Deferred(),"complete"===i.readyState||"loading"!==i.readyState&&!i.documentElement.doScroll?e.setTimeout(f.ready):(i.addEventListener("DOMContentLoaded",I),e.addEventListener("load",I))),O.promise(t)},f.ready.promise();var R=function(e,t,r,i,n,a,o){var s=0,l=e.length,h=null==r;if("object"===f.type(r))for(s in n=!0,r)R(e,t,s,r[s],!0,a,o);else if(void 0!==i&&(n=!0,f.isFunction(i)||(o=!0),h&&(o?(t.call(e,i),t=null):(h=t,t=function(e,t,r){return h.call(f(e),r)})),t))for(;s<l;s++)t(e[s],r,o?i:i.call(e[s],s,t(e[s],r)));return n?e:h?t.call(e):l?t(e[0],r):a},N=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function L(){this.expando=f.expando+L.uid++}L.uid=1,L.prototype={register:function(e,t){var r=t||{};return e.nodeType?e[this.expando]=r:Object.defineProperty(e,this.expando,{value:r,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!N(e))return{};var t=e[this.expando];return t||(t={},N(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var i,n=this.cache(e);if("string"==typeof t)n[t]=r;else for(i in t)n[i]=t[i];return n},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,r){var i;return void 0===t||t&&"string"==typeof t&&void 0===r?void 0!==(i=this.get(e,t))?i:this.get(e,f.camelCase(t)):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,i,n,a=e[this.expando];if(void 0!==a){if(void 0===t)this.register(e);else{f.isArray(t)?i=t.concat(t.map(f.camelCase)):(n=f.camelCase(t),i=t in a?[t,n]:(i=n)in a?[i]:i.match(D)||[]),r=i.length;for(;r--;)delete a[i[r]]}(void 0===t||f.isEmptyObject(a))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!f.isEmptyObject(t)}};var F=new L,B=new L,U=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,z=/[A-Z]/g;function H(e,t,r){var i;if(void 0===r&&1===e.nodeType)if(i="data-"+t.replace(z,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(i))){try{r="true"===r||"false"!==r&&("null"===r?null:+r+""===r?+r:U.test(r)?f.parseJSON(r):r)}catch(e){}B.set(e,t,r)}else r=void 0;return r}f.extend({hasData:function(e){return B.hasData(e)||F.hasData(e)},data:function(e,t,r){return B.access(e,t,r)},removeData:function(e,t){B.remove(e,t)},_data:function(e,t,r){return F.access(e,t,r)},_removeData:function(e,t){F.remove(e,t)}}),f.fn.extend({data:function(e,t){var r,i,n,a=this[0],o=a&&a.attributes;if(void 0===e){if(this.length&&(n=B.get(a),1===a.nodeType&&!F.get(a,"hasDataAttrs"))){for(r=o.length;r--;)o[r]&&0===(i=o[r].name).indexOf("data-")&&(i=f.camelCase(i.slice(5)),H(a,i,n[i]));F.set(a,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each((function(){B.set(this,e)})):R(this,(function(t){var r,i;if(a&&void 0===t)return void 0!==(r=B.get(a,e)||B.get(a,e.replace(z,"-$&").toLowerCase()))?r:(i=f.camelCase(e),void 0!==(r=B.get(a,i))||void 0!==(r=H(a,i,void 0))?r:void 0);i=f.camelCase(e),this.each((function(){var r=B.get(this,i);B.set(this,i,t),e.indexOf("-")>-1&&void 0!==r&&B.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){B.remove(this,e)}))}}),f.extend({queue:function(e,t,r){var i;if(e)return t=(t||"fx")+"queue",i=F.get(e,t),r&&(!i||f.isArray(r)?i=F.access(e,t,f.makeArray(r)):i.push(r)),i||[]},dequeue:function(e,t){t=t||"fx";var r=f.queue(e,t),i=r.length,n=r.shift(),a=f._queueHooks(e,t);"inprogress"===n&&(n=r.shift(),i--),n&&("fx"===t&&r.unshift("inprogress"),delete a.stop,n.call(e,(function(){f.dequeue(e,t)}),a)),!i&&a&&a.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return F.get(e,r)||F.access(e,r,{empty:f.Callbacks("once memory").add((function(){F.remove(e,[t+"queue",r])}))})}}),f.fn.extend({queue:function(e,t){var r=2;return"string"!=typeof e&&(t=e,e="fx",r--),arguments.length<r?f.queue(this[0],e):void 0===t?this:this.each((function(){var r=f.queue(this,e,t);f._queueHooks(this,e),"fx"===e&&"inprogress"!==r[0]&&f.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){f.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,i=1,n=f.Deferred(),a=this,o=this.length,s=function(){--i||n.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(r=F.get(a[o],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(s));return s(),n.promise(t)}});var j=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,V=new RegExp("^(?:([+-])=|)("+j+")([a-z%]*)$","i"),G=["Top","Right","Bottom","Left"],K=function(e,t){return e=t||e,"none"===f.css(e,"display")||!f.contains(e.ownerDocument,e)};function W(e,t,r,i){var n,a=1,o=20,s=i?function(){return i.cur()}:function(){return f.css(e,t,"")},l=s(),h=r&&r[3]||(f.cssNumber[t]?"":"px"),u=(f.cssNumber[t]||"px"!==h&&+l)&&V.exec(f.css(e,t));if(u&&u[3]!==h){h=h||u[3],r=r||[],u=+l||1;do{u/=a=a||".5",f.style(e,t,u+h)}while(a!==(a=s()/l)&&1!==a&&--o)}return r&&(u=+u||+l||0,n=r[1]?u+(r[1]+1)*r[2]:+r[2],i&&(i.unit=h,i.start=u,i.end=n)),n}var Y=/^(?:checkbox|radio)$/i,X=/<([\w:-]+)/,q=/^$|\/(?:java|ecma)script/i,Z={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function J(e,t){var r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&f.nodeName(e,t)?f.merge([e],r):r}function Q(e,t){for(var r=0,i=e.length;r<i;r++)F.set(e[r],"globalEval",!t||F.get(t[r],"globalEval"))}Z.optgroup=Z.option,Z.tbody=Z.tfoot=Z.colgroup=Z.caption=Z.thead,Z.th=Z.td;var $,ee,te=/<|&#?\w+;/;function re(e,t,r,i,n){for(var a,o,s,l,h,u,c=t.createDocumentFragment(),d=[],p=0,m=e.length;p<m;p++)if((a=e[p])||0===a)if("object"===f.type(a))f.merge(d,a.nodeType?[a]:a);else if(te.test(a)){for(o=o||c.appendChild(t.createElement("div")),s=(X.exec(a)||["",""])[1].toLowerCase(),l=Z[s]||Z._default,o.innerHTML=l[1]+f.htmlPrefilter(a)+l[2],u=l[0];u--;)o=o.lastChild;f.merge(d,o.childNodes),(o=c.firstChild).textContent=""}else d.push(t.createTextNode(a));for(c.textContent="",p=0;a=d[p++];)if(i&&f.inArray(a,i)>-1)n&&n.push(a);else if(h=f.contains(a.ownerDocument,a),o=J(c.appendChild(a),"script"),h&&Q(o),r)for(u=0;a=o[u++];)q.test(a.type||"")&&r.push(a);return c}$=i.createDocumentFragment().appendChild(i.createElement("div")),(ee=i.createElement("input")).setAttribute("type","radio"),ee.setAttribute("checked","checked"),ee.setAttribute("name","t"),$.appendChild(ee),c.checkClone=$.cloneNode(!0).cloneNode(!0).lastChild.checked,$.innerHTML="<textarea>x</textarea>",c.noCloneChecked=!!$.cloneNode(!0).lastChild.defaultValue;var ie=/^key/,ne=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ae=/^([^.]*)(?:\.(.+)|)/;function oe(){return!0}function se(){return!1}function le(){try{return i.activeElement}catch(e){}}function he(e,t,r,i,n,a){var o,s;if("object"==typeof t){for(s in"string"!=typeof r&&(i=i||r,r=void 0),t)he(e,s,r,i,t[s],a);return e}if(null==i&&null==n?(n=r,i=r=void 0):null==n&&("string"==typeof r?(n=i,i=void 0):(n=i,i=r,r=void 0)),!1===n)n=se;else if(!n)return e;return 1===a&&(o=n,(n=function(e){return f().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=f.guid++)),e.each((function(){f.event.add(this,t,n,i,r)}))}f.event={global:{},add:function(e,t,r,i,n){var a,o,s,l,h,u,c,d,p,m,g,y=F.get(e);if(y)for(r.handler&&(r=(a=r).handler,n=a.selector),r.guid||(r.guid=f.guid++),(l=y.events)||(l=y.events={}),(o=y.handle)||(o=y.handle=function(t){return void 0!==f&&f.event.triggered!==t.type?f.event.dispatch.apply(e,arguments):void 0}),h=(t=(t||"").match(D)||[""]).length;h--;)p=g=(s=ae.exec(t[h])||[])[1],m=(s[2]||"").split(".").sort(),p&&(c=f.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,c=f.event.special[p]||{},u=f.extend({type:p,origType:g,data:i,handler:r,guid:r.guid,selector:n,needsContext:n&&f.expr.match.needsContext.test(n),namespace:m.join(".")},a),(d=l[p])||((d=l[p]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,i,m,o)||e.addEventListener&&e.addEventListener(p,o)),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=r.guid)),n?d.splice(d.delegateCount++,0,u):d.push(u),f.event.global[p]=!0)},remove:function(e,t,r,i,n){var a,o,s,l,h,u,c,d,p,m,g,y=F.hasData(e)&&F.get(e);if(y&&(l=y.events)){for(h=(t=(t||"").match(D)||[""]).length;h--;)if(p=g=(s=ae.exec(t[h])||[])[1],m=(s[2]||"").split(".").sort(),p){for(c=f.event.special[p]||{},d=l[p=(i?c.delegateType:c.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=a=d.length;a--;)u=d[a],!n&&g!==u.origType||r&&r.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(a,1),u.selector&&d.delegateCount--,c.remove&&c.remove.call(e,u));o&&!d.length&&(c.teardown&&!1!==c.teardown.call(e,m,y.handle)||f.removeEvent(e,p,y.handle),delete l[p])}else for(p in l)f.event.remove(e,p+t[h],r,i,!0);f.isEmptyObject(l)&&F.remove(e,"handle events")}},dispatch:function(e){e=f.event.fix(e);var t,r,i,a,o,s=[],l=n.call(arguments),h=(F.get(this,"events")||{})[e.type]||[],u=f.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(s=f.event.handlers.call(this,e,h),t=0;(a=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,r=0;(o=a.handlers[r++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(i=((f.event.special[o.origType]||{}).handle||o.handler).apply(a.elem,l))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var r,i,n,a,o=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(i=[],r=0;r<s;r++)void 0===i[n=(a=t[r]).selector+" "]&&(i[n]=a.needsContext?f(n,this).index(l)>-1:f.find(n,this,null,[l]).length),i[n]&&i.push(a);i.length&&o.push({elem:l,handlers:i})}return s<t.length&&o.push({elem:this,handlers:t.slice(s)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var r,n,a,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=(r=e.target.ownerDocument||i).documentElement,a=r.body,e.pageX=t.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[f.expando])return e;var t,r,n,a=e.type,o=e,s=this.fixHooks[a];for(s||(this.fixHooks[a]=s=ne.test(a)?this.mouseHooks:ie.test(a)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,e=new f.Event(o),t=n.length;t--;)e[r=n[t]]=o[r];return e.target||(e.target=i),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==le()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===le()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&f.nodeName(this,"input"))return this.click(),!1},_default:function(e){return f.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},f.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},f.Event=function(e,t){if(!(this instanceof f.Event))return new f.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?oe:se):this.type=e,t&&f.extend(this,t),this.timeStamp=e&&e.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={constructor:f.Event,isDefaultPrevented:se,isPropagationStopped:se,isImmediatePropagationStopped:se,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=oe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=oe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=oe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},f.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){f.event.special[e]={delegateType:t,bindType:t,handle:function(e){var r,i=this,n=e.relatedTarget,a=e.handleObj;return n&&(n===i||f.contains(i,n))||(e.type=a.origType,r=a.handler.apply(this,arguments),e.type=t),r}}})),f.fn.extend({on:function(e,t,r,i){return he(this,e,t,r,i)},one:function(e,t,r,i){return he(this,e,t,r,i,1)},off:function(e,t,r){var i,n;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,f(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=se),this.each((function(){f.event.remove(this,e,r,t)}))}});var ue=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ce=/<script|<style|<link/i,de=/checked\s*(?:[^=]|=\s*.checked.)/i,fe=/^true\/(.*)/,pe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function me(e,t){return f.nodeName(e,"table")&&f.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ge(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ye(e){var t=fe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function ve(e,t){var r,i,n,a,o,s,l,h;if(1===t.nodeType){if(F.hasData(e)&&(a=F.access(e),o=F.set(t,a),h=a.events))for(n in delete o.handle,o.events={},h)for(r=0,i=h[n].length;r<i;r++)f.event.add(t,n,h[n][r]);B.hasData(e)&&(s=B.access(e),l=f.extend({},s),B.set(t,l))}}function be(e,t,r,i){t=a.apply([],t);var n,o,s,l,h,u,d=0,p=e.length,m=p-1,g=t[0],y=f.isFunction(g);if(y||p>1&&"string"==typeof g&&!c.checkClone&&de.test(g))return e.each((function(n){var a=e.eq(n);y&&(t[0]=g.call(this,n,a.html())),be(a,t,r,i)}));if(p&&(o=(n=re(t,e[0].ownerDocument,!1,e,i)).firstChild,1===n.childNodes.length&&(n=o),o||i)){for(l=(s=f.map(J(n,"script"),ge)).length;d<p;d++)h=n,d!==m&&(h=f.clone(h,!0,!0),l&&f.merge(s,J(h,"script"))),r.call(e[d],h,d);if(l)for(u=s[s.length-1].ownerDocument,f.map(s,ye),d=0;d<l;d++)h=s[d],q.test(h.type||"")&&!F.access(h,"globalEval")&&f.contains(u,h)&&(h.src?f._evalUrl&&f._evalUrl(h.src):f.globalEval(h.textContent.replace(pe,"")))}return e}function xe(e,t,r){for(var i,n=t?f.filter(t,e):e,a=0;null!=(i=n[a]);a++)r||1!==i.nodeType||f.cleanData(J(i)),i.parentNode&&(r&&f.contains(i.ownerDocument,i)&&Q(J(i,"script")),i.parentNode.removeChild(i));return e}f.extend({htmlPrefilter:function(e){return e.replace(ue,"<$1></$2>")},clone:function(e,t,r){var i,n,a,o,s,l,h,u=e.cloneNode(!0),d=f.contains(e.ownerDocument,e);if(!(c.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||f.isXMLDoc(e)))for(o=J(u),i=0,n=(a=J(e)).length;i<n;i++)s=a[i],l=o[i],h=void 0,"input"===(h=l.nodeName.toLowerCase())&&Y.test(s.type)?l.checked=s.checked:"input"!==h&&"textarea"!==h||(l.defaultValue=s.defaultValue);if(t)if(r)for(a=a||J(e),o=o||J(u),i=0,n=a.length;i<n;i++)ve(a[i],o[i]);else ve(e,u);return(o=J(u,"script")).length>0&&Q(o,!d&&J(e,"script")),u},cleanData:function(e){for(var t,r,i,n=f.event.special,a=0;void 0!==(r=e[a]);a++)if(N(r)){if(t=r[F.expando]){if(t.events)for(i in t.events)n[i]?f.event.remove(r,i):f.removeEvent(r,i,t.handle);r[F.expando]=void 0}r[B.expando]&&(r[B.expando]=void 0)}}}),f.fn.extend({domManip:be,detach:function(e){return xe(this,e,!0)},remove:function(e){return xe(this,e)},text:function(e){return R(this,(function(e){return void 0===e?f.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return be(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||me(this,e).appendChild(e)}))},prepend:function(){return be(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=me(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(f.cleanData(J(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return f.clone(this,e,t)}))},html:function(e){return R(this,(function(e){var t=this[0]||{},r=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ce.test(e)&&!Z[(X.exec(e)||["",""])[1].toLowerCase()]){e=f.htmlPrefilter(e);try{for(;r<i;r++)1===(t=this[r]||{}).nodeType&&(f.cleanData(J(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return be(this,arguments,(function(t){var r=this.parentNode;f.inArray(this,e)<0&&(f.cleanData(J(this)),r&&r.replaceChild(t,this))}),e)}}),f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){f.fn[e]=function(e){for(var r,i=[],n=f(e),a=n.length-1,s=0;s<=a;s++)r=s===a?this:this.clone(!0),f(n[s])[t](r),o.apply(i,r.get());return this.pushStack(i)}}));var _e,Te={HTML:"block",BODY:"block"};function Ee(e,t){var r=f(t.createElement(e)).appendTo(t.body),i=f.css(r[0],"display");return r.detach(),i}function Ae(e){var t=i,r=Te[e];return r||("none"!==(r=Ee(e,t))&&r||((t=(_e=(_e||f("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),r=Ee(e,t),_e.detach()),Te[e]=r),r}var we=/^margin/,ke=new RegExp("^("+j+")(?!px)[a-z%]+$","i"),Se=function(t){var r=t.ownerDocument.defaultView;return r&&r.opener||(r=e),r.getComputedStyle(t)},Me=function(e,t,r,i){var n,a,o={};for(a in t)o[a]=e.style[a],e.style[a]=t[a];for(a in n=r.apply(e,i||[]),t)e.style[a]=o[a];return n},Ce=i.documentElement;function Pe(e,t,r){var i,n,a,o,s=e.style;return""!==(o=(r=r||Se(e))?r.getPropertyValue(t)||r[t]:void 0)&&void 0!==o||f.contains(e.ownerDocument,e)||(o=f.style(e,t)),r&&!c.pixelMarginRight()&&ke.test(o)&&we.test(t)&&(i=s.width,n=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=r.width,s.width=i,s.minWidth=n,s.maxWidth=a),void 0!==o?o+"":o}function Oe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){var t,r,n,a,o=i.createElement("div"),s=i.createElement("div");function l(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Ce.appendChild(o);var i=e.getComputedStyle(s);t="1%"!==i.top,a="2px"===i.marginLeft,r="4px"===i.width,s.style.marginRight="50%",n="4px"===i.marginRight,Ce.removeChild(o)}s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",c.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",o.appendChild(s),f.extend(c,{pixelPosition:function(){return l(),t},boxSizingReliable:function(){return null==r&&l(),r},pixelMarginRight:function(){return null==r&&l(),n},reliableMarginLeft:function(){return null==r&&l(),a},reliableMarginRight:function(){var t,r=s.appendChild(i.createElement("div"));return r.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",r.style.marginRight=r.style.width="0",s.style.width="1px",Ce.appendChild(o),t=!parseFloat(e.getComputedStyle(r).marginRight),Ce.removeChild(o),s.removeChild(r),t}}))}();var De=/^(none|table(?!-c[ea]).+)/,Ie={position:"absolute",visibility:"hidden",display:"block"},Re={letterSpacing:"0",fontWeight:"400"},Ne=["Webkit","O","Moz","ms"],Le=i.createElement("div").style;function Fe(e){if(e in Le)return e;for(var t=e[0].toUpperCase()+e.slice(1),r=Ne.length;r--;)if((e=Ne[r]+t)in Le)return e}function Be(e,t,r){var i=V.exec(t);return i?Math.max(0,i[2]-(r||0))+(i[3]||"px"):t}function Ue(e,t,r,i,n){for(var a=r===(i?"border":"content")?4:"width"===t?1:0,o=0;a<4;a+=2)"margin"===r&&(o+=f.css(e,r+G[a],!0,n)),i?("content"===r&&(o-=f.css(e,"padding"+G[a],!0,n)),"margin"!==r&&(o-=f.css(e,"border"+G[a]+"Width",!0,n))):(o+=f.css(e,"padding"+G[a],!0,n),"padding"!==r&&(o+=f.css(e,"border"+G[a]+"Width",!0,n)));return o}function ze(e,t,r){var i=!0,n="width"===t?e.offsetWidth:e.offsetHeight,a=Se(e),o="border-box"===f.css(e,"boxSizing",!1,a);if(n<=0||null==n){if(((n=Pe(e,t,a))<0||null==n)&&(n=e.style[t]),ke.test(n))return n;i=o&&(c.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+Ue(e,t,r||(o?"border":"content"),i,a)+"px"}function He(e,t){for(var r,i,n,a=[],o=0,s=e.length;o<s;o++)(i=e[o]).style&&(a[o]=F.get(i,"olddisplay"),r=i.style.display,t?(a[o]||"none"!==r||(i.style.display=""),""===i.style.display&&K(i)&&(a[o]=F.access(i,"olddisplay",Ae(i.nodeName)))):(n=K(i),"none"===r&&n||F.set(i,"olddisplay",n?r:f.css(i,"display"))));for(o=0;o<s;o++)(i=e[o]).style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?a[o]||"":"none"));return e}function je(e,t,r,i,n){return new je.prototype.init(e,t,r,i,n)}f.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=Pe(e,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,a,o,s=f.camelCase(t),l=e.style;if(t=f.cssProps[s]||(f.cssProps[s]=Fe(s)||s),o=f.cssHooks[t]||f.cssHooks[s],void 0===r)return o&&"get"in o&&void 0!==(n=o.get(e,!1,i))?n:l[t];"string"===(a=typeof r)&&(n=V.exec(r))&&n[1]&&(r=W(e,t,n),a="number"),null!=r&&r==r&&("number"===a&&(r+=n&&n[3]||(f.cssNumber[s]?"":"px")),c.clearCloneStyle||""!==r||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(r=o.set(e,r,i))||(l[t]=r))}},css:function(e,t,r,i){var n,a,o,s=f.camelCase(t);return t=f.cssProps[s]||(f.cssProps[s]=Fe(s)||s),(o=f.cssHooks[t]||f.cssHooks[s])&&"get"in o&&(n=o.get(e,!0,r)),void 0===n&&(n=Pe(e,t,i)),"normal"===n&&t in Re&&(n=Re[t]),""===r||r?(a=parseFloat(n),!0===r||isFinite(a)?a||0:n):n}}),f.each(["height","width"],(function(e,t){f.cssHooks[t]={get:function(e,r,i){if(r)return De.test(f.css(e,"display"))&&0===e.offsetWidth?Me(e,Ie,(function(){return ze(e,t,i)})):ze(e,t,i)},set:function(e,r,i){var n,a=i&&Se(e),o=i&&Ue(e,t,i,"border-box"===f.css(e,"boxSizing",!1,a),a);return o&&(n=V.exec(r))&&"px"!==(n[3]||"px")&&(e.style[t]=r,r=f.css(e,t)),Be(0,r,o)}}})),f.cssHooks.marginLeft=Oe(c.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Pe(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),f.cssHooks.marginRight=Oe(c.reliableMarginRight,(function(e,t){if(t)return Me(e,{display:"inline-block"},Pe,[e,"marginRight"])})),f.each({margin:"",padding:"",border:"Width"},(function(e,t){f.cssHooks[e+t]={expand:function(r){for(var i=0,n={},a="string"==typeof r?r.split(" "):[r];i<4;i++)n[e+G[i]+t]=a[i]||a[i-2]||a[0];return n}},we.test(e)||(f.cssHooks[e+t].set=Be)})),f.fn.extend({css:function(e,t){return R(this,(function(e,t,r){var i,n,a={},o=0;if(f.isArray(t)){for(i=Se(e),n=t.length;o<n;o++)a[t[o]]=f.css(e,t[o],!1,i);return a}return void 0!==r?f.style(e,t,r):f.css(e,t)}),e,t,arguments.length>1)},show:function(){return He(this,!0)},hide:function(){return He(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){K(this)?f(this).show():f(this).hide()}))}}),f.Tween=je,je.prototype={constructor:je,init:function(e,t,r,i,n,a){this.elem=e,this.prop=r,this.easing=n||f.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=a||(f.cssNumber[r]?"":"px")},cur:function(){var e=je.propHooks[this.prop];return e&&e.get?e.get(this):je.propHooks._default.get(this)},run:function(e){var t,r=je.propHooks[this.prop];return this.options.duration?this.pos=t=f.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):je.propHooks._default.set(this),this}},je.prototype.init.prototype=je.prototype,je.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=f.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){f.fx.step[e.prop]?f.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[f.cssProps[e.prop]]&&!f.cssHooks[e.prop]?e.elem[e.prop]=e.now:f.style(e.elem,e.prop,e.now+e.unit)}}},je.propHooks.scrollTop=je.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},f.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},f.fx=je.prototype.init,f.fx.step={};var Ve,Ge,Ke=/^(?:toggle|show|hide)$/,We=/queueHooks$/;function Ye(){return e.setTimeout((function(){Ve=void 0})),Ve=f.now()}function Xe(e,t){var r,i=0,n={height:e};for(t=t?1:0;i<4;i+=2-t)n["margin"+(r=G[i])]=n["padding"+r]=e;return t&&(n.opacity=n.width=e),n}function qe(e,t,r){for(var i,n=(Ze.tweeners[t]||[]).concat(Ze.tweeners["*"]),a=0,o=n.length;a<o;a++)if(i=n[a].call(r,t,e))return i}function Ze(e,t,r){var i,n,a=0,o=Ze.prefilters.length,s=f.Deferred().always((function(){delete l.elem})),l=function(){if(n)return!1;for(var t=Ve||Ye(),r=Math.max(0,h.startTime+h.duration-t),i=1-(r/h.duration||0),a=0,o=h.tweens.length;a<o;a++)h.tweens[a].run(i);return s.notifyWith(e,[h,i,r]),i<1&&o?r:(s.resolveWith(e,[h]),!1)},h=s.promise({elem:e,props:f.extend({},t),opts:f.extend(!0,{specialEasing:{},easing:f.easing._default},r),originalProperties:t,originalOptions:r,startTime:Ve||Ye(),duration:r.duration,tweens:[],createTween:function(t,r){var i=f.Tween(e,h.opts,t,r,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(i),i},stop:function(t){var r=0,i=t?h.tweens.length:0;if(n)return this;for(n=!0;r<i;r++)h.tweens[r].run(1);return t?(s.notifyWith(e,[h,1,0]),s.resolveWith(e,[h,t])):s.rejectWith(e,[h,t]),this}}),u=h.props;for(!function(e,t){var r,i,n,a,o;for(r in e)if(n=t[i=f.camelCase(r)],a=e[r],f.isArray(a)&&(n=a[1],a=e[r]=a[0]),r!==i&&(e[i]=a,delete e[r]),(o=f.cssHooks[i])&&"expand"in o)for(r in a=o.expand(a),delete e[i],a)r in e||(e[r]=a[r],t[r]=n);else t[i]=n}(u,h.opts.specialEasing);a<o;a++)if(i=Ze.prefilters[a].call(h,e,u,h.opts))return f.isFunction(i.stop)&&(f._queueHooks(h.elem,h.opts.queue).stop=f.proxy(i.stop,i)),i;return f.map(u,qe,h),f.isFunction(h.opts.start)&&h.opts.start.call(e,h),f.fx.timer(f.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}f.Animation=f.extend(Ze,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return W(r.elem,e,V.exec(t),r),r}]},tweener:function(e,t){f.isFunction(e)?(t=e,e=["*"]):e=e.match(D);for(var r,i=0,n=e.length;i<n;i++)r=e[i],Ze.tweeners[r]=Ze.tweeners[r]||[],Ze.tweeners[r].unshift(t)},prefilters:[function(e,t,r){var i,n,a,o,s,l,h,u=this,c={},d=e.style,p=e.nodeType&&K(e),m=F.get(e,"fxshow");for(i in r.queue||(null==(s=f._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always((function(){u.always((function(){s.unqueued--,f.queue(e,"fx").length||s.empty.fire()}))}))),1===e.nodeType&&("height"in t||"width"in t)&&(r.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(h=f.css(e,"display"))?F.get(e,"olddisplay")||Ae(e.nodeName):h)&&"none"===f.css(e,"float")&&(d.display="inline-block")),r.overflow&&(d.overflow="hidden",u.always((function(){d.overflow=r.overflow[0],d.overflowX=r.overflow[1],d.overflowY=r.overflow[2]}))),t)if(n=t[i],Ke.exec(n)){if(delete t[i],a=a||"toggle"===n,n===(p?"hide":"show")){if("show"!==n||!m||void 0===m[i])continue;p=!0}c[i]=m&&m[i]||f.style(e,i)}else h=void 0;if(f.isEmptyObject(c))"inline"===("none"===h?Ae(e.nodeName):h)&&(d.display=h);else for(i in m?"hidden"in m&&(p=m.hidden):m=F.access(e,"fxshow",{}),a&&(m.hidden=!p),p?f(e).show():u.done((function(){f(e).hide()})),u.done((function(){var t;for(t in F.remove(e,"fxshow"),c)f.style(e,t,c[t])})),c)o=qe(p?m[i]:0,i,u),i in m||(m[i]=o.start,p&&(o.end=o.start,o.start="width"===i||"height"===i?1:0))}],prefilter:function(e,t){t?Ze.prefilters.unshift(e):Ze.prefilters.push(e)}}),f.speed=function(e,t,r){var i=e&&"object"==typeof e?f.extend({},e):{complete:r||!r&&t||f.isFunction(e)&&e,duration:e,easing:r&&t||t&&!f.isFunction(t)&&t};return i.duration=f.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in f.fx.speeds?f.fx.speeds[i.duration]:f.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){f.isFunction(i.old)&&i.old.call(this),i.queue&&f.dequeue(this,i.queue)},i},f.fn.extend({fadeTo:function(e,t,r,i){return this.filter(K).css("opacity",0).show().end().animate({opacity:t},e,r,i)},animate:function(e,t,r,i){var n=f.isEmptyObject(e),a=f.speed(t,r,i),o=function(){var t=Ze(this,f.extend({},e),a);(n||F.get(this,"finish"))&&t.stop(!0)};return o.finish=o,n||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(e,t,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){var t=!0,n=null!=e&&e+"queueHooks",a=f.timers,o=F.get(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&We.test(n)&&i(o[n]);for(n=a.length;n--;)a[n].elem!==this||null!=e&&a[n].queue!==e||(a[n].anim.stop(r),t=!1,a.splice(n,1));!t&&r||f.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,r=F.get(this),i=r[e+"queue"],n=r[e+"queueHooks"],a=f.timers,o=i?i.length:0;for(r.finish=!0,f.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete r.finish}))}}),f.each(["toggle","show","hide"],(function(e,t){var r=f.fn[t];f.fn[t]=function(e,i,n){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(Xe(t,!0),e,i,n)}})),f.each({slideDown:Xe("show"),slideUp:Xe("hide"),slideToggle:Xe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){f.fn[e]=function(e,r,i){return this.animate(t,e,r,i)}})),f.timers=[],f.fx.tick=function(){var e,t=0,r=f.timers;for(Ve=f.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||f.fx.stop(),Ve=void 0},f.fx.timer=function(e){f.timers.push(e),e()?f.fx.start():f.timers.pop()},f.fx.interval=13,f.fx.start=function(){Ge||(Ge=e.setInterval(f.fx.tick,f.fx.interval))},f.fx.stop=function(){e.clearInterval(Ge),Ge=null},f.fx.speeds={slow:600,fast:200,_default:400},f.fn.delay=function(t,r){return t=f.fx&&f.fx.speeds[t]||t,r=r||"fx",this.queue(r,(function(r,i){var n=e.setTimeout(r,t);i.stop=function(){e.clearTimeout(n)}}))},function(){var e=i.createElement("input"),t=i.createElement("select"),r=t.appendChild(i.createElement("option"));e.type="checkbox",c.checkOn=""!==e.value,c.optSelected=r.selected,t.disabled=!0,c.optDisabled=!r.disabled,(e=i.createElement("input")).value="t",e.type="radio",c.radioValue="t"===e.value}();var Je,Qe=f.expr.attrHandle;f.fn.extend({attr:function(e,t){return R(this,f.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){f.removeAttr(this,e)}))}}),f.extend({attr:function(e,t,r){var i,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?f.prop(e,t,r):(1===a&&f.isXMLDoc(e)||(t=t.toLowerCase(),n=f.attrHooks[t]||(f.expr.match.bool.test(t)?Je:void 0)),void 0!==r?null===r?void f.removeAttr(e,t):n&&"set"in n&&void 0!==(i=n.set(e,r,t))?i:(e.setAttribute(t,r+""),r):n&&"get"in n&&null!==(i=n.get(e,t))?i:null==(i=f.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!c.radioValue&&"radio"===t&&f.nodeName(e,"input")){var r=e.value;return e.setAttribute("type",t),r&&(e.value=r),t}}}},removeAttr:function(e,t){var r,i,n=0,a=t&&t.match(D);if(a&&1===e.nodeType)for(;r=a[n++];)i=f.propFix[r]||r,f.expr.match.bool.test(r)&&(e[i]=!1),e.removeAttribute(r)}}),Je={set:function(e,t,r){return!1===t?f.removeAttr(e,r):e.setAttribute(r,r),r}},f.each(f.expr.match.bool.source.match(/\w+/g),(function(e,t){var r=Qe[t]||f.find.attr;Qe[t]=function(e,t,i){var n,a;return i||(a=Qe[t],Qe[t]=n,n=null!=r(e,t,i)?t.toLowerCase():null,Qe[t]=a),n}}));var $e=/^(?:input|select|textarea|button)$/i,et=/^(?:a|area)$/i;f.fn.extend({prop:function(e,t){return R(this,f.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[f.propFix[e]||e]}))}}),f.extend({prop:function(e,t,r){var i,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&f.isXMLDoc(e)||(t=f.propFix[t]||t,n=f.propHooks[t]),void 0!==r?n&&"set"in n&&void 0!==(i=n.set(e,r,t))?i:e[t]=r:n&&"get"in n&&null!==(i=n.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=f.find.attr(e,"tabindex");return t?parseInt(t,10):$e.test(e.nodeName)||et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),c.optSelected||(f.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),f.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){f.propFix[this.toLowerCase()]=this}));var tt=/[\t\r\n\f]/g;function rt(e){return e.getAttribute&&e.getAttribute("class")||""}f.fn.extend({addClass:function(e){var t,r,i,n,a,o,s,l=0;if(f.isFunction(e))return this.each((function(t){f(this).addClass(e.call(this,t,rt(this)))}));if("string"==typeof e&&e)for(t=e.match(D)||[];r=this[l++];)if(n=rt(r),i=1===r.nodeType&&(" "+n+" ").replace(tt," ")){for(o=0;a=t[o++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");n!==(s=f.trim(i))&&r.setAttribute("class",s)}return this},removeClass:function(e){var t,r,i,n,a,o,s,l=0;if(f.isFunction(e))return this.each((function(t){f(this).removeClass(e.call(this,t,rt(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(D)||[];r=this[l++];)if(n=rt(r),i=1===r.nodeType&&(" "+n+" ").replace(tt," ")){for(o=0;a=t[o++];)for(;i.indexOf(" "+a+" ")>-1;)i=i.replace(" "+a+" "," ");n!==(s=f.trim(i))&&r.setAttribute("class",s)}return this},toggleClass:function(e,t){var r=typeof e;return"boolean"==typeof t&&"string"===r?t?this.addClass(e):this.removeClass(e):f.isFunction(e)?this.each((function(r){f(this).toggleClass(e.call(this,r,rt(this),t),t)})):this.each((function(){var t,i,n,a;if("string"===r)for(i=0,n=f(this),a=e.match(D)||[];t=a[i++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else void 0!==e&&"boolean"!==r||((t=rt(this))&&F.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":F.get(this,"__className__")||""))}))},hasClass:function(e){var t,r,i=0;for(t=" "+e+" ";r=this[i++];)if(1===r.nodeType&&(" "+rt(r)+" ").replace(tt," ").indexOf(t)>-1)return!0;return!1}});var it=/\r/g,nt=/[\x20\t\r\n\f]+/g;f.fn.extend({val:function(e){var t,r,i,n=this[0];return arguments.length?(i=f.isFunction(e),this.each((function(r){var n;1===this.nodeType&&(null==(n=i?e.call(this,r,f(this).val()):e)?n="":"number"==typeof n?n+="":f.isArray(n)&&(n=f.map(n,(function(e){return null==e?"":e+""}))),(t=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))}))):n?(t=f.valHooks[n.type]||f.valHooks[n.nodeName.toLowerCase()])&&"get"in t&&void 0!==(r=t.get(n,"value"))?r:"string"==typeof(r=n.value)?r.replace(it,""):null==r?"":r:void 0}}),f.extend({valHooks:{option:{get:function(e){var t=f.find.attr(e,"value");return null!=t?t:f.trim(f.text(e)).replace(nt," ")}},select:{get:function(e){for(var t,r,i=e.options,n=e.selectedIndex,a="select-one"===e.type||n<0,o=a?null:[],s=a?n+1:i.length,l=n<0?s:a?n:0;l<s;l++)if(((r=i[l]).selected||l===n)&&(c.optDisabled?!r.disabled:null===r.getAttribute("disabled"))&&(!r.parentNode.disabled||!f.nodeName(r.parentNode,"optgroup"))){if(t=f(r).val(),a)return t;o.push(t)}return o},set:function(e,t){for(var r,i,n=e.options,a=f.makeArray(t),o=n.length;o--;)((i=n[o]).selected=f.inArray(f.valHooks.option.get(i),a)>-1)&&(r=!0);return r||(e.selectedIndex=-1),a}}}}),f.each(["radio","checkbox"],(function(){f.valHooks[this]={set:function(e,t){if(f.isArray(t))return e.checked=f.inArray(f(e).val(),t)>-1}},c.checkOn||(f.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var at=/^(?:focusinfocus|focusoutblur)$/;f.extend(f.event,{trigger:function(t,r,n,a){var o,s,l,h,c,d,p,m=[n||i],g=u.call(t,"type")?t.type:t,y=u.call(t,"namespace")?t.namespace.split("."):[];if(s=l=n=n||i,3!==n.nodeType&&8!==n.nodeType&&!at.test(g+f.event.triggered)&&(g.indexOf(".")>-1&&(y=g.split("."),g=y.shift(),y.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[f.expando]?t:new f.Event(g,"object"==typeof t&&t)).isTrigger=a?2:3,t.namespace=y.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),r=null==r?[t]:f.makeArray(r,[t]),p=f.event.special[g]||{},a||!p.trigger||!1!==p.trigger.apply(n,r))){if(!a&&!p.noBubble&&!f.isWindow(n)){for(h=p.delegateType||g,at.test(h+g)||(s=s.parentNode);s;s=s.parentNode)m.push(s),l=s;l===(n.ownerDocument||i)&&m.push(l.defaultView||l.parentWindow||e)}for(o=0;(s=m[o++])&&!t.isPropagationStopped();)t.type=o>1?h:p.bindType||g,(d=(F.get(s,"events")||{})[t.type]&&F.get(s,"handle"))&&d.apply(s,r),(d=c&&s[c])&&d.apply&&N(s)&&(t.result=d.apply(s,r),!1===t.result&&t.preventDefault());return t.type=g,a||t.isDefaultPrevented()||p._default&&!1!==p._default.apply(m.pop(),r)||!N(n)||c&&f.isFunction(n[g])&&!f.isWindow(n)&&((l=n[c])&&(n[c]=null),f.event.triggered=g,n[g](),f.event.triggered=void 0,l&&(n[c]=l)),t.result}},simulate:function(e,t,r){var i=f.extend(new f.Event,r,{type:e,isSimulated:!0});f.event.trigger(i,null,t)}}),f.fn.extend({trigger:function(e,t){return this.each((function(){f.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var r=this[0];if(r)return f.event.trigger(e,t,r,!0)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(e,t){f.fn[t]=function(e,r){return arguments.length>0?this.on(t,null,e,r):this.trigger(t)}})),f.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),c.focusin="onfocusin"in e,c.focusin||f.each({focus:"focusin",blur:"focusout"},(function(e,t){var r=function(e){f.event.simulate(t,e.target,f.event.fix(e))};f.event.special[t]={setup:function(){var i=this.ownerDocument||this,n=F.access(i,t);n||i.addEventListener(e,r,!0),F.access(i,t,(n||0)+1)},teardown:function(){var i=this.ownerDocument||this,n=F.access(i,t)-1;n?F.access(i,t,n):(i.removeEventListener(e,r,!0),F.remove(i,t))}}}));var ot=e.location,st=f.now(),lt=/\?/;f.parseJSON=function(e){return JSON.parse(e+"")},f.parseXML=function(t){var r;if(!t||"string"!=typeof t)return null;try{r=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){r=void 0}return r&&!r.getElementsByTagName("parsererror").length||f.error("Invalid XML: "+t),r};var ht=/#.*$/,ut=/([?&])_=[^&]*/,ct=/^(.*?):[ \t]*([^\r\n]*)$/gm,dt=/^(?:GET|HEAD)$/,ft=/^\/\//,pt={},mt={},gt="*/".concat("*"),yt=i.createElement("a");function vt(e){return function(t,r){"string"!=typeof t&&(r=t,t="*");var i,n=0,a=t.toLowerCase().match(D)||[];if(f.isFunction(r))for(;i=a[n++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(r)):(e[i]=e[i]||[]).push(r)}}function bt(e,t,r,i){var n={},a=e===mt;function o(s){var l;return n[s]=!0,f.each(e[s]||[],(function(e,s){var h=s(t,r,i);return"string"!=typeof h||a||n[h]?a?!(l=h):void 0:(t.dataTypes.unshift(h),o(h),!1)})),l}return o(t.dataTypes[0])||!n["*"]&&o("*")}function xt(e,t){var r,i,n=f.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((n[r]?e:i||(i={}))[r]=t[r]);return i&&f.extend(!0,e,i),e}yt.href=ot.href,f.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ot.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ot.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?xt(xt(e,f.ajaxSettings),t):xt(f.ajaxSettings,e)},ajaxPrefilter:vt(pt),ajaxTransport:vt(mt),ajax:function(t,r){"object"==typeof t&&(r=t,t=void 0),r=r||{};var n,a,o,s,l,h,u,c,d=f.ajaxSetup({},r),p=d.context||d,m=d.context&&(p.nodeType||p.jquery)?f(p):f.event,g=f.Deferred(),y=f.Callbacks("once memory"),v=d.statusCode||{},b={},x={},_=0,T="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!s)for(s={};t=ct.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?o:null},setRequestHeader:function(e,t){var r=e.toLowerCase();return _||(e=x[r]=x[r]||e,b[e]=t),this},overrideMimeType:function(e){return _||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(_<2)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||T;return n&&n.abort(t),A(0,t),this}};if(g.promise(E).complete=y.add,E.success=E.done,E.error=E.fail,d.url=((t||d.url||ot.href)+"").replace(ht,"").replace(ft,ot.protocol+"//"),d.type=r.method||r.type||d.method||d.type,d.dataTypes=f.trim(d.dataType||"*").toLowerCase().match(D)||[""],null==d.crossDomain){h=i.createElement("a");try{h.href=d.url,h.href=h.href,d.crossDomain=yt.protocol+"//"+yt.host!=h.protocol+"//"+h.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=f.param(d.data,d.traditional)),bt(pt,d,r,E),2===_)return E;for(c in(u=f.event&&d.global)&&0==f.active++&&f.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!dt.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(lt.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=ut.test(a)?a.replace(ut,"$1_="+st++):a+(lt.test(a)?"&":"?")+"_="+st++)),d.ifModified&&(f.lastModified[a]&&E.setRequestHeader("If-Modified-Since",f.lastModified[a]),f.etag[a]&&E.setRequestHeader("If-None-Match",f.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||r.contentType)&&E.setRequestHeader("Content-Type",d.contentType),E.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+gt+"; q=0.01":""):d.accepts["*"]),d.headers)E.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(!1===d.beforeSend.call(p,E,d)||2===_))return E.abort();for(c in T="abort",{success:1,error:1,complete:1})E[c](d[c]);if(n=bt(mt,d,r,E)){if(E.readyState=1,u&&m.trigger("ajaxSend",[E,d]),2===_)return E;d.async&&d.timeout>0&&(l=e.setTimeout((function(){E.abort("timeout")}),d.timeout));try{_=1,n.send(b,A)}catch(e){if(!(_<2))throw e;A(-1,e)}}else A(-1,"No Transport");function A(t,r,i,s){var h,c,b,x,T,A=r;2!==_&&(_=2,l&&e.clearTimeout(l),n=void 0,o=s||"",E.readyState=t>0?4:0,h=t>=200&&t<300||304===t,i&&(x=function(e,t,r){for(var i,n,a,o,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(n in s)if(s[n]&&s[n].test(i)){l.unshift(n);break}if(l[0]in r)a=l[0];else{for(n in r){if(!l[0]||e.converters[n+" "+l[0]]){a=n;break}o||(o=n)}a=a||o}if(a)return a!==l[0]&&l.unshift(a),r[a]}(d,E,i)),x=function(e,t,r,i){var n,a,o,s,l,h={},u=e.dataTypes.slice();if(u[1])for(o in e.converters)h[o.toLowerCase()]=e.converters[o];for(a=u.shift();a;)if(e.responseFields[a]&&(r[e.responseFields[a]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=u.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(o=h[l+" "+a]||h["* "+a]))for(n in h)if((s=n.split(" "))[1]===a&&(o=h[l+" "+s[0]]||h["* "+s[0]])){!0===o?o=h[n]:!0!==h[n]&&(a=s[0],u.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(d,x,E,h),h?(d.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(f.lastModified[a]=T),(T=E.getResponseHeader("etag"))&&(f.etag[a]=T)),204===t||"HEAD"===d.type?A="nocontent":304===t?A="notmodified":(A=x.state,c=x.data,h=!(b=x.error))):(b=A,!t&&A||(A="error",t<0&&(t=0))),E.status=t,E.statusText=(r||A)+"",h?g.resolveWith(p,[c,A,E]):g.rejectWith(p,[E,A,b]),E.statusCode(v),v=void 0,u&&m.trigger(h?"ajaxSuccess":"ajaxError",[E,d,h?c:b]),y.fireWith(p,[E,A]),u&&(m.trigger("ajaxComplete",[E,d]),--f.active||f.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,r){return f.get(e,t,r,"json")},getScript:function(e,t){return f.get(e,void 0,t,"script")}}),f.each(["get","post"],(function(e,t){f[t]=function(e,r,i,n){return f.isFunction(r)&&(n=n||i,i=r,r=void 0),f.ajax(f.extend({url:e,type:t,dataType:n,data:r,success:i},f.isPlainObject(e)&&e))}})),f._evalUrl=function(e){return f.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},f.fn.extend({wrapAll:function(e){var t;return f.isFunction(e)?this.each((function(t){f(this).wrapAll(e.call(this,t))})):(this[0]&&(t=f(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this)},wrapInner:function(e){return f.isFunction(e)?this.each((function(t){f(this).wrapInner(e.call(this,t))})):this.each((function(){var t=f(this),r=t.contents();r.length?r.wrapAll(e):t.append(e)}))},wrap:function(e){var t=f.isFunction(e);return this.each((function(r){f(this).wrapAll(t?e.call(this,r):e)}))},unwrap:function(){return this.parent().each((function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)})).end()}}),f.expr.filters.hidden=function(e){return!f.expr.filters.visible(e)},f.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var _t=/%20/g,Tt=/\[\]$/,Et=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;function kt(e,t,r,i){var n;if(f.isArray(t))f.each(t,(function(t,n){r||Tt.test(e)?i(e,n):kt(e+"["+("object"==typeof n&&null!=n?t:"")+"]",n,r,i)}));else if(r||"object"!==f.type(t))i(e,t);else for(n in t)kt(e+"["+n+"]",t[n],r,i)}f.param=function(e,t){var r,i=[],n=function(e,t){t=f.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=f.ajaxSettings&&f.ajaxSettings.traditional),f.isArray(e)||e.jquery&&!f.isPlainObject(e))f.each(e,(function(){n(this.name,this.value)}));else for(r in e)kt(r,e[r],t,n);return i.join("&").replace(_t,"+")},f.fn.extend({serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=f.prop(this,"elements");return e?f.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!f(this).is(":disabled")&&wt.test(this.nodeName)&&!At.test(e)&&(this.checked||!Y.test(e))})).map((function(e,t){var r=f(this).val();return null==r?null:f.isArray(r)?f.map(r,(function(e){return{name:t.name,value:e.replace(Et,"\r\n")}})):{name:t.name,value:r.replace(Et,"\r\n")}})).get()}}),f.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var St={0:200,1223:204},Mt=f.ajaxSettings.xhr();c.cors=!!Mt&&"withCredentials"in Mt,c.ajax=Mt=!!Mt,f.ajaxTransport((function(t){var r,i;if(c.cors||Mt&&!t.crossDomain)return{send:function(n,a){var o,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];for(o in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)s.setRequestHeader(o,n[o]);r=function(e){return function(){r&&(r=i=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?a(0,"error"):a(s.status,s.statusText):a(St[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=r(),i=s.onerror=r("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout((function(){r&&i()}))},r=r("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(r)throw e}},abort:function(){r&&r()}}})),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return f.globalEval(e),e}}}),f.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),f.ajaxTransport("script",(function(e){var t,r;if(e.crossDomain)return{send:function(n,a){t=f("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",r=function(e){t.remove(),r=null,e&&a("error"===e.type?404:200,e.type)}),i.head.appendChild(t[0])},abort:function(){r&&r()}}}));var Ct=[],Pt=/(=)\?(?=&|$)|\?\?/;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ct.pop()||f.expando+"_"+st++;return this[e]=!0,e}}),f.ajaxPrefilter("json jsonp",(function(t,r,i){var n,a,o,s=!1!==t.jsonp&&(Pt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=f.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Pt,"$1"+n):!1!==t.jsonp&&(t.url+=(lt.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return o||f.error(n+" was not called"),o[0]},t.dataTypes[0]="json",a=e[n],e[n]=function(){o=arguments},i.always((function(){void 0===a?f(e).removeProp(n):e[n]=a,t[n]&&(t.jsonpCallback=r.jsonpCallback,Ct.push(n)),o&&f.isFunction(a)&&a(o[0]),o=a=void 0})),"script"})),f.parseHTML=function(e,t,r){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(r=t,t=!1),t=t||i;var n=E.exec(e),a=!r&&[];return n?[t.createElement(n[1])]:(n=re([e],t,a),a&&a.length&&f(a).remove(),f.merge([],n.childNodes))};var Ot=f.fn.load;function Dt(e){return f.isWindow(e)?e:9===e.nodeType&&e.defaultView}f.fn.load=function(e,t,r){if("string"!=typeof e&&Ot)return Ot.apply(this,arguments);var i,n,a,o=this,s=e.indexOf(" ");return s>-1&&(i=f.trim(e.slice(s)),e=e.slice(0,s)),f.isFunction(t)?(r=t,t=void 0):t&&"object"==typeof t&&(n="POST"),o.length>0&&f.ajax({url:e,type:n||"GET",dataType:"html",data:t}).done((function(e){a=arguments,o.html(i?f("<div>").append(f.parseHTML(e)).find(i):e)})).always(r&&function(e,t){o.each((function(){r.apply(this,a||[e.responseText,t,e])}))}),this},f.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){f.fn[t]=function(e){return this.on(t,e)}})),f.expr.filters.animated=function(e){return f.grep(f.timers,(function(t){return e===t.elem})).length},f.offset={setOffset:function(e,t,r){var i,n,a,o,s,l,h=f.css(e,"position"),u=f(e),c={};"static"===h&&(e.style.position="relative"),s=u.offset(),a=f.css(e,"top"),l=f.css(e,"left"),("absolute"===h||"fixed"===h)&&(a+l).indexOf("auto")>-1?(o=(i=u.position()).top,n=i.left):(o=parseFloat(a)||0,n=parseFloat(l)||0),f.isFunction(t)&&(t=t.call(e,r,f.extend({},s))),null!=t.top&&(c.top=t.top-s.top+o),null!=t.left&&(c.left=t.left-s.left+n),"using"in t?t.using.call(e,c):u.css(c)}},f.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){f.offset.setOffset(this,e,t)}));var t,r,i=this[0],n={top:0,left:0},a=i&&i.ownerDocument;return a?(t=a.documentElement,f.contains(t,i)?(n=i.getBoundingClientRect(),r=Dt(a),{top:n.top+r.pageYOffset-t.clientTop,left:n.left+r.pageXOffset-t.clientLeft}):n):void 0},position:function(){if(this[0]){var e,t,r=this[0],i={top:0,left:0};return"fixed"===f.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),f.nodeName(e[0],"html")||(i=e.offset()),i.top+=f.css(e[0],"borderTopWidth",!0),i.left+=f.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-f.css(r,"marginTop",!0),left:t.left-i.left-f.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===f.css(e,"position");)e=e.offsetParent;return e||Ce}))}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var r="pageYOffset"===t;f.fn[e]=function(i){return R(this,(function(e,i,n){var a=Dt(e);if(void 0===n)return a?a[t]:e[i];a?a.scrollTo(r?a.pageXOffset:n,r?n:a.pageYOffset):e[i]=n}),e,i,arguments.length)}})),f.each(["top","left"],(function(e,t){f.cssHooks[t]=Oe(c.pixelPosition,(function(e,r){if(r)return r=Pe(e,t),ke.test(r)?f(e).position()[t]+"px":r}))})),f.each({Height:"height",Width:"width"},(function(e,t){f.each({padding:"inner"+e,content:t,"":"outer"+e},(function(r,i){f.fn[i]=function(i,n){var a=arguments.length&&(r||"boolean"!=typeof i),o=r||(!0===i||!0===n?"margin":"border");return R(this,(function(t,r,i){var n;return f.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])):void 0===i?f.css(t,r,o):f.style(t,r,i,o)}),t,a?i:void 0,a,null)}}))})),f.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,i){return this.on(t,e,r,i)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)},size:function(){return this.length}}),f.fn.andSelf=f.fn.addBack;var It=e.jQuery,Rt=e.$;return f.noConflict=function(t){return e.$===f&&(e.$=Rt),t&&e.jQuery===f&&(e.jQuery=It),f},t||(e.jQuery=e.$=f),f}));var o,s=null;var l,h=function(){return s||(s=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),s},u=n;function c(e){if(""===e)return".";var t="/"===e[e.length-1]?e.slice(0,e.length-1):e,r=t.lastIndexOf("/");return-1===r?".":t.slice(0,r)}function d(e,t){if(e===t)return"";var r=e.split("/");"."===r[0]&&r.shift();var i,n,a=t.split("/");for("."===a[0]&&a.shift(),i=0;(i<a.length||i<r.length)&&null==n;i++)r[i]!==a[i]&&(n=i);var o=[];for(i=0;i<r.length-n;i++)o.push("..");return a.length>n&&o.push.apply(o,a.slice(n)),o.join("/")}(l=function(e,t){return d(c(u(e)),u(t))})._dirname=c,l._relative=d,o=h()+l("7pral","5eV8i");const f="#000000",p="#FFFFFF",m="#console",g=t(o),y="LOG",v="START_DRAG",b="CANCEL_DRAG",x="END_DRAG",_="DROP";let T;var E;let A;var w;let k;var S;(E=T||(T={}))[E.LEFT=1]="LEFT",E[E.MIDDLE=2]="MIDDLE",E[E.RIGHT=3]="RIGHT",(w=A||(A={}))[w.DOM_VK_CANCEL=3]="DOM_VK_CANCEL",w[w.DOM_VK_HELP=6]="DOM_VK_HELP",w[w.DOM_VK_BACK_SPACE=8]="DOM_VK_BACK_SPACE",w[w.DOM_VK_TAB=9]="DOM_VK_TAB",w[w.DOM_VK_CLEAR=12]="DOM_VK_CLEAR",w[w.DOM_VK_RETURN=13]="DOM_VK_RETURN",w[w.DOM_VK_ENTER=14]="DOM_VK_ENTER",w[w.DOM_VK_SHIFT=16]="DOM_VK_SHIFT",w[w.DOM_VK_CONTROL=17]="DOM_VK_CONTROL",w[w.DOM_VK_ALT=18]="DOM_VK_ALT",w[w.DOM_VK_PAUSE=19]="DOM_VK_PAUSE",w[w.DOM_VK_CAPS_LOCK=20]="DOM_VK_CAPS_LOCK",w[w.DOM_VK_ESCAPE=27]="DOM_VK_ESCAPE",w[w.DOM_VK_SPACE=32]="DOM_VK_SPACE",w[w.DOM_VK_PAGE_UP=33]="DOM_VK_PAGE_UP",w[w.DOM_VK_PAGE_DOWN=34]="DOM_VK_PAGE_DOWN",w[w.DOM_VK_END=35]="DOM_VK_END",w[w.DOM_VK_HOME=36]="DOM_VK_HOME",w[w.DOM_VK_LEFT=37]="DOM_VK_LEFT",w[w.DOM_VK_UP=38]="DOM_VK_UP",w[w.DOM_VK_RIGHT=39]="DOM_VK_RIGHT",w[w.DOM_VK_DOWN=40]="DOM_VK_DOWN",w[w.DOM_VK_PRINTSCREEN=44]="DOM_VK_PRINTSCREEN",w[w.DOM_VK_INSERT=45]="DOM_VK_INSERT",w[w.DOM_VK_DELETE=46]="DOM_VK_DELETE",w[w.DOM_VK_0=48]="DOM_VK_0",w[w.DOM_VK_1=49]="DOM_VK_1",w[w.DOM_VK_2=50]="DOM_VK_2",w[w.DOM_VK_3=51]="DOM_VK_3",w[w.DOM_VK_4=52]="DOM_VK_4",w[w.DOM_VK_5=53]="DOM_VK_5",w[w.DOM_VK_6=54]="DOM_VK_6",w[w.DOM_VK_7=55]="DOM_VK_7",w[w.DOM_VK_8=56]="DOM_VK_8",w[w.DOM_VK_9=57]="DOM_VK_9",w[w.DOM_VK_SEMICOLON=59]="DOM_VK_SEMICOLON",w[w.DOM_VK_LESSTHAN=60]="DOM_VK_LESSTHAN",w[w.DOM_VK_EQUALS=61]="DOM_VK_EQUALS",w[w.DOM_VK_MORETHAN=62]="DOM_VK_MORETHAN",w[w.DOM_VK_A=65]="DOM_VK_A",w[w.DOM_VK_B=66]="DOM_VK_B",w[w.DOM_VK_C=67]="DOM_VK_C",w[w.DOM_VK_D=68]="DOM_VK_D",w[w.DOM_VK_E=69]="DOM_VK_E",w[w.DOM_VK_F=70]="DOM_VK_F",w[w.DOM_VK_G=71]="DOM_VK_G",w[w.DOM_VK_H=72]="DOM_VK_H",w[w.DOM_VK_I=73]="DOM_VK_I",w[w.DOM_VK_J=74]="DOM_VK_J",w[w.DOM_VK_K=75]="DOM_VK_K",w[w.DOM_VK_L=76]="DOM_VK_L",w[w.DOM_VK_M=77]="DOM_VK_M",w[w.DOM_VK_N=78]="DOM_VK_N",w[w.DOM_VK_O=79]="DOM_VK_O",w[w.DOM_VK_P=80]="DOM_VK_P",w[w.DOM_VK_Q=81]="DOM_VK_Q",w[w.DOM_VK_R=82]="DOM_VK_R",w[w.DOM_VK_S=83]="DOM_VK_S",w[w.DOM_VK_T=84]="DOM_VK_T",w[w.DOM_VK_U=85]="DOM_VK_U",w[w.DOM_VK_V=86]="DOM_VK_V",w[w.DOM_VK_W=87]="DOM_VK_W",w[w.DOM_VK_X=88]="DOM_VK_X",w[w.DOM_VK_Y=89]="DOM_VK_Y",w[w.DOM_VK_Z=90]="DOM_VK_Z",w[w.DOM_VK_CONTEXT_MENU=93]="DOM_VK_CONTEXT_MENU",w[w.DOM_VK_NUMPAD0=96]="DOM_VK_NUMPAD0",w[w.DOM_VK_NUMPAD1=97]="DOM_VK_NUMPAD1",w[w.DOM_VK_NUMPAD2=98]="DOM_VK_NUMPAD2",w[w.DOM_VK_NUMPAD3=99]="DOM_VK_NUMPAD3",w[w.DOM_VK_NUMPAD4=100]="DOM_VK_NUMPAD4",w[w.DOM_VK_NUMPAD5=101]="DOM_VK_NUMPAD5",w[w.DOM_VK_NUMPAD6=102]="DOM_VK_NUMPAD6",w[w.DOM_VK_NUMPAD7=103]="DOM_VK_NUMPAD7",w[w.DOM_VK_NUMPAD8=104]="DOM_VK_NUMPAD8",w[w.DOM_VK_NUMPAD9=105]="DOM_VK_NUMPAD9",w[w.DOM_VK_MULTIPLY=106]="DOM_VK_MULTIPLY",w[w.DOM_VK_ADD=107]="DOM_VK_ADD",w[w.DOM_VK_SEPARATOR=108]="DOM_VK_SEPARATOR",w[w.DOM_VK_SUBTRACT=109]="DOM_VK_SUBTRACT",w[w.DOM_VK_DECIMAL=110]="DOM_VK_DECIMAL",w[w.DOM_VK_DIVIDE=111]="DOM_VK_DIVIDE",w[w.DOM_VK_F1=112]="DOM_VK_F1",w[w.DOM_VK_F2=113]="DOM_VK_F2",w[w.DOM_VK_F3=114]="DOM_VK_F3",w[w.DOM_VK_F4=115]="DOM_VK_F4",w[w.DOM_VK_F5=116]="DOM_VK_F5",w[w.DOM_VK_F6=117]="DOM_VK_F6",w[w.DOM_VK_F7=118]="DOM_VK_F7",w[w.DOM_VK_F8=119]="DOM_VK_F8",w[w.DOM_VK_F9=120]="DOM_VK_F9",w[w.DOM_VK_F10=121]="DOM_VK_F10",w[w.DOM_VK_F11=122]="DOM_VK_F11",w[w.DOM_VK_F12=123]="DOM_VK_F12",w[w.DOM_VK_F13=124]="DOM_VK_F13",w[w.DOM_VK_F14=125]="DOM_VK_F14",w[w.DOM_VK_F15=126]="DOM_VK_F15",w[w.DOM_VK_F16=127]="DOM_VK_F16",w[w.DOM_VK_F17=128]="DOM_VK_F17",w[w.DOM_VK_F18=129]="DOM_VK_F18",w[w.DOM_VK_F19=130]="DOM_VK_F19",w[w.DOM_VK_F20=131]="DOM_VK_F20",w[w.DOM_VK_F21=132]="DOM_VK_F21",w[w.DOM_VK_F22=133]="DOM_VK_F22",w[w.DOM_VK_F23=134]="DOM_VK_F23",w[w.DOM_VK_F24=135]="DOM_VK_F24",w[w.DOM_VK_NUM_LOCK=144]="DOM_VK_NUM_LOCK",w[w.DOM_VK_SCROLL_LOCK=145]="DOM_VK_SCROLL_LOCK",w[w.DOM_VK_COMMA=188]="DOM_VK_COMMA",w[w.DOM_VK_PERIOD=190]="DOM_VK_PERIOD",w[w.DOM_VK_SLASH=191]="DOM_VK_SLASH",w[w.DOM_VK_BACK_QUOTE=192]="DOM_VK_BACK_QUOTE",w[w.DOM_VK_OPEN_BRACKET=219]="DOM_VK_OPEN_BRACKET",w[w.DOM_VK_BACK_SLASH=220]="DOM_VK_BACK_SLASH",w[w.DOM_VK_CLOSE_BRACKET=221]="DOM_VK_CLOSE_BRACKET",w[w.DOM_VK_QUOTE=222]="DOM_VK_QUOTE",w[w.DOM_VK_META=224]="DOM_VK_META",(S=k||(k={}))[S.KEY_OR_BUTTON=1]="KEY_OR_BUTTON",S[S.MOUSE_MOVEMENT=2]="MOUSE_MOVEMENT",S[S.JOYSTICK_AXIS=3]="JOYSTICK_AXIS";class M{static multiply(e,t){let r,i,n;if("number"==typeof e)r=(16711680&e)>>16,i=(65280&e)>>8,n=255&e;else{let t=M.toRgb(e);r=t[0],i=t[1],n=t[2]}return r=Math.round(r*t),i=Math.round(i*t),n=Math.round(n*t),r=r<0?0:r>255?255:r,i=i<0?0:i>255?255:i,n=n<0?0:n>255?255:n,n|i<<8|r<<16}static max(e,t){let r,i,n,a,o,s;if("number"==typeof e)r=(16711680&e)>>16,i=(65280&e)>>8,n=255&e;else{let t=M.toRgb(e);r=t[0],i=t[1],n=t[2]}if("number"==typeof t)a=(16711680&t)>>16,o=(65280&t)>>8,s=255&t;else{let e=M.toRgb(t);a=e[0],o=e[1],s=e[2]}return a>r&&(r=a),o>i&&(i=o),s>n&&(n=s),n|i<<8|r<<16}static min(e,t){let r,i,n,a,o,s;if("number"==typeof e)r=(16711680&e)>>16,i=(65280&e)>>8,n=255&e;else{let t=M.toRgb(e);r=t[0],i=t[1],n=t[2]}if("number"==typeof t)a=(16711680&t)>>16,o=(65280&t)>>8,s=255&t;else{let e=M.toRgb(t);a=e[0],o=e[1],s=e[2]}return a<r&&(r=a),o<i&&(i=o),s<n&&(n=s),n|i<<8|r<<16}static colorMultiply(e,t){let r,i,n,a,o,s;if("number"==typeof e)r=(16711680&e)>>16,i=(65280&e)>>8,n=255&e;else{let t=M.toRgb(e);r=t[0],i=t[1],n=t[2]}if("number"==typeof t)a=(16711680&t)>>16,o=(65280&t)>>8,s=255&t;else{let e=M.toRgb(t);a=e[0],o=e[1],s=e[2]}return r=Math.floor(r*a/255),i=Math.floor(i*o/255),n=Math.floor(n*s/255),r=r<0?0:r>255?255:r,i=i<0?0:i>255?255:i,n=n<0?0:n>255?255:n,n|i<<8|r<<16}static computeIntensity(e){let t,r,i;if("number"==typeof e)t=(16711680&e)>>16,r=(65280&e)>>8,i=255&e;else{let n=M.toRgb(e);t=n[0],r=n[1],i=n[2]}return 1/255*(.2126*t+.7152*r+.0722*i)}static add(e,t){let r=((16711680&e)>>16)+((16711680&t)>>16),i=((65280&e)>>8)+((65280&t)>>8),n=(255&e)+(255&t);return r>255&&(r=255),i>255&&(i=255),n>255&&(n=255),n|i<<8|r<<16}static toRgb(e){return"number"==typeof e?M.toRgbFromNumber(e):M.toRgbFromString(e)}static toWeb(e){if("number"==typeof e){let t=e.toString(16),r=6-t.length;return r>0&&(t="000000".substr(0,r)+t),"#"+t}return e}static toNumber(e){if("number"==typeof e)return e;let t=e;if("#"===t.charAt(0)&&7===t.length)return parseInt(t.substr(1),16);{let e=M.toRgbFromString(t);return 65536*e[0]+256*e[1]+e[2]}}static stdCol={aqua:[0,255,255],black:[0,0,0],blue:[0,0,255],fuchsia:[255,0,255],gray:[128,128,128],green:[0,128,0],lime:[0,255,0],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],purple:[128,0,128],red:[255,0,0],silver:[192,192,192],teal:[0,128,128],white:[255,255,255],yellow:[255,255,0]};static toRgbFromNumber(e){return[(16711680&e)>>16,(65280&e)>>8,255&e]}static toRgbFromString(e){e=e.toLowerCase();let t=M.stdCol[String(e)];if(t)return t;if("#"===e.charAt(0)){return 4===e.length&&(e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)),[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]}if(0===e.indexOf("rgb(")){let t=e.substr(4,e.length-5).split(",");return[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)]}return[0,0,0]}}class C{static distance(e,t){let r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}static taxiDistance(e,t){let r=e.x-t.x,i=e.y-t.y;return Math.max(Math.abs(r),Math.abs(i))}static TDX=[-1,1,0,0,-1,1,-1,1];static TDY=[0,0,-1,1,-1,-1,1,1];constructor(e=0,t=0){this.x=e,this.y=t}set(e){this.x=e.x,this.y=e.y}clone(){return new C(this.x,this.y)}toString(){return this.x+","+this.y}moveTo(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isAdjacent(e,t=!0){let r=Math.abs(this.x-e.x),i=Math.abs(this.y-e.y);return t?1===r&&i<=1||r<=1&&1===i:1===r&&0===i||0===r&&1===i}getAdjacentCells(e,t,r=!0){let i=[];for(let n=0,a=r?8:4;n<a;++n){let r=this.x+C.TDX[n];if(r>=0&&r<e){let e=this.y+C.TDY[n];e>=0&&e<t&&i.push(new C(r,e))}}return i}}class P extends C{constructor(e=0,t=0,r=0,i=0){super(e,t),this.w=r,this.h=i}toString(){return super.toString()+"("+this.w+","+this.h+")"}resize(e,t){this.w=e,this.h=t}equals(e){return this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h}containsPos(e){return e.x>=this.x&&e.y>=this.y&&e.x<this.x+this.w&&e.y<this.y+this.h}contains(e,t){return e>=this.x&&t>=this.y&&e<this.x+this.w&&t<this.y+this.h}containsRect(e){return this.x<=e.x&&this.y<=e.y&&this.x+this.w>=e.x+e.w&&this.y+this.h>=e.y+e.h}intersects(e){return!(this.x+this.w<=e.x||e.x+e.w<=this.x||this.y+this.h<=e.y||e.y+e.h<=this.y)}expand(e){e.x<this.x?(this.w+=this.x-e.x,this.x=e.x):e.x>=this.x+this.w&&(this.w+=e.x-this.x-this.w+1),e.y<this.y?(this.h+=this.y-e.y,this.y=e.y):e.y>=this.y+this.h&&(this.h+=e.y-this.y-this.h+1)}expandRect(e){this.expand(e),this.expand(new C(e.x+e.w-1,e.y+e.h-1))}set(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h}clamp(e,t,r,i){this.x<e&&(this.w-=e-this.x,this.x=e),this.x+this.w>r&&(this.w=r-this.x),this.y<t&&(this.h-=t-this.y,this.y=t),this.y+this.h>i&&(this.h=i-this.y)}}class O{constructor(e,t=[]){this.__parent=e,this.children=t}addChild(e){return this.children.push(e),e.__parent=this,e}removeChild(e){let t=this.children.indexOf(e);return-1!==t&&this.children.splice(t,1),e}contains(e){if(!this.children)return!1;for(let t of this.children)if(t===e||t.contains(e))return!0;return!1}clearChildren(){this.children=[]}postLoad(){for(let e of this.children)e.__parent=this}}let D,I;function R(e){let t=[];for(let r=0;r<e;++r)t[r]=[];return t}function N(e){D||function(){let e;D=[];for(let t=0;t<256;t++){e=t;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;D[t]=e}}();let t=-1;for(let r=0,i=e.length;r<i;++r)t=t>>>8^D[255&(t^e.charCodeAt(r))];return(-1^t)>>>0}function L(e,t,r){return e<t?t:e>r?r:e}var F;(F=I||(I={}))[F.NONE=0]="NONE",F[F.HORIZONTAL=1]="HORIZONTAL",F[F.VERTICAL=2]="VERTICAL",F[F.BOTH=3]="BOTH";class B extends O{boundingBox=new P;visible=!0;zOrder=0;setExpandFlag(e){this._expand=e}logSceneGraph(e="",t=!0){t&&console.log("##### Umbra node stats :"+this.computeNodeCount(!0)+" nodes ("+this.computeNodeCount(!1)+" visibles) #####"),console.log(e+(this.visible?"":"*")+this.toString());for(let t of this.children)t.logSceneGraph(e+"  ",!1)}computeNodeCount(e=!1){if(!e&&!this.isVisible())return 0;let t=1;for(let r of this.children)t+=r.computeNodeCount(e);return t}toString(){return this.constructor.name+":"+this.boundingBox.toString()}expand(e,t){this.visible&&(e&&e>this.boundingBox.w&&(this._expand===I.HORIZONTAL||this._expand===I.BOTH)?this.boundingBox.w=e:e=this.boundingBox.w,t&&t>this.boundingBox.h&&(this._expand===I.VERTICAL||this._expand===I.BOTH)?this.boundingBox.h=t:t=this.boundingBox.h,this.expandChildren(e,t))}clearChildren(){this.termHierarchy(),super.clearChildren()}show(){this.visible=!0}hide(){this.visible=!1}getVisibleFlag(){return this.visible}isVisible(){return this.visible&&(void 0===this.__parent||this.__parent.isVisible())}getBoundingBox(){return this.boundingBox}getParentBoundingBox(){return this.__parent?this.__parent.getBoundingBox():void 0}moveTo(e,t){if("number"==typeof e)this.boundingBox.moveTo(e,t||this.boundingBox.y);else{let t=e;this.boundingBox.moveTo(t.x,t.y)}}moveToBottomLeft(){let e=this.getParentBoundingBox(),t=e?e.h:sc.getConsole().height;this.moveTo(0,t-this.boundingBox.h)}moveToTopLeft(){this.moveTo(0,0)}moveToBottomRight(){let e=this.getParentBoundingBox(),t=e?e.w:sc.getConsole().width,r=e?e.h:sc.getConsole().height;this.moveTo(t-this.boundingBox.w,r-this.boundingBox.h)}moveToTopRight(){let e=this.getParentBoundingBox(),t=e?e.w:sc.getConsole().width;this.moveTo(t-this.boundingBox.w,0)}resize(e,t){this.boundingBox.resize(e,t)}getZOrder(){return this.zOrder}setZOrder(e){let t=e-this.zOrder;this.zOrder=e;for(let e of this.children){let r=e;r.setZOrder(r.zOrder+t)}}containsAbsolute(e){let t=this.__parent,r=e.x,i=e.y;for(;t;)r-=t.boundingBox.x,i-=t.boundingBox.y,t=t.__parent;return this.boundingBox.contains(r,i)}abs2Local(e){let t=this;for(;t;)e.x-=t.boundingBox.x,e.y-=t.boundingBox.y,t=t.__parent}local2Abs(e){let t=this;for(;t;)e.x+=t.boundingBox.x,e.y+=t.boundingBox.y,t=t.__parent}onInit(){}onTerm(){}onPreRender(e){}onPostRender(e){}onRender(e){}onUpdate(e){}initHierarchy(){this.onInit();for(let e of this.children)e.initHierarchy()}renderHierarchy(e,t){if(this.visible){let r=void 0===t;t||(t=[]),t.push(this);for(let r of this.children)r.renderHierarchy(e,t);if(r){t.sort(((e,t)=>e.zOrder<t.zOrder?-1:e.zOrder>t.zOrder?1:0));for(let r of t)r.onPreRender(e);for(let r of t)r.onRender(e);for(let r of t)r.onPostRender(e)}}}async updateHierarchy(e){this.visible&&(await this.updateChildrenHierarchy(e),await this.onUpdate(e))}async updateHierarchyForType(e,t){if(this.visible){for(let r of this.children)await r.updateHierarchyForType(e,t);this instanceof t&&await this.onUpdate(e)}}termHierarchy(){for(let e=this.children.length-1;e>=0;--e){this.children[e].termHierarchy()}this.onTerm()}addChild(e){return super.addChild(e),e instanceof B&&e.computeBoundingBox(),e}removeChild(e){return super.removeChild(e),this.computeBoundingBox(),e}center(){let e=this.getParentBoundingBox();e&&this.moveTo(Math.floor((e.w-this.boundingBox.w)/2),Math.floor((e.h-this.boundingBox.h)/2))}computeBoundingBox(){if(this.visible){this.children.length>0&&(this.boundingBox.w=0,this.boundingBox.h=0);for(let e of this.children){let t=e;t.computeBoundingBox(),t.visible&&(this.boundingBox.w=Math.max(this.boundingBox.w,t.boundingBox.x+t.boundingBox.w),this.boundingBox.h=Math.max(this.boundingBox.h,t.boundingBox.y+t.boundingBox.h))}}}expandChildren(e,t){for(let r of this.children)r.expand(e,t)}async updateChildrenHierarchy(e){for(let t of this.children)await t.updateHierarchy(e)}}class U extends class{getRandomChance(e){let t=0;for(let r in e)e.hasOwnProperty(r)&&e[r]>0&&(t+=e[r]);let r=this.getNumber(0,t),i=0;for(let t in e)if(e.hasOwnProperty(t)&&e[t]>0&&(i+=e[t],r<=i))return t;return 0}}{static DIVIDER=1/Math.pow(2,32);cur=0;static get default(){return void 0===U._default&&(U._default=new U((new Date).getTime())),U._default}constructor(e){super(),e||(e=Math.floor(2147483647*Math.random()));let t=e;this.Q=[];for(let e=0;e<4096;e++)t=(1103515245*t+12345)%4294967296,this.Q[e]=t;this.c=(1103515245*t+12345)%809430660}getNumber(e,t){if(t===e)return e;if(t<e){let r=t;t=e,e=r}let r=t-e+1;return Math.abs(this.getCMWCNumber()%r)+e}getCMWCNumber(){let e,t;return this.cur=(this.cur+1)%4096,e=18782*this.Q[this.cur]+this.c,this.c=Math.floor(e*U.DIVIDER),t=(e+this.c)%4294967296,t<this.c&&(t++,this.c++),-1===t&&(this.c++,t=0),this.Q[this.cur]=4294967294-t,this.Q[this.cur]}}const z=196,H=179,j=180,V=195,G=193,K=194,W=197;class Y{constructor(e,t,r=16777215,i=0,n){this.renderer=n,this._width=e,this._height=t,this.text=this.newTable(),this.fore=this.newTable(),this.back=this.newTable(),this.clearText(),this.clearFore(r),this.clearBack(i),this.renderer&&this.renderer.init(this)}get height(){return this._height}get width(){return this._width}contains(e){return e.x>=0&&e.y>=0&&e.x<this._width&&e.y<this._height}render(){this.renderer&&this.renderer.render(this)}getPositionFromPixels(e,t,r){return this.renderer?this.renderer.getPositionFromPixels(e,t,r):void 0}getPixelPositionFromCell(e,t,r){return this.renderer?this.renderer.getPixelPositionFromCell(e,t,r):void 0}print(e,t,r,i=16777215){if(!r||void 0===e||void 0===t)return;let n=0,a=r.length;e+a>this.width&&(a=this.width-e),e<0&&(a+=e,n=-e,e=0),this.clearFore(i,e,t,a,1);for(let i=n;i<a;++i)this.text[i+e][t]=r.charCodeAt(i)}clearText(e=0,t=0,r=0,i=-1,n=-1){this.clearTable(this.text,e,t,r,i,n)}clearFore(e,t=0,r=0,i=-1,n=-1){this.clearTable(this.fore,e,t,r,i,n)}clearBack(e,t=0,r=0,i=-1,n=-1){this.clearTable(this.back,e,t,r,i,n)}blit(e,t=0,r=0,i=0,n=0,a=-1,o=-1){-1===a&&(a=this.width),-1===o&&(o=this.height),t+a>e.width&&(a=e.width-t),r+o>e.height&&(o=e.height-r);for(let s=r;s<r+o;++s)for(let o=t;o<t+a;++o){let a=i+o-t,l=n+s-r;e.text[o][s]=this.text[a][l],e.back[o][s]=this.back[a][l],e.fore[o][s]=this.fore[a][l]}}clearTable(e,t,r=0,i=0,n=-1,a=-1){-1===n&&(n=this.width-r),-1===a&&(a=this.height-i),r<0&&(n+=r,r=0),i<0&&(a+=i,i=0),n=Math.min(this._width-r,n),a=Math.min(this._height-i,a);for(let o=r;o<r+n;++o)if(void 0===e[o])console.log("ERROR: column "+o+" does not exist");else for(let r=i;r<i+a;++r)e[o][r]=t}newTable(){let e=[];for(let t=0;t<this.width;++t)e[t]=[];return e}}var X,q,Z={};!function(e){var t=e.Promise,r=t&&"resolve"in t&&"reject"in t&&"all"in t&&"race"in t&&function(){var e;return new t((function(t){e=t})),"function"==typeof e}();void 0!==Z&&Z?(X=r?t:T,Z.Promise=X,q=T,Z.Polyfill=q):r||(e.Promise=T);var i="pending",n="sealed",a="fulfilled",o="rejected",s=function(){};function l(e){return"[object Array]"===Object.prototype.toString.call(e)}var h,u="undefined"!=typeof setImmediate?setImmediate:setTimeout,c=[];function d(){for(var e=0;e<c.length;e++)c[e][0](c[e][1]);c=[],h=!1}function f(e,t){c.push([e,t]),h||(h=!0,u(d,0))}function p(e){var t=e.owner,r=t.state_,i=t.data_,n=e[r],s=e.then;if("function"==typeof n){r=a;try{i=n(i)}catch(e){v(s,e)}}m(s,i)||(r===a&&g(s,i),r===o&&v(s,i))}function m(e,t){var r;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var i=t.then;if("function"==typeof i)return i.call(t,(function(i){r||(r=!0,t!==i?g(e,i):y(e,i))}),(function(t){r||(r=!0,v(e,t))})),!0}}catch(t){return r||v(e,t),!0}return!1}function g(e,t){e!==t&&m(e,t)||y(e,t)}function y(e,t){e.state_===i&&(e.state_=n,e.data_=t,f(x,e))}function v(e,t){e.state_===i&&(e.state_=n,e.data_=t,f(_,e))}function b(e){var t=e.then_;e.then_=void 0;for(var r=0;r<t.length;r++)p(t[r])}function x(e){e.state_=a,b(e)}function _(e){e.state_=o,b(e)}function T(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof T==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(e,t){function r(e){v(t,e)}try{e((function(e){g(t,e)}),r)}catch(e){r(e)}}(e,this)}T.prototype={constructor:T,state_:i,then_:null,data_:void 0,then:function(e,t){var r={owner:this,then:new this.constructor(s),fulfilled:e,rejected:t};return this.state_===a||this.state_===o?f(p,r):this.then_.push(r),r.then},catch:function(e){return this.then(null,e)}},T.all=function(e){if(!l(e))throw new TypeError("You must pass an array to Promise.all().");return new this((function(t,r){var i=[],n=0;function a(e){return n++,function(r){i[e]=r,--n||t(i)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),r):i[s]=o;n||t(i)}))},T.race=function(e){if(!l(e))throw new TypeError("You must pass an array to Promise.race().");return new this((function(t,r){for(var i,n=0;n<e.length;n++)(i=e[n])&&"function"==typeof i.then?i.then(t,r):t(i)}))},T.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this((function(t){t(e)}))},T.reject=function(e){return new this((function(t,r){r(e)}))}}("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:Z);var J=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;function ee(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var te=t(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,n=ee(e),a=1;a<arguments.length;a++){for(var o in r=Object(arguments[a]))Q.call(r,o)&&(n[o]=r[o]);if(J){i=J(r);for(var s=0;s<i.length;s++)$.call(r,i[s])&&(n[i[s]]=r[i[s]])}}return n});window.Promise||(window.Promise=Z.Polyfill),Object.assign||(Object.assign=te);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!window.performance||!window.performance.now){var re=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-re}}for(var ie=Date.now(),ne=["ms","moz","webkit","o"],ae=0;ae<ne.length&&!window.requestAnimationFrame;++ae){var oe=ne[ae];window.requestAnimationFrame=window[oe+"RequestAnimationFrame"],window.cancelAnimationFrame=window[oe+"CancelAnimationFrame"]||window[oe+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(e){if("function"!=typeof e)throw new TypeError(e+"is not a function");var t=Date.now(),r=16+ie-t;return r<0&&(r=0),ie=t,window.setTimeout((function(){ie=Date.now(),e(performance.now())}),r)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){return clearTimeout(e)}),Math.sign||(Math.sign=function(e){return 0===(e=Number(e))||isNaN(e)?e:e>0?1:-1}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);var se={},le=/iPhone/i,he=/iPod/i,ue=/iPad/i,ce=/\biOS-universal(?:.+)Mac\b/i,de=/\bAndroid(?:.+)Mobile\b/i,fe=/Android/i,pe=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,me=/Silk/i,ge=/Windows Phone/i,ye=/\bWindows(?:.+)ARM\b/i,ve=/BlackBerry/i,be=/BB10/i,xe=/Opera Mini/i,_e=/\b(CriOS|Chrome)(?:.+)Mobile/i,Te=/Mobile(?:.+)Firefox\b/i,Ee=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};var Ae=function(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(e){return function(t){return t.test(e)}}(r),a={apple:{phone:n(le)&&!n(ge),ipod:n(he),tablet:!n(le)&&(n(ue)||Ee(t))&&!n(ge),universal:n(ce),device:(n(le)||n(he)||n(ue)||n(ce)||Ee(t))&&!n(ge)},amazon:{phone:n(pe),tablet:!n(pe)&&n(me),device:n(pe)||n(me)},android:{phone:!n(ge)&&n(pe)||!n(ge)&&n(de),tablet:!n(ge)&&!n(pe)&&!n(de)&&(n(me)||n(fe)),device:!n(ge)&&(n(pe)||n(me)||n(de)||n(fe))||n(/\bokhttp\b/i)},windows:{phone:n(ge),tablet:n(ye),device:n(ge)||n(ye)},other:{blackberry:n(ve),blackberry10:n(be),opera:n(xe),firefox:n(Te),chrome:n(_e),device:n(ve)||n(be)||n(xe)||n(Te)||n(_e)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}(window.navigator);var we={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(e){var t=!0;if(Ae.tablet||Ae.phone){var r;if(Ae.apple.device)if(r=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(r[1],10)<11&&(t=!1);if(Ae.android.device)if(r=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(r[1],10)<7&&(t=!1)}return t?e:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Ae.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!Ae.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},ke=Object.prototype.hasOwnProperty,Se="~";function Me(){}function Ce(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Pe(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new Ce(r,i||e,n),o=Se?Se+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],a]:e._events[o].push(a):(e._events[o]=a,e._eventsCount++),e}function Oe(e,t){0==--e._eventsCount?e._events=new Me:delete e._events[t]}function De(){this._events=new Me,this._eventsCount=0}Object.create&&(Me.prototype=Object.create(null),(new Me).__proto__||(Se=!1)),De.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)ke.call(e,t)&&r.push(Se?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},De.prototype.listeners=function(e){var t=Se?Se+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,a=new Array(n);i<n;i++)a[i]=r[i].fn;return a},De.prototype.listenerCount=function(e){var t=Se?Se+e:e,r=this._events[t];return r?r.fn?1:r.length:0},De.prototype.emit=function(e,t,r,i,n,a){var o=Se?Se+e:e;if(!this._events[o])return!1;var s,l,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,i),!0;case 5:return h.fn.call(h.context,t,r,i,n),!0;case 6:return h.fn.call(h.context,t,r,i,n,a),!0}for(l=1,s=new Array(u-1);l<u;l++)s[l-1]=arguments[l];h.fn.apply(h.context,s)}else{var c,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,r);break;case 4:h[l].fn.call(h[l].context,t,r,i);break;default:if(!s)for(c=1,s=new Array(u-1);c<u;c++)s[c-1]=arguments[c];h[l].fn.apply(h[l].context,s)}}return!0},De.prototype.on=function(e,t,r){return Pe(this,e,t,r,!1)},De.prototype.once=function(e,t,r){return Pe(this,e,t,r,!0)},De.prototype.removeListener=function(e,t,r,i){var n=Se?Se+e:e;if(!this._events[n])return this;if(!t)return Oe(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||Oe(this,n);else{for(var o=0,s=[],l=a.length;o<l;o++)(a[o].fn!==t||i&&!a[o].once||r&&a[o].context!==r)&&s.push(a[o]);s.length?this._events[n]=1===s.length?s[0]:s:Oe(this,n)}return this},De.prototype.removeAllListeners=function(e){var t;return e?(t=Se?Se+e:e,this._events[t]&&Oe(this,t)):(this._events=new Me,this._eventsCount=0),this},De.prototype.off=De.prototype.removeListener,De.prototype.addListener=De.prototype.on,De.prefixed=Se,De.EventEmitter=De;var Ie=t(De),Re={},Ne=Le;function Le(e,t,r){r=r||2;var i,n,a,o,s,l,h,u=t&&t.length,c=u?t[0]*r:e.length,d=Fe(e,0,c,r,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(e,t,r,i){var n,a,o,s=[];for(n=0,a=t.length;n<a;n++)(o=Fe(e,t[n]*i,n<a-1?t[n+1]*i:e.length,i,!1))===o.next&&(o.steiner=!0),s.push(Xe(o));for(s.sort(Ge),n=0;n<s.length;n++)Ke(s[n],r),r=Be(r,r.next);return r}(e,t,d,r)),e.length>80*r){i=a=e[0],n=o=e[1];for(var p=r;p<c;p+=r)(s=e[p])<i&&(i=s),(l=e[p+1])<n&&(n=l),s>a&&(a=s),l>o&&(o=l);h=0!==(h=Math.max(a-i,o-n))?1/h:0}return Ue(d,f,r,i,n,h),f}function Fe(e,t,r,i,n){var a,o;if(n===st(e,t,r,i)>0)for(a=t;a<r;a+=i)o=nt(a,e[a],e[a+1],o);else for(a=r-i;a>=t;a-=i)o=nt(a,e[a],e[a+1],o);return o&&Qe(o,o.next)&&(at(o),o=o.next),o}function Be(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!Qe(i,i.next)&&0!==Je(i.prev,i,i.next))i=i.next;else{if(at(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function Ue(e,t,r,i,n,a,o){if(e){!o&&a&&function(e,t,r,i){var n=e;do{null===n.z&&(n.z=Ye(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,a,o,s,l,h=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,i=r,s=0,t=0;t<h&&(s++,i=i.nextZ);t++);for(l=h;s>0||l>0&&i;)0!==s&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;r=i}a.nextZ=null,h*=2}while(o>1)}(n)}(e,i,n,a);for(var s,l,h=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?He(e,i,n,a):ze(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),at(e),e=l.next,h=l.next;else if((e=l)===h){o?1===o?Ue(e=je(Be(e),t,r),t,r,i,n,a,2):2===o&&Ve(e,t,r,i,n,a):Ue(Be(e),t,r,i,n,a,1);break}}}function ze(e){var t=e.prev,r=e,i=e.next;if(Je(t,r,i)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(qe(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&Je(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function He(e,t,r,i){var n=e.prev,a=e,o=e.next;if(Je(n,a,o)>=0)return!1;for(var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,h=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,u=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,c=Ye(s,l,t,r,i),d=Ye(h,u,t,r,i),f=e.prevZ,p=e.nextZ;f&&f.z>=c&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&qe(n.x,n.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Je(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&qe(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Je(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==e.prev&&f!==e.next&&qe(n.x,n.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Je(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&qe(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Je(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function je(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;!Qe(n,a)&&$e(n,i,i.next,a)&&rt(n,a)&&rt(a,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(a.i/r),at(i),at(i.next),i=e=a),i=i.next}while(i!==e);return Be(i)}function Ve(e,t,r,i,n,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Ze(o,s)){var l=it(o,s);return o=Be(o,o.next),l=Be(l,l.next),Ue(o,t,r,i,n,a),void Ue(l,t,r,i,n,a)}s=s.next}o=o.next}while(o!==e)}function Ge(e,t){return e.x-t.x}function Ke(e,t){if(t=function(e,t){var r,i=t,n=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>o){if(o=s,s===n){if(a===i.y)return i;if(a===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===o)return r;var l,h=r,u=r.x,c=r.y,d=1/0;i=r;do{n>=i.x&&i.x>=u&&n!==i.x&&qe(a<c?n:o,a,u,c,a<c?o:n,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(n-i.x),rt(i,e)&&(l<d||l===d&&(i.x>r.x||i.x===r.x&&We(r,i)))&&(r=i,d=l)),i=i.next}while(i!==h);return r}(e,t)){var r=it(t,e);Be(t,t.next),Be(r,r.next)}}function We(e,t){return Je(e.prev,e,t.prev)<0&&Je(t.next,e,e.next)<0}function Ye(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Xe(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function qe(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function Ze(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&$e(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(rt(e,t)&&rt(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(Je(e.prev,e,t.prev)||Je(e,t.prev,t))||Qe(e,t)&&Je(e.prev,e,e.next)>0&&Je(t.prev,t,t.next)>0)}function Je(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Qe(e,t){return e.x===t.x&&e.y===t.y}function $e(e,t,r,i){var n=tt(Je(e,t,r)),a=tt(Je(e,t,i)),o=tt(Je(r,i,e)),s=tt(Je(r,i,t));return n!==a&&o!==s||(!(0!==n||!et(e,r,t))||(!(0!==a||!et(e,i,t))||(!(0!==o||!et(r,e,i))||!(0!==s||!et(r,t,i)))))}function et(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function tt(e){return e>0?1:e<0?-1:0}function rt(e,t){return Je(e.prev,e,e.next)<0?Je(e,t,e.next)>=0&&Je(e,e.prev,t)>=0:Je(e,t,e.prev)<0||Je(e,e.next,t)<0}function it(e,t){var r=new ot(e.i,e.x,e.y),i=new ot(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}function nt(e,t,r,i){var n=new ot(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function at(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ot(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function st(e,t,r,i){for(var n=0,a=t,o=r-i;a<r;a+=i)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}(Re=Le).default=Ne,Le.deviation=function(e,t,r,i){var n=t&&t.length,a=n?t[0]*r:e.length,o=Math.abs(st(e,0,a,r));if(n)for(var s=0,l=t.length;s<l;s++){var h=t[s]*r,u=s<l-1?t[s+1]*r:e.length;o-=Math.abs(st(e,h,u,r))}var c=0;for(s=0;s<i.length;s+=3){var d=i[s]*r,f=i[s+1]*r,p=i[s+2]*r;c+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},Le.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[n][a][o]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r};var lt,ht=t(Re),ut={},ct=function(){var t=this,r={exports:this};return function(i){var n="object"==typeof t&&t&&!t.nodeType&&t,a="object"==typeof r&&r&&!r.nodeType&&r,o="object"==typeof e&&e;o.global!==o&&o.window!==o&&o.self!==o||(i=o);var s,l,h=2147483647,u=36,c=/^xn--/,d=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,g=String.fromCharCode;function y(e){throw new RangeError(p[e])}function v(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function b(e,t){var r=e.split("@"),i="";return r.length>1&&(i=r[0]+"@",e=r[1]),i+v((e=e.replace(f,".")).split("."),t).join(".")}function x(e){for(var t,r,i=[],n=0,a=e.length;n<a;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<a?56320==(64512&(r=e.charCodeAt(n++)))?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--):i.push(t);return i}function _(e){return v(e,(function(e){var t="";return e>65535&&(t+=g((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=g(e)})).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,r){var i=0;for(e=r?m(e/700):e>>1,e+=m(e/t);e>455;i+=u)e=m(e/35);return m(i+36*e/(e+38))}function A(e){var t,r,i,n,a,o,s,l,c,d,f,p=[],g=e.length,v=0,b=128,x=72;for((r=e.lastIndexOf("-"))<0&&(r=0),i=0;i<r;++i)e.charCodeAt(i)>=128&&y("not-basic"),p.push(e.charCodeAt(i));for(n=r>0?r+1:0;n<g;){for(a=v,o=1,s=u;n>=g&&y("invalid-input"),((l=(f=e.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:u)>=u||l>m((h-v)/o))&&y("overflow"),v+=l*o,!(l<(c=s<=x?1:s>=x+26?26:s-x));s+=u)o>m(h/(d=u-c))&&y("overflow"),o*=d;x=E(v-a,t=p.length+1,0==a),m(v/t)>h-b&&y("overflow"),b+=m(v/t),v%=t,p.splice(v++,0,b)}return _(p)}function w(e){var t,r,i,n,a,o,s,l,c,d,f,p,v,b,_,A=[];for(p=(e=x(e)).length,t=128,r=0,a=72,o=0;o<p;++o)(f=e[o])<128&&A.push(g(f));for(i=n=A.length,n&&A.push("-");i<p;){for(s=h,o=0;o<p;++o)(f=e[o])>=t&&f<s&&(s=f);for(s-t>m((h-r)/(v=i+1))&&y("overflow"),r+=(s-t)*v,t=s,o=0;o<p;++o)if((f=e[o])<t&&++r>h&&y("overflow"),f==t){for(l=r,c=u;!(l<(d=c<=a?1:c>=a+26?26:c-a));c+=u)_=l-d,b=u-d,A.push(g(T(d+_%b,0))),l=m(_/b);A.push(g(T(l,0))),a=E(r,v,i==n),r=0,++i}++r,++t}return A.join("")}if(s={version:"1.4.1",ucs2:{decode:x,encode:_},decode:A,encode:w,toASCII:function(e){return b(e,(function(e){return d.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return b(e,(function(e){return c.test(e)?A(e.slice(4).toLowerCase()):e}))}},n&&a)if(r.exports==n)a.exports=s;else for(l in s)s.hasOwnProperty(l)&&(n[l]=s[l]);else i.punycode=s}(this),r.exports}.call({});lt={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}};var dt=zt;ut.parse=dt;var ft=function(e,t){return zt(e,!1,!0).resolve(t)};ut.resolve=ft;var pt=function(e,t){return e?zt(e,!1,!0).resolveObject(t):t};ut.resolveObject=pt;var mt=function(e){lt.isString(e)&&(e=zt(e));return e instanceof yt?e.format():yt.prototype.format.call(e)};ut.format=mt;var gt=yt;function yt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}ut.Url=gt;var vt,bt,xt,_t=/^([a-z0-9.+-]+:)/i,Tt=/:[0-9]*$/,Et=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,At=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),wt=["'"].concat(At),kt=["%","/","?",";","#"].concat(wt),St=["/","?","#"],Mt=/^[+a-z0-9A-Z_-]{0,63}$/,Ct=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Pt={javascript:!0,"javascript:":!0},Ot={javascript:!0,"javascript:":!0},Dt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function It(e,t){return Object.prototype.hasOwnProperty.call(e,t)}xt=function(e,t,r,i){t=t||"&",r=r||"=";var n={};if("string"!=typeof e||0===e.length)return n;var a=/\+/g;e=e.split(t);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var l=0;l<s;++l){var h,u,c,d,f=e[l].replace(a,"%20"),p=f.indexOf(r);p>=0?(h=f.substr(0,p),u=f.substr(p+1)):(h=f,u=""),c=decodeURIComponent(h),d=decodeURIComponent(u),It(n,c)?Nt(n[c])?n[c].push(d):n[c]=[n[c],d]:n[c]=d}return n};var Rt,Nt=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Lt=(vt=xt,function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}});Rt=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Bt(Ut(e),(function(i){var n=encodeURIComponent(Lt(i))+r;return Ft(e[i])?Bt(e[i],(function(e){return n+encodeURIComponent(Lt(e))})).join(t):n+encodeURIComponent(Lt(e[i]))})).join(t):i?encodeURIComponent(Lt(i))+r+encodeURIComponent(Lt(e)):""};var Ft=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Bt(e,t){if(e.map)return e.map(t);for(var r=[],i=0;i<e.length;i++)r.push(t(e[i],i));return r}var Ut=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};bt=Rt;function zt(e,t,r){if(e&&lt.isObject(e)&&e instanceof yt)return e;var i=new yt;return i.parse(e,t,r),i}yt.prototype.parse=function(e,t,r){if(!lt.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=-1!==i&&i<e.indexOf("#")?"?":"#",a=e.split(n);a[0]=a[0].replace(/\\/g,"/");var o=e=a.join(n);if(o=o.trim(),!r&&1===e.split("#").length){var s=Et.exec(o);if(s)return this.path=o,this.href=o,this.pathname=s[1],s[2]?(this.search=s[2],this.query=t?vt(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=_t.exec(o);if(l){var h=(l=l[0]).toLowerCase();this.protocol=h,o=o.substr(l.length)}if(r||l||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===o.substr(0,2);!u||l&&Ot[l]||(o=o.substr(2),this.slashes=!0)}if(!Ot[l]&&(u||l&&!Dt[l])){for(var c,d,f=-1,p=0;p<St.length;p++){-1!==(m=o.indexOf(St[p]))&&(-1===f||m<f)&&(f=m)}-1!==(d=-1===f?o.lastIndexOf("@"):o.lastIndexOf("@",f))&&(c=o.slice(0,d),o=o.slice(d+1),this.auth=decodeURIComponent(c)),f=-1;for(p=0;p<kt.length;p++){var m;-1!==(m=o.indexOf(kt[p]))&&(-1===f||m<f)&&(f=m)}-1===f&&(f=o.length),this.host=o.slice(0,f),o=o.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var y=this.hostname.split(/\./),v=(p=0,y.length);p<v;p++){var b=y[p];if(b&&!b.match(Mt)){for(var x="",_=0,T=b.length;_<T;_++)b.charCodeAt(_)>127?x+="x":x+=b[_];if(!x.match(Mt)){var E=y.slice(0,p),A=y.slice(p+1),w=b.match(Ct);w&&(E.push(w[1]),A.unshift(w[2])),A.length&&(o="/"+A.join(".")+o),this.hostname=E.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=ct.toASCII(this.hostname));var k=this.port?":"+this.port:"",S=this.hostname||"";this.host=S+k,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!Pt[h])for(p=0,v=wt.length;p<v;p++){var M=wt[p];if(-1!==o.indexOf(M)){var C=encodeURIComponent(M);C===M&&(C=escape(M)),o=o.split(M).join(C)}}var P=o.indexOf("#");-1!==P&&(this.hash=o.substr(P),o=o.slice(0,P));var O=o.indexOf("?");if(-1!==O?(this.search=o.substr(O),this.query=o.substr(O+1),t&&(this.query=vt(this.query)),o=o.slice(0,O)):t&&(this.search="",this.query={}),o&&(this.pathname=o),Dt[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){k=this.pathname||"";var D=this.search||"";this.path=k+D}return this.href=this.format(),this},yt.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,a="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&lt.isObject(this.query)&&Object.keys(this.query).length&&(a=bt(this.query));var o=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||Dt[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),t+n+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+i},yt.prototype.resolve=function(e){return this.resolveObject(zt(e,!1,!0)).format()},yt.prototype.resolveObject=function(e){if(lt.isString(e)){var t=new yt;t.parse(e,!1,!0),e=t}for(var r=new yt,i=Object.keys(this),n=0;n<i.length;n++){var a=i[n];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),s=0;s<o.length;s++){var l=o[s];"protocol"!==l&&(r[l]=e[l])}return Dt[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Dt[e.protocol]){for(var h=Object.keys(e),u=0;u<h.length;u++){var c=h[u];r[c]=e[c]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||Ot[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=g||m||r.host&&e.pathname,v=y,b=r.pathname&&r.pathname.split("/")||[],x=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!Dt[r.protocol]);if(x&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),y=y&&(""===d[0]||""===b[0])),g)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,b=d;else if(d.length)b||(b=[]),b.pop(),b=b.concat(d),r.search=e.search,r.query=e.query;else if(!lt.isNullOrUndefined(e.search)){if(x)r.hostname=r.host=b.shift(),(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift());return r.search=e.search,r.query=e.query,lt.isNull(r.pathname)&&lt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var _=b.slice(-1)[0],T=(r.host||e.host||b.length>1)&&("."===_||".."===_)||""===_,E=0,A=b.length;A>=0;A--)"."===(_=b[A])?b.splice(A,1):".."===_?(b.splice(A,1),E++):E&&(b.splice(A,1),E--);if(!y&&!v)for(;E--;E)b.unshift("..");!y||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),T&&"/"!==b.join("/").substr(-1)&&b.push("");var w,k=""===b[0]||b[0]&&"/"===b[0].charAt(0);x&&(r.hostname=r.host=k?"":b.length?b.shift():"",(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift()));return(y=y||r.host&&b.length)&&!k&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),lt.isNull(r.pathname)&&lt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},yt.prototype.parseHost=function(){var e=this.host,t=Tt.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var Ht,jt,Vt,Gt,Kt,Wt,Yt,Xt,qt,Zt,Jt,Qt,$t,er,tr,rr,ir,nr,ar,or,sr,lr,hr,ur,cr,dr,fr,pr,mr,gr,yr,vr,br,xr,_r=t(ut);
/*!
  * @pixi/constants - v5.3.9
  * Compiled Wed, 24 Mar 2021 19:54:16 UTC
  *
  * @pixi/constants is licensed under the MIT License.
  * http://www.opensource.org/licenses/mit-license
  */(jt=Ht||(Ht={}))[jt.WEBGL_LEGACY=0]="WEBGL_LEGACY",jt[jt.WEBGL=1]="WEBGL",jt[jt.WEBGL2=2]="WEBGL2",(Gt=Vt||(Vt={}))[Gt.UNKNOWN=0]="UNKNOWN",Gt[Gt.WEBGL=1]="WEBGL",Gt[Gt.CANVAS=2]="CANVAS",(Wt=Kt||(Kt={}))[Wt.COLOR=16384]="COLOR",Wt[Wt.DEPTH=256]="DEPTH",Wt[Wt.STENCIL=1024]="STENCIL",(Xt=Yt||(Yt={}))[Xt.NORMAL=0]="NORMAL",Xt[Xt.ADD=1]="ADD",Xt[Xt.MULTIPLY=2]="MULTIPLY",Xt[Xt.SCREEN=3]="SCREEN",Xt[Xt.OVERLAY=4]="OVERLAY",Xt[Xt.DARKEN=5]="DARKEN",Xt[Xt.LIGHTEN=6]="LIGHTEN",Xt[Xt.COLOR_DODGE=7]="COLOR_DODGE",Xt[Xt.COLOR_BURN=8]="COLOR_BURN",Xt[Xt.HARD_LIGHT=9]="HARD_LIGHT",Xt[Xt.SOFT_LIGHT=10]="SOFT_LIGHT",Xt[Xt.DIFFERENCE=11]="DIFFERENCE",Xt[Xt.EXCLUSION=12]="EXCLUSION",Xt[Xt.HUE=13]="HUE",Xt[Xt.SATURATION=14]="SATURATION",Xt[Xt.COLOR=15]="COLOR",Xt[Xt.LUMINOSITY=16]="LUMINOSITY",Xt[Xt.NORMAL_NPM=17]="NORMAL_NPM",Xt[Xt.ADD_NPM=18]="ADD_NPM",Xt[Xt.SCREEN_NPM=19]="SCREEN_NPM",Xt[Xt.NONE=20]="NONE",Xt[Xt.SRC_OVER=0]="SRC_OVER",Xt[Xt.SRC_IN=21]="SRC_IN",Xt[Xt.SRC_OUT=22]="SRC_OUT",Xt[Xt.SRC_ATOP=23]="SRC_ATOP",Xt[Xt.DST_OVER=24]="DST_OVER",Xt[Xt.DST_IN=25]="DST_IN",Xt[Xt.DST_OUT=26]="DST_OUT",Xt[Xt.DST_ATOP=27]="DST_ATOP",Xt[Xt.ERASE=26]="ERASE",Xt[Xt.SUBTRACT=28]="SUBTRACT",Xt[Xt.XOR=29]="XOR",(Zt=qt||(qt={}))[Zt.POINTS=0]="POINTS",Zt[Zt.LINES=1]="LINES",Zt[Zt.LINE_LOOP=2]="LINE_LOOP",Zt[Zt.LINE_STRIP=3]="LINE_STRIP",Zt[Zt.TRIANGLES=4]="TRIANGLES",Zt[Zt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Zt[Zt.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Qt=Jt||(Jt={}))[Qt.RGBA=6408]="RGBA",Qt[Qt.RGB=6407]="RGB",Qt[Qt.ALPHA=6406]="ALPHA",Qt[Qt.LUMINANCE=6409]="LUMINANCE",Qt[Qt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Qt[Qt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Qt[Qt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(er=$t||($t={}))[er.TEXTURE_2D=3553]="TEXTURE_2D",er[er.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",er[er.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",er[er.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",er[er.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",er[er.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",er[er.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",er[er.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",er[er.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(rr=tr||(tr={}))[rr.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",rr[rr.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",rr[rr.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",rr[rr.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",rr[rr.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",rr[rr.FLOAT=5126]="FLOAT",rr[rr.HALF_FLOAT=36193]="HALF_FLOAT",(nr=ir||(ir={}))[nr.NEAREST=0]="NEAREST",nr[nr.LINEAR=1]="LINEAR",(or=ar||(ar={}))[or.CLAMP=33071]="CLAMP",or[or.REPEAT=10497]="REPEAT",or[or.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(lr=sr||(sr={}))[lr.OFF=0]="OFF",lr[lr.POW2=1]="POW2",lr[lr.ON=2]="ON",(ur=hr||(hr={}))[ur.NPM=0]="NPM",ur[ur.UNPACK=1]="UNPACK",ur[ur.PMA=2]="PMA",ur[ur.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ur[ur.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ur[ur.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(dr=cr||(cr={}))[dr.NO=0]="NO",dr[dr.YES=1]="YES",dr[dr.AUTO=2]="AUTO",dr[dr.BLEND=0]="BLEND",dr[dr.CLEAR=1]="CLEAR",dr[dr.BLIT=2]="BLIT",(pr=fr||(fr={}))[pr.AUTO=0]="AUTO",pr[pr.MANUAL=1]="MANUAL",(gr=mr||(mr={})).LOW="lowp",gr.MEDIUM="mediump",gr.HIGH="highp",(vr=yr||(yr={}))[vr.NONE=0]="NONE",vr[vr.SCISSOR=1]="SCISSOR",vr[vr.STENCIL=2]="STENCIL",vr[vr.SPRITE=3]="SPRITE",(xr=br||(br={}))[xr.NONE=0]="NONE",xr[xr.LOW=2]="LOW",xr[xr.MEDIUM=4]="MEDIUM",xr[xr.HIGH=8]="HIGH",r(se,"isMobile",(function(){return Ae})),r(se,"EventEmitter",(function(){return Ie})),r(se,"earcut",(function(){return ht})),r(se,"url",(function(){return _r})),we.RETINA_PREFIX=/@([0-9\.]+)x/,we.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var Tr,Er=!1;function Ar(){Er=!0}function wr(e){var t;if(!Er){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS 5.3.9 -  "+e+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=window.console).log.apply(t,r)}else window.console&&window.console.log("PixiJS 5.3.9 - "+e+" - http://www.pixijs.com/");Er=!0}}function kr(){return void 0===Tr&&(Tr=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:we.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),i=!(!r||!r.getContextAttributes().stencil);if(r){var n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch(e){return!1}}()),Tr}function Sr(e,t){return void 0===t&&(t=[]),t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function Mr(e){var t=e.toString(16);return"#"+(t="000000".substr(0,6-t.length)+t)}function Cr(e){return"string"==typeof e&&"#"===e[0]&&(e=e.substr(1)),parseInt(e,16)}function Pr(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}var Or=function(){for(var e=[],t=[],r=0;r<32;r++)e[r]=r,t[r]=r;e[Yt.NORMAL_NPM]=Yt.NORMAL,e[Yt.ADD_NPM]=Yt.ADD,e[Yt.SCREEN_NPM]=Yt.SCREEN,t[Yt.NORMAL]=Yt.NORMAL_NPM,t[Yt.ADD]=Yt.ADD_NPM,t[Yt.SCREEN]=Yt.SCREEN_NPM;var i=[];return i.push(t),i.push(e),i}();function Dr(e,t){return Or[t?1:0][e]}function Ir(e,t,r,i){return r=r||new Float32Array(4),i||void 0===i?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r}function Rr(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=e>>16&255,i=e>>8&255,n=255&e;return(255*t<<24)+((r=r*t+.5|0)<<16)+((i=i*t+.5|0)<<8)+(n=n*t+.5|0)}function Nr(e,t,r,i){return(r=r||new Float32Array(4))[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,(i||void 0===i)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r}function Lr(e,t){void 0===t&&(t=null);var r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+r);for(var i=0,n=0;i<r;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function Fr(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var Br={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Ur(e,t){for(var r=0,i=0,n={},a=0;a<e.length;a++)i+=t[a],r+=e[a].length;var o=new ArrayBuffer(4*r),s=null,l=0;for(a=0;a<e.length;a++){var h=t[a],u=e[a],c=Fr(u);n[c]||(n[c]=new Br[c](o)),s=n[c];for(var d=0;d<u.length;d++){s[(d/h|0)*i+l+d%h]=u[d]}l+=h}return new Float32Array(o)}function zr(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function Hr(e){return!(e&e-1||!e)}function jr(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,t|=r=((e>>>=r)>15?1:0)<<2,(t|=r=((e>>>=r)>3?1:0)<<1)|(e>>>=r)>>1}function Vr(e,t,r){var i,n=e.length;if(!(t>=n||0===r)){var a=n-(r=t+r>n?n-t:r);for(i=t;i<a;++i)e[i]=e[i+r];e.length=a}}function Gr(e){return 0===e?0:e<0?-1:1}var Kr=0;function Wr(){return++Kr}var Yr={};function Xr(e,t,r){if(void 0===r&&(r=3),!Yr[t]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+"\nDeprecated since v"+e),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e),console.warn(i))),Yr[t]=!0}}var qr={},Zr=Object.create(null),Jr=Object.create(null);function Qr(){var e;for(e in Zr)Zr[e].destroy();for(e in Jr)Jr[e].destroy()}function $r(){var e;for(e in Zr)delete Zr[e];for(e in Jr)delete Jr[e]}var ei=function(){function e(e,t,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||we.RESOLUTION,this.resize(e,t)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),e}();function ti(e){var t,r,i,n=e.width,a=e.height,o=e.getContext("2d"),s=o.getImageData(0,0,n,a).data,l=s.length,h={top:null,left:null,right:null,bottom:null},u=null;for(t=0;t<l;t+=4)0!==s[t+3]&&(r=t/4%n,i=~~(t/4/n),null===h.top&&(h.top=i),(null===h.left||r<h.left)&&(h.left=r),(null===h.right||h.right<r)&&(h.right=r+1),(null===h.bottom||h.bottom<i)&&(h.bottom=i));return null!==h.top&&(n=h.right-h.left,a=h.bottom-h.top+1,u=o.getImageData(h.left,h.top,n,a)),{height:a,width:n,data:u}}var ri,ii=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ni(e){var t=ii.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function ai(e,t){if(void 0===t&&(t=window.location),0===e.indexOf("data:"))return"";t=t||window.location,ri||(ri=document.createElement("a")),ri.href=e;var r=dt(ri.href),i=!r.port&&""===t.port||r.port===t.port;return r.hostname===t.hostname&&i&&r.protocol===t.protocol?"":"anonymous"}function oi(e,t){var r=we.RETINA_PREFIX.exec(e);return r?parseFloat(r[1]):void 0!==t?t:1}r(se,"uid",(function(){return Wr})),r(se,"trimCanvas",(function(){return ti})),r(se,"string2hex",(function(){return Cr})),r(se,"skipHello",(function(){return Ar})),r(se,"sign",(function(){return Gr})),r(se,"sayHello",(function(){return wr})),r(se,"rgb2hex",(function(){return Pr})),r(se,"removeItems",(function(){return Vr})),r(se,"premultiplyTintToRgba",(function(){return Nr})),r(se,"premultiplyTint",(function(){return Rr})),r(se,"premultiplyRgba",(function(){return Ir})),r(se,"premultiplyBlendMode",(function(){return Or})),r(se,"nextPow2",(function(){return zr})),r(se,"log2",(function(){return jr})),r(se,"isWebGLSupported",(function(){return kr})),r(se,"isPow2",(function(){return Hr})),r(se,"interleaveTypedArrays",(function(){return Ur})),r(se,"hex2string",(function(){return Mr})),r(se,"hex2rgb",(function(){return Sr})),r(se,"getResolutionOfUrl",(function(){return oi})),r(se,"getBufferType",(function(){return Fr})),r(se,"determineCrossOrigin",(function(){return ai})),r(se,"destroyTextureCache",(function(){return Qr})),r(se,"deprecation",(function(){return Xr})),r(se,"decomposeDataUri",(function(){return ni})),r(se,"createIndicesForQuads",(function(){return Lr})),r(se,"correctBlendMode",(function(){return Dr})),r(se,"clearTextureCache",(function(){return $r})),r(se,"TextureCache",(function(){return Zr})),r(se,"ProgramCache",(function(){return qr})),r(se,"DATA_URI",(function(){return ii})),r(se,"CanvasRenderTarget",(function(){return ei})),r(se,"BaseTextureCache",(function(){return Jr}));
/*!
  * @pixi/math - v5.3.9
  * Compiled Wed, 24 Mar 2021 19:54:16 UTC
  *
  * @pixi/math is licensed under the MIT License.
  * http://www.opensource.org/licenses/mit-license
  */
var si,li,hi=2*Math.PI,ui=180/Math.PI,ci=Math.PI/180;(li=si||(si={}))[li.POLY=0]="POLY",li[li.RECT=1]="RECT",li[li.CIRC=2]="CIRC",li[li.ELIP=3]="ELIP",li[li.RREC=4]="RREC";var di=function(){function e(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(i),this.type=si.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},e.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},e.prototype.pad=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},e.prototype.fit=function(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=i,this.height=Math.max(n-i,0),this},e.prototype.ceil=function(e,t){void 0===e&&(e=1),void 0===t&&(t=.001);var r=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=i-this.y,this},e.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=i,this.height=n-i,this},e}(),fi=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.radius=r,this.type=si.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-e,n=this.y-t;return(i*=i)+(n*=n)<=r},e.prototype.getBounds=function(){return new di(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e}(),pi=function(){function e(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=e,this.y=t,this.width=r,this.height=i,this.type=si.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var r=(e-this.x)/this.width,i=(t-this.y)/this.height;return(r*=r)+(i*=i)<=1},e.prototype.getBounds=function(){return new di(this.x-this.width,this.y-this.height,this.width,this.height)},e}(),mi=function(){function e(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];var i=Array.isArray(t[0])?t[0]:t;if("number"!=typeof i[0]){for(var n=[],a=0,o=i.length;a<o;a++)n.push(i[a].x,i[a].y);i=n}this.points=i,this.type=si.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t},e.prototype.contains=function(e,t){for(var r=!1,i=this.points.length/2,n=0,a=i-1;n<i;a=n++){var o=this.points[2*n],s=this.points[2*n+1],l=this.points[2*a],h=this.points[2*a+1];s>t!=h>t&&e<(t-s)/(h-s)*(l-o)+o&&(r=!r)}return r},e}(),gi=function(){function e(e,t,r,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=20),this.x=e,this.y=t,this.width=r,this.height=i,this.radius=n,this.type=si.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var r=e-(this.x+this.radius),i=t-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=e-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=t-(this.y+this.height-this.radius))*i<=n)return!0;if((r=e-(this.x+this.radius))*r+i*i<=n)return!0}return!1},e}(),yi=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},e.prototype.copyTo=function(e){return e.set(this.x,this.y),e},e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x=e,this.y=t,this},e}(),vi=function(){function e(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=e,this.scope=t}return e.prototype.clone=function(t,r){return void 0===t&&(t=this.cb),void 0===r&&(r=this.scope),new e(t,r,this._x,this._y)},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this._x===e&&this._y===t||(this._x=e,this._y=t,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},e.prototype.copyTo=function(e){return e.set(this._x,this._y),e},e.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),e}(),bi=function(){function e(e,t,r,i,n,a){void 0===e&&(e=1),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===a&&(a=0),this.array=null,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=a}return e.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.prototype.set=function(e,t,r,i,n,a){return this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=a,this},e.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(e,t){t=t||new yi;var r=e.x,i=e.y;return t.x=this.a*r+this.c*i+this.tx,t.y=this.b*r+this.d*i+this.ty,t},e.prototype.applyInverse=function(e,t){t=t||new yi;var r=1/(this.a*this.d+this.c*-this.b),i=e.x,n=e.y;return t.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,t},e.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),i=this.a,n=this.c,a=this.tx;return this.a=i*t-this.b*r,this.b=i*r+this.b*t,this.c=n*t-this.d*r,this.d=n*r+this.d*t,this.tx=a*t-this.ty*r,this.ty=a*r+this.ty*t,this},e.prototype.append=function(e){var t=this.a,r=this.b,i=this.c,n=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*r+e.b*n,this.c=e.c*t+e.d*i,this.d=e.c*r+e.d*n,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*n+this.ty,this},e.prototype.setTransform=function(e,t,r,i,n,a,o,s,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=e-(r*this.a+i*this.c),this.ty=t-(r*this.b+i*this.d),this},e.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},e.prototype.decompose=function(e){var t=this.a,r=this.b,i=this.c,n=this.d,a=-Math.atan2(-i,n),o=Math.atan2(r,t),s=Math.abs(a+o);return s<1e-5||Math.abs(hi-s)<1e-5?(e.rotation=o,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=o),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(i*i+n*n),e.position.x=this.tx,e.position.y=this.ty,e},e.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,i=this.d,n=this.tx,a=e*i-t*r;return this.a=i/a,this.b=-t/a,this.c=-r/a,this.d=e/a,this.tx=(r*this.ty-i*n)/a,this.ty=-(e*this.ty-t*n)/a,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},e.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},Object.defineProperty(e,"IDENTITY",{get:function(){return new e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TEMP_MATRIX",{get:function(){return new e},enumerable:!1,configurable:!0}),e}(),xi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],_i=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ti=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ei=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ai=[],wi=[],ki=Math.sign;!function(){for(var e=0;e<16;e++){var t=[];Ai.push(t);for(var r=0;r<16;r++)for(var i=ki(xi[e]*xi[r]+Ti[e]*_i[r]),n=ki(_i[e]*xi[r]+Ei[e]*_i[r]),a=ki(xi[e]*Ti[r]+Ti[e]*Ei[r]),o=ki(_i[e]*Ti[r]+Ei[e]*Ei[r]),s=0;s<16;s++)if(xi[s]===i&&_i[s]===n&&Ti[s]===a&&Ei[s]===o){t.push(s);break}}for(e=0;e<16;e++){var l=new bi;l.set(xi[e],_i[e],Ti[e],Ei[e],0,0),wi.push(l)}}();var Si={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return xi[e]},uY:function(e){return _i[e]},vX:function(e){return Ti[e]},vY:function(e){return Ei[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return Ai[e][t]},sub:function(e,t){return Ai[e][Si.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?Si.S:Si.N:2*Math.abs(t)<=Math.abs(e)?e>0?Si.E:Si.W:t>0?e>0?Si.SE:Si.SW:e>0?Si.NE:Si.NW},matrixAppendRotationInv:function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=wi[Si.inv(t)];n.tx=r,n.ty=i,e.append(n)}},Mi=function(){function e(){this.worldTransform=new bi,this.localTransform=new bi,this.position=new vi(this.onChange,this,0,0),this.scale=new vi(this.onChange,this,1,1),this.pivot=new vi(this.onChange,this,0,0),this.skew=new vi(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},e.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},e.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),e.IDENTITY=new e,e}();we.SORTABLE_CHILDREN=!1;var Ci=function(){function e(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return e.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},e.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},e.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?di.EMPTY:((e=e||new di(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},e.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},e.prototype.addQuad=function(e){var t=this.minX,r=this.minY,i=this.maxX,n=this.maxY,a=e[0],o=e[1];t=a<t?a:t,r=o<r?o:r,i=a>i?a:i,n=o>n?o:n,t=(a=e[2])<t?a:t,r=(o=e[3])<r?o:r,i=a>i?a:i,n=o>n?o:n,t=(a=e[4])<t?a:t,r=(o=e[5])<r?o:r,i=a>i?a:i,n=o>n?o:n,t=(a=e[6])<t?a:t,r=(o=e[7])<r?o:r,i=a>i?a:i,n=o>n?o:n,this.minX=t,this.minY=r,this.maxX=i,this.maxY=n},e.prototype.addFrame=function(e,t,r,i,n){this.addFrameMatrix(e.worldTransform,t,r,i,n)},e.prototype.addFrameMatrix=function(e,t,r,i,n){var a=e.a,o=e.b,s=e.c,l=e.d,h=e.tx,u=e.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=a*t+s*r+h,g=o*t+l*r+u;c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=a*i+s*r+h)<c?m:c,d=(g=o*i+l*r+u)<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=a*t+s*n+h)<c?m:c,d=(g=o*t+l*n+u)<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=a*i+s*n+h)<c?m:c,d=(g=o*i+l*n+u)<d?g:d,f=m>f?m:f,p=g>p?g:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},e.prototype.addVertexData=function(e,t,r){for(var i=this.minX,n=this.minY,a=this.maxX,o=this.maxY,s=t;s<r;s+=2){var l=e[s],h=e[s+1];i=l<i?l:i,n=h<n?h:n,a=l>a?l:a,o=h>o?h:o}this.minX=i,this.minY=n,this.maxX=a,this.maxY=o},e.prototype.addVertices=function(e,t,r,i){this.addVerticesMatrix(e.worldTransform,t,r,i)},e.prototype.addVerticesMatrix=function(e,t,r,i,n,a){void 0===n&&(n=0),void 0===a&&(a=n);for(var o=e.a,s=e.b,l=e.c,h=e.d,u=e.tx,c=e.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=r;g<i;g+=2){var y=t[g],v=t[g+1],b=o*y+l*v+u,x=h*v+s*y+c;d=Math.min(d,b-n),p=Math.max(p,b+n),f=Math.min(f,x-a),m=Math.max(m,x+a)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m},e.prototype.addBounds=function(e){var t=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>n?e.maxY:n},e.prototype.addBoundsMask=function(e,t){var r=e.minX>t.minX?e.minX:t.minX,i=e.minY>t.minY?e.minY:t.minY,n=e.maxX<t.maxX?e.maxX:t.maxX,a=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=n&&i<=a){var o=this.minX,s=this.minY,l=this.maxX,h=this.maxY;this.minX=r<o?r:o,this.minY=i<s?i:s,this.maxX=n>l?n:l,this.maxY=a>h?a:h}},e.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},e.prototype.addBoundsArea=function(e,t){var r=e.minX>t.x?e.minX:t.x,i=e.minY>t.y?e.minY:t.y,n=e.maxX<t.x+t.width?e.maxX:t.x+t.width,a=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=n&&i<=a){var o=this.minX,s=this.minY,l=this.maxX,h=this.maxY;this.minX=r<o?r:o,this.minY=i<s?i:s,this.maxX=n>l?n:l,this.maxY=a>h?a:h}},e.prototype.pad=function(e,t){void 0===e&&(e=0),void 0===t&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},e.prototype.addFramePad=function(e,t,r,i,n,a){e-=n,t-=a,r+=n,i+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>i?this.maxY:i},e}(),Pi=function(e,t){return(Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/function Oi(e,t){function r(){this.constructor=e}Pi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Di=function(e){function t(){var t=e.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Mi,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new Ci,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return Oi(t,e),t.mixin=function(e){for(var r=Object.keys(e),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e,n))}},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new di),t=this._boundsRect),this._bounds.getRectangle(t)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new di),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Ci);var t=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=i,this._bounds.updateID+=this._boundsID-n,a},t.prototype.toGlobal=function(e,t,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},t.prototype.toLocal=function(e,t,r,i){return t&&(e=t.toGlobal(e,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,t,r,i,n,a,o,s,l){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=l,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ii),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*ui},set:function(e){this.transform.rotation=e*ci},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){var t;this._mask&&((t=this._mask.maskObject||this._mask).renderable=!0,t.isMask=!1);(this._mask=e,this._mask)&&((t=this._mask.maskObject||this._mask).renderable=!1,t.isMask=!0)},enumerable:!1,configurable:!0}),t}(Ie),Ii=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sortDirty=null,t}return Oi(t,e),t}(Di);function Ri(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}Di.prototype.displayObjectUpdateTransform=Di.prototype.updateTransform;var Ni=function(e){function t(){var t=e.call(this)||this;return t.children=[],t.sortableChildren=we.SORTABLE_CHILDREN,t.sortDirty=!1,t}return Oi(t,e),t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];if(t.length>1)for(var i=0;i<t.length;i++)this.addChild(t[i]);else{var n=t[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return t[0]},t.prototype.addChildAt=function(e,t){if(t<0||t>this.children.length)throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e},t.prototype.swapChildren=function(e,t){if(e!==t){var r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}},t.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},t.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw new Error("The index "+t+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(e);Vr(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];if(t.length>1)for(var i=0;i<t.length;i++)this.removeChild(t[i]);else{var n=t[0],a=this.children.indexOf(n);if(-1===a)return null;n.parent=null,n.transform._parentID=-1,Vr(this.children,a,1),this._boundsID++,this.onChildrenChange(a),n.emit("removed",this),this.emit("childRemoved",n,this,a)}return t[0]},t.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Vr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t},t.prototype.removeChildren=function(e,t){void 0===e&&(e=0),void 0===t&&(t=this.children.length);var r,i=e,n=t-i;if(n>0&&n<=t){r=this.children.splice(i,n);for(var a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,t=0,r=this.children.length;t<r;++t){var i=this.children[t];i._lastSortedIndex=t,e||0===i.zIndex||(e=!0)}e&&this.children.length>1&&this.children.sort(Ri),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){var r=t._mask.maskObject||t._mask;r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(t,r){void 0===r&&(r=!1);var i=e.prototype.getLocalBounds.call(this,t);if(!r)for(var n=0,a=this.children.length;n<a;++n){var o=this.children[n];o.visible&&o.updateTransform()}return i},t.prototype._calculateBounds=function(){},t.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}},t.prototype.renderAdvanced=function(e){e.batch.flush();var t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<t.length;i++)t[i].enabled&&this._enabledFilters.push(t[i]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}r&&e.mask.push(this,this._mask),this._render(e);i=0;for(var n=this.children.length;i<n;i++)this.children[i].render(e);e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(t){e.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e},enumerable:!1,configurable:!0}),t}(Di);Ni.prototype.containerUpdateTransform=Ni.prototype.updateTransform;Di.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var Li,Fi,Bi=function(){function e(e){this._hookDiv=null,(Ae.tablet||Ae.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=2..toString(),this.div=t,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),e.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessability for this content",t.addEventListener("focus",(function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t},e.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},e.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},e.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,r=0;r<t.length;r++)this.updateAccessibleObjects(t[r])}},e.prototype.update=function(){var e=performance.now();if(!(Ae.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),r=this.renderer.resolution,i=t.width/this.renderer.width*r,n=t.height/this.renderer.height*r,a=this.div;a.style.left=t.left+"px",a.style.top=t.top+"px",a.style.width=this.renderer.width+"px",a.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var s=this.children[o];if(s.renderId!==this.renderId)s._accessibleActive=!1,Vr(this.children,o,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,o--;else{a=s._accessibleDiv;var l=s.hitArea,h=s.worldTransform;s.hitArea?(a.style.left=(h.tx+l.x*h.a)*i+"px",a.style.top=(h.ty+l.y*h.d)*n+"px",a.style.width=l.width*h.a*i+"px",a.style.height=l.height*h.d*n+"px"):(l=s.getBounds(),this.capHitArea(l),a.style.left=l.x*i+"px",a.style.top=l.y*n+"px",a.style.width=l.width*i+"px",a.style.height=l.height*n+"px",a.title!==s.accessibleTitle&&null!==s.accessibleTitle&&(a.title=s.accessibleTitle),a.getAttribute("aria-label")!==s.accessibleHint&&null!==s.accessibleHint&&a.setAttribute("aria-label",s.accessibleHint)),s.accessibleTitle===a.title&&s.tabIndex===a.tabIndex||(a.title=s.accessibleTitle,a.tabIndex=s.tabIndex,this.debug&&this.updateDebugHTML(a))}}this.renderId++}},e.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},e.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},e.prototype.addChild=function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title="displayObject "+e.tabIndex),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},e.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"click",t.eventData),t.dispatchEvent(e.target.displayObject,"pointertap",t.eventData),t.dispatchEvent(e.target.displayObject,"tap",t.eventData)},e.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseover",t.eventData)},e.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseout",t.eventData)},e.prototype._onKeyDown=function(e){9===e.keyCode&&this.activate()},e.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},e.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}();we.TARGET_FPMS=.06,(Fi=Li||(Li={}))[Fi.INTERACTION=50]="INTERACTION",Fi[Fi.HIGH=25]="HIGH",Fi[Fi.NORMAL=0]="NORMAL",Fi[Fi.LOW=-25]="LOW",Fi[Fi.UTILITY=-50]="UTILITY";var Ui=function(){function e(e,t,r,i){void 0===t&&(t=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=e,this.context=t,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return e.prototype.match=function(e,t){return void 0===t&&(t=null),this.fn===e&&this.context===t},e.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},e.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},e.prototype.destroy=function(e){void 0===e&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},e}(),zi=function(){function e(){var e=this;this._head=new Ui(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/we.TARGET_FPMS,this.elapsedMS=1/we.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t,r){return void 0===r&&(r=Li.NORMAL),this._addListener(new Ui(e,t,r))},e.prototype.addOnce=function(e,t,r){return void 0===r&&(r=Li.NORMAL),this._addListener(new Ui(e,t,r,!0))},e.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(e){var t;if(void 0===e&&(e=performance.now()),e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var r=e-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=e-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*we.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,we.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!1,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!1,configurable:!0}),e}(),Hi=function(){function e(){}return e.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Li.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?zi.shared:new zi,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},e}(),ji=function(){function e(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new yi,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(e.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),e.prototype.getLocalPosition=function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)},e.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},e.prototype.reset=function(){this.isPrimary=!1},e}(),Vi=function(e,t){return(Vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var Gi=function(){function e(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return e.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},e.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},e}(),Ki=function(){function e(t){this._pointerId=t,this._flags=e.FLAGS.NONE}return e.prototype._doSet=function(e,t){this._flags=t?this._flags|e:this._flags&~e},Object.defineProperty(e.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return this._flags===e.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"over",{get:function(){return 0!=(this._flags&e.FLAGS.OVER)},set:function(t){this._doSet(e.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightDown",{get:function(){return 0!=(this._flags&e.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(e.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftDown",{get:function(){return 0!=(this._flags&e.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(e.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),e.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),e}(),Wi=function(){function e(){this._tempPoint=new yi}return e.prototype.recursiveFindHit=function(e,t,r,i,n){if(!t||!t.visible)return!1;var a=e.data.global,o=!1,s=n=t.interactive||n,l=!0;if(t.hitArea?(i&&(t.worldTransform.applyInverse(a,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(i=!1,l=!1)),s=!1):t._mask&&i&&(t._mask.containsPoint&&t._mask.containsPoint(a)||(i=!1)),l&&t.interactiveChildren&&t.children)for(var h=t.children,u=h.length-1;u>=0;u--){var c=h[u],d=this.recursiveFindHit(e,c,r,i,s);if(d){if(!c.parent)continue;s=!1,d&&(e.target&&(i=!1),o=!0)}}return n&&(i&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(a)&&(o=!0),t.interactive&&(o&&!e.target&&(e.target=t),r&&r(e,t,!!o))),o},e.prototype.findHit=function(e,t,r,i){this.recursiveFindHit(e,t,r,i,!1)},e}(),Yi={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(e){e?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Di.mixin(Yi);var Xi={target:null,data:{global:null}},qi=function(e){function t(t,r){var i=e.call(this)||this;return r=r||{},i.renderer=t,i.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,i.interactionFrequency=r.interactionFrequency||10,i.mouse=new ji,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new Gi,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new Wi,i._tempDisplayObject=new Ii,i._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(e,t){function r(){this.constructor=e}Vi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,t){return Xi.target=null,Xi.data.global=e,t||(t=this.lastObjectRendered),this.processInteractive(Xi,t,null,!0),Xi.target},t.prototype.setTargetElement=function(e,t){void 0===t&&(t=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(zi.system.add(this.tickerUpdate,this,Li.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(zi.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var t=this.activeInteractionData[e];if(t.originalEvent&&"touch"!==t.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,t.originalEvent,t);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){if(e=e||"default",this.currentCursorMode!==e){this.currentCursorMode=e;var t=this.cursorStyles[e];if(t)switch(typeof t){case"string":this.interactionDOMElement.style.cursor=t;break;case"function":t(e);break;case"object":Object.assign(this.interactionDOMElement.style,t)}else"string"!=typeof e||Object.prototype.hasOwnProperty.call(this.cursorStyles,e)||(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,t,r){r.stopPropagationHint&&e!==r.stopsPropagatingAt||(r.currentTarget=e,r.type=t,e.emit(t,r),e[t]&&e[t](r))},t.prototype.delayDispatchEvent=function(e,t,r){this.delayedEvents.push({displayObject:e,eventString:t,eventData:r})},t.prototype.mapPositionToPoint=function(e,t,r){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;e.x=(t-i.left)*(this.interactionDOMElement.width/i.width)*n,e.y=(r-i.top)*(this.interactionDOMElement.height/i.height)*n},t.prototype.processInteractive=function(e,t,r,i){var n=this.search.findHit(e,t,r,i),a=this.delayedEvents;if(!a.length)return n;e.stopPropagationHint=!1;var o=a.length;this.delayedEvents=[];for(var s=0;s<o;s++){var l=a[s],h=l.displayObject,u=l.eventString,c=l.eventData;c.stopsPropagatingAt===h&&(c.stopPropagationHint=!0),this.dispatchEvent(h,u,c)}return n},t.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);if(this.autoPreventDefault&&t[0].isNormalized)(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=t.length,i=0;i<r;i++){var n=t[i],a=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,a);if(o.data.originalEvent=e,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var s=2===n.button;this.emit(s?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,t,r){var i=e.data,n=e.data.identifier;if(r)if(t.trackedPointers[n]||(t.trackedPointers[n]=new Ki(n)),this.dispatchEvent(t,"pointerdown",e),"touch"===i.pointerType)this.dispatchEvent(t,"touchstart",e);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;a?t.trackedPointers[n].rightDown=!0:t.trackedPointers[n].leftDown=!0,this.dispatchEvent(t,a?"rightdown":"mousedown",e)}},t.prototype.onPointerComplete=function(e,t,r){for(var i=this.normalizeToPointerData(e),n=i.length,a=e.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var s=i[o],l=this.getInteractionDataForPointerId(s),h=this.configureInteractionEventForDOMEvent(this.eventData,s,l);if(h.data.originalEvent=e,this.processInteractive(h,this.lastObjectRendered,r,t||!a),this.emit(t?"pointercancel":"pointerup"+a,h),"mouse"===s.pointerType||"pen"===s.pointerType){var u=2===s.button;this.emit(u?"rightup"+a:"mouseup"+a,h)}else"touch"===s.pointerType&&(this.emit(t?"touchcancel":"touchend"+a,h),this.releaseInteractionDataForPointerId(s.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,t){var r=e.data,i=e.data.identifier;void 0!==t.trackedPointers[i]&&(delete t.trackedPointers[i],this.dispatchEvent(t,"pointercancel",e),"touch"===r.pointerType&&this.dispatchEvent(t,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,t,r){var i=e.data,n=e.data.identifier,a=t.trackedPointers[n],o="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType,l=!1;if(s){var h=2===i.button,u=Ki.FLAGS,c=h?u.RIGHT_DOWN:u.LEFT_DOWN,d=void 0!==a&&a.flags&c;r?(this.dispatchEvent(t,h?"rightup":"mouseup",e),d&&(this.dispatchEvent(t,h?"rightclick":"click",e),l=!0)):d&&this.dispatchEvent(t,h?"rightupoutside":"mouseupoutside",e),a&&(h?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(t,"pointerup",e),o&&this.dispatchEvent(t,"touchend",e),a&&(s&&!l||this.dispatchEvent(t,"pointertap",e),o&&(this.dispatchEvent(t,"tap",e),a.over=!1))):a&&(this.dispatchEvent(t,"pointerupoutside",e),o&&this.dispatchEvent(t,"touchendoutside",e)),a&&a.none&&delete t.trackedPointers[n]},t.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);"mouse"!==t[0].pointerType&&"pen"!==t[0].pointerType||(this._didMove=!0,this.cursor=null);for(var r=t.length,i=0;i<r;i++){var n=t[i],a=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,a);o.data.originalEvent=e,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===t[0].pointerType&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,t,r){var i=e.data,n="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType;a&&this.processPointerOverOut(e,t,r),this.moveWhenInside&&!r||(this.dispatchEvent(t,"pointermove",e),n&&this.dispatchEvent(t,"touchmove",e),a&&this.dispatchEvent(t,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e)[0];"mouse"===t.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(t),i=this.configureInteractionEventForDOMEvent(this.eventData,t,r);i.data.originalEvent=t,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===t.pointerType||"pen"===t.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(r.identifier)}},t.prototype.processPointerOverOut=function(e,t,r){var i=e.data,n=e.data.identifier,a="mouse"===i.pointerType||"pen"===i.pointerType,o=t.trackedPointers[n];r&&!o&&(o=t.trackedPointers[n]=new Ki(n)),void 0!==o&&(r&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(t,"pointerover",e),a&&this.delayDispatchEvent(t,"mouseover",e)),a&&null===this.cursor&&(this.cursor=t.cursor)):o.over&&(o.over=!1,this.dispatchEvent(t,"pointerout",this.eventData),a&&this.dispatchEvent(t,"mouseout",e),o.none&&delete t.trackedPointers[n]))},t.prototype.onPointerOver=function(e){var t=this.normalizeToPointerData(e)[0],r=this.getInteractionDataForPointerId(t),i=this.configureInteractionEventForDOMEvent(this.eventData,t,r);i.data.originalEvent=t,"mouse"===t.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==t.pointerType&&"pen"!==t.pointerType||this.emit("mouseover",i)},t.prototype.getInteractionDataForPointerId=function(e){var t,r=e.pointerId;return 1===r||"mouse"===e.pointerType?t=this.mouse:this.activeInteractionData[r]?t=this.activeInteractionData[r]:((t=this.interactionDataPool.pop()||new ji).identifier=r,this.activeInteractionData[r]=t),t.copyEvent(e),t},t.prototype.releaseInteractionDataForPointerId=function(e){var t=this.activeInteractionData[e];t&&(delete this.activeInteractionData[e],t.reset(),this.interactionDataPool.push(t))},t.prototype.configureInteractionEventForDOMEvent=function(e,t,r){return e.data=r,this.mapPositionToPoint(r.global,t.clientX,t.clientY),"touch"===t.pointerType&&(t.globalX=r.global.x,t.globalY=r.global.y),r.originalEvent=t,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,i=e.changedTouches.length;r<i;r++){var n=e.changedTouches[r];void 0===n.button&&(n.button=e.touches.length?1:0),void 0===n.buttons&&(n.buttons=e.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,t.push(n)}else if(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof window.PointerEvent)t.push(e);else{var a=e;void 0===a.isPrimary&&(a.isPrimary=!0),void 0===a.width&&(a.width=1),void 0===a.height&&(a.height=1),void 0===a.tiltX&&(a.tiltX=0),void 0===a.tiltY&&(a.tiltY=0),void 0===a.pointerType&&(a.pointerType="mouse"),void 0===a.pointerId&&(a.pointerId=1),void 0===a.pressure&&(a.pressure=.5),void 0===a.twist&&(a.twist=0),void 0===a.tangentialPressure&&(a.tangentialPressure=0),a.isNormalized=!0,t.push(a)}return t},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(Ie),Zi=function(){function e(e){this.items=[],this._name=e,this._aliasCount=0}return e.prototype.emit=function(e,t,r,i,n,a,o,s){if(arguments.length>8)throw new Error("max arguments reached");var l=this,h=l.name,u=l.items;this._aliasCount++;for(var c=0,d=u.length;c<d;c++)u[c][h](e,t,r,i,n,a,o,s);return u===this.items&&this._aliasCount--,this},e.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},e.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},e.prototype.remove=function(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},e.prototype.contains=function(e){return-1!==this.items.indexOf(e)},e.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},e.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e}();Object.defineProperties(Zi.prototype,{dispatch:{value:Zi.prototype.emit},run:{value:Zi.prototype.emit}}),we.PREFER_ENV=Ae.any?Ht.WEBGL:Ht.WEBGL2,we.STRICT_TEXTURE_CACHE=!1;var Ji=[];function Qi(e,t){if(!e)return null;var r="";if("string"==typeof e){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(var n=Ji.length-1;n>=0;--n){var a=Ji[n];if(a.test&&a.test(e,r))return new a(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/var $i=function(e,t){return($i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function en(e,t){function r(){this.constructor=e}$i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var tn=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Zi("setRealSize"),this.onUpdate=new Zi("update"),this.onError=new Zi("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),rn=function(e){function t(t,r){var i=this,n=r||{},a=n.width,o=n.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return(i=e.call(this,a,o)||this).data=t,i}return en(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===hr.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,r.internalFormat,t.width,t.height,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(tn),nn={scaleMode:ir.NEAREST,format:Jt.RGBA,alphaMode:hr.NPM},an=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var i=e.call(this)||this,n=(r=r||{}).alphaMode,a=r.mipmap,o=r.anisotropicLevel,s=r.scaleMode,l=r.width,h=r.height,u=r.wrapMode,c=r.format,d=r.type,f=r.target,p=r.resolution,m=r.resourceOptions;return!t||t instanceof tn||((t=Qi(t,m)).internal=!0),i.width=l||0,i.height=h||0,i.resolution=p||we.RESOLUTION,i.mipmap=void 0!==a?a:we.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==o?o:we.ANISOTROPIC_LEVEL,i.wrapMode=u||we.WRAP_MODE,i.scaleMode=void 0!==s?s:we.SCALE_MODE,i.format=c||Jt.RGBA,i.type=d||tr.UNSIGNED_BYTE,i.target=f||$t.TEXTURE_2D,i.alphaMode=void 0!==n?n:hr.UNPACK,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.uid=Wr(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=l>0&&h>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(t),i}return en(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Hr(this.realWidth)&&Hr(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT()),this},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Jr[this.cacheId],delete Zr[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,i){void 0===i&&(i=we.STRICT_TEXTURE_CACHE);var n="string"==typeof e,a=null;n?a=e:(e._pixiId||(e._pixiId="pixiid_"+Wr()),a=e._pixiId);var o=Jr[a];if(n&&i&&!o)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return o||((o=new t(e,r)).cacheId=a,t.addToCache(o,a)),o},t.fromBuffer=function(e,r,i,n){e=e||new Float32Array(r*i*4);var a=new rn(e,{width:r,height:i}),o=e instanceof Float32Array?tr.FLOAT:tr.UNSIGNED_BYTE;return new t(a,Object.assign(nn,n||{width:r,height:i,type:o}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),Jr[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),Jr[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=Jr[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Jr[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)delete Jr[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(Ie),on=function(e){function t(t,r){var i=this,n=r||{},a=n.width,o=n.height;(i=e.call(this,a,o)||this).items=[],i.itemDirtyIds=[];for(var s=0;s<t;s++){var l=new an;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return en(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof tn?this.addResourceAt(e[r],r):this.addResourceAt(Qi(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})).filter((function(e){return e})).map((function(e){return e.load()}));return this._load=Promise.all(t).then((function(){var t=e.items[0],r=t.realWidth,i=t.realHeight;return e.resize(r,i),Promise.resolve(e)})),this._load},t}(tn),sn=function(e){function t(t,r){var i,n,a=this,o=r||{},s=o.width,l=o.height;return Array.isArray(t)?(i=t,n=t.length):n=t,a=e.call(this,n,{width:s,height:l})||this,i&&a.initFromArray(i,r),a}return en(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=$t.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var i=this,n=i.length,a=i.itemDirtyIds,o=i.items,s=e.gl;r.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,n,0,t.format,t.type,null);for(var l=0;l<n;l++){var h=o[l];a[l]<h.dirtyId&&(a[l]=h.dirtyId,h.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,t.format,t.type,h.resource.source))}return!0},t}(on),ln=function(e){function t(t){var r=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,a=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,n,a)||this).source=t,r.noSubImage=!1,r}return en(t,e),t.crossOrigin=function(e,t,r){void 0===r&&0!==t.indexOf("data:")?e.crossOrigin=ai(t):!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous")},t.prototype.upload=function(e,t,r,i){var n=e.gl,a=t.realWidth,o=t.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===hr.UNPACK),this.noSubImage||t.target!==n.TEXTURE_2D||r.width!==a||r.height!==o?(r.width=a,r.height=o,n.texImage2D(t.target,0,t.format,t.format,t.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.format,t.type,i),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(tn),hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return en(t,e),t.test=function(e){var t=window.OffscreenCanvas;return!!(t&&e instanceof t)||e instanceof HTMLCanvasElement},t}(ln),un=function(e){function t(r,i){var n=this,a=i||{},o=a.width,s=a.height,l=a.autoLoad,h=a.linkBaseTexture;if(r&&r.length!==t.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");n=e.call(this,6,{width:o,height:s})||this;for(var u=0;u<t.SIDES;u++)n.items[u].target=$t.TEXTURE_CUBE_MAP_POSITIVE_X+u;return n.linkBaseTexture=!1!==h,r&&n.initFromArray(r,i),!1!==l&&n.load(),n}return en(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=$t.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=$t.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,i){for(var n=this.itemDirtyIds,a=0;a<t.SIDES;a++){var o=this.items[a];n[a]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(e,o,i),n[a]=o.dirtyId):n[a]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[a]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(on),cn=function(e){function t(t,r){var i=this;if(r=r||{},!(t instanceof HTMLImageElement)){var n=new Image;ln.crossOrigin(n,t,r.crossorigin),n.src=t,t=n}return i=e.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==r.createBitmap?r.createBitmap:we.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==r.autoLoad&&i.load(),i}return en(t,e),t.prototype.load=function(e){var t=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((function(e,r){var i=t.source;t.url=i.src;var n=function(){t.destroyed||(i.onload=null,i.onerror=null,t.resize(i.width,i.height),t._load=null,t.createBitmap?e(t.process()):e(t))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(e){r(e),t.onError.emit(e)})}))),this._load},t.prototype.process=function(){var e=this,t=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(t,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===hr.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,i,this.bitmap),!this.preserveBitmap){var n=!0,a=r._glTextures;for(var o in a){var s=a[o];if(s!==i&&s.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},t}(ln),dn=function(e){function t(t,r){var i=this;return r=r||{},(i=e.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=t,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return en(t,e),t.prototype.load=function(){var e=this;return this._load||(this._load=new Promise((function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}))),this._load},t.prototype._loadSvg=function(){var e=this,t=new Image;ln.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){e._resolve&&(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,i=t.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=r*e.scale,a=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*r,a=e._overrideHeight||e._overrideWidth/r*i),n=Math.round(n),a=Math.round(a);var o=e.source;o.width=n,o.height=a,o._pixiId="canvas_"+Wr(),o.getContext("2d").drawImage(t,0,0,r,i,0,0,n,a),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(ln),fn=function(e){function t(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var a=document.createElement("video");a.setAttribute("preload","auto"),a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var o=r[0].src||r[0];ln.crossOrigin(a,o,i.crossorigin);for(var s=0;s<r.length;++s){var l=document.createElement("source"),h=r[s],u=h.src,c=h.mime,d=(u=u||r[s]).split("?").shift().toLowerCase(),f=d.substr(d.lastIndexOf(".")+1);c=c||t.MIME_TYPES[f]||"video/"+f,l.src=u,l.type=c,a.appendChild(l)}r=a}return(n=e.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return en(t,e),t.prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var r=zi.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){e.valid?r(e):(e._resolve=r,t.load())})),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(zi.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(zi.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&zi.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(zi.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(zi.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(ln),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return en(t,e),t.test=function(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},t}(ln);Ji.push(cn,pn,hn,fn,dn,rn,un,sn);var mn=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return en(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===hr.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,1===e.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},t}(rn),yn=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Zi("disposeFramebuffer"),this.multisample=br.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new an(null,{scaleMode:ir.NEAREST,resolution:1,mipmap:sr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new an(new gn(null,{width:this.width,height:this.height}),{scaleMode:ir.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:sr.OFF,format:Jt.DEPTH_COMPONENT,type:tr.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),vn=function(e){function t(t){var r=this;if("number"==typeof t){var i=arguments[0],n=arguments[1],a=arguments[2],o=arguments[3];t={width:i,height:n,scaleMode:a,resolution:o}}r=e.call(this,null,t)||this;var s=t||{},l=s.width,h=s.height;return r.mipmap=0,r.width=Math.ceil(l)||100,r.height=Math.ceil(h)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new yn(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return en(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(an),bn=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var i=t.width,n=t.height;if(r){var a=e.width/2/i,o=e.height/2/n,s=e.x/i+a,l=e.y/n+o;r=Si.add(r,Si.NW),this.x0=s+a*Si.uX(r),this.y0=l+o*Si.uY(r),r=Si.add(r,2),this.x1=s+a*Si.uX(r),this.y1=l+o*Si.uY(r),r=Si.add(r,2),this.x2=s+a*Si.uX(r),this.y2=l+o*Si.uY(r),r=Si.add(r,2),this.x3=s+a*Si.uX(r),this.y3=l+o*Si.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e}(),xn=new bn,_n=function(e){function t(r,i,n,a,o,s){var l=e.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new di(0,0,1,1)),r instanceof t&&(r=r.baseTexture),l.baseTexture=r,l._frame=i,l.trim=a,l.valid=!1,l._uvs=xn,l.uvMatrix=null,l.orig=n||i,l._rotate=Number(o||0),!0===o)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=s?new yi(s.x,s.y):new yi(0,0),l._updateID=0,l.textureCacheIds=[],r.valid?l.noFrame?r.valid&&l.onBaseTextureUpdated(r):l.frame=i:r.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&r.on("update",l.onBaseTextureUpdated,l),l}return en(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture;r&&r.url&&Zr[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===xn&&(this._uvs=new bn),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,i){void 0===r&&(r={}),void 0===i&&(i=we.STRICT_TEXTURE_CACHE);var n="string"==typeof e,a=null;n?a=e:(e._pixiId||(e._pixiId="pixiid_"+Wr()),a=e._pixiId);var o=Zr[a];if(n&&i&&!o)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return o||(r.resolution||(r.resolution=oi(e)),(o=new t(new an(e,r))).baseTexture.cacheId=a,an.addToCache(o.baseTexture,a),t.addToCache(o,a)),o},t.fromURL=function(e,r){var i=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),n=t.from(e,Object.assign({resourceOptions:i},r),!1),a=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):a.load().then((function(){return Promise.resolve(n)}))},t.fromBuffer=function(e,r,i,n){return new t(an.fromBuffer(e,r,i,n))},t.fromLoader=function(e,r,i){var n=new cn(e);n.url=r;var a=new t(new an(n,{scaleMode:we.SCALE_MODE,resolution:oi(r)}));return i||(i=r),an.addToCache(a.baseTexture,i),t.addToCache(a,i),i!==r&&(an.addToCache(a.baseTexture,r),t.addToCache(a,r)),a},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),Zr[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),Zr[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=Zr[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Zr[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)Zr[e.textureCacheIds[i]]===e&&delete Zr[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,i=e.width,n=e.height,a=t+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(a||o){var s=a&&o?"and":"or",l="X: "+t+" + "+i+" = "+(t+i)+" > "+this.baseTexture.width,h="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+s+" "+h)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(Ie);function Tn(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}_n.EMPTY=new _n(new an),Tn(_n.EMPTY),Tn(_n.EMPTY.baseTexture),_n.WHITE=function(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new _n(new an(new hn(e)))}(),Tn(_n.WHITE),Tn(_n.WHITE.baseTexture);var En=function(e){function t(t,r){var i=this,n=null;if(!(t instanceof vn)){var a=arguments[1],o=arguments[2],s=arguments[3],l=arguments[4];console.warn("Please use RenderTexture.create("+a+", "+o+") instead of the ctor directly."),n=arguments[0],r=null,t=new vn({width:a,height:o,scaleMode:s,resolution:l})}return(i=e.call(this,t,r)||this).legacyRenderer=n,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return en(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new vn(e))},t}(_n),An=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new vn(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new En(r)},e.prototype.getOptimalTexture=function(t,r,i){void 0===i&&(i=1);var n=e.SCREEN_KEY;t*=i,r*=i,this.enableFullScreen&&t===this._pixelsWidth&&r===this._pixelsHeight||(n=(65535&(t=zr(t)))<<16|65535&(r=zr(r))),this.texturePool[n]||(this.texturePool[n]=[]);var a=this.texturePool[n].pop();return a||(a=this.createTexture(t,r)),a.filterPoolKey=n,a.setResolution(i),a},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,i=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),wn=function(){function e(e,t,r,i,n,a,o){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=a,this.instance=o}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,i,n,a){return new e(t,r,i,n,a)},e}(),kn=0,Sn=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=kn++,this.disposeRunner=new Zi("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function Mn(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var Cn={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Pn={5126:4,5123:2,5121:1},On=0,Dn={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},In=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=On++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Zi("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,i,n,a,o,s){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===s&&(s=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Sn||(t instanceof Array&&(t=new Float32Array(t)),t=new Sn(t));var l=e.split("|");if(l.length>1){for(var h=0;h<l.length;h++)this.addAttribute(l[h],t,r,i,n);return this}var u=this.buffers.indexOf(t);return-1===u&&(this.buffers.push(t),u=this.buffers.length-1),this.attributes[e]=new wn(u,r,i,n,a,o,s),this.instanced=this.instanced||s,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof Sn||(e instanceof Array&&(e=new Uint16Array(e)),e=new Sn(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],i=new Sn;for(e in this.attributes){var n=this.attributes[e],a=this.buffers[n.buffer];t.push(a.data),r.push(n.size*Pn[n.type]/4),n.buffer=0}for(i.data=function(e,t){for(var r=0,i=0,n={},a=0;a<e.length;a++)i+=t[a],r+=e[a].length;var o=new ArrayBuffer(4*r),s=null,l=0;for(a=0;a<e.length;a++){var h=t[a],u=e[a],c=Mn(u);n[c]||(n[c]=new Cn[c](o)),s=n[c];for(var d=0;d<u.length;d++)s[(d/h|0)*i+l+d%h]=u[d];l+=h}return new Float32Array(o)}(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new Sn(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new wn(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,i=new e,n=[],a=[],o=[],s=0;s<t.length;s++){r=t[s];for(var l=0;l<r.buffers.length;l++)a[l]=a[l]||0,a[l]+=r.buffers[l].data.length,o[l]=0}for(s=0;s<r.buffers.length;s++)n[s]=new(Dn[Mn(r.buffers[s].data)])(a[s]),i.buffers[s]=new Sn(n[s]);for(s=0;s<t.length;s++){r=t[s];for(l=0;l<r.buffers.length;l++)n[l].set(r.buffers[l].data,o[l]),o[l]+=r.buffers[l].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.index=!0;var h=0,u=0,c=0,d=0;for(s=0;s<r.buffers.length;s++)if(r.buffers[s]!==r.indexBuffer){d=s;break}for(var s in r.attributes){var f=r.attributes[s];(0|f.buffer)===d&&(u+=f.size*Pn[f.type]/4)}for(s=0;s<t.length;s++){var p=t[s].indexBuffer.data;for(l=0;l<p.length;l++)i.indexBuffer.data[l+c]+=h;h+=r.buffers[d].data.length/u,c+=p.length}}return i},e}(),Rn=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return en(t,e),t}(In),Nn=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Sn(t.vertices),t.uvBuffer=new Sn(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return en(t,e),t.prototype.map=function(e,t){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+t.width/e.width,this.uvs[3]=i,this.uvs[4]=r+t.width/e.width,this.uvs[5]=i+t.height/e.height,this.uvs[6]=r,this.uvs[7]=i+t.height/e.height,r=t.x,i=t.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+t.width,this.vertices[3]=i,this.vertices[4]=r+t.width,this.vertices[5]=i+t.height,this.vertices[6]=r,this.vertices[7]=i+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(In),Ln=0,Fn=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Ln++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,i){this.uniforms[t]=new e(r,i)},e.from=function(t,r){return new e(t,r)},e}(),Bn=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new di,this.destinationFrame=new di,this.filters=[]}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),Un=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new An,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new Rn,r.quadUv=new Nn,r.tempRect=new di,r.activeState={},r.globalUniforms=new Fn({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return en(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new Bn,a=t[0].resolution,o=t[0].padding,s=t[0].autoFit,l=t[0].legacy,h=1;h<t.length;h++){var u=t[h];a=Math.min(a,u.resolution),o=this.useMaxPadding?Math.max(o,u.padding):o+u.padding,s=s&&u.autoFit,l=l||u.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=a,n.legacy=l,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(o),s&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(a),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a),n.filters=t,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var c=this.tempRect;c.width=n.sourceFrame.width,c.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame,c),r.renderTexture.clear()},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var i=this.globalUniforms.uniforms;i.outputFrame=t.sourceFrame,i.resolution=t.resolution;var n=i.inputSize,a=i.inputPixel,o=i.inputClamp;if(n[0]=t.destinationFrame.width,n[1]=t.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=n[0]*t.resolution,a[1]=n[1]*t.resolution,a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=t.sourceFrame.width*n[2]-.5*a[2],o[3]=t.sourceFrame.height*n[3]-.5*a[3],t.legacy){var s=i.filterArea;s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=t.sourceFrame.x,s[3]=t.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var l=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,l.renderTexture,cr.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var h=t.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,t.resolution);u.filterFrame=h.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,h,u,cr.CLEAR,t);var d=h;h=u,u=d}r[c].apply(this,h,l.renderTexture,cr.BLEND,t),this.returnFilterTexture(h),this.returnFilterTexture(u)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){if(void 0===t&&(t=cr.CLEAR),e&&e.filterFrame){var r=this.tempRect;r.width=e.filterFrame.width,r.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,r)}else this.renderer.renderTexture.bind(e);"boolean"==typeof t&&(t=t?cr.CLEAR:cr.BLEND,Xr("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(t===cr.CLEAR||t===cr.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},t.prototype.applyFilter=function(e,t,r,i){var n=this.renderer;this.bindAndClear(r,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.state.set(e.state),n.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(qt.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(qt.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,a=t._texture.orig,o=e.set(n.width,0,0,n.height,i.x,i.y),s=t.worldTransform.copyTo(bi.TEMP_MATRIX);return s.invert(),o.prepend(s),o.scale(1/a.width,1/a.height),o.translate(t.anchor.x,t.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return i.filterFrame=e.filterFrame,i},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(mn),zn=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),Hn=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new zn(t),r.currentRenderer=r.emptyRenderer,r}return en(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)},t.prototype.boundArray=function(e,t,r,i){for(var n=e.elements,a=e.ids,o=e.count,s=0,l=0;l<o;l++){var h=n[l],u=h._batchLocation;if(u>=0&&u<i&&t[u]===h)a[l]=u;else for(;s<i;){var c=t[s];if(!c||c._batchEnabled!==r||c._batchLocation!==s){a[l]=s,h._batchLocation=s,t[s]=h;break}s++}}},t}(mn),jn=0,Vn=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return en(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=jn++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=jn++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var r;if(we.PREFER_ENV>=Ht.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in window&&e instanceof window.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(mn),Gn=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=br.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},Kn=new di,Wn=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new yn(10,10),r.msaaSamples=null,r}return en(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new di,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;we.PREFER_ENV===Ht.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var n=0;n<e.colorTextures.length;n++){var a=e.colorTextures[n];this.renderer.texture.unbind(a.parentTextureArray||a)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===e&&n.y===t||(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,t,r,i,n){void 0===n&&(n=Kt.COLOR|Kt.DEPTH);var a=this.gl;a.clearColor(e,t,r,i),a.clear(n)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new Gn(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var i=e.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures.length;t.drawBuffers||(i=Math.min(i,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var n=[],a=0;a<i;a++)if(!(0===a&&r.multisample>1)){var o=e.colorTextures[a],s=o.parentTextureArray||o;this.renderer.texture.bind(s,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+a,o.target,s._glTextures[this.CONTEXT_UID].texture,0),n.push(t.COLOR_ATTACHMENT0+a)}if((n.length>1&&t.drawBuffers(n),e.depthTexture)&&this.writeDepthTexture){var l=e.depthTexture;this.renderer.texture.bind(l,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!e.stencil&&!e.depth||(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=br.NONE;if(e<=1||null===t)return r;for(var i=0;i<t.length;i++)if(t[i]<=e){r=t[i];break}return 1===r&&(r=br.NONE),r},t.prototype.blit=function(e,t,r){var i=this,n=i.current,a=i.renderer,o=i.gl,s=i.CONTEXT_UID;if(2===a.context.webGLVersion&&n){var l=n.glFramebuffers[s];if(l){if(!e){if(l.multisample<=1)return;l.blitFramebuffer||(l.blitFramebuffer=new yn(n.width,n.height),l.blitFramebuffer.addColorTexture(0,n.colorTextures[0])),(e=l.blitFramebuffer).width=n.width,e.height=n.height}t||((t=Kn).width=n.width,t.height=n.height),r||(r=t);var h=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,i=e.height,n=this.gl,a=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),t.stencil=a,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new di},t}(mn),Yn=function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},Xn={5126:4,5123:2,5121:1},qn=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return en(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;we.PREFER_ENV===Ht.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=function(e,t){return i.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,r,n,a){return i.drawElementsInstancedANGLE(e,t,r,n,a)},e.drawArraysInstanced=function(e,t,r,n){return i.drawArraysInstancedANGLE(e,t,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var a=i[t.program.id]||this.initGeometryVao(e,t.program,n);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?r.bindVertexArray(a):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var i=e.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var a=i.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(a,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)t.bufferSubData(a,0,i.data);else{var o=i.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,t.bufferData(a,i.data,o)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,i=t.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(e,t){var r=e.attributes,i=t.attributeData,n=["g",e.id];for(var a in r)i[a]&&n.push(a);return n.join("-")},t.prototype.initGeometryVao=function(e,t,r){void 0===r&&(r=!0),this.checkCompatibility(e,t);var i=this.gl,n=this.CONTEXT_UID,a=this.getSignature(e,t),o=e.glVertexArrayObjects[this.CONTEXT_UID],s=o[a];if(s)return o[t.id]=s,s;var l=e.buffers,h=e.attributes,u={},c={};for(var d in l)u[d]=0,c[d]=0;for(var d in h)!h[d].size&&t.attributeData[d]?h[d].size=t.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Xn[h[d].type];for(var d in h){var f=h[d],p=f.size;void 0===f.stride&&(u[f.buffer]===p*Xn[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=c[f.buffer],c[f.buffer]+=p*Xn[f.type])}s=i.createVertexArray(),i.bindVertexArray(s);for(var m=0;m<l.length;m++){var g=l[m];g._glBuffers[n]||(g._glBuffers[n]=new Yn(i.createBuffer()),this.managedBuffers[g.id]=g,g.disposeRunner.add(this)),r&&g._glBuffers[n].refCount++}return this.activateVao(e,t),this._activeVao=s,o[t.id]=s,o[a]=s,s},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers;if(e.disposeRunner.remove(this),r){for(var a=0;a<n.length;a++){var o=n[a]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||t||this.disposeBuffer(n[a],t)}if(!t)for(var s in r)if("g"===s[0]){var l=r[s];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);t=Object.keys(this.managedBuffers);for(r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,i=this.CONTEXT_UID,n=e.buffers,a=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[i].buffer);var o=null;for(var s in a){var l=a[s],h=n[l.buffer]._glBuffers[i];if(t.attributeData[s]){o!==h&&(r.bindBuffer(r.ARRAY_BUFFER,h.buffer),o=h);var u=t.attributeData[s].location;if(r.enableVertexAttribArray(u),r.vertexAttribPointer(u,l.size,l.type||r.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(u,1)}}}},t.prototype.draw=function(e,t,r,i){var n=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,s=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(e,t||a.indexBuffer.data.length,s,(r||0)*o,i||1):n.drawElements(e,t||a.indexBuffer.data.length,s,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(e,r,t||a.getSize(),i||1):n.drawArrays(e,r,t||a.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(mn),Zn=function(){function e(e){void 0===e&&(e=null),this.type=yr.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=yr.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function Jn(e,t,r){var i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function Qn(e,t,r,i){var n=Jn(e,e.VERTEX_SHADER,t),a=Jn(e,e.FRAGMENT_SHADER,r),o=e.createProgram();if(e.attachShader(o,n),e.attachShader(o,a),i)for(var s in i)e.bindAttribLocation(o,i[s],s);return e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(n))),e.getShaderParameter(a,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(a))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(o,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(o)),e.deleteProgram(o),o=null),e.deleteShader(n),e.deleteShader(a),o}function $n(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function ea(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return $n(2*t);case"bvec3":return $n(3*t);case"bvec4":return $n(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ta,ra={},ia=ra;function na(){if(ia===ra||ia&&ia.isContextLost()){var e=document.createElement("canvas"),t=void 0;we.PREFER_ENV>=Ht.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),ia=t}return ia}function aa(e,t,r){if("precision"!==e.substring(0,9)){var i=t;return t===mr.HIGH&&r!==mr.HIGH&&(i=mr.MEDIUM),"precision "+i+" float;\n"+e}return r!==mr.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var oa={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function sa(e){return oa[e]}var la=null,ha={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ua(e,t){if(!la){var r=Object.keys(ha);la={};for(var i=0;i<r.length;++i){var n=r[i];la[e[n]]=ha[n]}}return la[t]}var ca=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return'\n            if(uv["'+e+'"] !== ud["'+e+'"].value)\n            {\n                ud["'+e+'"].value = uv["'+e+'"]\n                gl.uniform1f(ud["'+e+'"].location, uv["'+e+'"])\n            }\n            '}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+e+'"], t);\n\n            if(ud["'+e+'"].value !== t)\n            {\n                ud["'+e+'"].value = t;\n                gl.uniform1i(ud["'+e+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'+e+'"].location, false, uv["'+e+'"].toArray(true));\n            '}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+e+'"].location, v.x, v.y);\n                }'}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+e+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+e+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+e+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],da={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},fa={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var pa,ma=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function ga(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}var ya=0,va={},ba=function(){function e(t,r,i){void 0===i&&(i="pixi-shader"),this.id=ya++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),va[i]?(va[i]++,i+="-"+va[i]):va[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=aa(this.vertexSrc,we.PRECISION_VERTEX,mr.HIGH),this.fragmentSrc=aa(this.fragmentSrc,we.PRECISION_FRAGMENT,function(){if(!ta){ta=mr.MEDIUM;var e=na();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);ta=t.precision?mr.HIGH:mr.MEDIUM}}return ta}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=na();if(r){var i=Qn(r,e,t);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},i=[],n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<n;a++){var o=t.getActiveAttrib(e,a),s=ua(t,o.type),l={type:s,name:o.name,size:sa(s),location:0};r[o.name]=l,i.push(l)}i.sort((function(e,t){return e.name>t.name?1:-1}));for(a=0;a<i.length;a++)i[a].location=a;return r},e.prototype.getUniformData=function(e,t){for(var r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;n<i;n++){var a=t.getActiveUniform(e,n),o=a.name.replace(/\[.*?\]$/,""),s=a.name.match(/\[.*?\]$/),l=ua(t,a.type);r[o]={type:l,size:a.size,isArray:s,value:ea(l,a.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),e.from=function(t,r,i){var n=t+r,a=qr[n];return a||(qr[n]=a=new e(t,r,i)),a},e}(),xa=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof Fn?t:new Fn(t):new Fn({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var i=t.uniforms[r];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,i){return new e(ba.from(t,r),i)},e}(),_a=function(){function e(){this.data=0,this.blendMode=Yt.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(e){!!(1&this.data)!==e&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(e){!!(2&this.data)!==e&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(e){!!(4&this.data)!==e&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(e){!!(8&this.data)!==e&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(e){!!(16&this.data)!==e&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==Yt.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),Ta=function(e){function t(r,i,n){var a=this,o=ba.from(r||t.defaultVertexSrc,i||t.defaultFragmentSrc);return(a=e.call(this,o,n)||this).padding=0,a.resolution=we.FILTER_RESOLUTION,a.enabled=!0,a.autoFit=!0,a.legacy=!!a.program.attributeData.aTextureCoord,a.state=new _a,a}return en(t,e),t.prototype.apply=function(e,t,r,i,n){e.applyFilter(this,t,r,i)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),t}(xa),Ea=new bi,Aa=function(){function e(e,t){this._texture=e,this.mapCoord=new bi,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],a=e[i+1];t[i]=n*r.a+a*r.c+r.tx,t[i+1]=n*r.b+a*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=t.orig,n=t.trim;n&&(Ea.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Ea));var a=t.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,l=this.clampOffset;return o[0]=(t._frame.x+s+l)/a.width,o[1]=(t._frame.y+s+l)/a.height,o[2]=(t._frame.x+t._frame.width-s+l)/a.width,o[3]=(t._frame.y+t._frame.height-s+l)/a.height,this.uClampOffset[0]=l/a.realWidth,this.uClampOffset[1]=l/a.realHeight,this.isSimple=t._frame.width===a.width&&t._frame.height===a.height&&0===t.rotate,!0},e}(),wa=function(e){function t(t){var r=this,i=new bi;return r=e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=i,r}return en(t,e),t.prototype.apply=function(e,t,r,i){var n=this.maskSprite,a=n._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Aa(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))},t}(Ta),ka=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return en(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var i=this.maskDataPool.pop()||new Zn;i.pooled=!0,i.maskObject=t,r=i}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case yr.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case yr.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case yr.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case yr.SCISSOR:this.renderer.scissor.pop();break;case yr.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case yr.SPRITE:this.popSpriteMask()}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=yr.SPRITE;else if(e.type=yr.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(e.type=yr.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new wa(t)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=t;var n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(mn),Sa=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return en(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var i=this.getStackLength();i!==r&&(0===i?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(mn),Ma=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return en(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,i=t.getBounds(!0),n=this.renderer.gl;t.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=i,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,a=r.destinationFrame,o=t?t.resolution:this.renderer.resolution,s=(e.x-n.x)*o+a.x,l=(e.y-n.y)*o+a.y,h=e.width*o,u=e.height*o;i&&(s+=i.tx*o,l+=i.ty*o),t||(l=this.renderer.height-u-l),this.renderer.gl.scissor(s,l,h,u)},t}(Sa),Ca=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return en(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Sa),Pa=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new bi,r.transform=null,r}return en(t,e),t.prototype.update=function(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,i){var n=this.projectionMatrix,a=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=a*(1/t.height*2),n.tx=-1-t.x*n.a,n.ty=-a-t.y*n.d},t.prototype.setTransform=function(e){},t}(mn),Oa=new di,Da=new di,Ia=new di,Ra=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new di,r.destinationFrame=new di,r}return en(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var i,n,a,o=this.renderer;this.current=e,e?(a=(i=e.baseTexture).resolution,t||(Oa.width=e.frame.width,Oa.height=e.frame.height,t=Oa),r||(Da.x=e.frame.x,Da.y=e.frame.y,Da.width=t.width,Da.height=t.height,r=Da),n=i.framebuffer):(a=o.resolution,t||(Oa.width=o.screen.width,Oa.height=o.screen.height,t=Oa),r||((r=Oa).width=t.width,r.height=t.height)),Ia.x=r.x*a,Ia.y=r.y*a,Ia.width=r.width*a,Ia.height=r.height*a,this.renderer.framebuffer.bind(n,Ia),this.renderer.projection.update(r,t,a,!n),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t)},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(mn),Na=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),La=0,Fa={textureCount:0},Ba=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=La++,r}return en(t,e),t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof pa)return pa;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");pa=!0===e({a:"b"},"a","b")}catch(e){pa=!1}return pa}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(Fa.textureCount=0,this.syncUniformGroup(e.uniformGroup,Fa)),i},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();e.static&&e.dirtyId===r.uniformGroups[e.id]||(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=function(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in e.uniforms){var n=t[i];if(n){for(var a=e.uniforms[i],o=!1,s=0;s<ca.length;s++)if(ca[s].test(n,a)){r.push(ca[s].code(i,a)),o=!0;break}if(!o){var l=(1===n.size?da:fa)[n.type].replace("location",'ud["'+i+'"].location');r.push('\n            cv = ud["'+i+'"].value;\n            v = uv["'+i+'"];\n            '+l+";")}}else e.uniforms[i].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+i+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,i=[];for(var n in r)i.push(n),t[n]&&i.push(t[n].type);return i.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var a=Qn(t,r.vertexSrc,r.fragmentSrc,i),o={};for(var n in r.uniformData){var s=r.uniformData[n];o[n]={location:t.getUniformLocation(a,n),value:ea(s.type,s.size)}}var l=new Na(a,o);return r.glPrograms[this.renderer.CONTEXT_UID]=l,l},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(mn);var Ua=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=Yt.NONE,r._blendEq=!1,r.map=[],r.map[0]=r.setBlend,r.map[1]=r.setOffset,r.map[2]=r.setCullFace,r.map[3]=r.setDepthTest,r.map[4]=r.setFrontFace,r.checks=[],r.defaultState=new _a,r.defaultState.blend=!0,r}return en(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(e,t){return void 0===t&&(t=[]),t[Yt.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.ADD]=[e.ONE,e.ONE],t[Yt.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.NONE]=[0,0],t[Yt.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[Yt.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[Yt.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[Yt.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[Yt.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[Yt.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[Yt.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[Yt.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[Yt.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[Yt.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[Yt.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(mn),za=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=we.GC_MAX_IDLE,r.checkCountMax=we.GC_MAX_CHECK_COUNT,r.mode=we.GC_MODE,r}return en(t,e),t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==fr.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){var a=0;for(i=0;i<t.length;i++)null!==t[i]&&(t[a++]=t[i]);t.length=a}},t.prototype.unload=function(e){var t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},t}(mn),Ha=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},ja=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new an,r}return en(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Ha(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Ha(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)},t.prototype.initTexture=function(e){var t=new Ha(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===tr.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t));else{var i=e.realWidth,n=e.realHeight,a=r.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,a.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var i=this.managedTextures.indexOf(e);-1!==i&&Vr(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==sr.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=ar.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===ir.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===ir.LINEAR){var n=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===ir.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===ir.LINEAR?r.LINEAR:r.NEAREST)},t}(mn),Va=new bi,Ga=function(e){function t(r){var i=e.call(this,Vt.WEBGL,r)||this;return r=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new Zi("destroy"),contextChange:new Zi("contextChange"),reset:new Zi("reset"),update:new Zi("update"),postrender:new Zi("postrender"),prerender:new Zi("prerender"),resize:new Zi("resize")},i.globalUniforms=new Fn({projectionMatrix:new bi},!0),i.addSystem(ka,"mask").addSystem(Vn,"context").addSystem(Ua,"state").addSystem(Ba,"shader").addSystem(ja,"texture").addSystem(qn,"geometry").addSystem(Wn,"framebuffer").addSystem(Ma,"scissor").addSystem(Ca,"stencil").addSystem(Pa,"projection").addSystem(za,"textureGC").addSystem(Un,"filter").addSystem(Ra,"renderTexture").addSystem(Hn,"batch"),i.initPlugins(t.__plugins),r.context?i.context.initFromContext(r.context):i.context.initFromOptions({alpha:!!i.transparent,antialias:r.antialias,premultipliedAlpha:i.transparent&&"notMultiplied"!==i.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,wr(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return en(t,e),t.create=function(e){if(kr())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var i in this[t]=r,this.runners)this.runners[i].add(r);return this},t.prototype.render=function(e,t,r,i,n){if(this.renderingToScreen=!t,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(t||(this._lastObjectRendered=e),!n){var a=e.enableTempParent();e.updateTransform(),e.disableTempParent(a)}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(function(e){function t(t,r){void 0===t&&(t=Vt.UNKNOWN);var i=e.call(this)||this;return(r=Object.assign({},we.RENDER_OPTIONS,r)).roundPixels&&(we.ROUND_PIXELS=r.roundPixels,Xr("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),i.options=r,i.type=t,i.screen=new di(0,0,r.width,r.height),i.view=r.view||document.createElement("canvas"),i.resolution=r.resolution||we.RESOLUTION,i.transparent=r.transparent,i.autoDensity=r.autoDensity||r.autoResize||!1,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,0],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i._lastObjectRendered=null,i.plugins={},i}return en(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,i){0===(i=i||e.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var n=En.create({width:0|i.width,height:0|i.height,scaleMode:t,resolution:r});return Va.tx=-i.x,Va.ty=-i.y,this.render(e,n,!1,Va,!!e.parent),n},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=Vt.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=Mr(e),Sr(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),t}(Ie));function Ka(e){return Ga.create(e)}var Wa="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Ya=function(){this.texArray=null,this.blend=0,this.type=qt.TRIANGLES,this.start=0,this.size=0,this.data=null},Xa=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}(),qa=function(){function e(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},e}(),Za=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=_a.for2d(),r.size=4*we.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return en(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;we.PREFER_ENV===Ht.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),we.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var i=ma.replace(/%forloop%/gi,ga(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;e.length<i;)e.push(new Ya);for(;r.length<n;)r.push(new Xa);for(var a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,i=t._textureArrayPool,n=this.renderer.batch,a=this._tempBoundTextures,o=this.renderer.textureGC.count,s=++an._globalBatch,l=0,h=i[0],u=0;n.copyBoundTextures(a,r);for(var c=0;c<this._bufferSize;++c){var d=e[c];e[c]=null,d._batchEnabled!==s&&(h.count>=r&&(n.boundArray(h,a,s,r),this.buildDrawCalls(h,u,c),u=c,h=i[++l],++s),d._batchEnabled=s,d.touched=o,h.elements[h.count++]=d)}h.count>0&&(n.boundArray(h,a,s,r),this.buildDrawCalls(h,u,this._bufferSize),++l,++s);for(c=0;c<a.length;c++)a[c]=null;an._globalBatch=s},t.prototype.buildDrawCalls=function(e,r,i){var n=this,a=n._bufferedElements,o=n._attributeBuffer,s=n._indexBuffer,l=n.vertexSize,h=t._drawCallPool,u=this._dcIndex,c=this._aIndex,d=this._iIndex,f=h[u];f.start=this._iIndex,f.texArray=e;for(var p=r;p<i;++p){var m=a[p],g=m._texture.baseTexture,y=Or[g.alphaMode?1:0][m.blendMode];a[p]=null,r<p&&f.blend!==y&&(f.size=d-f.start,r=p,(f=h[++u]).texArray=e,f.start=d),this.packInterleavedGeometry(m,o,s,c,d),c+=m.vertexData.length/2*l,d+=m.indices.length,f.blend=y}r<i&&(f.size=d-f.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=d},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,t=e._packedGeometries,r=e._attributeBuffer,i=e._indexBuffer;we.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,a=t._drawCallPool,o=null,s=0;s<e;s++){var l=a[s],h=l.texArray,u=l.type,c=l.size,d=l.start,f=l.blend;o!==h&&(o=h,this.bindAndClearTexArray(h)),this.state.blendMode=f,n.set(this.state),i.drawElements(u,c,i.UNSIGNED_SHORT,2*d)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),we.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=zr(Math.ceil(e/8)),r=jr(t),i=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new qa(i*this.vertexSize*4)),n},t.prototype.getIndexBuffer=function(e){var t=zr(Math.ceil(e/12)),r=jr(t),i=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},t.prototype.packInterleavedGeometry=function(e,t,r,i,n){for(var a=t.uint32View,o=t.float32View,s=i/this.vertexSize,l=e.uvs,h=e.indices,u=e.vertexData,c=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=d<1&&e._texture.baseTexture.alphaMode?Rr(e._tintRGB,d):e._tintRGB+(255*d<<24),p=0;p<u.length;p+=2)o[i++]=u[p],o[i++]=u[p+1],o[i++]=l[p],o[i++]=l[p+1],a[i++]=f,o[i++]=c;for(p=0;p<h.length;p++)r[n++]=s+h[p]},t._drawCallPool=[],t._textureArrayPool=[],t}(zn),Ja=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=Fn.from({uSamplers:t},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new ba(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new bi,default:this.defaultGroupCache[e]};return new xa(this.programCache[e],n)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"},e}(),Qa=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new Sn(null,t,!1),r._indexBuffer=new Sn(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,tr.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,tr.FLOAT).addAttribute("aColor",r._buffer,4,!0,tr.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,tr.FLOAT).addIndex(r._indexBuffer),r}return en(t,e),t}(In),$a="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",eo="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",to=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:$a,fragment:eo,geometryClass:Qa,vertexSize:6},e),r=t.vertex,i=t.fragment,n=t.vertexSize,a=t.geometryClass;return function(e){function t(t){var o=e.call(this,t)||this;return o.shaderGenerator=new Ja(r,i),o.geometryClass=a,o.vertexSize=n,o}return en(t,e),t}(Za)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return $a},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return eo},enumerable:!1,configurable:!0}),e}().create(),ro=function(){function e(t){var r=this;t=Object.assign({forceCanvas:!1},t),this.renderer=Ka(t),this.stage=new Ni,e._plugins.forEach((function(e){e.init.call(r,t)}))}return e.registerPlugin=function(t){e._plugins.push(t)},e.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(e.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){var i=this,n=e._plugins.slice(0);n.reverse(),n.forEach((function(e){e.destroy.call(i)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null},e}();ro._plugins=[];var io=function(){function e(){}return e.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(e){window.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame((function(){return t.resize()})))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){var e,r;if(t.cancelResize(),t._resizeTo===window)e=window.innerWidth,r=window.innerHeight;else{var i=t._resizeTo;e=i.clientWidth,r=i.clientHeight}t.renderer.resize(e,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},e.destroy=function(){window.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},e}();ro.registerPlugin(io);var no=new di,ao=function(){function e(e){this.renderer=e,e.extract=this}return e.prototype.image=function(e,t,r){var i=new Image;return i.src=this.base64(e,t,r),i},e.prototype.base64=function(e,t,r){return this.canvas(e).toDataURL(t,r)},e.prototype.canvas=function(t){var r,i,n,a=this.renderer,o=!1,s=!1;t&&(t instanceof En?n=t:(n=this.renderer.generateTexture(t),s=!0)),n?(r=n.baseTexture.resolution,i=n.frame,o=!1,a.renderTexture.bind(n)):(r=this.renderer.resolution,o=!0,(i=no).width=this.renderer.width,i.height=this.renderer.height,a.renderTexture.bind(null));var l=Math.floor(i.width*r+1e-4),h=Math.floor(i.height*r+1e-4),u=new ei(l,h,1),c=new Uint8Array(4*l*h),d=a.gl;d.readPixels(i.x*r,i.y*r,l,h,d.RGBA,d.UNSIGNED_BYTE,c);var f=u.context.getImageData(0,0,l,h);if(e.arrayPostDivide(c,f.data),u.context.putImageData(f,0,0),o){var p=new ei(u.width,u.height,1);p.context.scale(1,-1),p.context.drawImage(u.canvas,0,-h),u.destroy(),u=p}return s&&n.destroy(!0),u.canvas},e.prototype.pixels=function(t){var r,i,n,a=this.renderer,o=!1;t&&(t instanceof En?n=t:(n=this.renderer.generateTexture(t),o=!0)),n?(r=n.baseTexture.resolution,i=n.frame,a.renderTexture.bind(n)):(r=a.resolution,(i=no).width=a.width,i.height=a.height,a.renderTexture.bind(null));var s=i.width*r,l=i.height*r,h=new Uint8Array(4*s*l),u=a.gl;return u.readPixels(i.x*r,i.y*r,s,l,u.RGBA,u.UNSIGNED_BYTE,h),o&&n.destroy(!0),e.arrayPostDivide(h,h),h},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e.arrayPostDivide=function(e,t){for(var r=0;r<e.length;r+=4){var i=t[r+3]=e[r+3];0!==i?(t[r]=Math.round(Math.min(255*e[r]/i,255)),t[r+1]=Math.round(Math.min(255*e[r+1]/i,255)),t[r+2]=Math.round(Math.min(255*e[r+2]/i,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}},e}();var oo=t((function(e,t){if(e){t=t||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[t.strictMode?"strict":"loose"].exec(e),n={},a=14;a--;)n[r.key[a]]=i[a]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,(function(e,t,i){t&&(n[r.q.name][t]=i)})),n}})),so={};Object.defineProperty(so,"__esModule",{value:!0});var lo=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var uo=function(){function e(t,r,i){void 0===r&&(r=!1),ho(this,e),this._fn=t,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return lo(e,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),e}();function co(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}var fo=function(){function e(){ho(this,e),this._head=this._tail=void 0}return lo(e,[{key:"handlers",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this._head;if(e)return!!t;for(var r=[];t;)r.push(t),t=t._next;return r}},{key:"has",value:function(e){if(!(e instanceof uo))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return e._owner===this}},{key:"dispatch",value:function(){var e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}},{key:"add",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#add(): First arg must be a Function.");return co(this,new uo(e,!1,t))}},{key:"once",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#once(): First arg must be a Function.");return co(this,new uo(e,!0,t))}},{key:"detach",value:function(e){if(!(e instanceof uo))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return e._owner!==this||(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,null===e._next&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null),this}},{key:"detachAll",value:function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}}]),e}();fo.MiniSignalBinding=uo;var po=fo;so.default=po;var mo=t(so=so.default);function go(){}function yo(e,t,r,i){var n=0,a=e.length;!function o(s){s||n===a?r&&r(s):i?setTimeout((function(){t(e[n++],o)}),1):t(e[n++],o)}()}function vo(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function bo(e,t){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=0,i={_tasks:[],concurrency:t,saturated:go,unsaturated:go,buffer:t/4,empty:go,drain:go,error:go,started:!1,paused:!1,push:function(e,t){n(e,!1,t)},kill:function(){r=0,i.drain=go,i.started=!1,i._tasks=[]},unshift:function(e,t){n(e,!0,t)},process:function(){for(;!i.paused&&r<i.concurrency&&i._tasks.length;){var t=i._tasks.shift();0===i._tasks.length&&i.empty(),(r+=1)===i.concurrency&&i.saturated(),e(t.data,vo(a(t)))}},length:function(){return i._tasks.length},running:function(){return r},idle:function(){return i._tasks.length+r===0},pause:function(){!0!==i.paused&&(i.paused=!0)},resume:function(){if(!1!==i.paused){i.paused=!1;for(var e=1;e<=i.concurrency;e++)i.process()}}};function n(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(i.started=!0,null==e&&i.idle())setTimeout((function(){return i.drain()}),1);else{var n={data:e,callback:"function"==typeof r?r:go};t?i._tasks.unshift(n):i._tasks.push(n),setTimeout((function(){return i.process()}),1)}}function a(e){return function(){r-=1,e.callback.apply(e,arguments),null!=arguments[0]&&i.error(arguments[0],e.data),r<=i.concurrency-i.buffer&&i.unsaturated(),i.idle()&&i.drain(),i.process()}}return i}var xo={};function _o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function To(e,t,r){return t&&_o(e.prototype,t),r&&_o(e,r),e}var Eo=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),Ao=null;function wo(){}var ko=function(){function e(t,r,i){if("string"!=typeof t||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=t,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=wo,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new mo,this.onProgress=new mo,this.onComplete=new mo,this.onAfterMiddleware=new mo}e.setExtensionLoadType=function(t,r){So(e._loadTypeMap,t,r)},e.setExtensionXhrType=function(t,r){So(e._xhrTypeMap,t,r)};var t=e.prototype;return t.complete=function(){this._clearEvents(),this._finish()},t.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.load=function(t){var r=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout((function(){return t(r)}),1);else switch(t&&this.onComplete.once(t),this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement("image");break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement("audio");break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement("video");break;case e.LOAD_TYPE.XHR:default:Eo&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t._hasFlag=function(e){return 0!=(this._flags&e)},t._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},t._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===e&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===e&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(e),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(e,this.url[r],Array.isArray(t)?t[r]:t));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+e)},t._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=e.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},t._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout((function(){return e.send()}),1)},t._createSource=function(e,t,r){r||(r=e+"/"+this._getExtension(t));var i=document.createElement("source");return i.src=t,i.type=r,i},t._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},t._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},t._onTimeout=function(){this.abort("Load timed out.")},t._xhrOnError=function(){var e=this.xhr;this.abort(Mo(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},t._xhrOnTimeout=function(){var e=this.xhr;this.abort(Mo(e)+" Request timed out.")},t._xhrOnAbort=function(){var e=this.xhr;this.abort(Mo(e)+" Request was aborted by the user.")},t._xhrOnLoad=function(){var t=this.xhr,r="",i=void 0===t.status?200:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(r=t.responseText),0===i&&(r.length>0||t.responseType===e.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=e.TYPE.JSON}catch(e){return void this.abort("Error trying to parse loaded json: "+e)}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(r,"text/xml")}else{var a=document.createElement("div");a.innerHTML=r,this.data=a}this.type=e.TYPE.XML}catch(e){return void this.abort("Error trying to parse loaded xml: "+e)}else this.data=t.response||r;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},t._determineCrossOrigin=function(e,t){if(0===e.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";t=t||window.location,Ao||(Ao=document.createElement("a")),Ao.href=e;var r=!(e=oo(Ao.href,{strictMode:!0})).port&&""===t.port||e.port===t.port,i=e.protocol?e.protocol+":":"";return e.host===t.hostname&&r&&i===t.protocol?"":"anonymous"},t._determineXhrType=function(){return e._xhrTypeMap[this.extension]||e.XHR_RESPONSE_TYPE.TEXT},t._determineLoadType=function(){return e._loadTypeMap[this.extension]||e.LOAD_TYPE.XHR},t._getExtension=function(){var e=this.url,t="";if(this.isDataUrl){var r=e.indexOf("/");t=e.substring(r+1,e.indexOf(";",r))}else{var i=e.indexOf("?"),n=e.indexOf("#"),a=Math.min(i>-1?i:e.length,n>-1?n:e.length);t=(e=e.substring(0,a)).substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},t._getMimeFromXhrType=function(t){switch(t){case e.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case e.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case e.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case e.XHR_RESPONSE_TYPE.JSON:return"application/json";case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},To(e,[{key:"isDataUrl",get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}();function So(e,t,r){t&&0===t.indexOf(".")&&(t=t.substring(1)),t&&(e[t]=r)}function Mo(e){return e.toString().replace("object ","")}ko.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},ko.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},ko.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},ko.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},ko._loadTypeMap={gif:ko.LOAD_TYPE.IMAGE,png:ko.LOAD_TYPE.IMAGE,bmp:ko.LOAD_TYPE.IMAGE,jpg:ko.LOAD_TYPE.IMAGE,jpeg:ko.LOAD_TYPE.IMAGE,tif:ko.LOAD_TYPE.IMAGE,tiff:ko.LOAD_TYPE.IMAGE,webp:ko.LOAD_TYPE.IMAGE,tga:ko.LOAD_TYPE.IMAGE,svg:ko.LOAD_TYPE.IMAGE,"svg+xml":ko.LOAD_TYPE.IMAGE,mp3:ko.LOAD_TYPE.AUDIO,ogg:ko.LOAD_TYPE.AUDIO,wav:ko.LOAD_TYPE.AUDIO,mp4:ko.LOAD_TYPE.VIDEO,webm:ko.LOAD_TYPE.VIDEO},ko._xhrTypeMap={xhtml:ko.XHR_RESPONSE_TYPE.DOCUMENT,html:ko.XHR_RESPONSE_TYPE.DOCUMENT,htm:ko.XHR_RESPONSE_TYPE.DOCUMENT,xml:ko.XHR_RESPONSE_TYPE.DOCUMENT,tmx:ko.XHR_RESPONSE_TYPE.DOCUMENT,svg:ko.XHR_RESPONSE_TYPE.DOCUMENT,tsx:ko.XHR_RESPONSE_TYPE.DOCUMENT,gif:ko.XHR_RESPONSE_TYPE.BLOB,png:ko.XHR_RESPONSE_TYPE.BLOB,bmp:ko.XHR_RESPONSE_TYPE.BLOB,jpg:ko.XHR_RESPONSE_TYPE.BLOB,jpeg:ko.XHR_RESPONSE_TYPE.BLOB,tif:ko.XHR_RESPONSE_TYPE.BLOB,tiff:ko.XHR_RESPONSE_TYPE.BLOB,webp:ko.XHR_RESPONSE_TYPE.BLOB,tga:ko.XHR_RESPONSE_TYPE.BLOB,json:ko.XHR_RESPONSE_TYPE.JSON,text:ko.XHR_RESPONSE_TYPE.TEXT,txt:ko.XHR_RESPONSE_TYPE.TEXT,ttf:ko.XHR_RESPONSE_TYPE.BUFFER,otf:ko.XHR_RESPONSE_TYPE.BUFFER},ko.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Co=window.URL||window.webkitURL;var Po={caching:function(e,t){var r=this;xo[e.url]?(e.data=xo[e.url],e.complete()):e.onComplete.once((function(){return xo[r.url]=r.data})),t()},parsing:function(e,t){if(e.data){if(e.xhr&&e.xhrType===ko.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof e.data){if(0===e.data.type.indexOf("image")){var r=Co.createObjectURL(e.data);return e.blob=e.data,e.data=new Image,e.data.src=r,e.type=ko.TYPE.IMAGE,void(e.data.onload=function(){Co.revokeObjectURL(r),e.data.onload=null,t()})}}else{var i=e.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return e.data=new Image,e.data.src="data:"+i+";base64,"+function(e){for(var t="",r=0;r<e.length;){for(var i=[0,0,0],n=[0,0,0,0],a=0;a<i.length;++a)r<e.length?i[a]=255&e.charCodeAt(r++):i[a]=0;switch(n[0]=i[0]>>2,n[1]=(3&i[0])<<4|i[1]>>4,n[2]=(15&i[1])<<2|i[2]>>6,n[3]=63&i[2],r-(e.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(var o=0;o<n.length;++o)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n[o])}return t}(e.xhr.responseText),e.type=ko.TYPE.IMAGE,void(e.data.onload=function(){e.data.onload=null,t()})}t()}else t()}},Oo=/(#[\w-]+)?$/,Do=function(){function e(t,r){var i=this;void 0===t&&(t=""),void 0===r&&(r=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,t){return i._loadResource(e,t)},this._queue=bo(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new mo,this.onError=new mo,this.onLoad=new mo,this.onStart=new mo,this.onComplete=new mo;for(var n=0;n<e._defaultBeforeMiddleware.length;++n)this.pre(e._defaultBeforeMiddleware[n]);for(var a=0;a<e._defaultAfterMiddleware.length;++a)this.use(e._defaultAfterMiddleware[a])}var t=e.prototype;return t.add=function(e,t,r,i){if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.add(e[n]);return this}if("object"==typeof e&&(i=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),"string"!=typeof t&&(i=r,r=t,t=e),"string"!=typeof t)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(i=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new ko(e,t,r),"function"==typeof i&&this.resources[e].onAfterMiddleware.once(i),this.loading){for(var a=r.parentResource,o=[],s=0;s<a.children.length;++s)a.children[s].isComplete||o.push(a.children[s]);var l=a.progressChunk*(o.length+1)/(o.length+2);a.children.push(this.resources[e]),a.progressChunk=l;for(var h=0;h<o.length;++h)o[h].progressChunk=l;this.resources[e].progressChunk=l}return this._queue.push(this.resources[e]),this},t.pre=function(e){return this._beforeMiddleware.push(e),this},t.use=function(e){return this._afterMiddleware.push(e),this},t.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},t.load=function(e){if("function"==typeof e&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=t;this._onStart(),this._queue.resume()}return this},t._prepareUrl=function(e){var t,r=oo(e,{strictMode:!0});if(t=r.protocol||!r.path||0===e.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==e.charAt(0)?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var i=Oo.exec(t)[0];-1!==(t=t.substr(0,t.length-i.length)).indexOf("?")?t+="&"+this.defaultQueryString:t+="?"+this.defaultQueryString,t+=i}return t},t._loadResource=function(e,t){var r=this;e._dequeue=t,yo(this._beforeMiddleware,(function(t,i){t.call(r,e,(function(){i(e.isComplete?{}:null)}))}),(function(){e.isComplete?r._onLoad(e):(e._onLoadBinding=e.onComplete.once(r._onLoad,r),e.load())}),!0)},t._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),yo(this._afterMiddleware,(function(r,i){r.call(t,e,i)}),(function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(100,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&0===t._resourcesParsing.length&&t._onComplete()}),!0)},To(e,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),e}();Do._defaultBeforeMiddleware=[],Do._defaultAfterMiddleware=[],Do.pre=function(e){return Do._defaultBeforeMiddleware.push(e),Do},Do.use=function(e){return Do._defaultAfterMiddleware.push(e),Do};var Io=ko,Ro=function(e,t){return(Ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/var No=function(){function e(){}return e.use=function(e,t){e.data&&e.type===ko.TYPE.IMAGE&&(e.texture=_n.fromLoader(e.data,e.url,e.name)),t()},e}(),Lo=function(e){function t(r,i){for(var n=e.call(this,r,i)||this,a=0;a<t._plugins.length;++a){var o=t._plugins[a],s=o.pre,l=o.use;s&&n.pre(s),l&&n.use(l)}return n._protected=!1,n}return function(e,t){function r(){this.constructor=e}Ro(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t},t._plugins=[],t}(Do);Lo.registerPlugin({use:Po.parsing}),Lo.registerPlugin(No);var Fo=function(){function e(){}return e.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?Lo.shared:new Lo},e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e}(),Bo=function(e,t){return(Bo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/function Uo(e,t){function r(){this.constructor=e}Bo(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}!function(e){function t(t,r,i,n){void 0===t&&(t=1500),void 0===i&&(i=16384),void 0===n&&(n=!1);var a=e.call(this)||this;return i>16384&&(i=16384),a._properties=[!1,!0,!1,!1,!1],a._maxSize=t,a._batchSize=i,a._buffers=null,a._bufferUpdateIDs=[],a._updateID=0,a.interactiveChildren=!1,a.blendMode=Yt.NORMAL,a.autoResize=n,a.roundPixels=!0,a.baseTexture=null,a.setProperties(r),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}Uo(t,e),t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Sr(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var t=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return t.onChildrenChange(0)}))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var t=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}(Ni);var zo,Ho,jo,Vo,Go=function(){function e(e,t,r){this.geometry=new In,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<e.length;++i){var n=e[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||tr.FLOAT,offset:n.offset},t[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new Sn(Lr(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){(o=this.dynamicProperties[r]).offset=t,t+=o.size,this.dynamicStride+=o.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Sn(this.dynamicData,!1,!1);var n=0;this.staticStride=0;for(r=0;r<this.staticProperties.length;++r){(o=this.staticProperties[r]).offset=n,n+=o.size,this.staticStride+=o.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Sn(this.staticData,!0,!1);for(r=0;r<this.dynamicProperties.length;++r){var o=this.dynamicProperties[r];e.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===tr.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(r=0;r<this.staticProperties.length;++r){o=this.staticProperties[r];e.addAttribute(o.attributeName,this.staticBuffer,0,o.type===tr.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)}},e.prototype.uploadDynamic=function(e,t,r){for(var i=0;i<this.dynamicProperties.length;i++){var n=this.dynamicProperties[i];n.uploadFunction(e,t,r,n.type===tr.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},e.prototype.uploadStatic=function(e,t,r){for(var i=0;i<this.staticProperties.length;i++){var n=this.staticProperties[i];n.uploadFunction(e,t,r,n.type===tr.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},e.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},e}(),Ko=function(e){function t(t){var r=e.call(this,t)||this;return r.shader=null,r.properties=null,r.tempMatrix=new bi,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:tr.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=xa.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),r.state=_a.for2d(),r}return Uo(t,e),t.prototype.render=function(e){var t=e.children,r=e._maxSize,i=e._batchSize,n=this.renderer,a=t.length;if(0!==a){a>r&&!e.autoResize&&(a=r);var o=e._buffers;o||(o=e._buffers=this.generateBuffers(e));var s=t[0]._texture.baseTexture;this.state.blendMode=Dr(e.blendMode,s.alphaMode),n.state.set(this.state);var l=n.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Ir(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,s.alphaMode),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var u=!1,c=0,d=0;c<a;c+=i,d+=1){var f=a-c;f>i&&(f=i),d>=o.length&&o.push(this._generateOneMoreBuffer(e));var p=o[d];p.uploadDynamic(t,c,f);var m=e._bufferUpdateIDs[d]||0;(u=u||p._updateID<m)&&(p._updateID=e._updateID,p.uploadStatic(t,c,f)),n.geometry.bind(p.geometry),l.drawElements(l.TRIANGLES,6*f,l.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var t=[],r=e._maxSize,i=e._batchSize,n=e._properties,a=0;a<r;a+=i)t.push(new Go(this.properties,n,i));return t},t.prototype._generateOneMoreBuffer=function(e){var t=e._batchSize,r=e._properties;return new Go(this.properties,r,t)},t.prototype.uploadVertices=function(e,t,r,i,n,a){for(var o=0,s=0,l=0,h=0,u=0;u<r;++u){var c=e[t+u],d=c._texture,f=c.scale.x,p=c.scale.y,m=d.trim,g=d.orig;m?(o=(s=m.x-c.anchor.x*g.width)+m.width,l=(h=m.y-c.anchor.y*g.height)+m.height):(o=g.width*(1-c.anchor.x),s=g.width*-c.anchor.x,l=g.height*(1-c.anchor.y),h=g.height*-c.anchor.y),i[a]=s*f,i[a+1]=h*p,i[a+n]=o*f,i[a+n+1]=h*p,i[a+2*n]=o*f,i[a+2*n+1]=l*p,i[a+3*n]=s*f,i[a+3*n+1]=l*p,a+=4*n}},t.prototype.uploadPosition=function(e,t,r,i,n,a){for(var o=0;o<r;o++){var s=e[t+o].position;i[a]=s.x,i[a+1]=s.y,i[a+n]=s.x,i[a+n+1]=s.y,i[a+2*n]=s.x,i[a+2*n+1]=s.y,i[a+3*n]=s.x,i[a+3*n+1]=s.y,a+=4*n}},t.prototype.uploadRotation=function(e,t,r,i,n,a){for(var o=0;o<r;o++){var s=e[t+o].rotation;i[a]=s,i[a+n]=s,i[a+2*n]=s,i[a+3*n]=s,a+=4*n}},t.prototype.uploadUvs=function(e,t,r,i,n,a){for(var o=0;o<r;++o){var s=e[t+o]._texture._uvs;s?(i[a]=s.x0,i[a+1]=s.y0,i[a+n]=s.x1,i[a+n+1]=s.y1,i[a+2*n]=s.x2,i[a+2*n+1]=s.y2,i[a+3*n]=s.x3,i[a+3*n+1]=s.y3,a+=4*n):(i[a]=0,i[a+1]=0,i[a+n]=0,i[a+n+1]=0,i[a+2*n]=0,i[a+2*n+1]=0,i[a+3*n]=0,i[a+3*n+1]=0,a+=4*n)}},t.prototype.uploadTint=function(e,t,r,i,n,a){for(var o=0;o<r;++o){var s=e[t+o],l=s._texture.baseTexture.alphaMode>0,h=s.alpha,u=h<1&&l?Rr(s._tintRGB,h):s._tintRGB+(255*h<<24);i[a]=u,i[a+n]=u,i[a+2*n]=u,i[a+3*n]=u,a+=4*n}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(zn);(Ho=zo||(zo={})).MITER="miter",Ho.BEVEL="bevel",Ho.ROUND="round",(Vo=jo||(jo={})).BUTT="butt",Vo.ROUND="round",Vo.SQUARE="square";var Wo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(e,t){if(void 0===t&&(t=20),!this.adaptive||!e||isNaN(e))return t;var r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},Yo=function(){function e(){this.color=16777215,this.alpha=1,this.texture=_n.WHITE,this.matrix=null,this.visible=!1,this.reset()}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},e.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=_n.WHITE,this.matrix=null,this.visible=!1},e.prototype.destroy=function(){this.texture=null,this.matrix=null},e}(),Xo=function(e,t){return(Xo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function qo(e,t){function r(){this.constructor=e}Xo(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Zo={build:function(e){e.points=e.shape.points.slice()},triangulate:function(e,t){var r=e.points,i=e.holes,n=t.points,a=t.indices;if(r.length>=6){for(var o=[],s=0;s<i.length;s++){var l=i[s];o.push(r.length/2),r=r.concat(l.points)}var h=ht(r,o,2);if(!h)return;var u=n.length/2;for(s=0;s<h.length;s+=3)a.push(h[s]+u),a.push(h[s+1]+u),a.push(h[s+2]+u);for(s=0;s<r.length;s++)n.push(r[s])}}},Jo={build:function(e){var t,r,i=e.shape,n=e.points,a=i.x,o=i.y;if(n.length=0,e.type===si.CIRC)t=i.radius,r=i.radius;else{var s=e.shape;t=s.width,r=s.height}if(0!==t&&0!==r){var l=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(t+r));l/=2.3;for(var h=2*Math.PI/l,u=0;u<l-.5;u++)n.push(a+Math.sin(-h*u)*t,o+Math.cos(-h*u)*r);n.push(n[0],n[1])}},triangulate:function(e,t){var r=e.points,i=t.points,n=t.indices,a=i.length/2,o=a,s=e.shape,l=e.matrix,h=s.x,u=s.y;i.push(e.matrix?l.a*h+l.c*u+l.tx:h,e.matrix?l.b*h+l.d*u+l.ty:u);for(var c=0;c<r.length;c+=2)i.push(r[c],r[c+1]),n.push(a++,o,a)}},Qo={build:function(e){var t=e.shape,r=t.x,i=t.y,n=t.width,a=t.height,o=e.points;o.length=0,o.push(r,i,r+n,i,r+n,i+a,r,i+a)},triangulate:function(e,t){var r=e.points,i=t.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function $o(e,t,r){return e+(t-e)*r}function es(e,t,r,i,n,a,o){void 0===o&&(o=[]);for(var s=o,l=0,h=0,u=0,c=0,d=0,f=0,p=0,m=0;p<=20;++p)l=$o(e,r,m=p/20),h=$o(t,i,m),u=$o(r,n,m),c=$o(i,a,m),d=$o(l,u,m),f=$o(h,c,m),s.push(d,f);return s}var ts={build:function(e){var t=e.shape,r=e.points,i=t.x,n=t.y,a=t.width,o=t.height,s=Math.max(0,Math.min(t.radius,Math.min(a,o)/2));r.length=0,s?(es(i,n+s,i,n,i+s,n,r),es(i+a-s,n,i+a,n,i+a,n+s,r),es(i+a,n+o-s,i+a,n+o,i+a-s,n+o,r),es(i+s,n+o,i,n+o,i,n+o-s,r)):r.push(i,n,i+a,n,i+a,n+o,i,n+o)},triangulate:function(e,t){for(var r=e.points,i=t.points,n=t.indices,a=i.length/2,o=ht(r,null,2),s=0,l=o.length;s<l;s+=3)n.push(o[s]+a),n.push(o[s+1]+a),n.push(o[s+2]+a);for(s=0,l=r.length;s<l;s++)i.push(r[s],r[++s])}};function rs(e,t,r,i,n,a,o,s){var l,h;o?(l=i,h=-r):(l=-i,h=r);var u=e-r*n+l,c=t-i*n+h,d=e+r*a+l,f=t+i*a+h;return s.push(u,c),s.push(d,f),2}function is(e,t,r,i,n,a,o,s){var l=r-e,h=i-t,u=Math.atan2(l,h),c=Math.atan2(n-e,a-t);s&&u<c?u+=2*Math.PI:!s&&u>c&&(c+=2*Math.PI);var d=u,f=c-u,p=Math.abs(f),m=Math.sqrt(l*l+h*h),g=1+(15*p*Math.sqrt(m)/Math.PI>>0),y=f/g;if(d+=y,s){o.push(e,t),o.push(r,i);for(var v=1,b=d;v<g;v++,b+=y)o.push(e,t),o.push(e+Math.sin(b)*m,t+Math.cos(b)*m);o.push(e,t),o.push(n,a)}else{o.push(r,i),o.push(e,t);for(v=1,b=d;v<g;v++,b+=y)o.push(e+Math.sin(b)*m,t+Math.cos(b)*m),o.push(e,t);o.push(n,a),o.push(e,t)}return 2*g}function ns(e,t){e.lineStyle.native?function(e,t){var r=0,i=e.shape,n=e.points||i.points,a=i.type!==si.POLY||i.closeStroke;if(0!==n.length){var o=t.points,s=t.indices,l=n.length/2,h=o.length/2,u=h;for(o.push(n[0],n[1]),r=1;r<l;r++)o.push(n[2*r],n[2*r+1]),s.push(u,u+1),u++;a&&s.push(u,h)}}(e,t):function(e,t){var r=e.shape,i=e.points||r.points.slice(),n=t.closePointEps;if(0!==i.length){var a=e.lineStyle,o=new yi(i[0],i[1]),s=new yi(i[i.length-2],i[i.length-1]),l=r.type!==si.POLY||r.closeStroke,h=Math.abs(o.x-s.x)<n&&Math.abs(o.y-s.y)<n;if(l){i=i.slice(),h&&(i.pop(),i.pop(),s.set(i[i.length-2],i[i.length-1]));var u=.5*(o.x+s.x),c=.5*(s.y+o.y);i.unshift(u,c),i.push(u,c)}var d=t.points,f=i.length/2,p=i.length,m=d.length/2,g=a.width/2,y=g*g,v=a.miterLimit*a.miterLimit,b=i[0],x=i[1],_=i[2],T=i[3],E=0,A=0,w=-(x-T),k=b-_,S=0,M=0,C=Math.sqrt(w*w+k*k);w/=C,k/=C,w*=g,k*=g;var P=a.alignment,O=2*(1-P),D=2*P;l||(a.cap===jo.ROUND?p+=is(b-w*(O-D)*.5,x-k*(O-D)*.5,b-w*O,x-k*O,b+w*D,x+k*D,d,!0)+2:a.cap===jo.SQUARE&&(p+=rs(b,x,w,k,O,D,!0,d))),d.push(b-w*O,x-k*O),d.push(b+w*D,x+k*D);for(var I=1;I<f-1;++I){b=i[2*(I-1)],x=i[2*(I-1)+1],_=i[2*I],T=i[2*I+1],E=i[2*(I+1)],A=i[2*(I+1)+1],w=-(x-T),k=b-_,w/=C=Math.sqrt(w*w+k*k),k/=C,w*=g,k*=g,S=-(T-A),M=_-E,S/=C=Math.sqrt(S*S+M*M),M/=C,S*=g,M*=g;var R=_-b,N=x-T,L=_-E,F=A-T,B=N*L-F*R,U=B<0;if(Math.abs(B)<.1)d.push(_-w*O,T-k*O),d.push(_+w*D,T+k*D);else{var z=(-w+b)*(-k+T)-(-w+_)*(-k+x),H=(-S+E)*(-M+T)-(-S+_)*(-M+A),j=(R*H-L*z)/B,V=(F*z-N*H)/B,G=(j-_)*(j-_)+(V-T)*(V-T),K=_+(j-_)*O,W=T+(V-T)*O,Y=_-(j-_)*D,X=T-(V-T)*D,q=U?O:D;G<=Math.min(R*R+N*N,L*L+F*F)+q*q*y?a.join===zo.BEVEL||G/y>v?(U?(d.push(K,W),d.push(_+w*D,T+k*D),d.push(K,W),d.push(_+S*D,T+M*D)):(d.push(_-w*O,T-k*O),d.push(Y,X),d.push(_-S*O,T-M*O),d.push(Y,X)),p+=2):a.join===zo.ROUND?U?(d.push(K,W),d.push(_+w*D,T+k*D),p+=is(_,T,_+w*D,T+k*D,_+S*D,T+M*D,d,!0)+4,d.push(K,W),d.push(_+S*D,T+M*D)):(d.push(_-w*O,T-k*O),d.push(Y,X),p+=is(_,T,_-w*O,T-k*O,_-S*O,T-M*O,d,!1)+4,d.push(_-S*O,T-M*O),d.push(Y,X)):(d.push(K,W),d.push(Y,X)):(d.push(_-w*O,T-k*O),d.push(_+w*D,T+k*D),a.join===zo.BEVEL||G/y>v||(a.join===zo.ROUND?p+=U?is(_,T,_+w*D,T+k*D,_+S*D,T+M*D,d,!0)+2:is(_,T,_-w*O,T-k*O,_-S*O,T-M*O,d,!1)+2:(U?(d.push(Y,X),d.push(Y,X)):(d.push(K,W),d.push(K,W)),p+=2)),d.push(_-S*O,T-M*O),d.push(_+S*D,T+M*D),p+=2)}}b=i[2*(f-2)],x=i[2*(f-2)+1],_=i[2*(f-1)],w=-(x-(T=i[2*(f-1)+1])),k=b-_,w/=C=Math.sqrt(w*w+k*k),k/=C,w*=g,k*=g,d.push(_-w*O,T-k*O),d.push(_+w*D,T+k*D),l||(a.cap===jo.ROUND?p+=is(_-w*(O-D)*.5,T-k*(O-D)*.5,_-w*O,T-k*O,_+w*D,T+k*D,d,!1)+2:a.cap===jo.SQUARE&&(p+=rs(_,T,w,k,O,D,!1,d)));var Z=t.indices,J=Wo.epsilon*Wo.epsilon;for(I=m;I<p+m-2;++I)b=d[2*I],x=d[2*I+1],_=d[2*(I+1)],T=d[2*(I+1)+1],E=d[2*(I+2)],A=d[2*(I+2)+1],Math.abs(b*(T-A)+_*(A-x)+E*(x-T))<J||Z.push(I,I+1,I+2)}}(e,t)}var as,os=function(e){function t(t,r,i,n,a,o){void 0===o&&(o=0);a=a||n/2;for(var s=-1*Math.PI/2+o,l=2*i,h=hi/l,u=[],c=0;c<l;c++){var d=c%2?a:n,f=c*h+s;u.push(t+d*Math.cos(f),r+d*Math.sin(f))}return e.call(this,u)||this}return qo(t,e),t}(mi),ss=function(){function e(){}return e.curveTo=function(e,t,r,i,n,a){var o=a[a.length-2],s=a[a.length-1]-t,l=o-e,h=i-t,u=r-e,c=Math.abs(s*u-l*h);if(c<1e-8||0===n)return a[a.length-2]===e&&a[a.length-1]===t||a.push(e,t),null;var d=s*s+l*l,f=h*h+u*u,p=s*h+l*u,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(f)/c,y=m*p/d,v=g*p/f,b=m*u+g*l,x=m*h+g*s,_=l*(g+y),T=s*(g+y),E=u*(m+v),A=h*(m+v);return{cx:b+e,cy:x+t,radius:n,startAngle:Math.atan2(T-x,_-b),endAngle:Math.atan2(A-x,E-b),anticlockwise:l*h>u*s}},e.arc=function(e,t,r,i,n,a,o,s,l){for(var h=o-a,u=Wo._segmentsCount(Math.abs(h)*n,40*Math.ceil(Math.abs(h)/hi)),c=h/(2*u),d=2*c,f=Math.cos(c),p=Math.sin(c),m=u-1,g=m%1/m,y=0;y<=m;++y){var v=c+a+d*(y+g*y),b=Math.cos(v),x=-Math.sin(v);l.push((f*b+p*x)*n+r,(f*-x+p*b)*n+i)}},e}(),ls=function(){function e(){}return e.curveLength=function(e,t,r,i,n,a,o,s){for(var l=0,h=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,y=0,v=0,b=e,x=t,_=1;_<=10;++_)y=b-(m=(p=(f=(d=1-(h=_/10))*d)*d)*e+3*f*h*r+3*d*(u=h*h)*n+(c=u*h)*o),v=x-(g=p*t+3*f*h*i+3*d*u*a+c*s),b=m,x=g,l+=Math.sqrt(y*y+v*v);return l},e.curveTo=function(t,r,i,n,a,o,s){var l=s[s.length-2],h=s[s.length-1];s.length-=2;var u=Wo._segmentsCount(e.curveLength(l,h,t,r,i,n,a,o)),c=0,d=0,f=0,p=0,m=0;s.push(l,h);for(var g=1,y=0;g<=u;++g)f=(d=(c=1-(y=g/u))*c)*c,m=(p=y*y)*y,s.push(f*l+3*d*y*t+3*c*p*i+m*a,f*h+3*d*y*r+3*c*p*n+m*o)},e}(),hs=function(){function e(){}return e.curveLength=function(e,t,r,i,n,a){var o=e-2*r+n,s=t-2*i+a,l=2*r-2*e,h=2*i-2*t,u=4*(o*o+s*s),c=4*(o*l+s*h),d=l*l+h*h,f=2*Math.sqrt(u+c+d),p=Math.sqrt(u),m=2*u*p,g=2*Math.sqrt(d),y=c/p;return(m*f+p*c*(f-g)+(4*d*u-c*c)*Math.log((2*p+y+f)/(y+g)))/(4*m)},e.curveTo=function(t,r,i,n,a){for(var o=a[a.length-2],s=a[a.length-1],l=Wo._segmentsCount(e.curveLength(o,s,t,r,i,n)),h=0,u=0,c=1;c<=l;++c){var d=c/l;h=o+(t-o)*d,u=s+(r-s)*d,a.push(h+(t+(i-t)*d-h)*d,u+(r+(n-r)*d-u)*d)}},e}(),us=function(){function e(){this.reset()}return e.prototype.begin=function(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r},e.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},e.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},e}(),cs=((as={})[si.POLY]=Zo,as[si.CIRC]=Jo,as[si.ELIP]=Jo,as[si.RECT]=Qo,as[si.RREC]=ts,as),ds=[],fs=[],ps=function(){function e(e,t,r,i){void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=i,this.type=e.type,this.points=[],this.holes=[]}return e.prototype.clone=function(){return new e(this.shape,this.fillStyle,this.lineStyle,this.matrix)},e.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},e}(),ms=new yi,gs=new Ci,ys=function(e){function t(){var t=e.call(this)||this;return t.uvsFloat32=null,t.indicesUint16=null,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.dirty=0,t.batchDirty=-1,t.cacheDirty=-1,t.clearDirty=0,t.drawCalls=[],t.batches=[],t.shapeIndex=0,t._bounds=new Ci,t.boundsDirty=-1,t.boundsPadding=0,t.batchable=!1,t.indicesUint16=null,t.uvsFloat32=null,t.closePointEps=1e-4,t}return qo(t,e),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),fs.push(this.drawCalls[e]);this.drawCalls.length=0;for(e=0;e<this.batches.length;e++){var t=this.batches[e];t.reset(),ds.push(t)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,t,r,i){void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=null);var n=new ps(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this},t.prototype.drawHole=function(e,t){if(void 0===t&&(t=null),!this.graphicsData.length)return null;var r=new ps(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var t=this.graphicsData,r=0;r<t.length;++r){var i=t[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(e,ms):ms.copyFrom(e),i.shape.contains(ms.x,ms.y)))){var n=!1;if(i.holes)for(var a=0;a<i.holes.length;a++){if(i.holes[a].shape.contains(ms.x,ms.y)){n=!0;break}}if(!n)return!0}}return!1},t.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,r=this.graphicsData,i=null,n=null;this.batches.length>0&&(n=(i=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<r.length;a++){this.shapeIndex++;var o=r[a],s=o.fillStyle,l=o.lineStyle;cs[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix);for(var h=0;h<2;h++){var u=0===h?s:l;if(u.visible){var c=u.texture.baseTexture,d=this.indices.length,f=this.points.length/2;c.wrapMode=ar.REPEAT,0===h?this.processFill(o):this.processLine(o);var p=this.points.length/2-f;0!==p&&(i&&!this._compareStyles(n,u)&&(i.end(d,f),i=null),i||((i=ds.pop()||new us).begin(u,d,f),this.batches.push(i),n=u),this.addUvs(this.points,t,u.texture,f,p,u.matrix))}}}var m=this.indices.length,g=this.points.length/2;if(i&&i.end(m,g),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var y=g>65535&&e;this.indicesUint16=y?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},t.prototype._compareStyles=function(e,t){return!(!e||!t)&&(e.texture.baseTexture===t.texture.baseTexture&&(e.color+e.alpha===t.color+t.alpha&&!!e.native==!!t.native))},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,t=this.graphicsData.length;e<t;e++){var r=this.graphicsData[e],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,t=0,r=e.length;t<r;t++)for(var i=e[t],n=0;n<i.size;n++){var a=i.start+n;this.indicesUint16[a]=this.indicesUint16[a]-i.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE},t.prototype.buildDrawCalls=function(){for(var e=++an._globalBatch,t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),fs.push(this.drawCalls[t]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,n=fs.pop();n||((n=new Ya).texArray=new Xa),n.texArray.count=0,n.start=0,n.size=0,n.type=qt.TRIANGLES;var a=0,o=null,s=0,l=!1,h=qt.TRIANGLES,u=0;this.drawCalls.push(n);for(t=0;t<this.batches.length;t++){var c=this.batches[t],d=c.style,f=d.texture.baseTexture;l!==!!d.native&&(h=(l=!!d.native)?qt.LINES:qt.TRIANGLES,o=null,a=8,e++),o!==f&&(o=f,f._batchEnabled!==e&&(8===a&&(e++,a=0,n.size>0&&((n=fs.pop())||((n=new Ya).texArray=new Xa),this.drawCalls.push(n)),n.start=u,n.size=0,n.texArray.count=0,n.type=h),f.touched=1,f._batchEnabled=e,f._batchLocation=a,f.wrapMode=10497,n.texArray.elements[n.texArray.count++]=f,a++)),n.size+=c.size,u+=c.size,s=f._batchLocation,this.addColors(r,d.color,d.alpha,c.attribSize),this.addTextureIds(i,s,c.attribSize)}an._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*e.length*4),a=new Float32Array(n),o=new Uint32Array(n),s=0,l=0;l<e.length/2;l++)a[s++]=e[2*l],a[s++]=e[2*l+1],a[s++]=t[2*l],a[s++]=t[2*l+1],o[s++]=r[l],a[s++]=i[l];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?(this.processHoles(e.holes),Zo.triangulate(e,this)):cs[e.type].triangulate(e,this)},t.prototype.processLine=function(e){ns(e,this);for(var t=0;t<e.holes.length;t++)ns(e.holes[t],this)},t.prototype.processHoles=function(e){for(var t=0;t<e.length;t++){var r=e[t];cs[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,t=gs,r=bi.IDENTITY;this._bounds.clear(),t.clear();for(var i=0;i<this.graphicsData.length;i++){var n=this.graphicsData[i],a=n.shape,o=n.type,s=n.lineStyle,l=n.matrix||bi.IDENTITY,h=0;if(s&&s.visible){var u=s.alignment;h=s.width,o===si.POLY?h*=.5+Math.abs(.5-u):h*=Math.max(0,u)}if(r!==l&&(t.isEmpty()||(e.addBoundsMatrix(t,r),t.clear()),r=l),o===si.RECT||o===si.RREC){var c=a;t.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,h,h)}else if(o===si.CIRC){var d=a;t.addFramePad(d.x,d.y,d.x,d.y,d.radius+h,d.radius+h)}else if(o===si.ELIP){var f=a;t.addFramePad(f.x,f.y,f.x,f.y,f.width+h,f.height+h)}else{var p=a;e.addVerticesMatrix(r,p.points,0,p.points.length,h,h)}}t.isEmpty()||e.addBoundsMatrix(t,r),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,t){for(var r=0;r<e.length/2;r++){var i=e[2*r],n=e[2*r+1];e[2*r]=t.a*i+t.c*n+t.tx,e[2*r+1]=t.b*i+t.d*n+t.ty}},t.prototype.addColors=function(e,t,r,i){for(var n=Rr((t>>16)+(65280&t)+((255&t)<<16),r);i-- >0;)e.push(n)},t.prototype.addTextureIds=function(e,t,r){for(;r-- >0;)e.push(t)},t.prototype.addUvs=function(e,t,r,i,n,a){void 0===a&&(a=null);for(var o=0,s=t.length,l=r.frame;o<n;){var h=e[2*(i+o)],u=e[2*(i+o)+1];if(a){var c=a.a*h+a.c*u+a.tx;u=a.b*h+a.d*u+a.ty,h=c}o++,t.push(h/l.width,u/l.height)}var d=r.baseTexture;(l.width<d.width||l.height<d.height)&&this.adjustUvs(t,r,s,n)},t.prototype.adjustUvs=function(e,t,r,i){for(var n=t.baseTexture,a=1e-6,o=r+2*i,s=t.frame,l=s.width/n.width,h=s.height/n.height,u=s.x/s.width,c=s.y/s.height,d=Math.floor(e[r]+a),f=Math.floor(e[r+1]+a),p=r+2;p<o;p+=2)d=Math.min(d,Math.floor(e[p]+a)),f=Math.min(f,Math.floor(e[p+1]+a));u-=d,c-=f;for(p=r;p<o;p+=2)e[p]=(e[p]+u)*l,e[p+1]=(e[p+1]+c)*h},t.BATCHABLE_SIZE=100,t}(Qa),vs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=jo.BUTT,t.join=zo.MITER,t.miterLimit=10,t}return qo(t,e),t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){e.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(Yo),bs=new Float32Array(3),xs={},_s=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this)||this;return r._geometry=t||new ys,r._geometry.refCount++,r.shader=null,r.state=_a.for2d(),r._fillStyle=new Yo,r._lineStyle=new vs,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=Yt.NORMAL,r}return qo(t,e),Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e){if(void 0===e&&(e=null),"number"==typeof e){var t=arguments;e={width:t[0]||0,color:t[1]||0,alpha:void 0!==t[2]?t[2]:1,alignment:void 0!==t[3]?t[3]:.5,native:!!t[4]}}return this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){if("number"==typeof e){Xr("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var t=arguments,r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6];e={width:r,texture:i,color:n,alpha:a,matrix:o,alignment:s,native:l},Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]}))}e=Object.assign({width:0,texture:_n.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:jo.BUTT,join:zo.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var h=e.width>0&&e.alpha>0;return h?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:h},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new mi,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new mi,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this},t.prototype.lineTo=function(e,t){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===e&&n===t||r.push(e,t),this},t.prototype._initCurve=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)},t.prototype.quadraticCurveTo=function(e,t,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),hs.curveTo(e,t,r,i,n),this},t.prototype.bezierCurveTo=function(e,t,r,i,n,a){return this._initCurve(),ls.curveTo(e,t,r,i,n,a,this.currentPath.points),this},t.prototype.arcTo=function(e,t,r,i,n){this._initCurve(e,t);var a=this.currentPath.points,o=ss.curveTo(e,t,r,i,n,a);if(o){var s=o.cx,l=o.cy,h=o.radius,u=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(s,l,h,u,c,d)}return this},t.prototype.arc=function(e,t,r,i,n,a){if(void 0===a&&(a=!1),i===n)return this;if(!a&&n<=i?n+=hi:a&&i<=n&&(i+=hi),0===n-i)return this;var o=e+Math.cos(i)*r,s=t+Math.sin(i)*r,l=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){var u=Math.abs(h[h.length-2]-o),c=Math.abs(h[h.length-1]-s);u<l&&c<l||h.push(o,s)}else this.moveTo(o,s),h=this.currentPath.points;return ss.arc(o,s,e,t,r,i,n,a,h),this},t.prototype.beginFill=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),this.beginTextureFill({texture:_n.WHITE,color:e,alpha:t})},t.prototype.beginTextureFill=function(e){if(e instanceof _n){Xr("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var t=arguments,r=t[0],i=t[1],n=t[2],a=t[3];e={texture:r,color:i,alpha:n,matrix:a},Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]}))}e=Object.assign({texture:_n.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var o=e.alpha>0;return o?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:o},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,t,r,i){return this.drawShape(new di(e,t,r,i))},t.prototype.drawRoundedRect=function(e,t,r,i,n){return this.drawShape(new gi(e,t,r,i,n))},t.prototype.drawCircle=function(e,t,r){return this.drawShape(new fi(e,t,r))},t.prototype.drawEllipse=function(e,t,r,i){return this.drawShape(new pi(e,t,r,i))},t.prototype.drawPolygon=function(){for(var e,t=arguments,r=[],i=0;i<arguments.length;i++)r[i]=t[i];var n=!0,a=r[0];a.points?(n=a.closeStroke,e=a.points):e=Array.isArray(r[0])?r[0]:r;var o=new mi(e);return o.closeStroke=n,this.drawShape(o),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.drawStar=function(e,t,r,i,n,a){return void 0===a&&(a=0),this.drawPolygon(new os(e,t,r,i,n,a))},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return 1===e.length&&e[0].shape.type===si.RECT&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var t=this._geometry,r=e.context.supports.uint32Indices;t.updateBatches(r),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(var i=0;i<r;i++){var n=e.batches[i],a=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),s=new Float32Array(e.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),l={vertexData:o,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*n.start,n.size),uvs:s,_batchRGB:Sr(a),_tintRGB:a,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=l}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var t=0,r=this.batches.length;t<r;t++){var i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}},t.prototype._renderDirect=function(e){var t=this._resolveDirectShader(e),r=this._geometry,i=this.tint,n=this.worldAlpha,a=t.uniforms,o=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(i>>16&255)/255*n,a.tint[1]=(i>>8&255)/255*n,a.tint[2]=(255&i)/255*n,a.tint[3]=n,e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(var s=0,l=o.length;s<l;s++)this._renderDrawCallDirect(e,r.drawCalls[s])},t.prototype._renderDrawCallDirect=function(e,t){for(var r=t.texArray,i=t.type,n=t.size,a=t.start,o=r.count,s=0;s<o;s++)e.texture.bind(r.elements[s],s);e.geometry.draw(i,n,a)},t.prototype._resolveDirectShader=function(e){var t=this.shader,r=this.pluginName;if(!t){if(!xs[r]){for(var i=e.plugins.batch.MAX_TEXTURES,n=new Int32Array(i),a=0;a<i;a++)n[a]=a;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new bi,default:Fn.from({uSamplers:n},!0)},s=e.plugins[r]._shader.program;xs[r]=new xa(s,o)}t=xs[r]}return t},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var t=e.bounds,r=t.minX,i=t.minY,n=t.maxX,a=t.maxY;this._bounds.addFrame(this.transform,r,i,n,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Sr(this.tint,bs),t=0;t<this.batches.length;t++){var r=this.batches[t],i=r._batchRGB,n=(e[0]*i[0]*255<<16)+(e[1]*i[1]*255<<8)+(0|e[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,a=t.d,o=t.tx,s=t.ty,l=this._geometry.points,h=this.vertexData,u=0,c=0;c<l.length;c+=2){var d=l[c],f=l[c+1];h[u++]=r*d+n*f+o,h[u++]=a*f+i*d+s}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},t._TEMP_POINT=new yi,t}(Ni),Ts=function(e,t){return(Ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var Es,As,ws=new yi,ks=new Uint16Array([0,1,2,0,2,3]),Ss=function(e){function t(t){var r=e.call(this)||this;return r._anchor=new vi(r._onAnchorUpdate,r,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=Yt.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=t||_n.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=ks,r.pluginName="batch",r.isSprite=!0,r._roundPixels=we.ROUND_PIXELS,r}return function(e,t){function r(){this.constructor=e}Ts(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Gr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Gr(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,a=t.d,o=t.tx,s=t.ty,l=this.vertexData,h=e.trim,u=e.orig,c=this._anchor,d=0,f=0,p=0,m=0;if(h?(d=(f=h.x-c._x*u.width)+h.width,p=(m=h.y-c._y*u.height)+h.height):(d=(f=-c._x*u.width)+u.width,p=(m=-c._y*u.height)+u.height),l[0]=r*f+n*m+o,l[1]=a*m+i*f+s,l[2]=r*d+n*m+o,l[3]=a*m+i*d+s,l[4]=r*d+n*p+o,l[5]=a*p+i*d+s,l[6]=r*f+n*p+o,l[7]=a*p+i*f+s,this._roundPixels)for(var g=we.RESOLUTION,y=0;y<l.length;++y)l[y]=Math.round((l[y]*g|0)/g)}},t.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,r=e.orig,i=this._anchor,n=this.transform.worldTransform,a=n.a,o=n.b,s=n.c,l=n.d,h=n.tx,u=n.ty,c=-i._x*r.width,d=c+r.width,f=-i._y*r.height,p=f+r.height;t[0]=a*c+s*f+h,t[1]=l*f+o*c+u,t[2]=a*d+s*f+h,t[3]=l*f+o*d+u,t[4]=a*d+s*p+h,t[5]=l*p+o*d+u,t[6]=a*c+s*p+h,t[7]=l*p+o*c+u},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new di),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,ws);var t=this._texture.orig.width,r=this._texture.orig.height,i=-t*this.anchor.x,n=0;return ws.x>=i&&ws.x<i+t&&(n=-r*this.anchor.y,ws.y>=n&&ws.y<n+r)},t.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var r="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!r)}this._texture=null},t.from=function(e,r){return new t(e instanceof _n?e:_n.from(e,r))},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var t=Gr(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var t=Gr(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||_n.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Ni),Ms=function(e,t){return(Ms=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};(As=Es||(Es={}))[As.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",As[As.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";var Cs={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Es.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Ps=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Os=function(){function e(e){this.styleID=0,this.reset(),Rs(this,e,e)}return e.prototype.clone=function(){var t={};return Rs(t,this,Cs),new e(t)},e.prototype.reset=function(){Rs(this,Cs,Cs)},Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=Is(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=Is(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=Is(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),e.prototype.toFontString=function(){var e="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var r=t.length-1;r>=0;r--){var i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&Ps.indexOf(i)<0&&(i='"'+i+'"'),t[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},e}();function Ds(e){return"number"==typeof e?Mr(e):("string"==typeof e&&0===e.indexOf("0x")&&(e=e.replace("0x","#")),e)}function Is(e){if(Array.isArray(e)){for(var t=0;t<e.length;++t)e[t]=Ds(e[t]);return e}return Ds(e)}function Rs(e,t,r){for(var i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}var Ns=function(){function e(e,t,r,i,n,a,o,s,l){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=l}return e.measureText=function(t,r,i,n){void 0===n&&(n=e._canvas),i=null==i?r.wordWrap:i;var a=r.toFontString(),o=e.measureFont(a);0===o.fontSize&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);var s=n.getContext("2d");s.font=a;for(var l=(i?e.wordWrap(t,r,n):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),u=0,c=0;c<l.length;c++){var d=s.measureText(l[c]).width+(l[c].length-1)*r.letterSpacing;h[c]=d,u=Math.max(u,d)}var f=u+r.strokeThickness;r.dropShadow&&(f+=r.dropShadowDistance);var p=r.lineHeight||o.fontSize+r.strokeThickness,m=Math.max(p,o.fontSize+r.strokeThickness)+(l.length-1)*(p+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new e(t,r,f,m,l,h,p+r.leading,u,o)},e.wordWrap=function(t,r,i){void 0===i&&(i=e._canvas);for(var n=i.getContext("2d"),a=0,o="",s="",l=Object.create(null),h=r.letterSpacing,u=r.whiteSpace,c=e.collapseSpaces(u),d=e.collapseNewlines(u),f=!c,p=r.wordWrapWidth+h,m=e.tokenize(t),g=0;g<m.length;g++){var y=m[g];if(e.isNewline(y)){if(!d){s+=e.addLine(o),f=!c,o="",a=0;continue}y=" "}if(c){var v=e.isBreakingSpace(y),b=e.isBreakingSpace(o[o.length-1]);if(v&&b)continue}var x=e.getFromCache(y,h,l,n);if(x>p)if(""!==o&&(s+=e.addLine(o),o="",a=0),e.canBreakWords(y,r.breakWords))for(var _=e.wordWrapSplit(y),T=0;T<_.length;T++){for(var E=_[T],A=1;_[T+A];){var w=_[T+A],k=E[E.length-1];if(e.canBreakChars(k,w,y,T,r.breakWords))break;E+=w,A++}T+=E.length-1;var S=e.getFromCache(E,h,l,n);S+a>p&&(s+=e.addLine(o),f=!1,o="",a=0),o+=E,a+=S}else{o.length>0&&(s+=e.addLine(o),o="",a=0);var M=g===m.length-1;s+=e.addLine(y,!M),f=!1,o="",a=0}else x+a>p&&(f=!1,s+=e.addLine(o),o="",a=0),(o.length>0||!e.isBreakingSpace(y)||f)&&(o+=y,a+=x)}return s+=e.addLine(o,!1)},e.addLine=function(t,r){return void 0===r&&(r=!0),t=e.trimRight(t),t=r?t+"\n":t},e.getFromCache=function(e,t,r,i){var n=r[e];if("number"!=typeof n){var a=e.length*t;n=i.measureText(e).width+a,r[e]=n}return n},e.collapseSpaces=function(e){return"normal"===e||"pre-line"===e},e.collapseNewlines=function(e){return"normal"===e},e.trimRight=function(t){if("string"!=typeof t)return"";for(var r=t.length-1;r>=0;r--){var i=t[r];if(!e.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},e.isNewline=function(t){return"string"==typeof t&&e._newlines.indexOf(t.charCodeAt(0))>=0},e.isBreakingSpace=function(t){return"string"==typeof t&&e._breakingSpaces.indexOf(t.charCodeAt(0))>=0},e.tokenize=function(t){var r=[],i="";if("string"!=typeof t)return r;for(var n=0;n<t.length;n++){var a=t[n];e.isBreakingSpace(a)||e.isNewline(a)?(""!==i&&(r.push(i),i=""),r.push(a)):i+=a}return""!==i&&r.push(i),r},e.canBreakWords=function(e,t){return t},e.canBreakChars=function(e,t,r,i,n){return!0},e.wordWrapSplit=function(e){return e.split("")},e.measureFont=function(t){if(e._fonts[t])return e._fonts[t];var r={ascent:0,descent:0,fontSize:0},i=e._canvas,n=e._context;n.font=t;var a=e.METRICS_STRING+e.BASELINE_SYMBOL,o=Math.ceil(n.measureText(a).width),s=Math.ceil(n.measureText(e.BASELINE_SYMBOL).width),l=2*s;s=s*e.BASELINE_MULTIPLIER|0,i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(a,0,s);var h=n.getImageData(0,0,o,l).data,u=h.length,c=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var m=0;m<c;m+=4)if(255!==h[f+m]){p=!0;break}if(p)break;f+=c}for(r.ascent=s-d,f=u-c,p=!1,d=l;d>s;--d){for(m=0;m<c;m+=4)if(255!==h[f+m]){p=!0;break}if(p)break;f-=c}return r.descent=d-s,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r},e.clearMetrics=function(t){void 0===t&&(t=""),t?delete e._fonts[t]:e._fonts={}},e}(),Ls=function(){try{var e=new OffscreenCanvas(0,0),t=e.getContext("2d");return t&&t.measureText?e:document.createElement("canvas")}catch(e){return document.createElement("canvas")}}();Ls.width=Ls.height=10,Ns._canvas=Ls,Ns._context=Ls.getContext("2d"),Ns._fonts={},Ns.METRICS_STRING="|q",Ns.BASELINE_SYMBOL="M",Ns.BASELINE_MULTIPLIER=1.4,Ns._newlines=[10,13],Ns._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Fs={texture:!0,children:!1,baseTexture:!0},Bs=function(e){function t(t,r,i){var n=this,a=!1;i||(i=document.createElement("canvas"),a=!0),i.width=3,i.height=3;var o=_n.from(i);return o.orig=new di,o.trim=new di,(n=e.call(this,o)||this)._ownCanvas=a,n.canvas=i,n.context=n.canvas.getContext("2d"),n._resolution=we.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=t,n.style=r,n.localStyleID=-1,n}return function(e,t){function r(){this.constructor=e}Ms(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.updateText=function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),this.dirty||!e){this._font=this._style.toFontString();var r,i,n=this.context,a=Ns.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=a.width,s=a.height,l=a.lines,h=a.lineHeight,u=a.lineWidths,c=a.maxLineWidth,d=a.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,s)+2*t.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=t.strokeThickness,n.textBaseline=t.textBaseline,n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit;for(var f=t.dropShadow?2:1,p=0;p<f;++p){var m=t.dropShadow&&0===p,g=m?Math.ceil(Math.max(1,s)+2*t.padding):0,y=g*this._resolution;if(m){n.fillStyle="black",n.strokeStyle="black";var v=t.dropShadowColor,b=Sr("number"==typeof v?v:Cr(v));n.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+t.dropShadowAlpha+")",n.shadowBlur=t.dropShadowBlur,n.shadowOffsetX=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,n.shadowOffsetY=Math.sin(t.dropShadowAngle)*t.dropShadowDistance+y}else n.fillStyle=this._generateFillStyle(t,l,a),n.strokeStyle=t.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<l.length;x++)r=t.strokeThickness/2,i=t.strokeThickness/2+x*h+d.ascent,"right"===t.align?r+=c-u[x]:"center"===t.align&&(r+=(c-u[x])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(l[x],r+t.padding,i+t.padding-g,!0),t.fill&&this.drawLetterSpacing(l[x],r+t.padding,i+t.padding-g)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,t,r,i){void 0===i&&(i=!1);var n=this._style.letterSpacing;if(0!==n)for(var a=t,o=Array.from?Array.from(e):e.split(""),s=this.context.measureText(e).width,l=0,h=0;h<o.length;++h){var u=o[h];i?this.context.strokeText(u,a,r):this.context.fillText(u,a,r),a+=s-(l=this.context.measureText(e.substring(h+1)).width)+n,s=l}else i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r)},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var t=ti(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,a=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(e.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(e.height/this._resolution),r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},t.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},t.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,t,r){var i,n=e.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var a=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,s=Math.ceil(this.canvas.width/this._resolution)-a-2*o,l=Math.ceil(this.canvas.height/this._resolution)-a-2*o,h=n.slice(),u=e.fillGradientStops.slice();if(!u.length)for(var c=h.length+1,d=1;d<c;++d)u.push(d/c);if(h.unshift(n[0]),u.unshift(0),h.push(n[n.length-1]),u.push(1),e.fillGradientType===Es.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,o,s/2,l+o);var f=0,p=(r.fontProperties.fontSize+e.strokeThickness)/l;for(d=0;d<t.length;d++)for(var m=r.lineHeight*d,g=0;g<h.length;g++){var y=m/l+("number"==typeof u[g]?u[g]:g/h.length)*p,v=Math.max(f,y);v=Math.min(v,1),i.addColorStop(v,h[g]),f=v}}else{i=this.context.createLinearGradient(o,l/2,s+o,l/2);var b=h.length+1,x=1;for(d=0;d<h.length;d++){var _=void 0;_="number"==typeof u[d]?u[d]:x/b,i.addColorStop(_,h[d]),x++}}return i},t.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Fs,t),e.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=Gr(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=Gr(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof Os?e:new Os(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t}(Ss);we.UPLOADS_PER_FRAME=4;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/
var Us=function(e,t){return(Us=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var zs=function(){function e(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},e}();function Hs(e,t){var r=!1;if(e&&e._textures&&e._textures.length)for(var i=0;i<e._textures.length;i++)if(e._textures[i]instanceof _n){var n=e._textures[i].baseTexture;-1===t.indexOf(n)&&(t.push(n),r=!0)}return r}function js(e,t){if(e.baseTexture instanceof an){var r=e.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Vs(e,t){if(e._texture&&e._texture instanceof _n){var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Gs(e,t){return t instanceof Bs&&(t.updateText(!0),!0)}function Ks(e,t){if(t instanceof Os){var r=t.toFontString();return Ns.measureFont(r),!0}return!1}function Ws(e,t){if(e instanceof Bs){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Ys(e,t){return e instanceof Os&&(-1===t.indexOf(e)&&t.push(e),!0)}function Xs(e,t){return t instanceof an&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function qs(e,t){if(!(t instanceof _s))return!1;var r=t.geometry;t.finishPoly(),r.updateBatches();for(var i=r.batches,n=0;n<i.length;n++){var a=i[n].style.texture;a&&Xs(e,a.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function Zs(e,t){return e instanceof _s&&(t.push(e),!0)}var Js=function(e){function t(t){var r=e.call(this,t)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(Zs),r.registerUploadHook(Xs),r.registerUploadHook(qs),r}return function(e,t){function r(){this.constructor=e}Us(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(function(){function e(e){var t=this;this.limiter=new zs(we.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(Ws),this.registerFindHook(Ys),this.registerFindHook(Hs),this.registerFindHook(js),this.registerFindHook(Vs),this.registerUploadHook(Gs),this.registerUploadHook(Ks)}return e.prototype.upload=function(e,t){"function"==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,zi.system.addOnce(this.tick,this,Li.UTILITY))):t&&t()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)zi.system.addOnce(this.tick,this,Li.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(r=0,i=n.length;r<i;r++)n[r]()}},e.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},e.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},e.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Ni)for(t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},e.prototype.destroy=function(){this.ticking&&zi.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}()),Qs=(function(){function e(e){this.maxMilliseconds=e,this.frameStart=0}e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds}}(),function(){function e(e,t,r){void 0===r&&(r=null),this._texture=e instanceof _n?e:null,this.baseTexture=e instanceof an?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return e.prototype._updateResolution=function(e){void 0===e&&(e=null);var t=this.data.meta.scale,r=oi(e,null);return null===r&&(r=void 0!==t?parseFloat(t):1),1!==r&&this.baseTexture.setResolution(r),r},e.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},e.prototype._processFrames=function(t){for(var r=t,i=e.BATCH_SIZE;r-t<i&&r<this._frameKeys.length;){var n=this._frameKeys[r],a=this._frames[n],o=a.frame;if(o){var s=null,l=null,h=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,u=new di(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);s=a.rotated?new di(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new di(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(l=new di(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new _n(this.baseTexture,s,u,l,a.rotated?2:0,a.anchor),_n.addToCache(this.textures[n],n)}r++}},e.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var r=0;r<e[t].length;r++){var i=e[t][r];this.animations[t].push(this.textures[i])}}},e.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},e.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*e.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)},e.prototype.destroy=function(e){var t;for(var r in void 0===e&&(e=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(null===(t=this._texture)||void 0===t||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},e.BATCH_SIZE=1e3,e}()),$s=function(){function e(){}return e.use=function(t,r){var i=this,n=t.name+"_image";if(t.data&&t.type===Io.TYPE.JSON&&t.data.frames&&!i.resources[n]){var a={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},o=e.getResourcePath(t,i.baseUrl);i.add(n,o,a,(function(e){if(e.error)r(e.error);else{var i=new Qs(e.texture,t.data,t.url);i.parse((function(){t.spritesheet=i,t.textures=i.textures,r()}))}}))}else r()},e.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:_r.resolve(e.url.replace(t,""),e.data.meta.image)},e}(),el=function(e,t){return(el=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function tl(e,t){function r(){this.constructor=e}el(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var rl=new yi,il=(function(e){function t(t,r,i){void 0===r&&(r=100),void 0===i&&(i=100);var n=e.call(this,t)||this;return n.tileTransform=new Mi,n._width=r,n._height=i,n.uvMatrix=n.texture.uvMatrix||new Aa(t),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}tl(t,e),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var t=this._texture;t&&t.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,i)},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new di),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,rl);var t=this._width,r=this._height,i=-t*this.anchor._x;if(rl.x>=i&&rl.x<i+t){var n=-r*this.anchor._y;if(rl.y>=n&&rl.y<n+r)return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,r){return"number"==typeof r&&(Xr("5.3.0","TilingSprite.from use options instead of width and height args"),r={width:r,height:arguments[2]}),new t(_n.from(e,r),r.width,r.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0})}(Ss),"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"),nl=new bi,al=function(e){function t(t){var r=e.call(this,t)||this,i={globals:r.renderer.globalUniforms};return r.shader=xa.from(il,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",i),r.simpleShader=xa.from(il,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",i),r.quad=new Nn,r.state=_a.for2d(),r}return tl(t,e),t.prototype.render=function(e){var t=this.renderer,r=this.quad,i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&((i=r.uvs)[0]=i[6]=-e.anchor.x,i[1]=i[3]=-e.anchor.y,i[2]=i[4]=1-e.anchor.x,i[5]=i[7]=1-e.anchor.y),r.invalidate();var n=e._texture,a=n.baseTexture,o=e.tileTransform.localTransform,s=e.uvMatrix,l=a.isPowerOfTwo&&n.frame.width===a.width&&n.frame.height===a.height;l&&(a._glTextures[t.CONTEXT_UID]?l=a.wrapMode!==ar.CLAMP:a.wrapMode===ar.CLAMP&&(a.wrapMode=ar.REPEAT));var h=l?this.simpleShader:this.shader,u=n.width,c=n.height,d=e._width,f=e._height;nl.set(o.a*u/d,o.b*u/f,o.c*c/d,o.d*c/f,o.tx/d,o.ty/f),nl.invert(),l?nl.prepend(s.mapCoord):(h.uniforms.uMapCoord=s.mapCoord.toArray(!0),h.uniforms.uClampFrame=s.uClampFrame,h.uniforms.uClampOffset=s.uClampOffset),h.uniforms.uTransform=nl.toArray(!0),h.uniforms.uColor=Nr(e.tint,e.worldAlpha,h.uniforms.uColor,a.alphaMode),h.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),h.uniforms.uSampler=n,t.shader.bind(h),t.geometry.bind(r),this.state.blendMode=Dr(e.blendMode,a.alphaMode),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(zn),ol=function(e,t){return(ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function sl(e,t){function r(){this.constructor=e}ol(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var ll=function(){function e(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return e.prototype.update=function(e){if(e||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;this.data&&this.data.length===t.length||(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},e}(),hl=new yi,ul=new mi,cl=function(e){function t(t,r,i,n){void 0===n&&(n=qt.TRIANGLES);var a=e.call(this)||this;return a.geometry=t,t.refCount++,a.shader=r,a.state=i||_a.for2d(),a.drawMode=n,a.start=0,a.size=0,a.uvs=null,a.indices=null,a.vertexData=new Float32Array(1),a.vertexDirty=0,a._transformID=-1,a._roundPixels=we.ROUND_PIXELS,a.batchUvs=null,a}return sl(t,e),Object.defineProperty(t.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this.shader.tint},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),t.prototype._render=function(e){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===qt.TRIANGLES&&r.length<2*t.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},t.prototype._renderDefault=function(e){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.program.uniformData.translationMatrix&&(t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},t.prototype._renderToBatch=function(e){var t=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)},t.prototype.calculateVertices=function(){var e=this.geometry,t=e.buffers[0].data;if(e.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));for(var r=this.transform.worldTransform,i=r.a,n=r.b,a=r.c,o=r.d,s=r.tx,l=r.ty,h=this.vertexData,u=0;u<h.length/2;u++){var c=t[2*u],d=t[2*u+1];h[2*u]=i*c+a*d+s,h[2*u+1]=n*c+o*d+l}if(this._roundPixels){var f=we.RESOLUTION;for(u=0;u<h.length;++u)h[u]=Math.round((h[u]*f|0)/f)}this.vertexDirty=e.vertexDirtyId}},t.prototype.calculateUvs=function(){var e=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new ll(e,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,hl);for(var t=this.geometry.getBuffer("aVertexPosition").data,r=ul.points,i=this.geometry.getIndex().data,n=i.length,a=4===this.drawMode?3:1,o=0;o+2<n;o+=a){var s=2*i[o],l=2*i[o+1],h=2*i[o+2];if(r[0]=t[s],r[1]=t[s+1],r[2]=t[l],r[3]=t[l+1],r[4]=t[h],r[5]=t[h+1],ul.contains(hl.x,hl.y))return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},t.BATCHABLE_SIZE=100,t}(Ni),dl=function(e){function t(t,r){var i=this,n={uSampler:t,alpha:1,uTextureMatrix:bi.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(n,r.uniforms),(i=e.call(this,r.program||ba.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n)||this)._colorDirty=!1,i.uvMatrix=new Aa(t),i.batchable=void 0===r.program,i.pluginName=r.pluginName,i.tint=r.tint,i.alpha=r.alpha,i}return sl(t,e),Object.defineProperty(t.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;Nr(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},t}(xa),fl=function(e){function t(t,r,i){var n=e.call(this)||this,a=new Sn(t),o=new Sn(r,!0),s=new Sn(i,!0,!0);return n.addAttribute("aVertexPosition",a,2,!1,tr.FLOAT).addAttribute("aTextureCoord",o,2,!1,tr.FLOAT).addIndex(s),n._updateId=-1,n}return sl(t,e),Object.defineProperty(t.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),t}(In),pl=function(e,t){return(pl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var ml=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},gl=function(){function e(){}return e.test=function(e){return"string"==typeof e&&0===e.indexOf("info face=")},e.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var i in t){var n=t[i].match(/^[a-z]+/gm)[0],a=t[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in a){var l=a[s].split("="),h=l[0],u=l[1].replace(/"/gm,""),c=parseFloat(u),d=isNaN(c)?u:c;o[h]=d}r[n].push(o)}var f=new ml;return r.info.forEach((function(e){return f.info.push({face:e.face,size:parseInt(e.size,10)})})),r.common.forEach((function(e){return f.common.push({lineHeight:parseInt(e.lineHeight,10)})})),r.page.forEach((function(e){return f.page.push({id:parseInt(e.id,10),file:e.file})})),r.char.forEach((function(e){return f.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})})),r.kerning.forEach((function(e){return f.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})})),f},e}(),yl=function(){function e(){}return e.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},e.parse=function(e){for(var t=new ml,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),n=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),s=0;s<r.length;s++)t.info.push({face:r[s].getAttribute("face"),size:parseInt(r[s].getAttribute("size"),10)});for(s=0;s<i.length;s++)t.common.push({lineHeight:parseInt(i[s].getAttribute("lineHeight"),10)});for(s=0;s<n.length;s++)t.page.push({id:parseInt(n[s].getAttribute("id"),10)||0,file:n[s].getAttribute("file")});for(s=0;s<a.length;s++){var l=a[s];t.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(s=0;s<o.length;s++)t.kerning.push({first:parseInt(o[s].getAttribute("first"),10),second:parseInt(o[s].getAttribute("second"),10),amount:parseInt(o[s].getAttribute("amount"),10)});return t},e}(),vl=function(){function e(){}return e.test=function(e){if("string"==typeof e&&e.indexOf("<font>")>-1){var t=(new self.DOMParser).parseFromString(e,"text/xml");return yl.test(t)}return!1},e.parse=function(e){var t=(new window.DOMParser).parseFromString(e,"text/xml");return yl.parse(t)},e}(),bl=[gl,yl,vl];function xl(e){for(var t=0;t<bl.length;t++)if(bl[t].test(e))return bl[t];return null}function _l(e,t,r,i,n,a){var o,s=r.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];var l=r.dropShadow?r.dropShadowDistance:0,h=r.padding||0,u=Math.ceil(e.width/i)-l-2*h,c=Math.ceil(e.height/i)-l-2*h,d=s.slice(),f=r.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,m=1;m<p;++m)f.push(m/p);if(d.unshift(s[0]),f.unshift(0),d.push(s[s.length-1]),f.push(1),r.fillGradientType===Es.LINEAR_VERTICAL){o=t.createLinearGradient(u/2,h,u/2,c+h);var g=0,y=(a.fontProperties.fontSize+r.strokeThickness)/c;for(m=0;m<n.length;m++)for(var v=a.lineHeight*m,b=0;b<d.length;b++){var x=v/c+("number"==typeof f[b]?f[b]:b/d.length)*y,_=Math.max(g,x);_=Math.min(_,1),o.addColorStop(_,d[b]),g=_}}else{o=t.createLinearGradient(h,c/2,u+h,c/2);var T=d.length+1,E=1;for(m=0;m<d.length;m++){var A=void 0;A="number"==typeof f[m]?f[m]:E/T,o.addColorStop(A,d[m]),E++}}return o}function Tl(e,t,r,i,n,a,o){var s=r.text,l=r.fontProperties;t.translate(i,n),t.scale(a,a);var h=o.strokeThickness/2,u=-o.strokeThickness/2;t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=_l(e,t,o,a,[s],r),t.strokeStyle=o.stroke,t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=_l(e,t,o,a,[s],r),t.strokeStyle=o.stroke;var c=o.dropShadowColor,d=Sr("number"==typeof c?c:Cr(c));o.dropShadow?(t.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+o.dropShadowAlpha+")",t.shadowBlur=o.dropShadowBlur,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),o.stroke&&o.strokeThickness&&t.strokeText(s,h,u+r.lineHeight-l.descent),o.fill&&t.fillText(s,h,u+r.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}var El=function(){function e(e,t,r){var i=e.info[0],n=e.common[0],a=oi(e.page[0].file),o={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/a,this.chars={},this.pageTextures=o;for(var s=0;s<e.page.length;s++){var l=e.page[s],h=l.id,u=l.file;o[h]=t instanceof Array?t[s]:t[u]}for(s=0;s<e.char.length;s++){var c=e.char[s],d=(h=c.id,c.page),f=e.char[s],p=f.x,m=f.y,g=f.width,y=f.height,v=f.xoffset,b=f.yoffset,x=f.xadvance;m/=a,g/=a,y/=a,v/=a,b/=a,x/=a;var _=new di((p/=a)+o[d].frame.x/a,m+o[d].frame.y/a,g,y);this.chars[h]={xOffset:v,yOffset:b,xAdvance:x,kerning:{},texture:new _n(o[d].baseTexture,_),page:d}}for(s=0;s<e.kerning.length;s++){var T=e.kerning[s],E=T.first,A=T.second,w=T.amount;E/=a,A/=a,w/=a,this.chars[A]&&(this.chars[A].kerning[E]=w)}}return e.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},e.install=function(t,r,i){var n;if(t instanceof ml)n=t;else{var a=xl(t);if(!a)throw new Error("Unrecognized data format for font.");n=a.parse(t)}r instanceof _n&&(r=[r]);var o=new e(n,r,i);return e.available[o.font]=o,o},e.uninstall=function(t){var r=e.available[t];if(!r)throw new Error("No font found named '"+t+"'");r.destroy(),delete e.available[t]},e.from=function(t,r,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},e.defaultOptions,i),a=n.chars,o=n.padding,s=n.resolution,l=n.textureWidth,h=n.textureHeight,u=function(e){"string"==typeof e&&(e=[e]);for(var t=[],r=0,i=e.length;r<i;r++){var n=e[r];if(Array.isArray(n)){if(2!==n.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var a=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,l=o;s<=l;s++)t.push(String.fromCharCode(s))}else t.push.apply(t,n.split(""))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(a),c=r instanceof Os?r:new Os(r),d=l,f=new ml;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};for(var p,m,g,y=0,v=0,b=0,x=[],_=0;_<u.length;_++){p||((p=document.createElement("canvas")).width=l,p.height=h,m=p.getContext("2d"),g=new an(p,{resolution:s}),x.push(new _n(g)),f.page.push({id:x.length-1,file:""}));var T=Ns.measureText(u[_],c,!1,p),E=T.width,A=Math.ceil(T.height),w=Math.ceil(("italic"===c.fontStyle?2:1)*E);if(v>=h-A*s){if(0===v)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+c.fontSize+"px fonts");--_,p=null,m=null,g=null,v=0,y=0,b=0}else if(b=Math.max(A+T.fontProperties.descent,b),w*s+y>=d)--_,v+=b*s,v=Math.ceil(v),y=0,b=0;else{Tl(p,m,T,y,v,s,c);var k=T.text.charCodeAt(0);f.char.push({id:k,page:x.length-1,x:y/s,y:v/s,width:w,height:A,xoffset:0,yoffset:0,xadvance:Math.ceil(E-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),y+=(w+2*o)*s,y=Math.ceil(y)}}var S=new e(f,x,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=S,S},e.ALPHA=[["a","z"],["A","Z"]," "],e.NUMERIC=[["0","9"]],e.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],e.ASCII=[[" ","~"]],e.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:e.ALPHANUMERIC},e.available={},e}(),Al=[],wl=[],kl=(function(e){function t(r,i){void 0===i&&(i={});var n=e.call(this)||this;n._tint=16777215,i.font&&(Xr("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),n._upgradeStyle(i));var a=Object.assign({},t.styleDefaults,i),o=a.align,s=a.tint,l=a.maxWidth,h=a.letterSpacing,u=a.fontName,c=a.fontSize;if(!El.available[u])throw new Error('Missing BitmapFont "'+u+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=o,n._tint=s,n._fontName=u,n._fontSize=c||El.available[u].size,n._text=r,n._maxWidth=l,n._maxLineHeight=0,n._letterSpacing=h,n._anchor=new vi((function(){n.dirty=!0}),n,0,0),n._roundPixels=we.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}(function(e,t){function r(){this.constructor=e}pl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.prototype.updateText=function(){for(var e,t=El.available[this._fontName],r=this._fontSize/t.size,i=new yi,n=[],a=[],o=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",s=o.length,l=this._maxWidth*t.size/this._fontSize,h=null,u=0,c=0,d=0,f=-1,p=0,m=0,g=0,y=0;y<s;y++){var v=o.charCodeAt(y),b=o.charAt(y);if(/(?:\s)/.test(b)&&(f=y,p=u),"\r"!==b&&"\n"!==b){var x=t.chars[v];if(x){h&&x.kerning[h]&&(i.x+=x.kerning[h]);var _=wl.pop()||{texture:_n.EMPTY,line:0,charCode:0,position:new yi};_.texture=x.texture,_.line=d,_.charCode=v,_.position.x=i.x+x.xOffset+this._letterSpacing/2,_.position.y=i.y+x.yOffset,n.push(_),i.x+=x.xAdvance+this._letterSpacing,u=i.x,g=Math.max(g,x.yOffset+x.texture.height),h=v,-1!==f&&l>0&&i.x>l&&(Vr(n,1+f-++m,1+y-f),y=f,f=-1,a.push(p),c=Math.max(c,p),d++,i.x=0,i.y+=t.lineHeight,h=null)}}else a.push(u),c=Math.max(c,u),++d,++m,i.x=0,i.y+=t.lineHeight,h=null}var T=o.charAt(o.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(u=p),a.push(u),c=Math.max(c,u));var E=[];for(y=0;y<=d;y++){var A=0;"right"===this._align?A=c-a[y]:"center"===this._align&&(A=(c-a[y])/2),E.push(A)}var w=n.length,k={},S=[],M=this._activePagesMeshData;for(y=0;y<M.length;y++)Al.push(M[y]);for(y=0;y<w;y++){var C=(B=n[y].texture).baseTexture.uid;if(!k[C]){if(!(K=Al.pop())){var P=new fl,O=new dl(_n.EMPTY);K={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new cl(P,O),vertices:null,uvs:null,indices:null}}K.index=0,K.indexCount=0,K.vertexCount=0,K.uvsCount=0,K.total=0;var D=this._textureCache;D[C]=D[C]||new _n(B.baseTexture),K.mesh.texture=D[C],K.mesh.tint=this._tint,S.push(K),k[C]=K}k[C].total++}for(y=0;y<M.length;y++)-1===S.indexOf(M[y])&&this.removeChild(M[y].mesh);for(y=0;y<S.length;y++)S[y].mesh.parent!==this&&this.addChild(S[y].mesh);for(var y in this._activePagesMeshData=S,k){var I=(K=k[y]).total;if(!((null===(e=K.indices)||void 0===e?void 0:e.length)>6*I)||K.vertices.length<2*cl.BATCHABLE_SIZE)K.vertices=new Float32Array(8*I),K.uvs=new Float32Array(8*I),K.indices=new Uint16Array(6*I);else for(var R=K.total,N=K.vertices,L=4*R*2;L<N.length;L++)N[L]=0;K.mesh.size=6*I}for(y=0;y<w;y++){var F=(b=n[y]).position.x+E[b.line];this._roundPixels&&(F=Math.round(F));var B,U=F*r,z=b.position.y*r,H=k[(B=b.texture).baseTexture.uid],j=B.frame,V=B._uvs,G=H.index++;H.indices[6*G+0]=0+4*G,H.indices[6*G+1]=1+4*G,H.indices[6*G+2]=2+4*G,H.indices[6*G+3]=0+4*G,H.indices[6*G+4]=2+4*G,H.indices[6*G+5]=3+4*G,H.vertices[8*G+0]=U,H.vertices[8*G+1]=z,H.vertices[8*G+2]=U+j.width*r,H.vertices[8*G+3]=z,H.vertices[8*G+4]=U+j.width*r,H.vertices[8*G+5]=z+j.height*r,H.vertices[8*G+6]=U,H.vertices[8*G+7]=z+j.height*r,H.uvs[8*G+0]=V.x0,H.uvs[8*G+1]=V.y0,H.uvs[8*G+2]=V.x1,H.uvs[8*G+3]=V.y1,H.uvs[8*G+4]=V.x2,H.uvs[8*G+5]=V.y2,H.uvs[8*G+6]=V.x3,H.uvs[8*G+7]=V.y3}for(var y in this._textWidth=c*r,this._textHeight=(i.y+t.lineHeight)*r,k){var K=k[y];if(0!==this.anchor.x||0!==this.anchor.y)for(var W=0,Y=this._textWidth*this.anchor.x,X=this._textHeight*this.anchor.y,q=0;q<K.total;q++)K.vertices[W++]-=Y,K.vertices[W++]-=X,K.vertices[W++]-=Y,K.vertices[W++]-=X,K.vertices[W++]-=Y,K.vertices[W++]-=X,K.vertices[W++]-=Y,K.vertices[W++]-=X;this._maxLineHeight=g*r;var Z=K.mesh.geometry.getBuffer("aVertexPosition"),J=K.mesh.geometry.getBuffer("aTextureCoord"),Q=K.mesh.geometry.getIndex();Z.data=K.vertices,J.data=K.uvs,Q.data=K.indices,Z.update(),J.update(),Q.update()}for(y=0;y<n.length;y++)wl.push(n[y])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!El.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),t.prototype._upgradeStyle=function(e){if("string"==typeof e.font){var t=e.font.split(" ");e.fontName=1===t.length?t[0]:t.slice(1).join(" "),t.length>=2&&(e.fontSize=parseInt(t[0],10))}else e.fontName=e.font.name,e.fontSize="number"==typeof e.font.size?e.font.size:parseInt(e.font.size,10)},t.prototype.destroy=function(t){var r=this._textureCache;for(var i in r){r[i].destroy(),delete r[i]}this._textureCache=null,e.prototype.destroy.call(this,t)},t.registerFont=function(e,t){return Xr("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),El.install(e,t)},Object.defineProperty(t,"fonts",{get:function(){return Xr("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),El.available},enumerable:!1,configurable:!0}),t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(Ni),function(){function e(){}return e.add=function(){Io.setExtensionXhrType("fnt",Io.XHR_RESPONSE_TYPE.TEXT)},e.use=function(t,r){var i=xl(t.data);if(i)for(var n=e.getBaseUrl(this,t),a=i.parse(t.data),o={},s=function(e){o[e.metadata.pageFile]=e.texture,Object.keys(o).length===a.page.length&&(t.bitmapFont=El.install(a,o,!0),r())},l=0;l<a.page.length;++l){var h=a.page[l].file,u=n+h,c=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===u){f.metadata.pageFile=h,f.texture?s(f):f.onAfterMiddleware.add(s),c=!0;break}}if(!c){var p={crossOrigin:t.crossOrigin,loadType:Io.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(u,p,s)}}else r()},e.getBaseUrl=function(t,r){var i=r.isDataUrl?"":e.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),t.baseUrl&&i&&"/"===t.baseUrl.charAt(t.baseUrl.length-1)&&(i+="/")),(i=i.replace(t.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},e.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":""===t?"/":t},e}()),Sl=function(e,t){return(Sl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};!function(e){function t(t){void 0===t&&(t=1);var r=e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return r.alpha=t,r}(function(e,t){function r(){this.constructor=e}Sl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0})}(Ta);var Ml=function(e,t){return(Ml=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function Cl(e,t){function r(){this.constructor=e}Ml(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Pl,Ol,Dl,Il,Rl,Nl,Ll,Fl,Bl,Ul,zl,Hl,jl,Vl,Gl,Kl,Wl,Yl={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Xl=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(e){e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2"}(Pl||(Pl={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS"}(Ol||(Ol={})),function(e){e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL"}(Dl||(Dl={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR"}(Il||(Il={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Rl||(Rl={})),function(e){e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Nl||(Nl={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Ll||(Ll={})),function(e){e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=36193]="HALF_FLOAT"}(Fl||(Fl={})),function(e){e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR"}(Bl||(Bl={})),function(e){e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Ul||(Ul={})),function(e){e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON"}(zl||(zl={})),function(e){e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Hl||(Hl={})),function(e){e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT"}(jl||(jl={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(Vl||(Vl={})),function(e){e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp"}(Gl||(Gl={})),function(e){e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE"}(Kl||(Kl={})),function(e){e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH"}(Wl||(Wl={}));var ql=function(e){function t(t,r,i,n,a){void 0===r&&(r=8),void 0===i&&(i=4),void 0===n&&(n=we.FILTER_RESOLUTION),void 0===a&&(a=5);var o=this,s=function(e,t){var r,i=Math.ceil(e/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",a="";r=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<e;o++){var s=r.replace("%index%",o.toString());a+=s=s.replace("%sampleIndex%",o-(i-1)+".0"),a+="\n"}return(n=n.replace("%blur%",a)).replace("%size%",e.toString())}(a,t),l=function(e){for(var t,r=Yl[e],i=r.length,n=Xl,a="",o=0;o<e;o++){var s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());t=o,o>=i&&(t=e-o-1),a+=s=s.replace("%value%",r[t].toString()),a+="\n"}return(n=n.replace("%blur%",a)).replace("%size%",e.toString())}(a);return(o=e.call(this,s,l)||this).horizontal=t,o.resolution=n,o._quality=0,o.quality=i,o.blur=r,o}return Cl(t,e),t.prototype.apply=function(e,t,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,i);else{var n=e.getFilterTexture(),a=e.renderer,o=t,s=n;this.state.blend=!1,e.applyFilter(this,o,s,jl.CLEAR);for(var l=1;l<this.passes-1;l++){e.bindAndClear(o,jl.BLIT),this.uniforms.uSampler=s;var h=s;s=o,o=h,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,s,r,i),e.returnFilterTexture(n)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(Ta),Zl=(function(e){function t(t,r,i,n){void 0===t&&(t=8),void 0===r&&(r=4),void 0===i&&(i=we.FILTER_RESOLUTION),void 0===n&&(n=5);var a=e.call(this)||this;return a.blurXFilter=new ql(!0,t,r,i,n),a.blurYFilter=new ql(!1,t,r,i,n),a.resolution=i,a.quality=r,a.blur=t,a.repeatEdgePixels=!1,a}Cl(t,e),t.prototype.apply=function(e,t,r,i){var n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(n&&a){var o=e.getFilterTexture();this.blurXFilter.apply(e,t,o,jl.CLEAR),this.blurYFilter.apply(e,o,r,i),e.returnFilterTexture(o)}else a?this.blurYFilter.apply(e,t,r,i):this.blurXFilter.apply(e,t,r,i)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0})}(Ta),function(e,t){return(Zl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)});var Jl=function(e){function t(){var t=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(t=e.call(this,Wa,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",r)||this).alpha=1,t}return function(e,t){function r(){this.constructor=e}Zl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype._loadMatrix=function(e,t){void 0===t&&(t=!1);var r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e},t.prototype._colorMatrix=function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t},t.prototype.brightness=function(e,t){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.greyscale=function(e,t){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),i=Math.sin(e),n=1/3,a=(0,Math.sqrt)(n),o=[r+(1-r)*n,n*(1-r)-a*i,n*(1-r)+a*i,0,0,n*(1-r)+a*i,r+n*(1-r),n*(1-r)-a*i,0,0,n*(1-r)-a*i,n*(1-r)+a*i,r+n*(1-r),0,0,0,0,0,1,0];this._loadMatrix(o,t)},t.prototype.contrast=function(e,t){var r=(e||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.saturate=function(e,t){void 0===e&&(e=0);var r=2*e/3+1,i=-.5*(r-1),n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,t,r,i,n){var a=((r=r||16770432)>>16&255)/255,o=(r>>8&255)/255,s=(255&r)/255,l=((i=i||3375104)>>16&255)/255,h=(i>>8&255)/255,u=(255&i)/255,c=[.3,.59,.11,0,0,a,o,s,e=e||.2,0,l,h,u,t=t||.15,0,a-l,o-h,s-u,0,0];this._loadMatrix(c,n)},t.prototype.night=function(e,t){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.predator=function(e,t){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Ta);Jl.prototype.grayscale=Jl.prototype.greyscale;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/
var Ql=function(e,t){return(Ql=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};!function(e){function t(t,r){var i=this,n=new bi;return t.renderable=!1,(i=e.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=t,i.maskMatrix=n,null==r&&(r=20),i.scale=new yi(r,r),i}(function(e,t){function r(){this.constructor=e}Ql(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.prototype.apply=function(e,t,r,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,a=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==a&&0!==o&&(this.uniforms.rotation[0]=n.a/a,this.uniforms.rotation[1]=n.b/a,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),e.applyFilter(this,t,r,i)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0})}(Ta);var $l=function(e,t){return($l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};!function(e){function t(){return e.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}(function(e,t){function r(){this.constructor=e}$l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e)}(Ta);var eh=function(e,t){return(eh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};!function(e){function t(t,r){void 0===t&&(t=.5),void 0===r&&(r=Math.random());var i=e.call(this,Wa,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=t,i.seed=r,i}(function(e,t){function r(){this.constructor=e}eh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0})}(Ta);var th=new bi;Di.prototype._cacheAsBitmap=!1,Di.prototype._cacheData=null;var rh=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Di.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){var t;this._cacheAsBitmap!==e&&(this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new rh),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),Di.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},Di.prototype._initCachedDisplayObject=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters){var i=this.filters[0].padding;r.pad(i)}r.ceil(we.RESOLUTION);var n=e.renderTexture.current,a=e.renderTexture.sourceFrame.clone(),o=e.renderTexture.destinationFrame.clone(),s=e.projection.transform,l=En.create({width:r.width,height:r.height}),h="cacheAsBitmap_"+Wr();this._cacheData.textureCacheId=h,an.addToCache(l.baseTexture,h),_n.addToCache(l,h);var u=this.transform.localTransform.copyTo(th).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,l,!0,u,!1),e.projection.transform=s,e.renderTexture.bind(n,a,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var c=new Ss(l);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-r.x/r.width,c.anchor.y=-r.y/r.height,c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)}},Di.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},Di.prototype._initCachedDisplayObjectCanvas=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var i=e.context,n=e._projTransform;t.ceil(we.RESOLUTION);var a=En.create({width:t.width,height:t.height}),o="cacheAsBitmap_"+Wr();this._cacheData.textureCacheId=o,an.addToCache(a.baseTexture,o),_n.addToCache(a,o);var s=th;this.transform.localTransform.copyTo(s),s.invert(),s.tx-=t.x,s.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,a,!0,s,!1),e.context=i,e._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new Ss(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},Di.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Di.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Di.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,an.removeFromCache(this._cacheData.textureCacheId),_n.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Di.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},Di.prototype.name=null,Ni.prototype.getChildByName=function(e,t){for(var r=0,i=this.children.length;r<i;r++)if(this.children[r].name===e)return this.children[r];if(t)for(r=0,i=this.children.length;r<i;r++){if(this.children[r].getChildByName){var n=this.children[r].getChildByName(e,!0);if(n)return n}}return null},Di.prototype.getGlobalPosition=function(e,t){return void 0===e&&(e=new yi),void 0===t&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/
var ih=function(e,t){return(ih=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function nh(e,t){function r(){this.constructor=e}ih(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var ah=function(e){function t(t,r,i,n){void 0===t&&(t=100),void 0===r&&(r=100),void 0===i&&(i=10),void 0===n&&(n=10);var a=e.call(this)||this;return a.segWidth=i,a.segHeight=n,a.width=t,a.height=r,a.build(),a}return nh(t,e),t.prototype.build=function(){for(var e=this.segWidth*this.segHeight,t=[],r=[],i=[],n=this.segWidth-1,a=this.segHeight-1,o=this.width/n,s=this.height/a,l=0;l<e;l++){var h=l%this.segWidth,u=l/this.segWidth|0;t.push(h*o,u*s),r.push(h/n,u/a)}var c=n*a;for(l=0;l<c;l++){var d=l%n,f=l/n|0,p=f*this.segWidth+d,m=f*this.segWidth+d+1,g=(f+1)*this.segWidth+d,y=(f+1)*this.segWidth+d+1;i.push(p,m,g,m,y,g)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},t}(fl),oh=function(e){function t(t,r,i){void 0===t&&(t=200),void 0===i&&(i=0);var n=e.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return n.points=r,n._width=t,n.textureScale=i,n.build(),n}return nh(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),t.prototype.build=function(){var e=this.points;if(e){var t=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(e.length<1)){t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),i.data=new Uint16Array(6*(e.length-1)));var n=r.data,a=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,s=e[0],l=this._width*this.textureScale,h=e.length,u=0;u<h;u++){var c=4*u;if(this.textureScale>0){var d=s.x-e[u].x,f=s.y-e[u].y,p=Math.sqrt(d*d+f*f);s=e[u],o+=p/l}else o=u/(h-1);n[c]=o,n[c+1]=0,n[c+2]=o,n[c+3]=1}var m=0;for(u=0;u<h-1;u++){c=2*u;a[m++]=c,a[m++]=c+1,a[m++]=c+2,a[m++]=c+2,a[m++]=c+1,a[m++]=c+3}r.update(),i.update(),this.updateVertices()}}},t.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var t,r=e[0],i=0,n=0,a=this.buffers[0].data,o=e.length,s=0;s<o;s++){var l=e[s],h=4*s;n=-((t=s<e.length-1?e[s+1]:l).x-r.x),i=t.y-r.y;var u=Math.sqrt(i*i+n*n),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=u,n/=u,i*=c,n*=c,a[h]=l.x+i,a[h+1]=l.y+n,a[h+2]=l.x-i,a[h+3]=l.y-n,r=l}this.buffers[0].update()}},t.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},t}(fl),sh=(function(e){function t(t,r,i){void 0===i&&(i=0);var n=this,a=new oh(t.height,r,i),o=new dl(t);return i>0&&(t.baseTexture.wrapMode=ar.REPEAT),(n=e.call(this,a,o)||this).autoUpdate=!0,n}nh(t,e),t.prototype._render=function(t){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),e.prototype._render.call(this,t)}}(cl),function(e){function t(t,r,i){var n=this,a=new ah(t.width,t.height,r,i),o=new dl(_n.WHITE);return(n=e.call(this,a,o)||this).texture=t,n}return nh(t,e),t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var e=this.geometry;e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build()},Object.defineProperty(t.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),t.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),e.prototype._render.call(this,t)},t.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),e.prototype.destroy.call(this,t)},t}(cl)),lh=(function(e){function t(t,r,i,n,a){void 0===t&&(t=_n.EMPTY);var o=this,s=new fl(r,i,n);s.getBuffer("aVertexPosition").static=!1;var l=new dl(t);return(o=e.call(this,s,l,null,a)||this).autoUpdate=!0,o}nh(t,e),Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),e.prototype._render.call(this,t)}}(cl),function(e){function t(t,r,i,n,a){void 0===r&&(r=10),void 0===i&&(i=10),void 0===n&&(n=10),void 0===a&&(a=10);var o=e.call(this,_n.WHITE,4,4)||this;return o._origWidth=t.orig.width,o._origHeight=t.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=r,o._rightWidth=n,o._topHeight=i,o._bottomHeight=a,o.texture=t,o}nh(t,e),t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype.updateHorizontalVertices=function(){var e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height},t.prototype.updateVerticalVertices=function(){var e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width},t.prototype._getMinScale=function(){var e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,r=this._topHeight+this._bottomHeight,i=this._height>r?1:this._height/r;return Math.min(t,i)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topHeight",{get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()},enumerable:!1,configurable:!0}),t.prototype._refresh=function(){var e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var r=1/this._origWidth,i=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=r*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-r*this._rightWidth,t[9]=t[11]=t[13]=t[15]=i*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}(sh),function(e,t){return(lh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)});!function(e){function t(t,r){void 0===r&&(r=!0);var i=e.call(this,t[0]instanceof _n?t[0]:t[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=r,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=t,i}(function(e,t){function r(){this.constructor=e}lh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(zi.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(zi.shared.add(this.update,this,Li.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=t/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var r=[],i=0;i<e.length;++i)r.push(_n.from(e[i]));return new t(r)},t.fromImages=function(e){for(var r=[],i=0;i<e.length;++i)r.push(_n.from(e[i]));return new t(r)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof _n)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(zi.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(zi.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0})}(Ss);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/Ga.registerPlugin("accessibility",Bi),Ga.registerPlugin("extract",ao),Ga.registerPlugin("interaction",qi),Ga.registerPlugin("particle",Ko),Ga.registerPlugin("prepare",Js),Ga.registerPlugin("batch",to),Ga.registerPlugin("tilingSprite",al),Lo.registerPlugin(kl),Lo.registerPlugin($s),ro.registerPlugin(Hi),ro.registerPlugin(Fo);class hh{static ASCII_SPACE=32;static ASCII_FULL=219;static CANVAS_ID="__yendor_canvas";static CANVAS_SELECTOR="#"+hh.CANVAS_ID;constructor(e,t,r,i,n){this.fontUrl=i,this.rendererName=n,this.divSelector=r,this.loadComplete=!1,this.defaultBackgroundColor=M.toNumber(t),this.defaultForegroundColor=M.toNumber(e),this.stage=new Ni}init(e){this.loadFont(this.fontUrl,this.rendererName,e)}render(e){if(this.loadComplete){for(let t=0;t<e.width;t++)for(let r=0;r<e.height;r++){let i=e.text[t][r];i>=0&&i<=255&&(this.foreCells[t][r].texture=this.chars[i]),this.foreCells[t][r].tint=M.toNumber(e.fore[t][r]),this.backCells[t][r].tint=M.toNumber(e.back[t][r])}this.renderer.render(this.stage)}}getPositionFromPixels(e,t,r){let i=r||new C;if(this.loadComplete){let r=e-this.topLeftPos.x,n=t-this.topLeftPos.y;i.x=Math.floor(r/this.charWidth),i.y=Math.floor(n/this.charHeight)}else i.x=-1,i.y=-1;return i}getPixelPositionFromCell(e,t,r){let i=r||new C;return this.loadComplete?(i.x=e*this.charWidth+this.topLeftPos.x,i.y=t*this.charHeight+this.topLeftPos.y):(i.x=-1,i.y=-1),i}loadFont(e,t,r){this.font=new an(e,{scaleMode:ir.NEAREST}),this.font.valid?this.onFontLoaded(t,r):(this.font.on("loaded",(()=>this.onFontLoaded(t,r))),this.font.on("error",(()=>this.onFontError(e))))}onFontError(e){console.log("FATAL: error while loading font "+e)}onFontLoaded(e,t){this.charWidth=this.font.width/16,this.charHeight=this.font.height/16,this.initCanvas(e,t),this.initCharacterMap(),this.initBackgroundCells(t),this.initForegroundCells(t),this.loadComplete=!0}initCanvas(e,t){let r=a(this.divSelector)[0],i=t.width*this.charWidth,n=t.height*this.charHeight;r.innerHTML="<canvas id='"+hh.CANVAS_ID+"' width='"+i+"' height='"+n+"'></canvas>",this.canvas=a(hh.CANVAS_SELECTOR)[0],this.topLeftPos=new C(a(hh.CANVAS_SELECTOR).offset().left,a(hh.CANVAS_SELECTOR).offset().top);let o={width:i,height:n,antialias:!1,clearBeforeRender:!1,preserveDrawingBuffer:!1,resolution:1,transparent:!1,view:this.canvas};this.renderer=Ka(o),this.renderer.backgroundColor=this.defaultBackgroundColor}initCharacterMap(){this.chars=[];for(let e=0;e<16;e++)for(let t=0;t<16;t++){let r=new di(e*this.charWidth,t*this.charHeight,this.charWidth,this.charHeight);this.chars[e+16*t]=new _n(this.font,r)}}initBackgroundCells(e){this.backCells=[];for(let t=0;t<e.width;t++){this.backCells[t]=[];for(let r=0;r<e.height;r++){let e=new Ss(this.chars[hh.ASCII_FULL]);e.position.x=t*this.charWidth,e.position.y=r*this.charHeight,e.width=this.charWidth,e.height=this.charHeight,e.tint=this.defaultBackgroundColor,this.backCells[t][r]=e,this.stage.addChild(e)}}}initForegroundCells(e){this.foreCells=[];for(let t=0;t<e.width;t++){this.foreCells[t]=[];for(let r=0;r<e.height;r++){let e=new Ss(this.chars[hh.ASCII_SPACE]);e.position.x=t*this.charWidth,e.position.y=r*this.charHeight,e.width=this.charWidth,e.height=this.charHeight,e.tint=this.defaultForegroundColor,this.foreCells[t][r]=e,this.stage.addChild(e)}}}}class uh{constructor(e){this.divSelector=e,this.div=a(e)[0],this.div.style.fontFamily="monospace",this.div.style.whiteSpace="pre",this.div.style.display="table"}init(e){this.computeCharSize(e)}render(e){this.div.innerHTML=this.getHTML(e)}getPositionFromPixels(e,t,r){let i=r||new C,n=a(this.divSelector).offset(),o=e-n.left,s=t-n.top;return i.x=Math.floor(o/this.charWidth),i.y=Math.floor(s/this.charHeight),i}getPixelPositionFromCell(e,t,r){let i=r||new C,n=a(this.divSelector).offset();return i.x=e*this.charWidth+n.left,i.y=t*this.charHeight+n.top,i}getHTML(e){let t="";for(let r=0;r<e.height;r++)t+="<div class='line'>"+this.getLineHTML(r,e)+"</div>";return t}computeCharSize(e){e.text[0][0]="@".charCodeAt(0),e.fore[0][0]=0,e.render();let t=this.div.id;this.div.id="__yendor_div";let r=a("#__yendor_div div.line span");this.charWidth=r.width(),this.charHeight=r.height(),console.log("Char size : "+this.charWidth+" x "+this.charHeight),this.div.id=t,e.text[0][0]=0,e.fore[0][0]=e.fore[0][1],e.render()}getChar(e,t,r){let i=r.text[e][t];return 0===i?" ":String.fromCharCode(i)}getLineHTML(e,t){let r=M.toWeb(t.fore[0][e]),i=M.toWeb(t.back[0][e]),n="<span style='color:"+r+";background-color:"+i+"'>"+this.getChar(0,e,t);for(let a=1;a<t.width;a++){let o=M.toWeb(t.fore[a][e]),s=M.toWeb(t.back[a][e]);o===r&&s===i||(r=o,i=s,n+="</span><span style='color:"+r+";background-color:"+i+"'>"),n+=this.getChar(a,e,t)}return n+="</span>",n}}let ch;var dh;(dh=ch||(ch={}))[dh.CONTINUE=0]="CONTINUE",dh[dh.STOP=1]="STOP";class fh extends P{splitPos=0;horiz=!0;level=0;constructor(e,t,r,i,n,a){super(e,t,r,i),this.level=n||0,this.parent=a}isLeaf(){return!this.leftChild}findNode(e,t){if(this.contains(e,t))return this.leftChild&&this.leftChild.contains(e,t)?this.leftChild.findNode(e,t):this.rightChild&&this.rightChild.contains(e,t)?this.rightChild.findNode(e,t):this}clear(){this.leftChild=void 0,this.rightChild=void 0,this.splitPos=0,this.horiz=!0}split(e,t){this.horiz=e,this.splitPos=t,e?(this.leftChild=new fh(this.x,this.y,this.splitPos,this.h,this.level+1,this),this.rightChild=new fh(this.x+this.splitPos,this.y,this.w-this.splitPos,this.h,this.level+1,this)):(this.leftChild=new fh(this.x,this.y,this.w,this.splitPos,this.level+1,this),this.rightChild=new fh(this.x,this.y+this.splitPos,this.w,this.h-this.splitPos,this.level+1,this))}splitRecursive(e,t,r,i){e||(e=U.default);let n=!1;if(r){if(this.w<2*r||this.h<2*r)return;this.w<2*r?n=!1:this.h<2*r&&(n=!0)}else r=0;n||(n=0!==e.getNumber(0,1));let a=n?e.getNumber(r,this.w-r):e.getNumber(r,this.h-r);this.split(n,a),t>1&&this.leftChild&&this.rightChild&&(this.leftChild.splitRecursive(e,t-1,r,i),this.rightChild.splitRecursive(e,t-1,r,i))}traversePreOrder(e,t){if(e(this,t)===ch.STOP)return ch.STOP;if(this.leftChild){if(this.leftChild.traversePreOrder(e,t)===ch.STOP)return ch.STOP;if(this.rightChild&&this.rightChild.traversePreOrder(e,t)===ch.STOP)return ch.STOP}return ch.CONTINUE}traverseInOrder(e,t){return this.leftChild&&this.leftChild.traverseInOrder(e,t)===ch.STOP||e(this,t)===ch.STOP?ch.STOP:this.rightChild?this.rightChild.traverseInOrder(e,t):ch.CONTINUE}traversePostOrder(e,t){if(this.leftChild){if(this.leftChild.traversePostOrder(e,t)===ch.STOP)return ch.STOP;if(this.rightChild&&this.rightChild.traversePostOrder(e,t)===ch.STOP)return ch.STOP}return e(this,t)}traverseLevelOrder(e,t){for(let r of this.buildLevelTraversalNodeArray())if(e(r,t)===ch.STOP)return ch.STOP;return ch.CONTINUE}traverseInvertedLevelOrder(e,t){let r=this.buildLevelTraversalNodeArray();for(let i=r.length-1;i>=0;i--){if(e(r[i],t)===ch.STOP)return ch.STOP}return ch.CONTINUE}buildLevelTraversalNodeArray(){let e=[],t=[];for(t.push(this);t.length>0;){let r=t.shift();r&&(e.push(r),r.leftChild&&(t.push(r.leftChild),r.rightChild&&t.push(r.rightChild)))}return e}}class ph{constructor(e,t){this._width=e,this._height=t,this._transparent=[];for(let t=0;t<e;t++)this._transparent[t]=[];this.startAngle=[],this.endAngle=[]}get width(){return this._width}get height(){return this._height}isTransparent(e,t){return!!this._transparent[e]&&this._transparent[e][t]}setTransparent(e,t,r){this._transparent[e]&&(this._transparent[e][t]=r)}computeFov(e,t,r,i,n=!0){this.clearFov(e),e[t][r]=!0,this.computeQuadrantVertical(e,t,r,i,n,1,1),this.computeQuadrantHorizontal(e,t,r,i,n,1,1),this.computeQuadrantVertical(e,t,r,i,n,1,-1),this.computeQuadrantHorizontal(e,t,r,i,n,1,-1),this.computeQuadrantVertical(e,t,r,i,n,-1,1),this.computeQuadrantHorizontal(e,t,r,i,n,-1,1),this.computeQuadrantVertical(e,t,r,i,n,-1,-1),this.computeQuadrantHorizontal(e,t,r,i,n,-1,-1)}clearFov(e){for(let t=0;t<this.width;t++)for(let r=0;r<this.height;r++)e[t][r]=!1}computeQuadrantVertical(e,t,r,i,n,a,o){let s=r+o,l=!1,h=1,u=0,c=0,d=0;for(;!l&&s>=0&&s<this.height;){let r=1/h,f=.5*r,p=Math.floor((u+f)/r),m=Math.max(0,t-h),g=Math.min(this.width-1,t+h);l=!0;for(let i=t+p*a;i>=m&&i<=g;i+=a){let t=p*r,m=t-f,g=t+f,y=!0,v=!1;if(c>0&&!e[i][s]){let r=0;if(y&&!this.canSee(e,i,s-o)&&i-a>=0&&i-a<this.width&&!this.canSee(e,i-a,s-o))y=!1;else for(;y&&r<c;)this.startAngle[r]>g||this.endAngle[r]<m||(this.isTransparent(i,s)?t>this.startAngle[r]&&t<this.endAngle[r]&&(y=!1):m>=this.startAngle[r]&&g<=this.endAngle[r]?y=!1:(this.startAngle[r]=Math.min(this.startAngle[r],m),this.endAngle[r]=Math.max(this.endAngle[r],g),v=!0)),++r}y&&(e[i][s]=!0,l=!1,this.isTransparent(i,s)||(u>=m?(u=g,p===h&&(l=!0)):v||(this.startAngle[d]=m,this.endAngle[d]=g,d++),n||(e[i][s]=!1))),p++}h===i&&(l=!0),h++,c=d,s+=o,(s<0||s>=this.height)&&(l=!0)}}computeQuadrantHorizontal(e,t,r,i,n,a,o){let s=t+a,l=!1,h=1,u=0,c=0,d=0;for(;!l&&s>=0&&s<this.width;){let t=1/h,f=.5*t,p=Math.floor((u+f)/t),m=Math.max(0,r-h),g=Math.min(this.height-1,r+h);l=!0;for(let i=r+p*o;i>=m&&i<=g;i+=o){let r=p*t,m=r-f,g=r+f,y=!0,v=!1;if(c>0&&!e[s][i]){let t=0;if(y&&!this.canSee(e,s-a,i)&&i-o>=0&&i-o<this.height&&!this.canSee(e,s-a,i-o))y=!1;else for(;y&&t<c;)this.startAngle[t]>g||this.endAngle[t]<m||(this.isTransparent(s,i)?r>this.startAngle[t]&&r<this.endAngle[t]&&(y=!1):m>=this.startAngle[t]&&g<=this.endAngle[t]?y=!1:(this.startAngle[t]=Math.min(this.startAngle[t],m),this.endAngle[t]=Math.max(this.endAngle[t],g),v=!0)),++t}y&&(e[s][i]=!0,l=!1,this.isTransparent(s,i)||(u>=m?(u=g,p===h&&(l=!0)):v||(this.startAngle[d]=m,this.endAngle[d]=g,d++),n||(e[s][i]=!1))),p++}h===i&&(l=!0),h++,c=d,s+=a,(s<0||s>=this.width)&&(l=!0)}}canSee(e,t,r){return e[t][r]&&this.isTransparent(t,r)}}class mh{content=[];constructor(e){this.scoreFunction=e}push(e){this.content.push(e),this.bubbleUp(this.content.length-1)}pushAll(e){for(let t of e)this.push(t)}peek(e=0){return this.content.length>e?this.content[e]:void 0}clear(){this.content=[]}pop(){let e;if(this.content.length>0){e=this.content[0];let t=this.content.pop();this.content.length>0&&(this.content[0]=t,this.sinkDown(0))}return e}contains(e){for(let t of this.content)if(e.equals(t))return!0;return!1}remove(e){let t=this.content.indexOf(e);if(-1===t)return!1;let r=this.content.pop();return t!==this.content.length&&(this.content[t]=r,this.scoreFunction(r)<this.scoreFunction(e)?this.bubbleUp(t):this.sinkDown(t)),!0}size(){return this.content.length}isEmpty(){return 0===this.content.length}bubbleUp(e){let t=this.content[e];for(;e>0;){let r=Math.floor((e+1)/2)-1,i=this.content[r];if(!(this.scoreFunction(t)<=this.scoreFunction(i)))break;this.content[r]=t,this.content[e]=i,e=r}}sinkDown(e){let t=this.content.length,r=this.content[e],i=this.scoreFunction(r);for(;;){let n,a=2*(e+1),o=a-1,s=0;if(o<t){let e=this.content[o];s=this.scoreFunction(e),s<i&&(n=o)}if(a<t){let e=this.content[a];this.scoreFunction(e)<(void 0===n?i:s)&&(n=a)}if(void 0===n)break;this.content[e]=this.content[n],this.content[n]=r,e=n}}}class gh{constructor(e,t,r,i,n=!0){this.walkCostFunction=r||function(e,t){return 1},this.heuristicFunction=i||(n?C.distance:C.taxiDistance),this.mapWidth=e,this.mapHeight=t,this.allowDiagonals=n}getPath(e,t,r=0){let i=[],n={},a={},o={},s=this,l=new mh((function(e){return o[s.pos2Offset(e)]})),h=this.pos2Offset(e);a[h]=0,o[h]=a[h]+this.heuristicFunction(e,t),this.maxSteps=10*o[h],l.push(new C(e.x,e.y));let u=this.maxSteps;for(;l.size()>0&&u>0;){u--;let e=l.pop();if(e.x===t.x&&e.y===t.y)return this.reconstructPath(n,e);i.push(e);let r=this.pos2Offset(e),s=e.getAdjacentCells(this.mapWidth,this.mapHeight,this.allowDiagonals);for(let h of s)if(!this.arrayContains(i,h)){let i=this.pos2Offset(h),s=this.walkCostFunction(e,h);if(s>0){let u=a[r]+s,c=l.contains(h);(!c||u<a[i])&&(n[i]=e,a[i]=u,o[i]=u+this.heuristicFunction(h,t),c||l.push(h))}}}0===u&&console.log("Could not find path from "+e.x+","+e.y+" to "+t.x+","+t.y+": max steps reached")}pos2Offset(e){return e.x+e.y*this.mapWidth}arrayContains(e,t){for(let r of e)if(r.equals(t))return!0;return!1}reconstructPath(e,t){let r=[t],i=this.pos2Offset(t);for(;e[i];)t=e[i],i=this.pos2Offset(t),e[i]&&r.push(t);return r}}class yh extends class{fbm1D(e,t,r,i=2,n=.5){let a=this.get1D(e,t),o=1,s=1;for(let l=1;l<r;l++)t*=i,o*=n,s+=o,a+=this.get1D(e,t)*o;return a/s}fbm2D(e,t,r,i,n=2,a=.5){let o=this.get2D(e,t,r),s=1,l=1;for(let h=1;h<i;h++)r*=n,s*=a,l+=s,o+=this.get2D(e,t,r)*s;return o/l}fbm3D(e,t,r,i,n,a=2,o=.5){let s=this.get3D(e,t,r,i),l=1,h=1;for(let u=1;u<n;u++)i*=a,l*=o,h+=l,s+=this.get3D(e,t,r,i)*l;return s/h}}{static HASH_MASK=255;static GRADIENTS_1D=[1,-1];static GRADIENTS_1D_MASK=1;static INVERSE_MAX_FALLOF_1D=64/27;static GRADIENTS_2D=[[1,0],[-1,0],[0,1],[0,-1]];static GRADIENTS_2D_MASK=3;static SQUARE_TO_TRIANGLE=(3-Math.sqrt(3))/6;static TRIANGLE_TO_SQUARE=(Math.sqrt(3)-1)/2;static INVERSE_MAX_FALLOF_2D=2916*Math.sqrt(2)/125;static GRADIENTS_3D=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,1],[-1,1,1],[1,-1,1],[-1,-1,1],[1,1,-1],[-1,1,-1],[1,-1,-1],[-1,-1,-1]];static GRADIENTS_3D_MASK=31;static normalizedGradient3d=!1;static INVERSE_MAX_FALLOF_3D=8192*Math.sqrt(3)/375;static normalizeGradient3d(){yh.normalizedGradient3d=!0;for(let e=0;e<=yh.GRADIENTS_3D_MASK;++e){let t=yh.GRADIENTS_3D[e][0],r=yh.GRADIENTS_3D[e][1],i=yh.GRADIENTS_3D[e][2],n=1/Math.sqrt(t*t+r*r+i*i);yh.GRADIENTS_3D[e][0]*=n,yh.GRADIENTS_3D[e][1]*=n,yh.GRADIENTS_3D[e][2]*=n}}constructor(e){super(),yh.normalizedGradient3d||yh.normalizeGradient3d(),this.hash=this.computeHash(e)}get1D(e,t){e*=t;let r=Math.floor(e),i=this.grad1d(e,r);return i+=this.grad1d(e,r+1),i*yh.INVERSE_MAX_FALLOF_1D}get2D(e,t,r){let i=((e*=r)+(t*=r))*yh.TRIANGLE_TO_SQUARE,n=e+i,a=t+i,o=Math.floor(n),s=Math.floor(a),l=this.grad2d(e,t,o,s);return l+=this.grad2d(e,t,o+1,s+1),l+=n-o>=a-s?this.grad2d(e,t,o+1,s):this.grad2d(e,t,o,s+1),l*yh.INVERSE_MAX_FALLOF_2D}get3D(e,t,r,i){let n=((e*=i)+(t*=i)+(r*=i))*(1/3),a=e+n,o=t+n,s=r+n,l=Math.floor(a),h=Math.floor(o),u=Math.floor(s),c=this.grad3d(e,t,r,l,h,u);c+=this.grad3d(e,t,r,l+1,h+1,u+1);let d=a-l,f=o-h,p=s-u;return d>=f?d>=p?(c+=this.grad3d(e,t,r,l+1,h,u),c+=f>=p?this.grad3d(e,t,r,l+1,h+1,u):this.grad3d(e,t,r,l+1,h,u+1)):(c+=this.grad3d(e,t,r,l,h,u+1),c+=this.grad3d(e,t,r,l+1,h,u+1)):f>=p?(c+=this.grad3d(e,t,r,l,h+1,u),c+=d>=p?this.grad3d(e,t,r,l+1,h+1,u):this.grad3d(e,t,r,l,h+1,u+1)):(c+=this.grad3d(e,t,r,l,h,u+1),c+=this.grad3d(e,t,r,l,h+1,u+1)),c*yh.INVERSE_MAX_FALLOF_3D}computeHash(e){let t,r=[];for(t=0;t<=yh.HASH_MASK;++t)r[t]=t;for(;--t;){let i=Math.floor(e.getNumber(0,yh.HASH_MASK)),n=r[t];r[t]=r[i],r[i]=n}return r}grad1d(e,t){let r=e-t,i=1-r*r;i*=i*i;let n=this.hash[t&yh.HASH_MASK];return i*(yh.GRADIENTS_1D[n&yh.GRADIENTS_1D_MASK]*r)}grad2d(e,t,r,i){let n=(r+i)*yh.SQUARE_TO_TRIANGLE,a=e-r+n,o=t-i+n,s=.5-a*a-o*o;if(s>0){s*=s*s;let e=this.hash[this.hash[r&yh.HASH_MASK]+i&yh.HASH_MASK],t=yh.GRADIENTS_2D[e&yh.GRADIENTS_2D_MASK];return s*(t[0]*a+t[1]*o)}return 0}grad3d(e,t,r,i,n,a){let o=(i+n+a)*(1/6),s=e-i+o,l=t-n+o,h=r-a+o,u=.5-s*s-l*l-h*h;if(u>0){u*=u*u;let e=this.hash[this.hash[this.hash[i&yh.HASH_MASK]+n&yh.HASH_MASK]+a&yh.HASH_MASK],t=yh.GRADIENTS_3D[e&yh.GRADIENTS_3D_MASK];return u*(t[0]*s+t[1]*l+t[2]*h)}return 0}}class vh{paused=!0;currentTime=0;constructor(){this.entities=new mh((e=>e.getNextActionTime()))}add(e){this.entities.contains(e)||(this.entities.push(e),e.wait(this.currentTime-e.getNextActionTime()))}rawAdd(e){this.entities.contains(e)||this.entities.push(e)}addAll(e){for(const t of e)t.wait(this.currentTime-t.getNextActionTime());this.entities.pushAll(e)}contains(e){return this.entities.contains(e)}remove(e){e===this.currentEntity?this.currentEntity=void 0:this.entities.remove(e)}clear(){this.entities.clear()}pause(){this.paused=!0}resume(){this.paused=!1}isPaused(){return this.paused}async run(){if(this.paused||this.entities.isEmpty())return;let e=this.entities.peek();if(!e)return;this.currentTime=e.getNextActionTime();let t,r=[];for(;!this.entities.isEmpty()&&e&&e.getNextActionTime()<=this.currentTime;){this.currentEntity=this.entities.pop();let i=this.currentEntity.getNextActionTime();if(await this.currentEntity.update(),this.paused&&void 0===t)t=this.currentEntity;else if(void 0!==this.currentEntity){if(!this.paused&&this.currentEntity.getNextActionTime()===i&&"player"===this.currentEntity.name)throw console.log("ERROR : scheduler : entity didn't wait after update"),console.log((new Error).stack),new Error(this.currentEntity.name);r.push(this.currentEntity)}this.currentEntity=void 0,e=this.entities.peek()}this.entities.pushAll(r),t&&this.entities.push(t)}}class bh{static registerConstructor(e,t){bh.constructors[e]=t}static registerClass(e){bh.classes[e.name]=e}static getClass(e){return bh.classes[e]}static getConstructor(e){return bh.constructors[e]}static constructors={};static classes={}}class xh{static json2Object(e,t){if(!e)return;let r=JSON.parse(e);return null!=r?xh.loadFromData(r,t):void 0}static object2Json(e){if("number"==typeof e)return e.toString();if("string"==typeof e)return e;xh.needsClassName(e)&&(e.className=e.constructor.name);try{return JSON.stringify(e,xh.jsonReplacer)}catch(t){return void console.log("Error while serializing "+e.className+" to JSON:"+t)}}static loadFromData(e,t){if(null!=e)return e instanceof Array?xh.loadArrayFromData(e,t):"object"==typeof e?xh.loadObjectFromData(e,t):e}static needsClassName(e){return e&&"object"==typeof e&&"Array"!==e.constructor.name}static jsonReplacer(e,t){if(0!==e.indexOf("__"))return xh.needsClassName(t)&&(t.className=t.constructor.name),t}static loadArrayFromData(e,t){let r=t&&a.isArray(t)?t:[];for(let t=0,i=e.length;t<i;++t)r[t]=this.loadFromData(e[t]);return r}static loadObjectFromData(e,t){if(!t)if(e.className&&"Object"!==e.className){let r=bh.getClass(e.className);if(r)t=new r;else{let r=bh.getConstructor(e.className);if(!r)return void console.log("Error reading from persistence : unknown class "+e.className);t=r()}}else t={};if(t.load)t.load(e);else for(let r in e)if(e.hasOwnProperty(r))try{t[r]=this.loadFromData(e[r])}catch(i){console.log("ERROR loading field "+r+" with value "+e[r]+" on object "+t.constructor.name+" : "+i)}return t.postLoad&&t.postLoad(),t}}var _h={};!function(e,t){"object"==typeof _h?_h=t():e.Dexie=t()}(_h,(function(){var t="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function r(e,r){t=e,i=r}var i=function(){return!0},n=!new Error("").stack;function a(){if(n)try{throw a.arguments,new Error}catch(e){return e}return new Error}function o(e,t){var r=e.stack;return r?(t=t||0,0===r.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),r.split("\n").slice(t).filter(i).map((function(e){return"\n"+e})).join("")):""}function s(){}function l(e){return e}function h(e,t){return null==e||e===l?t:function(r){return t(e(r))}}function u(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function c(e,t){return e===s?t:function(){var r=e.apply(this,arguments);void 0!==r&&(arguments[0]=r);var i=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?u(i,this.onsuccess):i),n&&(this.onerror=this.onerror?u(n,this.onerror):n),void 0!==a?a:r}}function d(e,t){return e===s?t:function(){e.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?u(r,this.onsuccess):r),i&&(this.onerror=this.onerror?u(i,this.onerror):i)}}function f(e,t){return e===s?t:function(r){var i=e.apply(this,arguments);b(r,i);var n=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?u(n,this.onsuccess):n),a&&(this.onerror=this.onerror?u(a,this.onerror):a),void 0===i?void 0===o?void 0:o:b(i,o)}}function p(e,t){return e===s?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function m(e,t){return e===s?t:function(){var r=e.apply(this,arguments);if(r&&"function"==typeof r.then){for(var i=this,n=arguments.length,a=new Array(n);n--;)a[n]=arguments[n];return r.then((function(){return t.apply(i,a)}))}return t.apply(this,arguments)}}var g=Object.keys,y=Array.isArray,v="undefined"!=typeof self?self:"undefined"!=typeof window?window:e;function b(e,t){return"object"!=typeof t||g(t).forEach((function(r){e[r]=t[r]})),e}var x=Object.getPrototypeOf,_={}.hasOwnProperty;function T(e,t){return _.call(e,t)}function E(e,t){"function"==typeof t&&(t=t(x(e))),g(t).forEach((function(r){A(e,r,t[r])}))}function A(e,t,r,i){Object.defineProperty(e,t,b(r&&T(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function w(e){return{from:function(t){return e.prototype=Object.create(t.prototype),A(e.prototype,"constructor",e),{extend:E.bind(null,e.prototype)}}}}var k=Object.getOwnPropertyDescriptor;function S(e,t){var r;return k(e,t)||(r=x(e))&&S(r,t)}var M=[].slice;function C(e,t,r){return M.call(e,t,r)}function P(e,t){return t(e)}function O(e){var t=setTimeout(e,1e3);clearTimeout(t)}function D(e){if(!e)throw new ie.Internal("Assertion failed")}function I(e){v.setImmediate?setImmediate(e):setTimeout(e,0)}function R(e,t){return e.reduce((function(e,r,i){var n=t(r,i);return n&&(e[n[0]]=n[1]),e}),{})}function N(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}function L(e,t,r){try{e.apply(null,r)}catch(e){t&&t(e)}}function F(e,t){var r=_e.reject(e);return t?r.uncaught(t):r}function B(e,t){if(T(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var r=[],i=0,n=t.length;i<n;++i){var a=B(e,t[i]);r.push(a)}return r}var o=t.indexOf(".");if(-1!==o){var s=e[t.substr(0,o)];return void 0===s?void 0:B(s,t.substr(o+1))}}function U(e,t,r){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){D("string"!=typeof r&&"length"in r);for(var i=0,n=t.length;i<n;++i)U(e,t[i],r[i])}else{var a=t.indexOf(".");if(-1!==a){var o=t.substr(0,a),s=t.substr(a+1);if(""===s)void 0===r?delete e[o]:e[o]=r;else{var l=e[o];l||(l=e[o]={}),U(l,s,r)}}else void 0===r?delete e[t]:e[t]=r}}function z(e){var t={};for(var r in e)T(e,r)&&(t[r]=e[r]);return t}function H(e){if(!e||"object"!=typeof e)return e;var t;if(y(e)){t=[];for(var r=0,i=e.length;r<i;++r)t.push(H(e[r]))}else if(e instanceof Date)(t=new Date).setTime(e.getTime());else for(var n in t=e.constructor?Object.create(e.constructor.prototype):{},e)T(e,n)&&(t[n]=H(e[n]));return t}function j(e,t,r,i){return r=r||{},i=i||"",g(e).forEach((function(n){if(T(t,n)){var a=e[n],o=t[n];"object"==typeof a&&"object"==typeof o&&a&&o&&a.constructor===o.constructor?j(a,o,r,i+n+"."):a!==o&&(r[i+n]=t[n])}else r[i+n]=void 0})),g(t).forEach((function(n){T(e,n)||(r[i+n]=t[n])})),r}var V="undefined"!=typeof Symbol&&Symbol.iterator,G=V?function(e){var t;return null!=e&&(t=e[V])&&t.apply(e)}:function(){return null},K={};function W(e){var t,r,i,n;if(1===arguments.length){if(y(e))return e.slice();if(this===K&&"string"==typeof e)return[e];if(n=G(e)){for(r=[];!(i=n.next()).done;)r.push(i.value);return r}if(null==e)return[e];if("number"==typeof(t=e.length)){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Y=[].concat;function X(e){return Y.apply([],e)}var q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Z=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","IncompatiblePromise"].concat(q),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Q(e,t){this._e=a(),this.name=e,this.message=t}function $(e,t,r,i){this._e=a(),this.failures=t,this.failedKeys=i,this.successCount=r}function ee(e,t){this._e=a(),this.name="BulkError",this.failures=t,this.message=function(e,t){return e+". Errors: "+t.map((function(e){return e.toString()})).filter((function(e,t,r){return r.indexOf(e)===t})).join("\n")}(e,t)}w(Q).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+o(this._e,2))}},toString:function(){return this.name+": "+this.message}}),w($).from(Q),w(ee).from(Q);var te=Z.reduce((function(e,t){return e[t]=t+"Error",e}),{}),re=Q,ie=Z.reduce((function(e,t){var r=t+"Error";function i(e,i){this._e=a(),this.name=r,e?"string"==typeof e?(this.message=e,this.inner=i||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=J[t]||r,this.inner=null)}return w(i).from(re),e[t]=i,e}),{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var ne=q.reduce((function(e,t){return e[t+"Error"]=ie[t],e}),{});var ae=Z.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ie[t]),e}),{});function oe(e){var t={},r=function(r,i){if(i){for(var n=arguments.length,a=new Array(n-1);--n;)a[n-1]=arguments[n];return t[r].subscribe.apply(null,a),e}if("string"==typeof r)return t[r]};r.addEventType=a;for(var i=1,n=arguments.length;i<n;++i)a(arguments[i]);return r;function a(e,i,n){if("object"==typeof e)return o(e);i||(i=p),n||(n=s);var a={subscribers:[],fire:n,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=i(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter((function(t){return t!==e})),a.fire=a.subscribers.reduce(i,n)}};return t[e]=r[e]=a,a}function o(e){g(e).forEach((function(t){var r=e[t];if(y(r))a(t,e[t][0],e[t][1]);else{if("asap"!==r)throw new ie.InvalidArgument("Invalid event config");var i=a(t,l,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];i.subscribers.forEach((function(e){I((function(){e.apply(null,t)}))}))}))}}))}}ae.ModifyError=$,ae.DexieError=Q,ae.BulkError=ee;var se={},le=!1,he="undefined"==typeof setImmediate?function(){setTimeout(Pe,0)}:setImmediate.bind(null,Pe),ue=function(e,t){ve.push([e,t]),de&&(he(),de=!1)},ce=!0,de=!0,fe=[],pe=[],me=null,ge=l,ye={global:!0,ref:0,unhandleds:[],onunhandled:Be,finalize:function(){this.unhandleds.forEach((function(e){try{Be(e[0],e[1])}catch(e){}}))}},ve=[],be=0,xe=[];function _e(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=s,this._lib=!1;var r=this._PSD=ye;if(t&&(this._stackHolder=a(),this._prev=null,this._numPrev=0,Ce(this,me)),"function"!=typeof e){if(e!==se)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ae(this,this._value))}this._state=null,this._value=null,++r.ref,Ee(this,e)}function Te(e,t,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=i,this.psd=ye}function Ee(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Oe();t&&"function"==typeof t.then?Ee(e,(function(e,r){t instanceof _e?t._then(e,r):t.then(e,r)})):(e._state=!0,e._value=t,we(e)),r&&De()}}),Ae.bind(null,e))}catch(t){Ae(e,t)}}function Ae(e,r){if(pe.push(r),null===e._state){var i=e._lib&&Oe();r=ge(r),e._state=!1,e._value=r,t&&null!==r&&"object"==typeof r&&!r._promise&&L((function(){var t=S(r,"stack");r._promise=e,A(r,"stack",{get:function(){return le?t&&(t.get?t.get.apply(r):t.value):e.stack}})})),function(e){fe.some((function(t){return t._value===e._value}))||fe.push(e)}(e),we(e),i&&De()}}function we(e){var t=e._listeners;e._listeners=[];for(var r=0,i=t.length;r<i;++r)ke(e,t[r]);var n=e._PSD;--n.ref||n.finalize(),0===be&&(++be,ue((function(){0==--be&&Ie()}),[]))}function ke(e,t){if(null!==e._state){var r=e._state?t.onFulfilled:t.onRejected;if(null===r)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++be,ue(Se,[r,e,t])}else e._listeners.push(t)}function Se(e,t,r){var i=ye,n=r.psd;try{n!==i&&(ye=n),me=t;var a,o=t._value;t._state?a=e(o):(pe.length&&(pe=[]),a=e(o),-1===pe.indexOf(o)&&function(e){var t=fe.length;for(;t;)if(fe[--t]._value===e._value)return void fe.splice(t,1)}(t)),r.resolve(a)}catch(e){r.reject(e)}finally{n!==i&&(ye=i),me=null,0==--be&&Ie(),--n.ref||n.finalize()}}function Me(e,r,i){if(r.length===i)return r;var n="";if(!1===e._state){var a,s,l=e._value;null!=l?(a=l.name||"Error",s=l.message||l,n=o(l,0)):(a=l,s=""),r.push(a+(s?": "+s:"")+n)}return t&&((n=o(e._stackHolder,2))&&-1===r.indexOf(n)&&r.push(n),e._prev&&Me(e._prev,r,i)),r}function Ce(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Pe(){Oe()&&De()}function Oe(){var e=ce;return ce=!1,de=!1,e}function De(){var e,t,r;do{for(;ve.length>0;)for(e=ve,ve=[],r=e.length,t=0;t<r;++t){var i=e[t];i[0].apply(null,i[1])}}while(ve.length>0);ce=!0,de=!0}function Ie(){var e=fe;fe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=xe.slice(0),r=t.length;r;)t[--r]()}function Re(e){return new _e(se,!1,e)}function Ne(e,t){var r=ye;return function(){var i=Oe(),n=ye;try{return n!==r&&(ye=r),e.apply(this,arguments)}catch(e){t&&t(e)}finally{n!==r&&(ye=n),i&&De()}}}function Le(e,t,r,i){var n=ye,a=Object.create(n);a.parent=n,a.ref=0,a.global=!1,++n.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Fe(a,e,t,r,i);return 0===a.ref&&a.finalize(),o}function Fe(e,t,r,i,n){var a=ye;try{return e!==a&&(ye=e),t(r,i,n)}finally{e!==a&&(ye=a)}}function Be(e,t){var r;try{r=t.onuncatched(e)}catch(e){}if(!1!==r)try{_e.on.error.fire(e,t)}catch(e){}}E(_e.prototype,{then:function(e,r){var i=this,n=new _e((function(t,n){ke(i,new Te(e,r,t,n))}));return t&&(!this._prev||null===this._state)&&Ce(n,this),n},_then:function(e,t){ke(this,new Te(null,null,e,t))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],r=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?r(e):Re(e)})):this.then(null,(function(e){return e&&e.name===t?r(e):Re(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Re(t)}))},uncaught:function(e){var t=this;return this.onuncatched=p(this.onuncatched,e),!1===this._state&&-1===fe.indexOf(this)&&fe.some((function(e,r,i){return e._value===t._value&&(i[r]=t)})),this},stack:{get:function(){if(this._stack)return this._stack;try{le=!0;var e=Me(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{le=!1}}}}),E(_e,{all:function(){var e=W.apply(null,arguments);return new _e((function(t,r){0===e.length&&t([]);var i=e.length;e.forEach((function(n,a){return _e.resolve(n).then((function(r){e[a]=r,--i||t(e)}),r)}))}))},resolve:function(e){return e&&"function"==typeof e.then?e:new _e(se,!0,e)},reject:Re,race:function(){var e=W.apply(null,arguments);return new _e((function(t,r){e.map((function(e){return _e.resolve(e).then(t,r)}))}))},PSD:{get:function(){return ye},set:function(e){return ye=e}},newPSD:Le,usePSD:Fe,scheduler:{get:function(){return ue},set:function(e){ue=e}},rejectionMapper:{get:function(){return ge},set:function(e){ge=e}},follow:function(e){return new _e((function(t,r){return Le((function(t,r){var i=ye;i.unhandleds=[],i.onunhandled=r,i.finalize=u((function(){var e=this;!function(e){function t(){e(),xe.splice(xe.indexOf(t),1)}xe.push(t),++be,ue((function(){0==--be&&Ie()}),[])}((function(){0===e.unhandleds.length?t():r(e.unhandleds[0])}))}),i.finalize),e()}),t,r)}))},on:oe(null,{error:[p,function(e){console.warn("Unhandled rejection: "+(e.stack||e))}]})}),O((function(){ue=function(e,t){setTimeout((function(){e.apply(null,t)}),0)}}));var Ue="1.4.1",ze=String.fromCharCode(65535),He=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return ze}}(),je="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ve="String expected.",Ge=[],Ke="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),We=Ke,Ye=Ke,Xe=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function qe(e,r){var i,n,o,u=qe.dependencies,p=b({addons:qe.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},r),v=p.addons,x=p.autoOpen,_=p.indexedDB,k=p.IDBKeyRange,S=this._dbSchema={},M=[],I=[],V={},G=null,Y=null,q=!1,Z=!1,J="readonly",Q="readwrite",te=this,re=new _e((function(e){i=e})),ne=new _e((function(e,t){n=t})),ae=!0,se=!!ct(_);function le(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function he(e,t,r){var i=te._createTransaction(Q,I,S);i.create(t),i._completion.catch(r);var n=i._reject.bind(i);Le((function(){ye.trans=i,0===e?(g(S).forEach((function(e){ue(t,e,S[e].primKey,S[e].indexes)})),_e.follow((function(){return te.on.populate.fire(i)})).catch(n)):function(e,t,r){var i=[],n=M.filter((function(t){return t._cfg.version===e}))[0];if(!n)throw new ie.Upgrade("Dexie specification of currently installed DB version is missing");S=te._dbSchema=n._cfg.dbschema;var a=!1;function o(){return i.length?_e.resolve(i.shift()(t.idbtrans)).then(o):_e.resolve()}return M.filter((function(t){return t._cfg.version>e})).forEach((function(e){i.push((function(){var i=S,n=e._cfg.dbschema;Fe(i,r),Fe(n,r),S=te._dbSchema=n;var o=function(e,t){var r={del:[],add:[],change:[]};for(var i in e)t[i]||r.del.push(i);for(i in t){var n=e[i],a=t[i];if(n){var o={name:i,def:a,recreate:!1,del:[],add:[],change:[]};if(n.primKey.src!==a.primKey.src)o.recreate=!0,r.change.push(o);else{var s=n.idxByName,l=a.idxByName;for(var h in s)l[h]||o.del.push(h);for(h in l){var u=s[h],c=l[h];u?u.src!==c.src&&o.change.push(c):o.add.push(c)}(o.del.length>0||o.add.length>0||o.change.length>0)&&r.change.push(o)}}else r.add.push([i,a])}return r}(i,n);if(o.add.forEach((function(e){ue(r,e[0],e[1].primKey,e[1].indexes)})),o.change.forEach((function(e){if(e.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){ce(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),ce(t,e)})),e.del.forEach((function(e){t.deleteIndex(e)}))})),e._cfg.contentUpgrade)return a=!0,_e.follow((function(){e._cfg.contentUpgrade(t)}))})),i.push((function(t){a&&!We&&function(e,t){for(var r=0;r<t.db.objectStoreNames.length;++r){var i=t.db.objectStoreNames[r];null==e[i]&&t.db.deleteObjectStore(i)}}(e._cfg.dbschema,t)}))})),o().then((function(){!function(e,t){g(e).forEach((function(r){t.db.objectStoreNames.contains(r)||ue(t,r,e[r].primKey,e[r].indexes)}))}(S,r)}))}(e,i,t).catch(n)}))}function ue(e,t,r,i){var n=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach((function(e){ce(n,e)})),n}function ce(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function de(e){return te.on.error.fire(e)}function fe(e,t,r){if(Z||ye.letThrough){var i=te._createTransaction(e,t,S);return i._promise(e,(function(e,t){Le((function(){ye.trans=i,r(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(!q){if(!x)return F(new ie.DatabaseClosed,de);te.open().catch(s)}return re.then((function(){return fe(e,t,r)}))}function pe(e,t,r){this.name=e,this.schema=t,this.hook=V[e]?V[e].hook:oe(null,{creating:[c,s],reading:[h,l],updating:[f,s],deleting:[d,s]}),this._collClass=r||Te}function me(e,t,r){pe.call(this,e,t,r||Ae)}function ge(e,t,r){return(r?it:rt)((function(r){e.push(r),t&&t()}))}function ve(e,t,r,i,n){return new _e((function(a,o){var s=r.length,l=s-1;if(0===s)return a();if(i){var h,u=it(o),c=tt(null);L((function(){for(var i=0;i<s;++i){h={onsuccess:null,onerror:null};var o=r[i];n.call(h,o[0],o[1],t);var d=e.delete(o[0]);d._hookCtx=h,d.onerror=u,d.onsuccess=i===l?tt(a):c}}),(function(e){throw h.onerror&&h.onerror(e),e}))}else for(var d=0;d<s;++d){var f=e.delete(r[d]);f.onerror=Ne(rt(o)),d===l&&(f.onsuccess=Ne((function(){return a()})))}})).uncaught(de)}function be(e,t,r,i){var n=this;this.db=te,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=oe(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._tables=null,this._reculock=0,this._blockedFuncs=[],this._psd=null,this._dbschema=r,this._resolve=null,this._reject=null,this._completion=new _e((function(e,t){n._resolve=e,n._reject=t})).uncaught(de),this._completion.then((function(){n.on.complete.fire()}),(function(e){return n.on.error.fire(e),n.parent?n.parent._reject(e):n.active&&n.idbtrans&&n.idbtrans.abort(),n.active=!1,F(e)}))}function xe(e,t,r){this._ctx={table:e,index:":id"===t?null:t,collClass:e._collClass,or:r}}function Te(e,t){var r=null,i=null;if(t)try{r=t()}catch(e){i=e}var n=e._ctx,a=n.table;this._ctx={table:a,index:n.index,isPrimKey:!n.index||a.schema.primKey.keyPath&&n.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:n.or,valueMapper:a.hook.reading.fire}}function Ee(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ae(){Te.apply(this,arguments)}function we(e,t){return e._cfg.version-t._cfg.version}function ke(e,t,r,i){t.forEach((function(t){var n=te._tableFactory(r,i[t]);e.forEach((function(e){t in e||(e[t]=n)}))}))}function Se(e,t,r,i,n,a){var o=Ne(a?function(e,t,i){return r(a(e),t,i)}:r,n);e.onerror||(e.onerror=rt(n)),e.onsuccess=N(t?function(){var r=e.result;if(r){var a=function(){r.continue()};t(r,(function(e){a=e}),i,n)&&o(r.value,r,(function(e){a=e})),a()}else i()}:function(){var t=e.result;if(t){var r=function(){t.continue()};o(t.value,t,(function(e){r=e})),r()}else i()},n)}function Me(e,t){return _.cmp(e,t)}function Ce(e,t){return Me(e,t)>0?e:t}function Pe(e,t){return _.cmp(e,t)}function Oe(e,t){return _.cmp(t,e)}function De(e,t){return e<t?-1:e===t?0:1}function Ie(e,t){return e>t?-1:e===t?0:1}function Re(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Fe(e,t){for(var r=t.db.objectStoreNames,i=0;i<r.length;++i){var n=r[i],a=t.objectStore(n);o="getAll"in a;for(var s=0;s<a.indexNames.length;++s){var l=a.indexNames[s],h=a.index(l).keyPath,u="string"==typeof h?h:"["+C(h).join("+")+"]";if(e[n]){var c=e[n].idxByName[u];c&&(c.name=l)}}}}function Be(e){te.on("blocked").fire(e),Ge.filter((function(e){return e.name===te.name&&e!==te&&!e._vcFired})).map((function(t){return t.on("versionchange").fire(e)}))}this.version=function(e){if(G||q)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=M.filter((function(t){return t._cfg.version===e}))[0];return t||(t=new le(e),M.push(t),M.sort(we),t)},b(le.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?b(this._cfg.storesSource,e):e;var t={};M.forEach((function(e){b(t,e._cfg.storesSource)}));var r=this._cfg.dbschema={};return this._parseStoresSpec(t,r),S=te._dbSchema=r,[V,te,be.prototype].forEach((function(e){for(var t in e)e[t]instanceof pe&&delete e[t]})),ke([V,te,be.prototype,this._cfg.tables],g(r),Q,r),I=g(r),this},upgrade:function(e){var t=this;return Ze((function(){e(te._createTransaction(Q,g(t._cfg.dbschema),t._cfg.dbschema))})),this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){g(e).forEach((function(r){if(null!==e[r]){var i={},n=function(e){var t=[];return e.split(",").forEach((function(e){var r=(e=e.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;t.push(new st(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),y(i),/\./.test(e)))})),t}(e[r]),a=n.shift();if(a.multi)throw new ie.Schema("Primary key cannot be multi-valued");a.keyPath&&U(i,a.keyPath,a.auto?0:a.keyPath),n.forEach((function(e){if(e.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string");U(i,e.keyPath,e.compound?e.keyPath.map((function(){return""})):"")})),t[r]=new lt(r,a,n,i)}}))}}),this._allTables=V,this._tableFactory=function(e,t){return e===J?new pe(t.name,t,Te):new me(t.name,t)},this._createTransaction=function(e,t,r,i){return new be(e,t,r,i)},this._whenReady=function(e){return new _e(Je||Z||ye.letThrough?e:function(t,r){if(!q){if(!x)return void r(new ie.DatabaseClosed);te.open().catch(s)}re.then((function(){e(t,r)}))}).uncaught(de)},this.verno=0,this.open=function(){if(q||G)return re.then((function(){return Y?F(Y,de):te}));t&&(ne._stackHolder=a()),q=!0,Y=null,Z=!1;var r=i,n=null;return _e.race([ne,new _e((function(t,r){if(O((function(){return t()})),M.length>0&&(ae=!1),!_)throw new ie.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var i=ae?_.open(e):_.open(e,Math.round(10*te.verno));if(!i)throw new ie.MissingAPI("IndexedDB API not available");i.onerror=Ne(rt(r)),i.onblocked=Ne(Be),i.onupgradeneeded=Ne((function(t){if(n=i.transaction,ae&&!te._allowEmptyDB){i.onerror=nt,n.abort(),i.result.close();var a=_.deleteDatabase(e);a.onsuccess=a.onerror=Ne((function(){r(new ie.NoSuchDatabase("Database "+e+" doesnt exist"))}))}else{n.onerror=Ne(rt(r)),he((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,n,r)}}),r),i.onsuccess=Ne((function(){if(n=null,G=i.result,Ge.push(te),ae)!function(){if(te.verno=G.version/10,te._dbSchema=S={},0===(I=C(G.objectStoreNames,0)).length)return;var e=G.transaction(ut(I),"readonly");I.forEach((function(t){for(var r=e.objectStore(t),i=r.keyPath,n=i&&"string"==typeof i&&-1!==i.indexOf("."),a=new st(i,i||"",!1,!1,!!r.autoIncrement,i&&"string"!=typeof i,n),o=[],s=0;s<r.indexNames.length;++s){var l=r.index(r.indexNames[s]);n=(i=l.keyPath)&&"string"==typeof i&&-1!==i.indexOf(".");var h=new st(l.name,i,!!l.unique,!!l.multiEntry,!1,i&&"string"!=typeof i,n);o.push(h)}S[t]=new lt(t,a,o,{})})),ke([V,be.prototype],g(S),Q,S)}();else if(G.objectStoreNames.length>0)try{Fe(S,G.transaction(ut(G.objectStoreNames),J))}catch(e){}G.onversionchange=Ne((function(e){te._vcFired=!0,te.on("versionchange").fire(e)})),se||at((function(t){if(-1===t.indexOf(e))return t.push(e)})),t()}),r)}))]).then((function(){return qe.vip(te.on.ready.fire)})).then((function(){return q=!1,te})).catch((function(e){try{n&&n.abort()}catch(e){}return q=!1,te.close(),F(Y=e,de)})).finally((function(){Z=!0,r()}))},this.close=function(){var e=Ge.indexOf(te);if(e>=0&&Ge.splice(e,1),G){try{G.close()}catch(e){}G=null}x=!1,Y=new ie.DatabaseClosed,q&&n(Y),re=new _e((function(e){i=e})),ne=new _e((function(e,t){n=t}))},this.delete=function(){var t=arguments.length>0;return new _e((function(r,i){if(t)throw new ie.InvalidArgument("Arguments not allowed in db.delete()");function n(){te.close();var t=_.deleteDatabase(e);t.onsuccess=Ne((function(){se||at((function(t){var r=t.indexOf(e);if(r>=0)return t.splice(r,1)})),r()})),t.onerror=Ne(rt(i)),t.onblocked=Be}q?re.then(n):n()})).uncaught(de)},this.backendDB=function(){return G},this.isOpen=function(){return null!==G},this.hasFailed=function(){return null!==Y},this.dynamicallyOpened=function(){return ae},this.name=e,A(this,"tables",{get:function(){return g(V).map((function(e){return V[e]}))}}),this.on=oe(this,"error","populate","blocked","versionchange",{ready:[m,s]}),this.on.ready.subscribe=P(this.on.ready.subscribe,(function(e){return function(t,r){qe.vip((function(){e(t),r||e((function e(){te.on.ready.unsubscribe(t),te.on.ready.unsubscribe(e)}))}))}})),Ze((function(){te.on("populate").fire(te._createTransaction(Q,I,S)),te.on("error").fire(new Error)})),this.transaction=function(e,t,r){var i=arguments.length;if(i<2)throw new ie.InvalidArgument("Too few arguments");for(var n=new Array(i-1);--i;)n[i-1]=arguments[i];r=n.pop();var a=X(n),o=ye.trans;o&&o.db===te&&-1===e.indexOf("!")||(o=null);var s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var l=a.map((function(e){var t=e instanceof pe?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}));if("r"==e||e==J)e=J;else{if("rw"!=e&&e!=Q)throw new ie.InvalidArgument("Invalid transaction mode: "+e);e=Q}if(o){if(o.mode===J&&e===Q){if(!s)throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&l.forEach((function(e){if(!T(o.tables,e)){if(!s)throw new ie.SubTransaction("Table "+e+" not included in parent transaction.");o=null}}))}}catch(e){return o?o._promise(null,(function(t,r){r(e)})):F(e,de)}return o?o._promise(e,h,"lock"):te._whenReady(h);function h(t){var i=ye;t(_e.resolve().then((function(){return Le((function(){ye.transless=ye.transless||i;var t=te._createTransaction(e,l,S,o);ye.trans=t,o?t.idbtrans=o.idbtrans:t.create();var n,a=l.map((function(e){return t.tables[e]}));return a.push(t),_e.follow((function(){if(n=r.apply(t,a))if("function"==typeof n.next&&"function"==typeof n.throw)n=ot(n);else if("function"==typeof n.then&&!T(n,"_PSD"))throw new ie.IncompatiblePromise("Incompatible Promise returned from transaction scope (read more at http://tinyurl.com/znyqjqc). Transaction scope: "+r.toString())})).uncaught(de).then((function(){return o&&t._resolve(),t._completion})).then((function(){return n})).catch((function(e){return t._reject(e),F(e)}))}))})))}},this.table=function(e){if(Je&&ae)return new me(e);if(!T(V,e))throw new ie.InvalidTable("Table "+e+" does not exist");return V[e]},E(pe.prototype,{_trans:function(e,t,r){var i=ye.trans;return i&&i.db===te?i._promise(e,t,r):fe(e,[this.name],t)},_idbstore:function(e,t,r){if(Je)return new _e(t);var i=ye.trans,n=this.name;function a(e,r,i){t(e,r,i.idbtrans.objectStore(n),i)}return i&&i.db===te?i._promise(e,a,r):fe(e,[this.name],a)},get:function(e,t){var r=this;return this._idbstore(J,(function(t,i,n){Je&&t(r.schema.instanceTemplate);var a=n.get(e);a.onerror=rt(i),a.onsuccess=function(){t(r.hook.reading.fire(a.result))}})).then(t)},where:function(e){return new xe(this,e)},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new this._collClass(new xe(this,e))},toCollection:function(){return new this._collClass(new xe(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var r=Object.create(e.prototype);t&&$e(r,t),this.schema.instanceTemplate=r;var i=function(t){if(!t)return t;var r=Object.create(e.prototype);for(var i in t)T(t,i)&&(r[i]=t[i]);return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e},defineClass:function(e){return this.mapToClass(qe.defineClass(e),e)}}),w(me).from(pe).extend({bulkDelete:function(e){return this.hook.deleting.fire===s?this._idbstore(Q,(function(t,r,i,n){t(ve(i,n,e,!1,s))})):this.where(":id").anyOf(e).delete().then((function(){}))},bulkPut:function(e,t){var r=this;return this._idbstore(Q,(function(i,n,a){if(!a.keyPath&&!r.schema.primKey.auto&&!t)throw new ie.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(a.keyPath&&t)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();var o,l,h=function(e){0===u.length?i(e):n(new ee(r.name+".bulkPut(): "+u.length+" of "+c+" operations failed",u))},u=[],c=e.length,d=r;if(r.hook.creating.fire===s&&r.hook.updating.fire===s){l=ge(u);for(var f=0,p=e.length;f<p;++f)(o=t?a.put(e[f],t[f]):a.put(e[f])).onerror=l;o.onerror=ge(u,h),o.onsuccess=et(h)}else{var m=t||a.keyPath&&e.map((function(e){return B(e,a.keyPath)})),g=m&&R(m,(function(t,r){return null!=t&&[t,e[r]]}));(m?d.where(":id").anyOf(m.filter((function(e){return null!=e}))).modify((function(){this.value=g[this.primKey],g[this.primKey]=null})).catch($,(function(e){u=e.failures})).then((function(){for(var r=[],i=t&&[],n=m.length-1;n>=0;--n){var a=m[n];(null==a||g[a])&&(r.push(e[n]),t&&i.push(a),null!=a&&(g[a]=null))}return r.reverse(),t&&i.reverse(),d.bulkAdd(r,i)})).then((function(e){var t=m[m.length-1];return null!=t?t:e})):d.bulkAdd(e)).then(h).catch(ee,(function(e){u=u.concat(e.failures),h()})).catch(n)}}),"locked")},bulkAdd:function(e,t){var r=this,i=this.hook.creating.fire;return this._idbstore(Q,(function(n,a,o,l){if(!o.keyPath&&!r.schema.primKey.auto&&!t)throw new ie.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(o.keyPath&&t)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return n();function h(e){0===f.length?n(e):a(new ee(r.name+".bulkAdd(): "+f.length+" of "+p+" operations failed",f))}var u,c,d,f=[],p=e.length;if(i!==s){var m,g=o.keyPath;c=ge(f,null,!0),d=tt(null),L((function(){for(var r=0,n=e.length;r<n;++r){m={onerror:null,onsuccess:null};var a=t&&t[r],s=e[r],h=t?a:g?B(s,g):void 0,f=i.call(m,h,s,l);null==h&&null!=f&&(g?U(s=H(s),g,f):a=f),(u=null!=a?o.add(s,a):o.add(s))._hookCtx=m,r<n-1&&(u.onerror=c,m.onsuccess&&(u.onsuccess=d))}}),(function(e){throw m.onerror&&m.onerror(e),e})),u.onerror=ge(f,h,!0),u.onsuccess=tt(h)}else{c=ge(f);for(var y=0,v=e.length;y<v;++y)(u=t?o.add(e[y],t[y]):o.add(e[y])).onerror=c;u.onerror=ge(f,h),u.onsuccess=et(h)}}))},add:function(e,t){var r=this.hook.creating.fire;return this._idbstore(Q,(function(i,n,a,o){var l={onsuccess:null,onerror:null};if(r!==s){var h=null!=t?t:a.keyPath?B(e,a.keyPath):void 0,u=r.call(l,h,e,o);null==h&&null!=u&&(a.keyPath?U(e,a.keyPath,u):t=u)}try{var c=null!=t?a.add(e,t):a.add(e);c._hookCtx=l,c.onerror=it(n),c.onsuccess=tt((function(t){var r=a.keyPath;r&&U(e,r,t),i(t)}))}catch(e){throw l.onerror&&l.onerror(e),e}}))},put:function(e,t){var r=this,i=this.hook.creating.fire,n=this.hook.updating.fire;return i!==s||n!==s?this._trans(Q,(function(i,n,a){var o=void 0!==t?t:r.schema.primKey.keyPath&&B(e,r.schema.primKey.keyPath);null==o?a.tables[r.name].add(e).then(i,n):(a._lock(),e=H(e),a.tables[r.name].where(":id").equals(o).modify((function(){this.value=e})).then((function(i){return 0===i?a.tables[r.name].add(e,t):o})).finally((function(){a._unlock()})).then(i,n))})):this._idbstore(Q,(function(r,i,n){var a=void 0!==t?n.put(e,t):n.put(e);a.onerror=rt(i),a.onsuccess=function(t){var i=n.keyPath;i&&U(e,i,t.target.result),r(a.result)}}))},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(Q,(function(t,r,i){var n=i.delete(e);n.onerror=rt(r),n.onsuccess=function(){t(n.result)}}))},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(Q,(function(e,t,r){var i=r.clear();i.onerror=rt(t),i.onsuccess=function(){e(i.result)}}))},update:function(e,t){if("object"!=typeof t||y(t))throw new ie.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||y(e))return this.where(":id").equals(e).modify(t);g(t).forEach((function(r){U(e,r,t[r])}));var r=B(e,this.schema.primKey.keyPath);return void 0===r?F(new ie.InvalidArgument("Given object does not contain its primary key"),de):this.where(":id").equals(r).modify(t)}}),E(be.prototype,{_lock:function(){return D(!ye.global),++this._reculock,1!==this._reculock||ye.global||(ye.lockOwnerFor=this),this},_unlock:function(){if(D(!ye.global),0==--this._reculock)for(ye.global||(ye.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{e()}catch(e){}}return this},_locked:function(){return this._reculock&&ye.lockOwnerFor!==this},create:function(e){var t=this;if(D(!this.idbtrans),!e&&!G)switch(Y&&Y.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(Y);case"MissingAPIError":throw new ie.MissingAPI(Y.message,Y);default:throw new ie.OpenFailed(Y)}if(!this.active)throw new ie.TransactionInactive;return D(null===this._completion._state),(e=this.idbtrans=e||G.transaction(ut(this.storeNames),this.mode)).onerror=Ne((function(r){nt(r),t._reject(e.error)})),e.onabort=Ne((function(e){nt(e),t.active&&t._reject(new ie.Abort),t.active=!1,t.on("abort").fire(e)})),e.oncomplete=Ne((function(){t.active=!1,t._resolve()})),this},_promise:function(e,t,r){var i=this;return Le((function(){var n;return i._locked()?n=new _e((function(n,a){i._blockedFuncs.push((function(){i._promise(e,t,r).then(n,a)}))})):(n=i.active?new _e((function(n,a){if(e===Q&&i.mode!==Q)throw new ie.ReadOnly("Transaction is readonly");!i.idbtrans&&e&&i.create(),r&&i._lock(),t(n,a,i)})):F(new ie.TransactionInactive),i.active&&r&&n.finally((function(){i._unlock()}))),n._lib=!0,n.uncaught(de)}))},abort:function(){this.active&&this._reject(new ie.Abort),this.active=!1},tables:{get:function(){return this._tables?this._tables:this._tables=R(this.storeNames,(function(e){return[e,V[e]]}))}},complete:function(e){return this.on("complete",e)},error:function(e){return this.on("error",e)},table:function(e){if(-1===this.storeNames.indexOf(e))throw new ie.InvalidTable("Table "+e+" not in transaction");return V[e]}}),E(xe.prototype,(function(){function e(e,t,r){var i=e instanceof xe?new e._ctx.collClass(e):e;return i._ctx.error=r?new r(t):new TypeError(t),i}function t(e){return new e._ctx.collClass(e,(function(){return k.only("")})).limit(0)}function r(e,t,r,i,n,a){for(var o=Math.min(e.length,i.length),s=-1,l=0;l<o;++l){var h=t[l];if(h!==i[l])return n(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):n(e[l],i[l])<0?e.substr(0,l)+i[l]+r.substr(l+1):s>=0?e.substr(0,s)+t[s]+r.substr(s+1):null;n(e[l],h)<0&&(s=l)}return o<i.length&&"next"===a?e+r.substr(e.length):o<e.length&&"prev"===a?e.substr(0,r.length):s<0?null:e.substr(0,s)+i[s]+r.substr(s+1)}function i(t,i,n,a){var o,s,l,h,u,c,d,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return e(t,Ve);function p(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),s=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),l="next"===e?De:Ie;var t=n.map((function(e){return{lower:s(e),upper:o(e)}})).sort((function(e,t){return l(e.lower,t.lower)}));h=t.map((function(e){return e.upper})),u=t.map((function(e){return e.lower})),c=e,d="next"===e?"":a}p("next");var m=new t._ctx.collClass(t,(function(){return k.bound(h[0],u[f-1]+a)}));m._ondirectionchange=function(e){p(e)};var g=0;return m._addAlgorithm((function(e,t,n){var a=e.key;if("string"!=typeof a)return!1;var o=s(a);if(i(o,u,g))return!0;for(var p=null,m=g;m<f;++m){var y=r(a,o,h[m],u[m],l,c);null===y&&null===p?g=m+1:(null===p||l(p,y)>0)&&(p=y)}return t(null!==p?function(){e.continue(p+d)}:n),!1})),m}return{between:function(r,i,n,a){n=!1!==n,a=!0===a;try{return Me(r,i)>0||0===Me(r,i)&&(n||a)&&(!n||!a)?t(this):new this._ctx.collClass(this,(function(){return k.bound(r,i,!n,!a)}))}catch(t){return e(this,je)}},equals:function(e){return new this._ctx.collClass(this,(function(){return k.only(e)}))},above:function(e){return new this._ctx.collClass(this,(function(){return k.lowerBound(e,!0)}))},aboveOrEqual:function(e){return new this._ctx.collClass(this,(function(){return k.lowerBound(e)}))},below:function(e){return new this._ctx.collClass(this,(function(){return k.upperBound(e,!0)}))},belowOrEqual:function(e){return new this._ctx.collClass(this,(function(){return k.upperBound(e)}))},startsWith:function(t){return"string"!=typeof t?e(this,Ve):this.between(t,t+ze,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):i(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],ze)},equalsIgnoreCase:function(e){return i(this,(function(e,t){return e===t[0]}),[e],"")},anyOfIgnoreCase:function(){var e=W.apply(K,arguments);return 0===e.length?t(this):i(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},startsWithAnyOfIgnoreCase:function(){var e=W.apply(K,arguments);return 0===e.length?t(this):i(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,ze)},anyOf:function(){var r=W.apply(K,arguments),i=Pe;try{r.sort(i)}catch(t){return e(this,je)}if(0===r.length)return t(this);var n=new this._ctx.collClass(this,(function(){return k.bound(r[0],r[r.length-1])}));n._ondirectionchange=function(e){i="next"===e?Pe:Oe,r.sort(i)};var a=0;return n._addAlgorithm((function(e,t,n){for(var o=e.key;i(o,r[a])>0;)if(++a===r.length)return t(n),!1;return 0===i(o,r[a])||(t((function(){e.continue(r[a])})),!1)})),n},notEqual:function(e){return this.inAnyRange([[-1/0,e],[e,He]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=W.apply(K,arguments);if(0===t.length)return new this._ctx.collClass(this);try{t.sort(Pe)}catch(t){return e(this,je)}var r=t.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return r.push([t[t.length-1],He]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(r,i){var n=this._ctx;if(0===r.length)return t(this);if(!r.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&Pe(e[0],e[1])<=0})))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var a=!i||!1!==i.includeLowers,o=i&&!0===i.includeUppers;var s,l=Pe;function h(e,t){return l(e[0],t[0])}try{(s=r.reduce((function(e,t){for(var r=0,i=e.length;r<i;++r){var n=e[r];if(Me(t[0],n[1])<0&&Me(t[1],n[0])>0){n[0]=Me(a=n[0],o=t[0])<0?a:o,n[1]=Ce(n[1],t[1]);break}}var a,o;return r===i&&e.push(t),e}),[])).sort(h)}catch(t){return e(this,je)}var u=0,c=o?function(e){return Pe(e,s[u][1])>0}:function(e){return Pe(e,s[u][1])>=0},d=a?function(e){return Oe(e,s[u][0])>0}:function(e){return Oe(e,s[u][0])>=0};var f=c,p=new n.collClass(this,(function(){return k.bound(s[0][0],s[s.length-1][1],!a,!o)}));return p._ondirectionchange=function(e){"next"===e?(f=c,l=Pe):(f=d,l=Oe),s.sort(h)},p._addAlgorithm((function(e,t,r){for(var i=e.key;f(i);)if(++u===s.length)return t(r),!1;return!!function(e){return!c(e)&&!d(e)}(i)||(0===Me(i,s[u][1])||0===Me(i,s[u][0])||t((function(){l===Pe?e.continue(s[u][0]):e.continue(s[u][1])})),!1)})),p},startsWithAnyOf:function(){var r=W.apply(K,arguments);return r.every((function(e){return"string"==typeof e}))?0===r.length?t(this):this.inAnyRange(r.map((function(e){return[e,e+ze]}))):e(this,"startsWithAnyOf() only works with strings")}}})),E(Te.prototype,(function(){function e(e,t){e.filter=Re(e.filter,t)}function t(e,t,r){var i=e.replayFilter;e.replayFilter=i?function(){return Re(i(),t())}:t,e.justLimit=r&&!i}function r(e,t){if(e.isPrimKey)return t;var r=e.table.schema.idxByName[e.index];if(!r)throw new ie.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(r.name)}function i(e,t){var i=r(e,t);return e.keysOnly&&"openKeyCursor"in i?i.openKeyCursor(e.range||null,e.dir+e.unique):i.openCursor(e.range||null,e.dir+e.unique)}function n(e,t,r,n,a){var o=e.replayFilter?Re(e.filter,e.replayFilter()):e.filter;e.or?function(){var s={},l=0;function h(){2==++l&&r()}function u(e,r,i){if(!o||o(r,i,h,n)){var a=r.primaryKey.toString();T(s,a)||(s[a]=!0,t(e,r,i))}}e.or._iterate(u,h,n,a),Se(i(e,a),e.algorithm,u,h,n,!e.keysOnly&&e.valueMapper)}():Se(i(e,a),Re(e.algorithm,o),t,r,n,!e.keysOnly&&e.valueMapper)}function a(e){return e.table.schema.instanceTemplate}return{_read:function(e,t){var r=this._ctx;return r.error?r.table._trans(null,(function(e,t){t(r.error)})):r.table._idbstore(J,e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,(function(e,r){r(t.error)})):t.table._idbstore(Q,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Re(t.algorithm,e)},_iterate:function(e,t,r,i){return n(this._ctx,e,t,r,i)},clone:function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&b(r,e),t._ctx=r,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;if(Je){var r=a(t),i=t.table.schema.primKey.keyPath,o=B(r,t.index?t.table.schema.idxByName[t.index].keyPath:i),s=B(r,i);e(r,{key:o,primaryKey:s})}return this._read((function(r,i,a){n(t,e,r,i,a)}))},count:function(e){if(Je)return _e.resolve(0).then(e);var t=this._ctx;if(Ee(t,!0))return this._read((function(e,i,n){var a=r(t,n),o=t.range?a.count(t.range):a.count();o.onerror=rt(i),o.onsuccess=function(r){e(Math.min(r.target.result,t.limit))}}),e);var i=0;return this._read((function(e,r,a){n(t,(function(){return++i,!1}),(function(){e(i)}),r,a)}),e)},sortBy:function(e,t){var r=e.split(".").reverse(),i=r[0],n=r.length-1;function a(e,t){return t?a(e[r[t]],t-1):e[i]}var o="next"===this._ctx.dir?1:-1;function s(e,t){var r=a(e,n),i=a(t,n);return r<i?-o:r>i?o:0}return this.toArray((function(e){return e.sort(s)})).then(t)},toArray:function(e){var t=this._ctx;return this._read((function(e,i,s){if(Je&&e([a(t)]),o&&"next"===t.dir&&Ee(t,!0)&&t.limit>0){var h=t.table.hook.reading.fire,u=r(t,s),c=t.limit<1/0?u.getAll(t.range,t.limit):u.getAll(t.range);c.onerror=rt(i),c.onsuccess=h===l?et(e):Ne(et((function(t){e(t.map(h))})))}else{var d=[];n(t,(function(e){d.push(e)}),(function(){e(d)}),i,s)}}),e)},offset:function(e){var r=this._ctx;return e<=0||(r.offset+=e,Ee(r)?t(r,(function(){var t=e;return function(e,r){return 0===t||(1===t?(--t,!1):(r((function(){e.advance(t),t=0})),!1))}})):t(r,(function(){var t=e;return function(){return--t<0}}))),this},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,(function(){var t=e;return function(e,r,i){return--t<=0&&r(i),t>=0}}),!0),this},until:function(t,r){var i=this._ctx;return Je&&t(a(i)),e(this._ctx,(function(e,i,n){return!t(e.value)||(i(n),r)})),this},first:function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){var r,i;return Je&&t(a(this._ctx)),e(this._ctx,(function(e){return t(e.value)})),r=this._ctx,i=t,r.isMatch=Re(r.isMatch,i),this},and:function(e){return this.filter(e)},or:function(e){return new xe(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){e(r.key,r)}))},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){e(r.primaryKey,r)}))},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each((function(e,t){r.push(t.key)})).then((function(){return r})).then(e)},primaryKeys:function(e){var t=this._ctx;if(o&&"next"===t.dir&&Ee(t,!0)&&t.limit>0)return this._read((function(e,i,n){var a=r(t,n),o=t.limit<1/0?a.getAllKeys(t.range,t.limit):a.getAllKeys(t.range);o.onerror=rt(i),o.onsuccess=et(e)})).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.primaryKey)})).then((function(){return i})).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var i={};return e(this._ctx,(function(e){var t=e.primaryKey.toString(),r=T(i,t);return i[t]=!0,!r})),this}}})),w(Ae).from(Te).extend({modify:function(e){var t=this,r=this._ctx,i=r.table.hook,n=i.updating.fire,a=i.deleting.fire;return Je&&"function"==typeof e&&e.call({value:r.table.schema.instanceTemplate},r.table.schema.instanceTemplate),this._write((function(r,i,o,l){var h;if("function"==typeof e)h=n===s&&a===s?e:function(t){var r=H(t);if(!1===e.call(this,t,this))return!1;if(T(this,"value")){var i=j(r,this.value),o=n.call(this,i,this.primKey,r,l);o&&(t=this.value,g(o).forEach((function(e){U(t,e,o[e])})))}else a.call(this,this.primKey,t,l)};else if(n===s){var u=g(e),c=u.length;h=function(t){for(var r=!1,i=0;i<c;++i){var n=u[i],a=e[n];B(t,n)!==a&&(U(t,n,a),r=!0)}return r}}else{var d=e;e=z(d),h=function(t){var r=!1,i=n.call(this,e,this.primKey,H(t),l);return i&&b(e,i),g(e).forEach((function(i){var n=e[i];B(t,i)!==n&&(U(t,i,n),r=!0)})),i&&(e=z(d)),r}}var f=0,p=0,m=!1,y=[],v=[],x=null;function _(e){return e&&(y.push(e),v.push(x)),i(new $("Error modifying one or more objects",y,p,v))}function E(){m&&p+y.length===f&&(y.length>0?_():r(p))}t.clone().raw()._iterate((function(e,t){x=t.primaryKey;var r={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function i(e){return y.push(e),v.push(r.primKey),E(),!0}if(!1!==h.call(r,e,r)){var n=!T(r,"value");++f,L((function(){var e=n?t.delete():t.update(r.value);e._hookCtx=r,e.onerror=it(i),e.onsuccess=tt((function(){++p,E()}))}),i)}else r.onsuccess&&r.onsuccess(r.value)}),(function(){m=!0,E()}),_,o)}))},delete:function(){var e=this,t=this._ctx,r=t.range,i=t.table.hook.deleting.fire,n=i!==s;if(!n&&Ee(t)&&(t.isPrimKey&&!Ye||!r))return this._write((function(e,t,i){var n=rt(t),a=r?i.count(r):i.count();a.onerror=n,a.onsuccess=function(){var o=a.result;L((function(){var t=r?i.delete(r):i.clear();t.onerror=n,t.onsuccess=function(){return e(o)}}),(function(e){return t(e)}))}}));var a=n?2e3:1e4;return this._write((function(r,o,s,l){var h=0,u=e.clone({keysOnly:!t.isMatch&&!n}).distinct().limit(a).raw(),c=[],d=function(){return u.each(n?function(e,t){c.push([t.primaryKey,t.value])}:function(e,t){c.push(t.primaryKey)}).then((function(){return n?c.sort((function(e,t){return Pe(e[0],t[0])})):c.sort(Pe),ve(s,l,c,n,i)})).then((function(){var e=c.length;return h+=e,c=[],e<a?h:d()}))};r(d())}))}}),b(this,{Collection:Te,Table:pe,Transaction:be,Version:le,WhereClause:xe,WriteableCollection:Ae,WriteableTable:me}),te.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+te.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+te.name+"'. Closing db now to resume the delete request."),te.close()})),te.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+te.name+"') was blocked"):console.warn("Upgrade '"+te.name+"' blocked by other connection holding version "+e.oldVersion/10)})),v.forEach((function(e){e(te)}))}r(t,Xe);var Ze=function(){},Je=!1;function Qe(e){if("function"==typeof e)return new e;if(y(e))return[Qe(e[0])];if(e&&"object"==typeof e){var t={};return $e(t,e),t}return e}function $e(e,t){return g(t).forEach((function(r){var i=Qe(t[r]);e[r]=i})),e}function et(e){return function(t){e(t.target.result)}}function tt(e){return Ne((function(t){var r=t.target,i=r.result,n=r._hookCtx,a=n&&n.onsuccess;a&&a(i),e&&e(i)}),e)}function rt(e){return function(t){return nt(t),e(t.target.error),!1}}function it(e){return Ne((function(t){var r=t.target,i=r.error,n=r._hookCtx,a=n&&n.onerror;return a&&a(i),nt(t),e(i),!1}))}function nt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function at(e){var t,r=qe.dependencies.localStorage;if(!r)return e([]);try{t=JSON.parse(r.getItem("Dexie.DatabaseNames")||"[]")}catch(e){t=[]}e(t)&&r.setItem("Dexie.DatabaseNames",JSON.stringify(t))}function ot(e){var t=function(t){return e.next(t)},r=n(t),i=n((function(t){return e.throw(t)}));function n(e){return function(t){var n=e(t),a=n.value;return n.done?a:a&&"function"==typeof a.then?a.then(r,i):y(a)?_e.all(a).then(r,i):r(a)}}return n(t)()}function st(e,t,r,i,n,a,o){this.name=e,this.keyPath=t,this.unique=r,this.multi=i,this.auto=n,this.compound=a,this.dotted=o;var s="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(r?"&":"")+(i?"*":"")+(n?"++":"")+s}function lt(e,t,r,i){this.name=e,this.primKey=t||new st,this.indexes=r||[new st],this.instanceTemplate=i,this.mappedClass=null,this.idxByName=R(r,(function(e){return[e.name,e]}))}var ht=v.idbModules&&v.idbModules.shimIndexedDB?v.idbModules:{};function ut(e){return 1===e.length?e[0]:e}function ct(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}return E(qe,ae),E(qe,{delete:function(e){var t=new qe(e),r=t.delete();return r.onblocked=function(e){return t.on("blocked",e),this},r},exists:function(e){return new qe(e).open().then((function(e){return e.close(),!0})).catch(qe.NoSuchDatabaseError,(function(){return!1}))},getDatabaseNames:function(e){return new _e((function(e,t){var r=ct(indexedDB);if(r){var i=r();i.onsuccess=function(t){e(C(t.target.result,0))},i.onerror=rt(t)}else at((function(t){return e(t),!1}))})).then(e)},defineClass:function(e){return function(t){t?b(this,t):Je&&$e(this,e)}},applyStructure:$e,ignoreTransaction:function(e){return ye.trans?Fe(ye.transless,e):e()},vip:function(e){return Le((function(){return ye.letThrough=!0,e()}))},async:function(e){return function(){try{var t=ot(e.apply(this,arguments));return t&&"function"==typeof t.then?t:_e.resolve(t)}catch(e){return F(e)}}},spawn:function(e,t,r){try{var i=ot(e.apply(r,t||[]));return i&&"function"==typeof i.then?i:_e.resolve(i)}catch(e){return F(e)}},currentTransaction:{get:function(){return ye.trans||null}},Promise:_e,debug:{get:function(){return t},set:function(e){r(e,"dexie"===e?function(){return!0}:Xe)}},derive:w,extend:b,props:E,override:P,Events:oe,events:oe,getByKeyPath:B,setByKeyPath:U,delByKeyPath:function(e,t){"string"==typeof t?U(e,t,void 0):"length"in t&&[].map.call(t,(function(t){U(e,t,void 0)}))},shallowClone:z,deepClone:H,getObjectDiff:j,asap:I,maxKey:He,addons:[],connections:Ge,MultiModifyError:ie.Modify,errnames:te,IndexSpec:st,TableSchema:lt,dependencies:{indexedDB:ht.shimIndexedDB||v.indexedDB||v.mozIndexedDB||v.webkitIndexedDB||v.msIndexedDB,IDBKeyRange:ht.IDBKeyRange||v.IDBKeyRange||v.webkitIDBKeyRange},semVer:Ue,version:Ue.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,r){return e+t/Math.pow(10,2*r)})),fakeAutoComplete:Ze,default:qe}),L((function(){qe.dependencies.localStorage=null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:v.localStorage})),_e.rejectionMapper=function(e,t){if(!e||e instanceof Q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ne[e.name])return e;var r=new ne[e.name](t||e.message,e);return"stack"in e&&A(r,"stack",{get:function(){return this.inner.stack}}),r},O((function(){qe.fakeAutoComplete=Ze=O,qe.fake=Je=!0})),qe}));var Th=t(_h);class Eh extends Th{constructor(){super("YendorDb"),this.version(1).stores({data:"key, value"})}loadFromKey(e,t){return new Promise((r=>{console.log("loading "+e+" from indexedDb..."),this.data.get(e).then((e=>{let i=e&&e.value?xh.json2Object(e.value,t):void 0;r(i)}))}))}saveToKey(e,t){return new Promise((r=>{this.data.put({key:e,value:xh.object2Json(t)}).then((e=>{r()}))}))}deleteKey(e){return new Promise((t=>{console.log("deleting "+e+" from indexedDb..."),this.data.delete(e).then((e=>{t()}))}))}}const Ah="open",wh="openNodes";let kh;var Sh;let Mh;var Ch;let Ph;var Oh;let Dh;var Ih;(Sh=kh||(kh={}))[Sh.COMPOSITE=1]="COMPOSITE",Sh[Sh.DECORATOR=2]="DECORATOR",Sh[Sh.ACTION=3]="ACTION",Sh[Sh.CONDITION=4]="CONDITION",(Ch=Mh||(Mh={}))[Ch.SUCCESS=1]="SUCCESS",Ch[Ch.FAILURE=2]="FAILURE",Ch[Ch.RUNNING=3]="RUNNING",Ch[Ch.ERROR=4]="ERROR",(Oh=Ph||(Ph={}))[Oh.GLOBAL=1]="GLOBAL",Oh[Oh.TREE=2]="TREE",Oh[Oh.NODE=3]="NODE",(Ih=Dh||(Dh={}))[Ih.LESSER=0]="LESSER",Ih[Ih.LESSER_OR_EQUAL=1]="LESSER_OR_EQUAL",Ih[Ih.EQUAL=2]="EQUAL",Ih[Ih.NOT_EQUAL=3]="NOT_EQUAL",Ih[Ih.GREATER=4]="GREATER",Ih[Ih.GREATER_OR_EQUAL=5]="GREATER_OR_EQUAL";class Rh{globalCtx={};treeCtx={};set(e,t,r,i){void 0===r&&void 0===i?this.globalCtx[e]=t:void 0===i?this.getTreeDictionnary(r)[e]=t:this.getNodeDictionnary(r,i)[e]=t}get(e,t,r){return void 0===t&&void 0===r?this.globalCtx[e]:void 0===r?this.getTreeDictionnary(t)[e]:this.getNodeDictionnary(t,r)[e]}getTreeDictionnary(e){let t=this.treeCtx[e];return void 0===t&&(t={nodeDictionnaries:[],openNodes:[],traversalDepth:0,traversalCycle:0},this.treeCtx[e]=t),t}getNodeDictionnary(e,t){let r=this.getTreeDictionnary(e),i=r.nodeDictionnaries[t];return void 0===i&&(i={},r.nodeDictionnaries[t]=i),i}}class Nh{_nodeCount=0;_openNodes=[];get openNodes(){return this._openNodes}get nodeCount(){return this._nodeCount}get context(){return this._context}get tree(){return this._tree}constructor(e,t,r){if(this._tree=e,this._context=t,this.userData=r,!t)throw new Error("Cannot construct!")}enterNode(e){}isOpen(e){return!0===this._context.get(Ah,this._tree.id,e.id)}openNode(e){this._nodeCount++,this._openNodes.push(e),this._context.set(Ah,!0,this._tree.id,e.id)}tickNode(e){}closeNode(e){this._openNodes.pop(),this._context.set(Ah,!1,this._tree.id,e.id)}exitNode(e){}}class Lh extends O{static seq=0;constructor(e){super(),this.category=e,this.id=Lh.seq++}execute(e){this._enter(e),e.isOpen(this)||this._open(e);let t=this._tick(e);return t!==Mh.RUNNING&&this._close(e),this._exit(e),t}_close(e){e.closeNode(this),this.close(e)}enter(e){}open(e){}close(e){}exit(e){}_enter(e){e.enterNode(this),this.enter(e)}_open(e){e.openNode(this),this.open(e)}_tick(e){return e.tickNode(this),this.tick(e)}_exit(e){e.exitNode(this),this.exit(e)}}class Fh{static seq=0;constructor(e,t){this.name=e,this.root=t,this.id=Fh.seq++}tick(e,t){let r=new Nh(this,e,t),i=this.root.execute(r),n=e.get(wh,this.id),a=r.openNodes.slice(0),o=0;for(let e=0;e<Math.min(n.length,a.length)&&(o=e+1,n[e]===a[e]);++e);for(let e=n.length-1;e>=o;--e)n[e]._close(r);return e.set(wh,a,this.id),e.set("nodeCount",r.nodeCount,this.id),i}}class Bh extends Lh{constructor(){super(kh.COMPOSITE)}}class Uh extends Lh{constructor(){super(kh.DECORATOR)}tick(e){return 1!==this.children.length?(console.log("ERROR : "+this.constructor.name+" should have only one child"),Mh.ERROR):this.internalTick(e)}}class zh extends Lh{constructor(){super(kh.CONDITION)}}class Hh extends Lh{constructor(){super(kh.ACTION)}}class jh extends Hh{tick(e){return Mh.ERROR}}class Vh extends Hh{tick(e){return Mh.FAILURE}}class Gh extends Hh{tick(e){return Mh.RUNNING}}class Kh extends Hh{tick(e){return Mh.SUCCESS}}class Wh extends Hh{constructor(e){super(),this.tickCount=e}tick(e){return this.tickCount--,this.tickCount<=0?Mh.SUCCESS:Mh.RUNNING}}class Yh extends Bh{constructor(e){if(super(),e)for(let t of e)this.addChild(t)}tick(e){for(let t of this.children){let r=t.execute(e);if(r!==Mh.FAILURE)return r}return Mh.FAILURE}}class Xh extends Bh{constructor(e){if(super(),e)for(let t of e)this.addChild(t)}tick(e){for(let t of this.children){let r=t.execute(e);if(r!==Mh.SUCCESS)return r}return Mh.SUCCESS}}const qh="runningChild";class Zh extends Bh{open(e){e.context.set(qh,0,e.tree.id,this.id)}tick(e){let t=e.context.get(qh,e.tree.id,this.id);for(;t<this.children.length;){let r=this.children[t].execute(e);if(r!==Mh.FAILURE)return r===Mh.RUNNING&&e.context.set(qh,t,e.tree.id,this.id),r;t++}return Mh.FAILURE}}class Jh extends Bh{open(e){e.context.set(qh,0,e.tree.id,this.id)}tick(e){let t=e.context.get(qh,e.tree.id,this.id);for(;t<this.children.length;){let r=this.children[t].execute(e);if(r!==Mh.SUCCESS)return r===Mh.RUNNING&&e.context.set(qh,t,e.tree.id,this.id),r;t++}return Mh.SUCCESS}}class Qh extends Uh{constructor(e){super(),e&&this.addChild(e)}internalTick(e){let t=this.children[0].execute(e);return t===Mh.SUCCESS?Mh.FAILURE:t===Mh.FAILURE?Mh.SUCCESS:t}}const $h="tickCount";class eu extends Uh{constructor(e,t){super(),this.maxTicks=e,t&&this.addChild(t)}open(e){e.context.set($h,0,e.tree.id,this.id)}internalTick(e){let t=e.context.get($h,e.tree.id,this.id);return t<this.maxTicks?(e.context.set($h,t+1,e.tree.id,this.id),this.children[0].execute(e)):Mh.FAILURE}}class tu extends Uh{constructor(e,t,r,i,n){super(),this.contextKey=e,this.contextLevel=t,this.value=r,this.operator=i,n&&this.addChild(n)}internalTick(e){let t;switch(this.contextLevel){default:case Ph.GLOBAL:t=e.context.get(this.contextKey);break;case Ph.TREE:t=e.context.get(this.contextKey,e.tree.id);break;case Ph.NODE:t=e.context.get(this.contextKey,e.tree.id,this.id)}return this.valueMatches(t,this.value,this.operator)?this.children[0].execute(e):Mh.FAILURE}valueMatches(e,t,r){if(void 0===t&&void 0===r)return void 0!==e;if(void 0===r)return e===t;switch(r){default:case Dh.EQUAL:return e===t;case Dh.NOT_EQUAL:return e!==t;case Dh.GREATER:return e>t;case Dh.GREATER_OR_EQUAL:return e>=t;case Dh.LESSER:return e<t;case Dh.LESSER_OR_EQUAL:return e<=t}}}let ru,iu,nu;new Function("try {return this===window;}catch(e){ return false;}");function au(){iu=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/120,(new Date).getTime())},ru=function(){let e=window.location.search.substring(1).split("&"),t={};for(let r of e){let e=r.split("=");2===e.length&&(t[e[0]]=decodeURIComponent(e[1].replace(/\+/g," ")))}return t}()}async function ou(e){iu(ou),await nu(e)}bh.registerClass(C),bh.registerClass(P),bh.registerClass(Lh),bh.registerClass(zh),bh.registerClass(Bh),bh.registerClass(Hh),bh.registerClass(Uh),bh.registerClass(Rh),bh.registerClass(Fh),bh.registerClass(Nh),bh.registerClass(Yh),bh.registerClass(Xh),bh.registerClass(Jh),bh.registerClass(Zh),bh.registerClass(jh),bh.registerClass(Vh),bh.registerClass(Gh),bh.registerClass(Kh),bh.registerClass(Wh),bh.registerClass(Qh),bh.registerClass(eu);class su extends B{constructor(){super(),this._expand=I.BOTH}}class lu{static runScene(e){lu.currentScene&&lu.currentScene.termHierarchy(),lu.currentScene=e,e.initHierarchy(),ru.debug&&(e.computeBoundingBox(),e.expand(sc.getConsole().width,sc.getConsole().height),e.logSceneGraph())}static getRunningScene(){return lu.currentScene}static pushScene(){lu.sceneStack.push(lu.currentScene)}static popScene(){lu.currentScene&&lu.currentScene.onTerm();let e=lu.sceneStack.pop();if(e)return lu.currentScene=e,lu.currentScene.onInit(),lu.currentScene;lc.critical("Cannot pop the last scene")}static sceneStack=[]}let hu,uu={},cu={},du={},fu={};function pu(e,t){let r=t?1:0,i=fu[e];i&&(i.rawValue=r,i.pressed=t,i.released=!t,t&&(hu=i.name))}function mu(e,t){let r=t?1:0,i=cu[e];i&&(i.rawValue=r,i.pressed=t,i.released=!t,t&&(hu=i.name))}function gu(e,t){"string"==typeof e?(lc.debug("   Umbra.Input : ascii button "+e),du[e.charCodeAt(0)]=t):"MouseButtonEnum"==typeof e?(lc.debug("   Umbra.Input : mouse button "+e),fu[e]=t):(lc.debug("   Umbra.Input : key button "+e),cu[e]=t)}function yu(e){let t={altNegativeButton:e.altNegativeButton,altPositiveButton:e.altPositiveButton,deadZone:e.deadZone,gravity:e.gravity,invert:e.invert,name:e.name,negativeButton:e.negativeButton,negativeDescription:e.negativeDescription,positiveButton:e.positiveButton,positiveDescription:e.positiveDescription,rawValue:0,sensitivity:e.sensitivity,snap:e.snap,type:e.type,value:0};uu[t.name]=t,lc.debug("Umbra.Input : new axis "+t.name+" type "+t.type),t.altNegativeButton&&gu(t.altNegativeButton,t),t.altPositiveButton&&gu(t.altPositiveButton,t),t.positiveButton&&gu(t.positiveButton,t),t.negativeButton&&gu(t.negativeButton,t)}class vu{static registerEventListener(e,t){vu.listeners[t]||(vu.listeners[t]=new Array),vu.addListener(e,vu.listeners[t])}static unregisterEventListener(e,t){if(vu.listeners[t]){let r=vu.listeners[t].indexOf(e);r>-1&&vu.listeners[t].splice(r,1)}}static publishEvent(e,t){if(vu.listeners[e])for(let r of vu.listeners[e])vu.processEvent(e,r,t)}static processEvent(e,t,r){let i=vu.eventTypeToCallback(e),n=t[i];n&&"function"==typeof n?void 0!==r?n.call(t,r):n.call(t):e===y?console.log("Warning : object type "+(t.className||"unknown")+" does not implement handler "+i+" for event "+e):lc.warn("Warning : object type "+(t.className||"unknown")+" does not implement handler "+i+" for event "+e)}static eventTypeToCallback(e){return"on"+e.toLowerCase().replace(/(\b|_)\w/g,(function(e){return e.toUpperCase().replace(/_/,"")}))}static listeners={};static addListener(e,t){let r=0;if(e.node){let i=t.length;do{let i=t[r].node;if(i&&i.getZOrder()<=e.node.getZOrder())break;r++}while(r<i)}t.splice(r-1,0,e)}}let bu,xu={buttons:[],cellPos:new C,hasMoved:!1,pixelPos:new C},_u={},Tu={},Eu=new C,Au=new C;function wu(){return xu.cellPos}function ku(e){return!!xu.buttons[e]&&xu.buttons[e].released}function Su(){for(let e=0,t=xu.buttons.length;e<t;++e)xu.buttons[e]&&(xu.buttons[e].pressed=!1,xu.buttons[e].released=!1);for(let e in _u)_u.hasOwnProperty(e)&&(_u[e].pressed=!1,_u[e].released=!1);for(let e in Tu)Tu.hasOwnProperty(e)&&(Tu[e]=!1);!function(){for(let e in uu)uu.hasOwnProperty(e)&&(uu[e].pressed&&(uu[e].pressed=!1),uu[e].released&&(uu[e].released=!1));for(let e in du)du.hasOwnProperty(e)&&(du[e].rawValue=0);hu=void 0}(),xu.hasMoved=!1}function Mu(e){var t;xu.buttons[e.which]?(xu.buttons[e.which].pressed=!0,xu.buttons[e.which].released=!1,xu.buttons[e.which].status=!0):xu.buttons[e.which]={pressed:!0,released:!1,status:!0},Eu.set(xu.pixelPos),Au.set(xu.cellPos),t=T.LEFT,xu.buttons[t]&&xu.buttons[t].status&&vu.publishEvent(v,{startCellPos:Au,startPos:Eu}),pu(e.which,!0)}function Cu(e){xu.buttons[e.which]?(xu.buttons[e.which].pressed=!1,xu.buttons[e.which].released=!0,xu.buttons[e.which].status=!1):xu.buttons[e.which]={pressed:!1,released:!0,status:!1},xu.pixelPos.equals(Eu)?vu.publishEvent(b):vu.publishEvent(x,{startCellPos:Au,startPos:Eu}),pu(e.which,!1)}function Pu(e){Tu[e.charCode]=!0,function(e){let t=du[e];t&&(t.rawValue=1,t.pressed=!0,t.released=!1,hu=t.name)}(e.charCode)}function Ou(e){_u[e.keyCode]?(_u[e.keyCode].pressed=!0,_u[e.keyCode].released=!1,_u[e.keyCode].status=!0):_u[e.keyCode]={pressed:!0,released:!1,status:!0},mu(e.keyCode,!0),e.shiftKey||e.altKey||e.ctrlKey||e.preventDefault()}function Du(e){_u[e.keyCode]?(_u[e.keyCode].pressed=!1,_u[e.keyCode].released=!0,_u[e.keyCode].status=!1):_u[e.keyCode]={pressed:!1,released:!0,status:!1},mu(e.keyCode,!1),e.preventDefault()}var Iu;let Ru,Nu;function Lu(){return Ru}function Fu(e,t,r,i,n=!1){let a=sc.getConsole().height-1;if(r<0||r>a)return;let o=sc.getConsole().width-1;t+i>o&&(i=o-t),t<0&&(i+=t,t=0),Bu(e,t,r,i,n)}function Bu(e,t,r,i,n=!1){let a=sc.getConsole().width-1,o=sc.getConsole().height-1,s=[],l=[];if(n)for(let n=t;n<t+i;++n)(e.text[n][r]===G||e.text[n][r]===W||e.text[n][r]===V||e.text[n][r]===j||e.text[n][r]===H||r>0&&e.text[n][r-1]===H)&&(s[n-t]=!0),(e.text[n][r]===K||e.text[n][r]===W||e.text[n][r]===V||e.text[n][r]===j||e.text[n][r]===H||r<o&&e.text[n][r+1]===H)&&(l[n-t]=!0);for(let a=t;a<t+i;++a){let i=a-t;n?s[i]&&l[i]?e.text[a][r]=W:s[i]?e.text[a][r]=G:l[i]?e.text[a][r]=K:e.text[a][r]=z:e.text[a][r]=z}n&&(t-1>=0&&t-1<=a&&(e.text[t-1][r]===j?e.text[t-1][r]=W:e.text[t-1][r]===H&&(e.text[t-1][r]=V)),t+i>=0&&t+i<=a&&(e.text[t+i][r]===V?e.text[t+i][r]=W:e.text[t+i][r]===H&&(e.text[t+i][r]=j)))}function Uu(e,t,r,i,n=!1){let a=sc.getConsole().width-1,o=sc.getConsole().height-1,s=[],l=[];if(n)for(let n=r;n<r+i;++n)(e.text[t][n]===j||e.text[t][n]===W||e.text[t][n]===G||e.text[t][n]===K||e.text[t][n]===z||t>0&&e.text[t-1][n]===z)&&(s[n-r]=!0),(e.text[t][n]===V||e.text[t][n]===W||e.text[t][n]===G||e.text[t][n]===K||e.text[t][n]===z||t<a&&e.text[t+1][n]===z)&&(l[n-r]=!0);for(let a=r;a<r+i;++a){let i=a-r;n?s[i]&&l[i]?e.text[t][a]=W:s[i]?e.text[t][a]=j:l[i]?e.text[t][a]=V:e.text[t][a]=H:e.text[t][a]=H}n&&(r-1>=0&&r-1<=o&&(e.text[t][r-1]===G?e.text[t][r-1]=W:e.text[t][r-1]===z&&(e.text[t][r-1]=K)),r+i>=0&&r+i<=o&&(e.text[t][r+i]===K?e.text[t][r+i]=W:e.text[t][r+i]===z&&(e.text[t][r+i]=G)))}function zu(e,t){return e>=0&&t>=0&&e<sc.getConsole().width&&t<sc.getConsole().height}function Hu(e,t,r,i,n,a){if(e.clearBack(Lu().color.background,t,r,i,n),e.clearFore(Lu().color.foregroundDisabled,t,r,i,n),e.clearText(32,t+1,r+1,i-2,n-2),function(e,t,r,i,n){let a=sc.getConsole().width,o=sc.getConsole().height;t+i<=0||t>a||r+n<=0||r>o||(t+i>a&&(i=a-t),t<0&&(i+=t,t=0),r+n>o&&(n=o-r),r<0&&(n+=r,r=0),zu(t,r)&&(e.text[t][r]=218),zu(t+i-1,r)&&(e.text[t+i-1][r]=191),zu(t,r+n-1)&&(e.text[t][r+n-1]=192),zu(t+i-1,r+n-1)&&(e.text[t+i-1][r+n-1]=217),Bu(e,t+1,r,i-2),Bu(e,t+1,r+n-1,i-2),Uu(e,t,r+1,n-2),Uu(e,t+i-1,r+1,n-2))}(e,t,r,i,n),a){let n=a.length,o=t+Math.floor((i-n)/2);zu(o-1,r)&&(e.text[o-1][r]=j),zu(o+n,r)&&(e.text[o+n][r]=V),e.print(o,r,a,Lu().color.titleForeground)}}var ju;(Iu=bu||(bu={}))[Iu.MODAL_SHOW=1]="MODAL_SHOW",Iu[Iu.MODAL_HIDE=2]="MODAL_HIDE",(ju=Nu||(Nu={}))[ju.LEFT=1]="LEFT",ju[ju.RIGHT=2]="RIGHT",ju[ju.CENTER=3]="CENTER";class Vu extends B{static getActiveModal(){return Vu.activeModal}static modalStack=[];enableEvents=!0;modal=!1;constructor(){super(),this.setZOrder(1)}isModal(){return this.modal||void 0!==this.__parent&&void 0!==this.__parent.isModal&&this.__parent.isModal()}isActive(){return void 0===Vu.activeModal||this.modal&&this===Vu.activeModal||void 0!==this.__parent&&void 0!==this.__parent.isActive&&this.__parent.isActive()}show(){this.modal&&(Vu.activeModal&&Vu.modalStack.push(Vu.activeModal),Vu.activeModal=this,vu.publishEvent(bu[bu.MODAL_SHOW],this)),super.show()}hide(){this.modal&&(Vu.activeModal=Vu.modalStack.pop(),vu.publishEvent(bu[bu.MODAL_HIDE],this)),super.hide()}onTerm(){super.onTerm(),this.showEventType&&vu.unregisterEventListener(this,this.showEventType)}showOnEventType(e,t){vu.registerEventListener(this,e),this.showEventType=e,this[vu.eventTypeToCallback(e)]=function(e){this.show(),t&&t(e)}.bind(this)}setModal(){this.modal=!0}}class Gu extends Vu{constructor(){super()}init(e,t){this.boundingBox=new P(0,0,e,t),this.__console=new Y(e,t)}get console(){return this.__console}resize(e,t){super.resize(e,t),this.__console=new Y(e,t)}onRender(e){let t=new C;this.local2Abs(t),this.__console.blit(e,t.x,t.y)}}class Ku extends Vu{constructor(e){super(),this.label=e,this.boundingBox.h=1}onRender(e){let t=new C(0,this.boundingBox.y);this.__parent.local2Abs(t);let r=this.getParentBoundingBox(),i=r?r.w:0;if(e.clearBack(Lu().color.background,t.x,t.y,i,1),e.clearFore(Lu().color.foregroundDisabled,t.x,t.y,i,1),Fu(e,t.x,t.y,i,!0),this.label){let r=this.label.length,n=t.x+Math.floor((i-r)/2);zu(n-1,t.y)&&(e.text[n-1][t.y]=j),zu(n+r,t.y)&&(e.text[n+r][t.y]=V),e.print(n,t.y,this.label,Lu().color.titleForeground)}}computeBoundingBox(){this.boundingBox.w=this.label?this.label.length+2:0,this.boundingBox.h=1}}class Wu extends Vu{constructor(e){super(),this.options=e,void 0!==e.expand&&(this._expand=e.expand)}getOptions(){return this.options}computeBoundingBox(){super.computeBoundingBox(),this.options.minWidth&&this.boundingBox.w<this.options.minWidth&&(this.boundingBox.w=this.options.minWidth),this.options.minHeight&&this.boundingBox.h<this.options.minHeight&&(this.boundingBox.h=this.options.minHeight)}}class Yu extends Wu{static isDragging(){return void 0!==Yu.drag}static resetDrag(){Yu.drag=void 0}static get draggedWidget(){return Yu.drag}static startDrag=new C;static dragPos=new P;static dragPixelPos=new P;constructor(e){super(e),void 0===this._expand&&(this._expand=I.BOTH)}getDragPos(){return this===Yu.drag?Yu.dragPos:this.boundingBox}getDragPixelPos(){if(this===Yu.drag)return Yu.dragPixelPos}onInit(){super.onInit(),vu.registerEventListener(this,v),vu.registerEventListener(this,b),vu.registerEventListener(this,x)}onTerm(){vu.unregisterEventListener(this,v),vu.unregisterEventListener(this,b),vu.unregisterEventListener(this,x),super.onTerm()}onStartDrag(e){if(this.isVisible()&&this.isActive()&&this.containsAbsolute(wu())){Yu.drag=this,Yu.dragZOrder=this.getZOrder(),Yu.startDrag.set(wu()),Yu.dragPos.set(this.boundingBox),this.setZOrder(1e3),Su();let e=this.getOptions().startDragCallback;e&&e(this,this.getOptions().data)}}onEndDrag(e){if(this===Yu.drag){Su();let t=this.getOptions().endDragCallback;t&&t(this,this.getOptions().data),this.onCancelDrag(e),vu.publishEvent(_,this)}}onCancelDrag(e){this===Yu.drag&&(this.setZOrder(Yu.dragZOrder),Yu.drag=void 0)}onPreRender(){this.swapDragAndBox()}onPostRender(){this.swapDragAndBox()}onUpdate(e){if(Yu.drag===this){let e=wu().clone();Yu.dragPos.x=e.x+this.boundingBox.x-Yu.startDrag.x,Yu.dragPos.y=e.y+this.boundingBox.y-Yu.startDrag.y;let t=sc.getConsole().width-this.boundingBox.w,r=sc.getConsole().height-this.boundingBox.h,i=new C(-this.boundingBox.x,-this.boundingBox.y);this.local2Abs(i),Yu.dragPos.x=L(Yu.dragPos.x,-i.x,t-i.x),Yu.dragPos.y=L(Yu.dragPos.y,-i.y,r-i.y),void 0!==this.options.minDragX&&Yu.dragPos.x<this.options.minDragX?Yu.dragPos.x=this.options.minDragX:void 0!==this.options.maxDragX&&Yu.dragPos.x>this.options.maxDragX&&(Yu.dragPos.x=this.options.maxDragX),void 0!==this.options.minDragY&&Yu.dragPos.y<this.options.minDragY?Yu.dragPos.y=this.options.minDragY:void 0!==this.options.maxDragY&&Yu.dragPos.y>this.options.maxDragY&&(Yu.dragPos.y=this.options.maxDragY);let n=xu.pixelPos;Yu.dragPixelPos.x=n.x,Yu.dragPixelPos.y=n.y}}swapDragAndBox(){if(Yu.drag===this){let e=this.boundingBox;this.boundingBox=Yu.dragPos,Yu.dragPos=e}}}class Xu extends Wu{constructor(e){super(e),void 0===this._expand&&(this._expand=I.BOTH)}onInit(){super.onInit(),vu.registerEventListener(this,_)}onTerm(){vu.unregisterEventListener(this,_),super.onTerm()}onDrop(e){this.isVisible()&&this.isActive()&&!this.contains(e)&&this.containsAbsolute(wu())&&this.options.dropCallback&&this.options.dropCallback(e,this,this.options.data)}onPostRender(e){if(Yu.isDragging()&&this.isActive()){let t=new C(this.boundingBox.x,this.boundingBox.y);this.__parent.local2Abs(t),e.clearBack(Lu().color.backgroundActive,t.x,t.y,this.boundingBox.w,this.boundingBox.h)}}}class qu extends Wu{constructor(e){super(e),void 0===this._expand&&(this._expand=I.HORIZONTAL)}toString(){return this.constructor.name+"("+this.options.label+"):"+this.boundingBox.toString()}onRender(e){let t=new C(this.boundingBox.x,this.boundingBox.y);this.__parent.local2Abs(t),this.renderWithColor(e,t,Lu().color.foregroundDisabled,Lu().color.background),this.options.postRender&&this.options.postRender(e,t.x,t.y,this.options,!1)}computeBoundingBox(){this.boundingBox.w=this.options.label.length,this.boundingBox.h=1}renderWithColor(e,t,r,i){e.clearBack(i,t.x,t.y,this.boundingBox.w,this.boundingBox.h),e.clearText(32,t.x,t.y,this.boundingBox.w,this.boundingBox.h);let n=0;switch(this.options.textAlign){case Nu.RIGHT:n=this.boundingBox.w-this.options.label.length;break;case Nu.CENTER:n=Math.floor((this.boundingBox.w-this.options.label.length)/2)}e.print(t.x+n,t.y,this.options.label,r)}}class Zu extends qu{constructor(e){super(e)}onRender(e){let t=new C(this.boundingBox.x,this.boundingBox.y);this.__parent.local2Abs(t),this.active=this.isActive()&&this.containsAbsolute(wu()),this.renderWithColor(e,t,this.active?Lu().color.foregroundActive:Lu().color.foreground,this.active?Lu().color.backgroundActive:Lu().color.background),this.options.postRender&&this.options.postRender(e,t.x,t.y,this.options,this.active)}onUpdate(e){if(this.active=this.isActive()&&this.containsAbsolute(wu()),this.pressed=this.active&&ku(T.LEFT),this.pressed||this.options.asciiShortcut&&("string"==typeof(t=this.options.asciiShortcut)?Tu[t.charCodeAt(0)]:Tu[t])){Su();let e=!0;this.options.callback&&(e=this.options.callback(this.options.eventData)),e&&(this.options.autoHideWidget&&this.options.autoHideWidget.hide(),this.options.eventType&&vu.publishEvent(this.options.eventType,this.options?this.options.eventData:void 0))}var t}}class Ju extends Wu{constructor(e){super(e),void 0===e.minWidth&&(this.options.minWidth=10),this.options.minHeight=1}getValue(){return this.value}setValue(e){this.value=e,this.value=L(this.value,this.options.minValue,this.options.maxValue);let t=Math.floor((this.boundingBox.w-1)*(this.value-this.options.minValue)/(this.options.maxValue-this.options.minValue));this.draggable.moveTo(t,this.draggable.getBoundingBox().y),this.setSliderCharacter()}onInit(){this.dragButton=new Zu({expand:I.NONE,label:String.fromCharCode(V)}),this.draggable=new Yu({endDragCallback:this.endDragCallback.bind(this),maxDragX:(this.options.minWidth||1)-1,maxDragY:0,minDragX:0,minDragY:0}),this.addChild(this.draggable).addChild(this.dragButton),this.value=this.options.minValue}onRender(e){let t=new C(this.boundingBox.x,this.boundingBox.y);this.__parent.local2Abs(t),e.clearText(0,t.x,t.y,this.boundingBox.w,1),Fu(e,t.x,t.y,this.boundingBox.w)}onUpdate(e){if(Yu.draggedWidget===this.draggable){let e=new C(this.boundingBox.x,this.boundingBox.y);this.__parent.local2Abs(e);let t=sc.getConsole().getPixelPositionFromCell(e.x+this.boundingBox.w,e.y),r=sc.getConsole().getPixelPositionFromCell(e.x,e.y),i=this.draggable.getDragPixelPos();this.setSliderCharacter(),this.value=this.options.minValue+(this.options.maxValue+1-this.options.minValue)*(i.x-r.x)/(t.x-r.x),this.value=L(this.value,this.options.minValue,this.options.maxValue)}}setSliderCharacter(){0===this.draggable.getDragPos().x?this.dragButton.getOptions().label=String.fromCharCode(V):this.draggable.getDragPos().x===this.boundingBox.w-1?this.dragButton.getOptions().label=String.fromCharCode(j):this.dragButton.getOptions().label=String.fromCharCode(W)}endDragCallback(e,t){e.moveTo(e.getDragPos())}}class Qu extends Wu{constructor(e){super(e),void 0===e.hPadding&&(this.options.hPadding=0),void 0===e.wPadding&&(this.options.wPadding=0)}computeBoundingBox(){super.computeBoundingBox(),this.boundingBox.h+=this.options.hPadding||0,this.boundingBox.w+=this.options.wPadding||0}addChild(e){let t=super.addChild(e);return e instanceof B&&e.moveTo(this.options.wPadding||0,this.options.hPadding||0),t}expandChildren(e,t){for(let r of this.children)r.expand(e-2*(this.options.wPadding||0),t-2*(this.options.hPadding||0))}}class $u extends Qu{constructor(e){super(e),(!this.options.hPadding||this.options.hPadding<1)&&(this.options.hPadding=1),(!this.options.wPadding||this.options.wPadding<1)&&(this.options.wPadding=1),void 0===this.options.minHeight&&(this.options.minHeight=1)}onInit(){super.onInit();let e=this.options;e.leftButton&&(this.leftButton=this.addChild(new Zu(e.leftButton)),this.leftButton.setExpandFlag(I.NONE)),e.rightButton&&(this.rightButton=this.addChild(new Zu(e.rightButton)),this.rightButton.setExpandFlag(I.NONE))}onRender(e){let t=new C;this.local2Abs(t);let r=this.options;Hu(e,t.x,t.y,this.boundingBox.w,this.boundingBox.h,r.title),r.footer&&e.print(Math.floor(t.x+(this.boundingBox.w-r.footer.length)/2),t.y+this.boundingBox.h-1,r.footer)}computeBoundingBox(){this.leftButton&&this.leftButton.hide(),this.rightButton&&this.rightButton.hide(),super.computeBoundingBox();let e=this.options,t=e.title?e.title.length:0;this.boundingBox.w=Math.max(t+4,this.boundingBox.w);let r=e.footer?e.footer.length:0;this.boundingBox.w=Math.max(r+2,this.boundingBox.w),this.leftButton&&(this.leftButton.show(),this.leftButton.moveTo(Math.floor(this.boundingBox.w/4-this.leftButton.getBoundingBox().w/2),this.boundingBox.h-1)),this.rightButton&&(this.rightButton.show(),this.rightButton.moveTo(Math.floor(3*this.boundingBox.w/4-this.rightButton.getBoundingBox().w/2),this.boundingBox.h-1))}}class ec extends Qu{constructor(e){super(e),void 0===this._expand&&(this._expand=I.BOTH)}onUpdate(e){let t;var r;this.options&&(t=this.options.cancelAction),r=Lu().input.cancelAxisName,uu[r]&&uu[r].pressed&&(t&&!t()||this.__parent.hide(),Su())}}class tc extends Qu{constructor(e){super(e),void 0===this._expand&&(this._expand=I.HORIZONTAL)}computeBoundingBox(){super.computeBoundingBox();let e=this.options.hPadding||0;for(let t of this.children)t.moveTo(this.options.wPadding||0,e),t.getVisibleFlag()&&(e+=t.getBoundingBox().h);this.boundingBox.h=2*e,this.options.minHeight&&this.boundingBox.h<this.options.minHeight&&(this.boundingBox.h=this.options.minHeight)}addChild(e){let t=super.addChild(e);return this.computeBoundingBox(),t}expandChildren(e,t){super.expandChildren(e,0)}}class rc extends Qu{constructor(e){super(e),void 0===this._expand&&(this._expand=I.VERTICAL)}computeBoundingBox(){super.computeBoundingBox();let e=this.options.wPadding||0;for(let t of this.children)t.moveTo(e,this.options.hPadding||0),t.getVisibleFlag()&&(e+=t.getBoundingBox().w);this.boundingBox.w=2*e,this.options.minWidth&&this.boundingBox.w<this.options.minWidth&&(this.boundingBox.w=this.options.minWidth)}addChild(e){let t=super.addChild(e);return this.computeBoundingBox(),t}expandChildren(e,t){super.expandChildren(0,t)}}class ic{static DEFAULT_OPTIONS={consoleHeight:34,consoleWidth:80,defaultBackgroundColor:f,defaultForegroundColor:p,fontFileName:g,renderDivSelector:m,ticksPerSecond:120};_gameTime=0;_elapsedTime=0;paused=!1;dirtyFrame=!0;getConsole(){return this.console}get gameTime(){return this._gameTime}get elapsedTime(){return this._elapsedTime}run(e,t=ic.DEFAULT_OPTIONS){var r,i,n,o,s,l;a(window).focus(this.onGainFocus.bind(this)),a(window).blur(this.onLoseFocus.bind(this)),this.options={backgroundAnimation:t.backgroundAnimation||false,consoleHeight:t.consoleHeight?t.consoleHeight:34,consoleWidth:t.consoleWidth?t.consoleWidth:80,defaultBackgroundColor:t.defaultBackgroundColor||f,defaultForegroundColor:t.defaultForegroundColor||p,fontFileName:t.fontFileName?t.fontFileName:g,renderDivSelector:t.renderDivSelector?t.renderDivSelector:m,ticksPerSecond:t.ticksPerSecond?t.ticksPerSecond:120},ru.font&&(this.options.fontFileName=ru.font),this.dirtyFrame=!0,this.tickLength=1/(this.options.ticksPerSecond||1),this.console=(r=this.options.consoleWidth||80,i=this.options.consoleHeight||34,n=this.options.defaultForegroundColor||p,o=this.options.defaultBackgroundColor||f,s=this.options.renderDivSelector||m,l=this.options.fontFileName||g,"yendor/div"===ru.renderer?new Y(r,i,n,o,new uh(s)):new Y(r,i,n,o,new hh(n,o,s,l,ru.renderer))),lu.runScene(e),async function(e){nu=e,iu(ou)}((async e=>await this.onNewFrame(e)))}onLoseFocus(){this.paused=!0}onGainFocus(){this.paused=!1,Su()}rendering=!1;async onNewFrame(e){try{this._elapsedTime=e-this._gameTime;let t=lu.getRunningScene();this._elapsedTime>=this.tickLength&&(this._gameTime=e,this.paused||(this.rendering?await t.updateHierarchyForType(e,Vu):(this.rendering=!0,await t.updateHierarchy(e),this.rendering=!1),t.computeBoundingBox(),t.expand(this.console.width,this.console.height),Su(),this.dirtyFrame=!0)),t.renderHierarchy(this.console),this.console.render(),this.options.backgroundAnimation||(this.dirtyFrame=!1)}catch(e){console.log(e.stack),lc.critical(e.fileName+":"+e.lineNumber+"\n"+e.message)}}}let nc;var ac;(ac=nc||(nc={}))[ac.DEBUG=1]="DEBUG",ac[ac.INFO=2]="INFO",ac[ac.WARN=3]="WARN",ac[ac.ERROR=4]="ERROR",ac[ac.CRITICAL=5]="CRITICAL";class oc{static colors=["#CCCCCC","#000000","#FFDD66","#FF3333","#FF0000"];enableEvents=!0;onLog(e){console.log("%c"+e.text,"color:"+oc.colors[e.level])}}let sc,lc=new class extends class{debug(e){this.isDebugEnabled()&&this.log(nc.DEBUG,e)}info(e){this.log(nc.INFO,e)}warn(e){this.log(nc.WARN,e)}error(e){this.log(nc.ERROR,e)}critical(e){this.log(nc.CRITICAL,e)}isDebugEnabled(){return ru&&void 0!==ru.debug}}{log(e,t){vu.publishEvent(y,{level:e,text:t})}};function hc(e){return au(),vu.registerEventListener(new oc,y),sc=e,e&&(a(document).keydown(Ou),a(document).keypress(Pu),a(document).keyup(Du),a(document).mousemove((e=>function(e,t){xu.pixelPos.x=e.pageX,xu.pixelPos.y=e.pageY,t&&t.getPositionFromPixels(e.pageX,e.pageY,xu.cellPos),xu.hasMoved=!0}(e,sc.getConsole()))),a(document).mousedown(Mu),a(document).mouseup(Cu)),sc}const uc=14737663,cc=.25,dc=10,fc="right hand",pc="left hand",mc="body",gc="head",yc="legs",vc="boots",bc="hands",xc="quiver",_c="actors",Tc="actorsSeq",Ec="LIGHT_ONOFF";let Ac;var wc;(wc=Ac||(Ac={}))[wc.NOACTION=1]="NOACTION",wc[wc.MOVE_NORTH=2]="MOVE_NORTH",wc[wc.MOVE_SOUTH=3]="MOVE_SOUTH",wc[wc.MOVE_EAST=4]="MOVE_EAST",wc[wc.MOVE_WEST=5]="MOVE_WEST",wc[wc.MOVE_UP=6]="MOVE_UP",wc[wc.MOVE_DOWN=7]="MOVE_DOWN",wc[wc.WAIT=8]="WAIT",wc[wc.GRAB=9]="GRAB",wc[wc.USE_ITEM=10]="USE_ITEM",wc[wc.SACRIFICE_ITEM=11]="SACRIFICE_ITEM",wc[wc.DROP_ITEM=12]="DROP_ITEM",wc[wc.THROW_ITEM=13]="THROW_ITEM",wc[wc.FIRE=14]="FIRE",wc[wc.ZAP=15]="ZAP",wc[wc.SELECT_TILE=16]="SELECT_TILE",wc[wc.SELECT_ITEM=17]="SELECT_ITEM",wc[wc.VALIDATE=18]="VALIDATE",wc[wc.AUTOEXPLORE=19]="AUTOEXPLORE",wc[wc.AUTOFIGHT=20]="AUTOFIGHT",wc[wc.AUTODOWN=21]="AUTODOWN",wc[wc.AUTOUP=22]="AUTOUP",wc[wc.CANCEL=23]="CANCEL";let kc=function(){if(hu)return Ac[hu]},Sc=function(e){let t=new C(0,0);switch(e){case Ac.MOVE_NORTH:t.y=-1;break;case Ac.MOVE_SOUTH:t.y=1;break;case Ac.MOVE_EAST:t.x=1;break;case Ac.MOVE_WEST:t.x=-1}return t},Mc=function(e,t,r,i,n){let a=e;return t&&(a=a.replace(/\[The actor1\'s\] /g,t.getThenames()),a=a.replace(/ \[the actor1\'s\] /g,t.getthenames()),a=a.replace(/\[The actor1\]/g,t.getThename()),a=a.replace(/ \[the actor1\]/g,t.getthename()),a=a.replace(/\[A actor1\]/g,t.getAname()),a=a.replace(/ \[a actor1\]/g,t.getaname()),a=a.replace(/\[s\]/g,t.getVerbEnd()),a=a.replace(/ \[it\]/g,t.getit()),a=a.replace(/ \[its\] /g,t.getits()),a=a.replace(/ \[is\]/g,t.getis())),r&&(a=a.replace(/\[The actor2\'s\] /g,r.getThenames()),a=a.replace(/ \[the actor2\'s\] /g,r.getthenames()),a=a.replace(/\[The actor2\]/g,r.getThename()),a=a.replace(/ \[the actor2\]/g,r.getthename()),a=a.replace(/\[A actor2\]/g,r.getAname()),a=a.replace(/ \[a actor2\]/g,r.getaname()),a=a.replace(/\[s2\]/g,r.getVerbEnd()),a=a.replace(/ \[it2\]/g,r.getit()),a=a.replace(/ \[its2\] /g,r.getits()),a=a.replace(/ \[is2\]/g,r.getis())),void 0!==i&&(a=a.replace(/\[value1\]/g,""+i)),void 0!==n&&(a=a.replace(/\[value2\]/g,""+n)),a};const Cc=-1;class Pc{get id(){return this._id}constructor(e){this._id=e}equals(e){return this._id===e.id}}class Oc extends Pc{gut=!1;constructor(e,t,r){super(e),this.pos=t,this.sector1Id=r}isDummy(){return void 0===this.sector2Id}getDescription(){return(this.gut?"gut ":"")+"connector "+this.id+" : "+this.pos.x+"-"+this.pos.y+" between "+this.sector1Id+" and "+this.sector2Id}}class Dc extends Pc{cellCount=0;connectors=[];deadEnd=!0;constructor(e,t){super(e),this.seed=t}isDeadEnd(){return this.deadEnd}getDescription(){return(this.deadEnd?"dead end ":"")+"sector "+this.id+" : "+this.seed.x+"-"+this.seed.y+" ("+this.cellCount+" cells)"}addConnector(e){-1===this.connectors.indexOf(e)?(this.connectors.push(e),this.deadEnd&&(this.deadEnd=this.connectors.length<2)):this.deadEnd=!1}}class Ic{objectMap=[];objects=[];_sectors=[];_connectors=[];_puzzle=[];get puzzle(){return this._puzzle}get sectors(){return this._sectors}get connectors(){return this._connectors}constructor(e,t){this.width=e,this.height=t;for(let r=0;r<e;++r){this.objectMap[r]=[];for(let e=0;e<t;++e)this.objectMap[r][e]=Cc}}createSector(e){let t=new Dc(this.objects.length,e);return this.objects.push(t),this._sectors.push(t),t}createConnector(e,t){let r=new Oc(this.objects.length,e,t);return this.objects.push(r),this._connectors.push(r),r}getObjectId(e){return this.objectMap[e.x][e.y]}setObjectId(e,t){this.objectMap[e.x][e.y]=t}getSector(e){return e instanceof C?this.getSectorFromPosition(e):this.getSectorFromId(e)}getConnector(e){return e instanceof C?this.getConnectorFromPos(e):this.getConnectorFromId(e)}getRandomPositionInSector(e,t){let r=new C(-1,0),i=this.getSectorFromId(e),n=t.getNumber(1,i.cellCount);do{do{r.x++,r.x===this.width&&(r.x=0,r.y++,r.y===this.height&&(r.y=0))}while(this.objectMap[r.x][r.y]!==e);n--}while(n>0);return r}computePath(e,t){let r=[],i=[],n=new mh((e=>r[e.id]));r[e]=0,i[e]=void 0,n.push(this.objects[e]);let a=n.pop();for(;a&&a.id!==t;){for(let e of a.connectors){let t=this.objects[e];if(void 0===t.lock){let e=t.sector1Id===a.id?t.sector2Id:t.sector1Id,o=r[a.id]+1;if(void 0===r[e]||r[e]>o){let t=this.objects[e];r[e]=o,i[e]=a.id,n.contains(t)||n.push(t)}}}a=n.pop()}let o=[],s=t;for(;void 0!==s&&void 0!==i[s];)o.splice(0,0,s),s=i[s];return o.splice(0,0,e),o}findFarthestSector(e,t=!1){let r=1,i=Cc;for(let n of this._sectors)if(n.id!==e&&(n.isDeadEnd()||!t)){let t=this.computePath(e,n.id).length;t>r&&(r=t,i=n.id)}return i}findFarthestDeadEnd(e){return this.findFarthestSector(e,!0)}getSectorFromId(e){let t=this.objects[e];if(!(t instanceof Dc))throw"TopologyMap : object "+e+" is not a sector";return t}getSectorFromPosition(e){return this.getSectorFromId(this.objectMap[e.x][e.y])}getConnectorFromId(e){let t=this.objects[e];if(!(t instanceof Oc))throw"TopologyMap : object "+e+" is not a connector";return t}getConnectorFromPos(e){return this.getConnectorFromId(this.objectMap[e.x][e.y])}}class Rc{sectorSeeds=[];findDungeonExits(e,t,r=!1){let i=0;for(let n of this.topologyMap.sectors)if(r||n.isDeadEnd()){let r=this.topologyMap.findFarthestSector(n.id);if(r===Cc)continue;let a=this.topologyMap.computePath(n.id,r).length;if(a>i){i=a;let o=this.topologyMap.getSector(r);e.x=o.seed.x,e.y=o.seed.y,t.x=n.seed.x,t.y=n.seed.y}}if(0===i&&!r)return this.findDungeonExits(e,t,!0)}buildPuzzle(e,t,r=0){let i=this.topologyMap.computePath(t,e);if(1===i.length)return;let n,a=0,o=this.topologyMap.getSector(i[a]);a++;do{let e=this.topologyMap.getSector(i[a]);a++;for(let t of o.connectors){let r=this.topologyMap.getConnector(t);if(r.sector1Id===e.id||r.sector2Id===e.id){n=r,o=e;break}}}while(a<i.length&&(void 0===n||!n.gut));if(n&&n.gut){n.lock=r;let t=this.topologyMap.findFarthestSector(e);t!==Cc?(this.topologyMap.getSector(t).key=r,this.topologyMap.puzzle.push({connectorId:n.id,keySectorId:t}),e!==t&&this.buildPuzzle(e,t,r+1)):n.lock=void 0}}buildTopologyMap(e,t){for(this.topologyMap=new Ic(e.w,e.h),this.sectorSeeds.push(t);0!==this.sectorSeeds.length;){let t=this.sectorSeeds.shift();t&&this.topologyMap.getObjectId(t)===Cc&&this.floodFill(e,t.x,t.y)}return this.findGuts(),this.topologyMap}floodFill(e,t,r){let i=[],n=new C(t,r),a=this.topologyMap.createSector(n);for(this.topologyMap.setObjectId(n,a.id),a.cellCount++,i.push(n);0!==i.length;){let t=i.shift();if(!t)break;let r=t.getAdjacentCells(e.w,e.h);for(let n of r)if(!e.isWall(n.x,n.y)&&this.topologyMap.getObjectId(n)!==a.id)if(this.topologyMap.getObjectId(n)===Cc)e.canWalk(n.x,n.y)?(this.topologyMap.setObjectId(n,a.id),a.cellCount++,i.push(n)):n.x!==t.x&&n.y!==t.y||!this.hasDoor(e,n)||this.topologyMap.setObjectId(n,this.newConnector(t,n,a.id));else if(this.hasDoor(e,n)){let e=this.topologyMap.getConnector(n);e.sector1Id!==a.id&&void 0===e.sector2Id&&(e.sector2Id=a.id,this.topologyMap.getSector(e.sector1Id).addConnector(e.id),this.topologyMap.getSector(e.sector2Id).addConnector(e.id))}}}hasDoor(e,t){return e.actorList.filter((e=>e.pos.equals(t)&&e.isA("door[s]"))).length>0}newConnector(e,t,r){let i,n=this.topologyMap.createConnector(t,r);return e.x===t.x-1?i=new C(t.x+1,t.y):e.x===t.x+1?i=new C(t.x-1,t.y):e.y===t.y-1?i=new C(t.x,t.y+1):e.y===t.y+1&&(i=new C(t.x,t.y-1)),i&&this.sectorSeeds.push(i),n.id}findGuts(){for(let e of this.topologyMap.connectors)e.isDummy()||(e.gut=this.computeGut(e))}computeGut(e){let t=[],r=[];for(t.push(e.sector1Id);t.length>0;){let i=t.shift();if(void 0===i||i===e.sector2Id)return!1;r.push(i);let n=this.topologyMap.getSector(i);for(let i of n.connectors){let a=this.topologyMap.getConnector(i);a.id!==e.id&&(a.sector1Id!==n.id||a.isDummy()||-1!==r.indexOf(a.sector2Id)?a.sector2Id===n.id&&-1===r.indexOf(a.sector1Id)&&t.push(a.sector1Id):t.push(a.sector2Id))}}return!0}}let Nc;var Lc;let Fc;var Bc;let Uc;var zc;(Lc=Nc||(Nc={}))[Lc.NONE=1]="NONE",Lc[Lc.NORMAL=2]="NORMAL",Lc[Lc.DETECTED=3]="DETECTED",(Bc=Fc||(Fc={}))[Bc.DARKNESS=1]="DARKNESS",Bc[Bc.PENUMBRA=2]="PENUMBRA",Bc[Bc.LIGHT=3]="LIGHT",(zc=Uc||(Uc={}))[zc.NORMAL=1]="NORMAL",zc[zc.TRANSPARENCY=2]="TRANSPARENCY",zc[zc.LIGHTMAP=3]="LIGHTMAP",zc[zc.FOV=4]="FOV",zc[zc.ALL_SEEING_EYE=5]="ALL_SEEING_EYE";class Hc extends B{basePriority=0;__renderMode=Uc.NORMAL;constructor(e){super(),this.shader=e}getRenderMode(){return this.__renderMode}setRenderMode(e){this.__renderMode=e}initForNewMap(){this.shader.initForNewMap()}}class jc extends Hc{onRender(e){let t=vg.specialActors[gg.PLAYER];if(Gc.current&&t)switch(this.__renderMode){case Uc.NORMAL:this.renderNormal(e);break;case Uc.TRANSPARENCY:this.renderTransparency(e);break;case Uc.LIGHTMAP:this.renderLightmap(e);break;case Uc.FOV:this.renderFov(e);break;case Uc.ALL_SEEING_EYE:this.renderAllSeeingEye(e)}}getActorRenderMode(e,t){if(!e.fovOnly&&Gc.current.isExplored(e.pos.x,e.pos.y))return Nc.NORMAL;let r=vg.specialActors[gg.PLAYER];return t>0&&e.ai&&e.destructible&&!e.destructible.isDead()&&C.distance(r.pos,e.pos)<t?Nc.DETECTED:Gc.current.isInFov(e.pos.x,e.pos.y)?Nc.NORMAL:Nc.NONE}canIdentifyActor(e){return this.__renderMode===Uc.ALL_SEEING_EYE||this.shader.canIdentifyActor(e)}getCellLightLevel(e,t){return this.__renderMode===Uc.ALL_SEEING_EYE?Fc.LIGHT:this.shader.getCellLightLevel(e,t)}renderActor(e,t,r){let i=this.getActorRenderMode(t,r);if(i!==Nc.NONE){let r=t.pos;e.text[r.x][r.y]=this.__renderMode===Uc.ALL_SEEING_EYE?t.charCode:this.shader.getActorCharCode(t,i),e.fore[r.x][r.y]=this.__renderMode===Uc.ALL_SEEING_EYE?t.col:this.shader.getActorColor(t,i)}}renderActors(e){let t=vg.specialActors[gg.PLAYER].ai.getCondition(rm.DETECT_LIFE),r=t?t.range:0;for(let t of vg.list){if(t.pickable&&t.pickable.containerId)continue;let i=this.basePriority;t.isA("key[s]")?i+=2:t.isA("item[s]")?i++:t.isA("creature[s]")&&!t.destructible.isDead()&&(i+=3);let n=this.actorPriorityMap[t.pos.x][t.pos.y];(void 0===n||n<i)&&(this.renderActor(e,t,r),this.actorPriorityMap[t.pos.x][t.pos.y]=i)}this.basePriority+=3}renderMap(e){let t=Gc.current;this.actorPriorityMap||(this.actorPriorityMap=R(t.w));for(let r=0;r<t.w;r++)for(let i=0;i<t.h;i++)e.back[r][i]=this.shader.getBackgroundColor(t,r,i)}renderAllSeeingEye(e){let t=vg.specialActors[gg.PLAYER];e.clearText(),Gc.current.resetFov(!0),this.shader.prepareFrame(),this.renderMap(e),this.renderActors(e),Gc.current.setDirty(),Gc.current.computeFov(t.pos.x,t.pos.y,1+t.xpHolder.xpLevel)}renderNormal(e){let t=vg.specialActors[gg.PLAYER];e.clearText(),Gc.current.computeFov(t.pos.x,t.pos.y,1+t.xpHolder.xpLevel),this.shader.prepareFrame(),this.renderMap(e),this.renderActors(e)}renderTransparency(e){e.clearText(),e.clearBack(0),e.clearFore(0);let t=Gc.current;for(let r=0;r<t.w;r++)for(let i=0;i<t.h;i++)e.back[r][i]=t.fov.isTransparent(r,i)?"#BBBBBB":"#888888"}renderLightmap(e){let t=vg.specialActors[gg.PLAYER];e.clearText(),Gc.current.resetFov(!0),this.shader.prepareFrame(),this.renderMap(e),this.renderActors(e),Gc.current.setDirty(),Gc.current.computeFov(t.pos.x,t.pos.y,1+t.xpHolder.xpLevel)}renderFov(e){e.clearText(),e.clearBack(0),e.clearFore(0);let t=Gc.current;for(let r=0;r<t.w;r++)for(let i=0;i<t.h;i++)e.back[r][i]=t.isInFov(r,i)?"#BBBBBB":"#888888"}}class Vc{explored=!1;isWall=!0;isWalkable=!1;scentAmount=0}class Gc extends P{static currentIndex=0;static get current(){return Gc.mapDb[this.currentIndex]}static get currentActors(){return Gc.getActors(this.currentIndex)}static mapDb=[];static actorsDb=[];_currentScentValue=0;_dirty=!0;static getActors(e){for(;Gc.actorsDb.length<=e;)Gc.actorsDb.push([]);return Gc.actorsDb[e]}get actorList(){return Gc.getActors(this.index)}get renderer(){return this.__renderer}constructor(e){super(),this.__renderer=e}init(e,t,r){this.resize(t,r),this.index=e,this.tiles=[],this.__inFov=[],this._fov=new ph(t,r);for(let e=0;e<t;e++){this.tiles[e]=[],this.__inFov[e]=[];for(let t=0;t<r;t++)this.tiles[e][t]=new Vc}this._dirty=!0,this.__renderer.onInit()}get currentScentValue(){return this._currentScentValue}get fov(){return this._fov}setDirty(){this._dirty=!0}isWall(e,t){return!this.tiles[e]||!this.tiles[e][t]||this.tiles[e][t].isWall}findRandomWamlkableCell(){let e=U.default,t=e.getNumber(0,this.w-1),r=e.getNumber(0,this.h-1);for(;!this.canWalk(t,r);)t++,t===this.w&&(t=0,r++,r===this.h&&(r=0));return[t,r]}isWallWithAdjacentFloor(e,t){if(!this.isWall(e,t))return;let r=new C(e,t).getAdjacentCells(this.w,this.h,!1);for(let e of r)if(!this.isWall(e.x,e.y))return e}canWalk(e,t){return!this.isWall(e,t)&&0===this.actorList.filter((r=>r.pos.x===e&&r.pos.y===t&&r.blocks)).length}isExplored(e,t){return this.tiles[e][t].explored}isAdjacentUnexplored(e,t,r=!1){let i=new C(e,t).getAdjacentCells(this.w,this.h,!0);for(let e of i)if((r||!this.isWall(e.x,e.y))&&!this.isExplored(e.x,e.y))return!0;return!1}isInFov(e,t){return this.__inFov[e]&&this.__inFov[e][t]}getScent(e,t){return this.tiles[e][t].scentAmount}resetFov(e){for(let t=0;t<this.w;t++)for(let r=0;r<this.h;r++)this.__inFov[t][r]=e}computeFov(e,t,r){if(this._dirty){this._fov.computeFov(this.__inFov,e,t,r);for(let e=0;e<this.w;e++)for(let t=0;t<this.h;t++)this.__inFov[e]&&this.__inFov[e][t]&&!this.tiles[e][t].explored&&this.__renderer.getCellLightLevel(e,t)!==Fc.DARKNESS&&(this.tiles[e][t].explored=!0)}this._dirty=!1}setFloor(e,t){this._fov.setTransparent(e,t,!0),this.tiles[e][t].isWall=!1,this.tiles[e][t].isWalkable=!0,this._dirty=!0}setWall(e,t){this._fov.setTransparent(e,t,!1),this.tiles[e][t].isWall=!0,this.tiles[e][t].isWalkable=!1,this._dirty=!0}setWalkable(e,t,r){this.tiles[e][t].isWalkable=r,this._dirty=!0}setTransparent(e,t,r){this._fov.setTransparent(e,t,r),this._dirty=!0}reveal(){for(let e=0;e<this.w;e++)for(let t=0;t<this.h;t++)this.tiles[e][t].explored=!0}load(e){this.init(e.index,e.w,e.h),this._fov=new ph(this.w,this.h);for(let t=0;t<this.w;t++)for(let r=0;r<this.h;r++)this.tiles[t][r].explored=e.tiles[t][r].explored,this.tiles[t][r].scentAmount=e.tiles[t][r].scentAmount,this.tiles[t][r].isWall=e.tiles[t][r].isWall,this.tiles[t][r].isWalkable=e.tiles[t][r].isWalkable,this._fov.setTransparent(t,r,e._fov._transparent[t][r])}updateScentField(e,t){this._currentScentValue++;for(let r=0;r<this.w;r++)for(let i=0;i<this.h;i++)if(this.isInFov(r,i)){let n=this.getScent(r,i),a=r-e,o=i-t,s=Math.floor(Math.sqrt(a*a+o*o)),l=this._currentScentValue-s;l>n&&(this.tiles[r][i].scentAmount=l)}}}const Kc=7898283;class Wc{initForNewMap(){}canIdentifyActor(e){return!0}getActorCharCode(e,t){return e.charCode}getActorColor(e,t){return e.col}getCellLightLevel(e,t){return Fc.LIGHT}getBackgroundColor(e,t,r){return e.isInFov(t,r)?e.isWall(t,r)?7898283:4077404:e.isExplored(t,r)?e.isWall(t,r)?Kc:3289750:0}prepareFrame(){}}class Yc{enableEvents=!0;constructor(e){vu.registerEventListener(this,Ec),this.initForNewMap(),this.nolightShader=e}initForNewMap(){this.lights={},this.lights[um.ADDITIVE]=[],this.lights[um.MAX]=[];let e=vg.specialActors[gg.PLAYER];if(e&&e.container){for(let t=0,r=e.container.size();t<r;++t){let r=e.container.get(t);r&&r.light&&(!r.activable||r.activable.isActive())&&this.onLightOnoff(r)}e.light&&this.onLightOnoff(e)}}getCellLightLevel(e,t){if(!this.lightMap)return Fc.DARKNESS;let r=this.lightMap[e][t];if(!r)return Fc.DARKNESS;let i=M.computeIntensity(r);return i>cc?Fc.LIGHT:i>0?Fc.PENUMBRA:Fc.DARKNESS}canIdentifyActor(e){if(!e.fovOnly)return!0;let t=this.lightMap[e.pos.x][e.pos.y];return!!t&&M.computeIntensity(t)>cc}getActorCharCode(e,t){if(!e.fovOnly||e===vg.specialActors[gg.PLAYER]||t===Nc.DETECTED)return this.nolightShader.getActorCharCode(e,t);let r=this.lightMap[e.pos.x][e.pos.y];return r?M.computeIntensity(r)<=cc?63:this.nolightShader.getActorCharCode(e,t):63}getActorColor(e,t){if(!e.fovOnly&&Gc.current.isExplored(e.pos.x,e.pos.y)||t===Nc.DETECTED)return this.nolightShader.getActorColor(e,t);let r=this.lightMap[e.pos.x][e.pos.y];return r?M.colorMultiply(this.nolightShader.getActorColor(e,t),r):0}getBackgroundColor(e,t,r){let i=this.lightMap[t][r];return e.isWall(t,r)&&e.isExplored(t,r)?e.isInFov(t,r)&&i&&M.computeIntensity(i)>cc?M.colorMultiply(this.nolightShader.getBackgroundColor(e,t,r),i):Kc:i&&e.isInFov(t,r)?M.colorMultiply(this.nolightShader.getBackgroundColor(e,t,r),i):0}onLightOnoff(e){if(e.light)if(!e.activable||e.activable.isActive())-1===this.lights[e.light.options.renderMode].indexOf(e)&&this.lights[e.light.options.renderMode].push(e);else{let t=this.lights[e.light.options.renderMode].indexOf(e);-1!==t&&this.lights[e.light.options.renderMode].splice(t,1)}}prepareFrame(){this.lightMap||(this.lightMap=R(Gc.current.w),this.inFov=R(Gc.current.w)),this.clearLightmap(),this.computeLightMaps(um.ADDITIVE),this.computeLightMaps(um.MAX)}computeLightMaps(e){for(let t of this.lights[e]){let e=t.light.computeIntensityVariation(sc.elapsedTime);this.computeLightMap(t,e)}}clearLightmap(){let e=Gc.current.w,t=Gc.current.h;for(let r=0;r<e;++r)for(let e=0;e<t;++e)this.lightMap[r][e]=0}computeLightMap(e,t){let r=new P,i=e.light.position;void 0===i&&(i=e.pos),r.x=i.x-e.light.options.range,r.y=i.y-e.light.options.range,r.w=2*e.light.options.range+1,r.h=2*e.light.options.range+1,r.clamp(0,0,Gc.current.w,Gc.current.h);let n=e.light.options.range;n*=n;let a=e.light.options.intensityVariationRange?.25*((1-t)/e.light.options.intensityVariationRange-.5):0;Gc.current.fov.computeFov(this.inFov,i.x,i.y,e.light.options.range);for(let t=r.x,n=r.x+r.w;t<n;++t){let n=i.x-t+a;n*=n;for(let n=r.y,o=r.y+r.h;n<o;++n){let r=i.y-n-a;r*=r,this.lightMap[t][n]=e.light.options.color}}}}const Xc=2566178,qc=16720418,Zc=16752752,Jc=8093050,Qc=8553352,$c=12885548,ed=16737996,td="guard",rd="version",id="schedulerTime",nd="story",ad="dungeonLevel",od="statusPanel",sd="map",ld="OPEN_MAIN_MENU",hd="OPEN_DEBUG_MENU",ud="NEW_GAME",cd="CHANGE_STATUS",dd="USE_PORTAL";let fd;var pd;(pd=fd||(fd={}))[pd.INITIALIZING=1]="INITIALIZING",pd[pd.NEXT_LEVEL=2]="NEXT_LEVEL",pd[pd.RUNNING=3]="RUNNING",pd[pd.NEXT_TURN=4]="NEXT_TURN",pd[pd.VICTORY=5]="VICTORY",pd[pd.DEFEAT=6]="DEFEAT";const md="creature[s]",gd="humanoid[s]",yd="hostile humanoid[s]",vd="human[s]",bd="player",xd="magic",_d="item[s]",Td="flask[s]",Ed="artefact[s]",Ad="money",wd="gold piece[s]",kd="container[s]",Sd="static container[s]",Md="small chest[s]",Cd="chest[s]",Pd="crate[s]",Od="barrel[s]",Dd="pickable container[s]",Id="potion[s]",Rd="health potion[s]",Nd="greater health potion[s]",Ld="regeneration potion[s]",Fd="scroll[s]",Bd="scroll[s] of lighting bolt",Ud="scroll[s] of fireball",zd="scroll[s] of confusion",Hd="weapon[s]",jd="blade[s]",Vd="knife[s]",Gd="short sword[s]",Kd="longsword[s]",Wd="greatsword[s]",Yd="powersword[s]",Xd="shield[s]",qd="armour[s]",Zd="boots",Jd="pants",Qd="helmet",$d="ranged",ef="short bow[s]",tf="long bow[s]",rf="wand[s]",nf="wand[s] of frost",af="staff[s]",of="scroll[s] of teleportation",sf="scroll[s] of life detection",lf="scroll[s] of mapping",hf="projectile[s]",uf="arrow[s]",cf="iron arrow[s]",df="thrown[s]",ff="dart[s]",pf="key[s]",mf="device[s]",gf="stairs",yf="stairs up",vf="stairs down",bf="door[s]",xf="wooden door[s]",_f="iron door[s]";var Tf={};Object.defineProperty(Tf,"__esModule",{value:!0});var Ef={};Object.defineProperty(Ef,"__esModule",{value:!0});var Af={};Object.defineProperty(Af,"__esModule",{value:!0});var wf={};Object.defineProperty(wf,"__esModule",{value:!0});wf.names={vileAndCrude:{small:["ach","adz","ak","ark","az","balg","bilg","blid","blig","blok","blot","bolg","bot","bug","burk","dokh","drik","driz","duf","flug","ga","gad","gag","gah","gak","gar","gat","gaz","ghag","ghak","git","glag","glak","glat","glig","gliz","glok","gnat","gog","grak","grat","guk","hig","irk","kak","khad","krig","lag","lak","lig","likk","loz","luk","mak","maz","miz","mub","nad","nag","naz","nig","nikk","nogg","nok","nukk","rag","rak","rat","rok","shrig","shuk","skrag","skug","slai","slig","slog","sna","snag","snark","snat","snig","snik","snit","sog","spik","stogg","tog","urf","vark","yad","yagg","yak","yark","yarp","yig","yip","zat","zib","zit","ziz"],medium:["ag","aug","bad","bag","bakh","bash","baz","blag","brag","brog","bruz","dag","dakk","darg","dob","dog","drab","dug","dur","gash","ghaz","glakh","glaz","glob","glol","gluf","glur","gnarl","gnash","gnub","gob","gokh","gol","golk","gor","grakh","grash","grath","graz","grot","grub","grud","gud","gut","hag","hakk","hrat","hrog","hrug","khag","khar","krag","krud","lakh","lash","lob","lub","lud","luf","luk","molk","muk","muz","nar","ogg","olg","rag","rash","rogg","rorg","rot","rud","ruft","rug","rut","shad","shag","shak","shaz","shog","skar","skulg","slur","snar","snorl","snub","snurr","sod","stulg","thak","trog","ug","umsh","ung","uth","yakh","yash","yob","zahk","zog"],large:["argh","barsh","bog","burz","dof","drok","drub","drug","dub","dug","dul","dursh","dush","duz","faug","fug","ghakh","ghar","ghash","ghol","ghor","ghukk","ghul","glub","glud","glug","gluz","gom","grad","grash","grob","grogg","grok","grol","gru","gruf","gruk","grul","grum","grumf","grut","gruz","guhl","gulv","hai","hrung","hur","hurg","kai","klob","krod","kug","kulk","kur","lorg","lug","lukh","lum","lurz","lush","luz","makh","maug","molg","mud","mug","mul","murk","muzd","nakh","narg","obb","rolb","rukh","ruz","sharg","shruf","shud","shug","shur","shuz","slub","slud","slug","snad","snog","thrag","thulk","thurk","trug","ulg","ur","urd","urgh","urkh","uz","yug","yur","zud","zug"]},primitive:{names:["ahg","baod","beegh","bohr","bul","buli","burh","buri","chah","dhak","digri","dum","eghi","ehm","faogh","feehm","ghad","ghah","gham","ghan","ghat","ghaw","ghee","ghish","ghug","giree","gonkh","goun","goush","guh","gunri","hah","hani","haogh","hatoo","heghi","heh","hoo","houm","hree","ig","kham","khan","khaz","khee","khem","khuri","logh","lugh","maoh","meh","mogh","mouh","mugh","naoh","naroo","nham","nuh","ob","oli","orf","ough","ouh","peh","pogh","pugh","puh","quagi","rahoo","rhoo","rifoo","ronkh","rouk","saom","saori","shehi","shlo","shom","shour","shul","snaoh","suhi","suth","teb","thom","toudh","tregh","tuhli","ub","urush","ush","vuh","wah","wuh","yaum","yauth","yeeh","yih","yuh","zham"],suffixes:["doh","rei","mih","fah","soh","lah","tih","daoh"]},doughty:{syllables:["bal","durn","na","bord","from","nor","born","fror","nord","brim","fuld","orm","brod","fund","skand","brokk","gim","skond","brom","glo","storn","bru","gond","strom","bur","gord","stur","burl","gorm","sturl","da","grad","sund","dal","grim","thor","dolg","grod","thorn","dor","grom","thra","dorm","guld","thro","dral","gund","throl","drim","gur","thror","drom","hord","thru","dur","horn","thrur","durm","hra","thund"],maleSuffixes:["bor","din","in","in","in","ir","li","li","lin","nir","or","ri","ri","rin","rok","ror","rur","vi","vir","vor"],femaleSuffixes:["bis","da","dis","dis","dis","dis","ga","hild","is","is","lif","lind","lis","na","nis","ris","rith","run","run","vis"]},homely:{syllables:["ad","blanc","falc","mil","adel","boff","ferd","mung","adr","bomb","frob","od","ail","bram","fulb","oth","alb","bung","gam","sab","alm","droc","hald","sam","amb","drog","ham","seg","band","durl","hasc","serl","bard","emm","hod","tob","ben","erd","hug","wan","biff","ern","iv","wig","bild","ever","mark","wyd"],maleSuffixes:["ald","ard","ert","fast","o","o","o","o","o","old","win","wise"],femaleSuffixes:["a","a","a","a","a","ia","ia","ice","ily","ina","wina","wisa"]},familyName:{english:["Adshead","Akers","Antell","Applegarth","Babb","Babbs","Baffin","Bagg","Baggett","Bagnall","Baldey","Bamber","Bark","Barling","Barnstable","Barraclough","Bastable","Bastin","Bather","Batkin","Batt","Bazley","Bebb","Beddall","Beeby","Beecroft","Beedell","Bellis","Belsey","Berridge","Besley","Bibby","Bickle","Biddle","Biddulph","Bigg","Binks","Binns","Bisp","Biss","Blenk","Blenkin","Boam","Bobo","Boddington","Boffey","Bonger","Bonney","Bonser","Borrett","Bossey","Botterill","Botting","Bottom","Bottomley","Botwright","Bowser","Bracher","Brasnett","Brayley","Breary","Brickwood","Brindley","Broadfoot","Broadribb","Brocksopp","Broster","Buckmaster","Budge","Buffard","Bugg","Buggy","Bulger","Bulman","Bunce","Bunt","Burrow","Bushby","Buss","Cade","Cadwaller","Cantrill","Cardno","Catlow","Cattermole","Chaffe","Chaffer","Chard","Chettle","Chilcott","Chitty","Chivers","Chubb","Chugg","Clewes","Coaker","Cobden","Cobley","Coggan","Coggins","Collop","Coney","Coote","Copp","Coppard","Cornock","Cossey","Cottle","Coultip","Crang","Crimp","Croom","Crowles","Cubitt","Cullimore","Cuss","Custance","Cuthbert","Dabbin","Dabbing","Dabbs","Dagg","Dainty","Deeley","Derrick","Dibb","Dibble","Diccox","Diggins","Diggle","Diggles","Digweed","Dimmock","Dinsdale","Dipple","Dobbie","Dobby","Doggett","Dorey","Drabble","Draycott","Dring","Drudge","Duffield","Dufty","Duggan","Duggleby","Dumbrell","Dunkley","Eatwell","Eggins","Entwistle","Erlam","Etchells","Fairclough","Felgate","Fensome","Fenton","Fidge","Fidoe","Figg","Filer","Fincham","Firkins","Flann","Flanner","Flippance","Flook","Flunder","Followes","Fooks","Fremlin","Frisby","Frogley","Frohock","Froome","Frow","Fuggle","Furse","Furze","Gabb","Gaffey","Gagg","Gander","Garbutt","Garlick","Garn","Gazard","Gedge","Giblett","Giddy","Gigg","Gilliat","Gimble","Gimson","Ginger","Gipps","Girdler","Gissing","Gleave","Goggin","Gollogly","Gomm","Goodier","Gook","Gorringe","Gorwyn","Gosden","Gribble","Grigg","Griggs","Grill","Grimble","Grimes","Grimshaw","Grist","Grubb","Guckeen","Guckian","Guild","Gull","Gully","Gumbold","Gummer","Gummidge","Gurden","Haffenden","Hales","Halse","Harpham","Hartle","Hatch","Hayhurst","Hearle","Henley","Henwood","Heppell","Herrick","Herring","Hesketh","Hext","Hicken","Hickmott","Higman","Hinchcliffe","Hindmarsh","Hobley","Hoddy","Hogben","Holdom","Hollick","Holtom","Honeysett","Hook","Hopley","Hopps","Horrocks","Horsfall","Horwood","Hotten","Housely","Howie","Huff","Huffam","Hutton","Huxtable","Icke","Idden","Inskip","Iveson","Izzard","Jaggs","Jellis","Jepson","Jesty","Keel","Keetley","Kerkin","Kerslake","Kettley","Killick","Kinch","Knaggs","Kneebone","Knopp","Knott","Lagden","Laslett","Laverick","Leaper","Leggett","Liddane","Liddy","Liggan","Lithgoe","Lobb","Lodder","Looby","Loody","Lubbock","Luff","Lugard","Lugg","Lumsden","Lyle","Mabb","Mabbitt","Mabbot","Mabbs","Mabbutt","Maffey","Mallam","Mangold","Mapp","Mappin","Marfell","Matthams","Maunder","Maxted","Mayo","Meech","Meeson","Meggison","Meggitt","Meggs","Mellings","Merrikin","Metherell","Mew","Miggles","Miggs","Milsom","Milson","Minchin","Minns","Mobbs","Moberly","Mockler","Mogford","Mogg","Moggs","Morkam","Morphett","Mossman","Mossop","Mottershead","Moulds","Muddle","Muddock","Mudge","Mullock","Murch","Murfin","Murfitt","Musson","Mustill","Mutter","Mutton","Nance","Napper","Neep","Negus","Netherway","Newitt","Niblett","Nickless","Noad","Nobbs","Noblet","Nosworthy","Nottage","Nutt","Offen","Oram","Orcutt","Ord","Orpe","Paddock","Paddon","Pannell","Parham","Pavey","Peay","Peever","Pegg","Pegge","Pegler","Pegrum","Pelly","Pelter","Pendle","Petch","Petcher","Petchey","Pettipher","Philp","Phippen","Phippin","Pickersgill","Pickley","Pickwell","Pidduck","Pigg","Pilkington","Pimblett","Pingree","Pinch","Pinn","Pither","Pochin","Poggs","Polkinghorne","Pomeroy","Pomfret","Postlethwaite","Potticary","Poxon","Pring","Pringle","Prisk","Proudfoot","Puddicombe","Pudding","Puddy","Pugsley","Purslove","Pym","Quaife","Quain","Quenby","Quibell","Quigg","Raddle","Ranby","Rapkins","Ratter","Reakes","Reeson","Riddle","Rix","Roddis","Rosser","Ruddle","Ruffle","Rugg","Rumming","Rump","Sadd","Samways","Sankey","Scantlebury","Scoones","Scouse","Scragg","Scrimgeour","Scroggs","Scruby","Scutt","Sefton","Selth","Semmens","Seward","Shalloo","Sharples","Siggers","Sirett","Skeels","Skerrett","Slee","Sluggett","Smedley","Snoddy","Snuggs","Sparrow","Sparrowhawke","Spink","Spinks","Spriggs","Springett","Sproat","Sprunt","Spurle","Spurrett","Spurrier","Squance","Squarey","Squibb","Squirrel","Staines","Steggal","Stelfox","Stirk","Stith","Strag","Straw","Strutt","Stubbins","Stuppies","Suggett","Swaffer","Swaffield","Swarbrick","Symes","Tabor","Tagg","Tapping","Tarr","Tassell","Teale","Thew","Thick","Thornber","Thwaites","Tibbins","Tibbits","Tibbles","Tibbotts","Tink","Tippell","Tipping","Tippins","Tippling","Tipton","Tisser","Tittmuss","Tobitt","Tonks","Topping","Towse","Toye","Tozer","Trafford","Treasure","Tremlett","Trett","Trible","Tricker","Tripe","Trippe","Tripper","Trist","Troake","Trotter","Trouncer","Trumble","Tudge","Tuffin","Tufley","Tulk","Tully","Tumman","Tunks","Tunnah","Tunnicliffe","Turnock","Tween","Tyrer","Unsworth","Uttley","Varney","Vooght","Wackrill","Waddilove","Waddilow","Walthew","Waltho","Walwin","Wanless","Wann","Waple","Waring","Warrilow","Welburn","Wenden","Werrett","Wescott","Whinnett","Whiskard","Whisker","Whitefoot","Whitlow","Wibberley","Widdicombe","Widdows","Widdup","Wigg","Wigley","Wilberforce","Wilmer","Wintle","Witherden","Witney","Witter","Wolnoth","Woodhead","Wookey","Woolland","Woombill","Worrel","Worsley","Wortley","Wragg","Wrixon","Yeandle","Yeend","Yemm","Yould"],scottish:["Aiken","Aitken","Baikie","Baillie","Bainbridge","Baird","Bairnsfeather","Balios","Balnaves","Barbour","Barclay","Barrie","Beattie","Beilby","Bell","Bellenden","Berwick","Blackie","Blackwood","Blaikie","Blair","Bogue","Boyce","Braid","Brechin","Brisbane","Brough","Brougham","Brown","Brownlee","Brymner","Cairns","Calderwood","Candlish","Cardus","Cargill","Caven","Christison","Clyde","Cochran","Cochrane","Cockburn","Colomb","Crockett","Cronin","Cruden","Cunningham","Cushny","Dalziel","Deems","Dempster","Dinwiddie","Doohan","Doone","Dunbar","Dundas","Dundee","Dunn","Dunning","Eccles","Eckford","Edmonstone","Elder","Fairbairn","Falconer","Fenwick","Ferrier","Gairdner","Galloway","Galt","Geddes","Geikie","Glass","Glendon","Graham","Gregory","Guthrie","Haig","Halkett","Herdman","Hogg","Imey","Inchbald","Inglis","Irvine","Ivory","Jebb","Kerr","Kircaldy","Kirk","Kirkbride","Laird","Laughlin","Lawson","Legge","Lillie","Lipton","Lockhart","Lorimer","Lyall","Lyte","Masson","Melrose","Mill","Miller","Milligan","Milner","Moffat","Mollison","Moncrief","Montrose","Motherwell","Muir","Muirhead","Murray","Nairn","Naysmith","Nesbit","Nisbet","Nol","Orchardson","Pasley","Paterson","Pender","Preston","Primrose","Pringle","Quiller","Raeburn","Ransay","Redpath","Renfrew","Rennie","Renwick","Sanderson","Semphill","Smiles","Smollett","Smybert","Spenlove","Sterling","Stirling","Strang","Strange","Strangeways","Tait","Tannahill","Tassie","Thom","Tolmie","Urquhart","Wardlaw","Wedderburn","Whearty","Wilkie","Wiseheart","Wishart","Yarrow"]},fairAndNoble:{elfPrefixes:["an","im","ar","in","cal","ir","car","ist","cel","lar","cir","lir","clar","lor","el","mar","elb","mel","er","mer","erl","mir","est","nim","far","nin","fin","nir","gal","ral","gan","ran","gar","rel","gel","ril","gil","rin","ilm","rim"],alternativeElfPrefixes:["aeg","lith","ael","maeg","aer","mind","aes","mith","aeth","nith","bel","rael","ber","rind","cael","saer","caer","sar","cris","seld","ear","ser","elth","sil","eol","silm","faer","sind","fean","thael","find","thaer","ith","thal","laeg","thel","lend","ther","lind","thir"],middle:["ad","al","am","an","ar","as","eb","ed","el","em","en","er","es","ev","il","in","ir","ol","thal","thon"],maleSuffixes:["ad","dan","del","dil","dir","fal","ion","ion","lad","las","lin","nar","or","orn","ras","rior","rod","rond","ros","thir"],femaleSuffixes:["edel","el","eth","ian","iel","iel","ien","loth","mir","rial","rian","riel","riel","rien","ril","rol","sil","w","wen","wen"]},fairy:{prefixes:["dex","gliss","tink","flax","goss","tiss","flim","hex","trill","fliss","liss","trist","flix","min","twill","foss","misk","twiss","frisk","raff","twisp","friss","ress","twix","gess","riff","weft","glan","rill","wesk","glax","saff","winn","glim","shim","wisp"],maleSuffixes:["aldo","allo","amo","ando","aroll","aron","asto","endo","eroll","eron","esto","ondo"],femaleSuffixes:["afer","amer","anel","arel","asti","efer","enti","erel","ifer","imer","inel","irel"]},alternateFairy:{prefixes:["bris","iphil","opal","cryl","ispel","oris","elsi","istle","orif","ember","jat","peri","esk","jost","sarm","feris","jus","sprin","frimi","lirra","stith","gan","mali","tansi","glink","mink","tirra","hal","mirra","trump","hel","mistle","whis","hist","ninka","zando"],maleSuffixes:["bik","brix","frell","fret","kin","mist","mit","rix","tross","twik","win","zisk"],femaleSuffixes:["dee","kiss","la","liss","mee","niss","nyx","ree","riss","sa","tiss","ynx"]},elegantEvil:{prefixesDarkElves:["bal","myr","ber","ne","char","nel","de","nil","div","no","dri","nyl","dul","rel","eil","rha","ek","ru","im","sab","ins","sin","ist","sul","jeg","sus","jer","tel","jys","tul","lil","ver","mar","vil","mer","vir","mez","vril","mor","yas"],prefixesAlternateDarkElves:["bur","olg","chor","on","col","or","dol","org","dor","oth","drom","pan","dur","pel","en","por","er","sek","gon","sol","gul","sun","jend","ten","kil","thal","lul","tor","mab","torm","maz","vek","mol","vol","nor","vor","noth","yel","ol","yol"],middle:["dyl","el","en","er","id","il","is","lav","len","lev","lin","liv","pel","pir","ra","ral","ril","rin","sin","syl"],maleSuffixes:["ald","eld","id","ild","ird","lim","naz","nid","nil","nim","red","rid","rim","riv","ul","uld","vid","vim","vir","viz"],femaleSuffixes:["bra","dra","dril","ene","hel","ia","il","iln","ira","istra","ith","iza","lin","na","ra","rin","sil","tra","vra","vril"]},malevolent:{prefixes:["aag","karg","ulthu","alur","khark","urz","arak","krau","uti","az","kriv","uznid","azik","kuaz","virn","bral","kudu","vlaaj","braz","luri","vlag","bruh","mulk","vlash","draan","nau","vluk","drulg","nid","vluzak","guz","ninj","vraz","haug","nul","vulk","idru","nym","xau","jhaal","ranag","xid","jid","rilthu","xul","jiu","ruk","xuraj","jur","rulk","zauv","jurg","ruz","zug","jurz","saag","zuldu","kaaz","skaur","zuv"],maleSuffixes:["arag","bru","drul","inu","lank","lun","lurr","lurug","nal","rul","ruzuk","salk","sul","suruk","ull","undak","uvik","xulg","zu","zuk"],femaleSuffixes:["anil","bau","diu","dusla","giu","ija","izil","jiul","lihyl","lin","lyrr","nalu","rhyl","rula","skiu","sula","ulla","xhiu","zihyl","ziu"]},draconic:{prefixes:["abra","har","phrixu","adastra","helio","porphyro","adra","huro","pyra","anca","iul","rhada","andra","jalan","rhe","arag","jarzem","rhodo","archo","jazra","rau","atra","jurga","sar","bar","keruxa","sarcu","bara","kralka","sarda","beru","lazulo","scarva","bhakri","majuri","sidereo","bia","malacho","skhia","bra","mar","sulchru","brado","marmora","tchalcedo","brima","melkar","tchazar","cadra","orgra","trocho","chro","ouro","vra","chryso","perido","zalar","glau","phoro","zerul"],suffixes:["bazius","boros","bradax","calchax","cordax","lagon","malax","mandros","manthys","mordax","nadral","nalux","neriax","phylax","vorax","vorung","xenor","zuthrax","zzebrax","zzemal"]},infernal:{softs:["alu","alz","avu","azaz","baph","baz","cha","fraz","garl","garu","gla","hra","mal","nahu","nal","nasu","paz","raz","tha","thalu","bre","dre","gel","gle","gre","hez","rez","rezu","tze","gzi","hriz","hzi","idrau","itha","ixu","lilu","riz","yil","dromu","gro","lol","moz","olth","oxu","sco","tho","bu","bul","buz","chru","dru","ghu","gura","guz","hruz","huz","kul","lurhz","muz","ru","shu","ssu","szul","thu","ulchru","utu","vul","zu","zul","baal","ghaa","kraa","phaal","raal","saa","bial","oazo","soaz","ruaz","gya","yaa","bael","nee","ziel","yee","aiaz","shai","reoz","duoi","drau","ghau","glau","mau","sau","tzau","iuz","juu","rhuu","vuul","zuu"],dulls:["agh","alg","barg","chag","ghad","glab","grag","hrag","kag","kwarg","mag","nalb","sag","tharg","brelg","dergh","dregh","drelb","felg","heg","kleg","igg","rigg","blog","drog","grolb","kolg","krolg","lolg","mog","morg","nog","obb","ogg","olb","rogg","strog","thog","trob","tzolg","vogt","bub","bulg","druj","durg","frub","fulg","gub","hrud","hurg","jub","julb","nud","nug","nulb","rung","shub","stug","sug","szug","trulg","ulb","urb","vub","vulb","xub","zub","zug","zugt","aab","aag","glaag","haag","naag","raag","boaj","moab","uag","leegh","yeb","yeeg","aig","yibb","iog","droog","nyog","aug","baug","daurg","draug","gaub","laug","maug","naug","raug","saug","thaug","iub","iug","ruug"],sharps:["ach","akk","ash","azt","bahor","bar","bas","brax","charn","dak","hrax","lach","lazt","mat","nam","nazt","ralk","rhast","sark","slarv","tash","thak","thalur","thalk","vach","vap","dek","ech","fesh","gek","hrek","lech","met","ner","ter","blik","gith","igm","inax","irsch","kir","lis","lisk","lith","nilv","nirr","tlizit","bor","chon","goch","gor","goth","hoth","khor","kos","loch","lok","loth","moch","moth","noc","och","oth","rolk","roth","sot","soth","vrok","dun","gur","hun","luth","muth","nur","rutt","sut","sutt","szut","tur","urt","utuk","uzt","krych","nyth","slyth","gaan","xaas","boak","ruaak","yalm","haerx","iex","draum","gaur","glaur","rauk","saur","duum","nuur","ruun"]},empyreal:{prefixes:["adan","asan","jasan","palant","sarnat","valmar","adrast","asarn","jasarm","palor","solar","valnar","alant","astar","javral","raman","talan","valnor","amad","atar","kalad","ranal","talar","valon","aman","atlan","kalar","ranar","talas","valor","amar","avar","kalas","rasan","talon","vanar","amars","avlant","kalast","ravan","taran","varal","amart","avral","kasal","samar","taval","varam","ansam","jalan","katarn","saran","valant","varan","arad","jalkar","kaval","sarat","valar","varat","aram","jaran","klaron","sardan","valdor","vardar","aran","jasal","palad","sardar","valkar","voltar"],maleSuffixes:["al","an","ar","as","at","ath","ath","ath","anth","athal","athar","athas"],femaleSuffixes:["el","en","er","es","et","eth","eth","eth","enth","eleth","ereth","eseth"],titles:["ar-","sar-","tar-","var-","jal-","kal-","pal-","ral-","tal-"]},human:{one:["Aind","Ainn","Airk","Aitze","Ald","Ance","Anxe","Ard","Ashf","Aulg","Aun","Aure","Authe","Baelt","Bakh","Bal","Balt","Balthe","Barg","Barll","Bauce","Baysc","Beek","Beele","Berl","Bersch","Beyn","Bhozt","Birme","Birr","Bjanc","Blaen","Blize","Blouch","Blurk","Blynze","Bokk","Borl","Borse","Brahl","Brakk","Bralk","Brang","Brann","Branth","Brem","Bress","Breun","Briint","Brill","Brize","Brod","Broik","Brolt","Bront","Broozh","Brosck","Broud","Brud","Brule","Brun","Bulse","Bunth","Byar","Byst","Caer","Cail","Canth","Carn","Cayrl","Ceyt","Chaeng","Chail","Chaith","Chal","Chalm","Charg","Charn","Chave","Chayle","Chaze","Cheal","Cheev","Chel","Chern","Cherze","Chezl","Chilk","Chlenk","Choalg","Choje","Chor","Chorl","Chorsk","Chounce","Chraq","Chrarr","Chrem","Chrent","Chriyb","Chroad","Chud","Chuz","Claed","Clart","Clesh","Cloup","Clour","Clowr","Coll","Corb","Corje","Corm","Corme","Crade","Creeg","Croold","Croyn","Cthon","Cush","Daalx","Dahr","Daig","Dal","Darm","Darsh","Darze","Dashf","Dask","Datz","Daug","Dawl","Deelth","Deerch","Derd","Derle","Dest","Deuth","Dex","Dhaant","Dherl","Dhoul","Dhuul","Dhuur","Dinz","Dlak","Dlask","Dlir","Doag","Dolc","Dorse","Dralg","Dram","Dran","Drance","Drath","Drax","Draygg","Dreact","Dreed","Dreeg","Dreen","Dreev","Drelm","Drelth","Drerle","Drewm","Drilm","Drinn","Drism","Drissth","Drix","Droale","Drojj","Drom","Droxe","Droy","Drun","Drust","Druuth","Dryle","Drynn","Drythe","Dvarch","Dwesk","Dzairn","Dzij","Dzym","Eeb","Eenthe","Elb","Emp","Ence","Ench","Eng","Enz","Ept","Erd","Esk","Faig","Falthe","Fanch","Faoth","Fard","Faum","Faz","Feant","Feej","Felg","Fernsh","Fesk","Fess","Feth","Fimth","Fize","Flast","Flatch","Flayre","Flerd","Flersh","Flisp","Florn","Fompt","Fousk","Fraine","Frakk","Fralg","Frast","Fregg","Frem","Fresk","Fretch","Frex","Frike","Frile","Frism","Frold","Frone","Fronx","Frook","Frool","Froy","Frush","Fryx","Fulm","Fyahn","Fyast","Fyorb","Fzek","Fzron","Gair","Galthz","Gand","Gane","Gann","Gart","Gath","Gault","Gawle","Gax","Genze","Gerd","Gez","Gharl","Ghea","Ghenz","Ghorl","Ghorx","Gilft","Gilm","Gire","Glaar","Glain","Glarch","Glaux","Gleeth","Gleev","Gleft","Glekke","Glem","Glice","Glip","Glish","Glith","Gloard","Gloob","Gloorsh","Glosk","Glund","Glyre","Glyth","Gnarre","Golm","Gond","Gorm","Gosp","Goste","Graal","Grall","Greel","Greeld","Greelp","Grend","Grilf","Grimp","Groad","Grond","Groolsh","Gruon","Grux","Gthuu","Gurze","Gwisp","Gwith","Gwosk","Gyorr","Gyz","Haag","Haar","Haask","Hade","Hadj","Halk","Halm","Hane","Harb","Harch","Harg","Harx","Hauke","Haux","Hawlx","Hax","Heerf","Hersh","Hetz","Hezz","Hisk","Hize","Hjorr","Hlare","Hlor","Hoag","Hob","Horl","Horm","Hosh","Hraak","Hrailk","Hreen","Hrine","Hroon","Hrume","Hruse","Huxx","Hythe","Ingg","Jaarge","Jad","Jaerth","Jaig","Jairn","Jal","Jalth","Jance","Jand","Jant","Janx","Jard","Jark","Jarn","Jask","Jath","Jauce","Jaus","Jauth","Jaze","Jeel","Jekk","Jend","Jenx","Jerd","Jern","Jexx","Jhang","Jhaulk","Jhor","Jhure","Jinch","Jind","Jinz","Jirle","Joorm","Jorm","Jorn","Jrond","Jurze","Jusk","Juzz","Jyfe","Jyin","Kaerr","Kaid","Kal","Kamn","Kand","Kang","Kank","Karn","Karth","Karze","Kaune","Kedj","Keek","Keig","Kell","Kelph","Kerce","Kerm","Kerst","Kesp","Keth","Kez","Khaiz","Khal","Khand","Kharb","Kharsp","Khern","Khif","Khond","Khr","Khorst","Khrev","Kinch","Kish","Kiv","Kjeld","Klaff","Klaz","Kleed","Kloob","Kloohn","Klyne","Kmool","Knaar","Knut","Kolff","Kolg","Konv","Koss","Koul","Krake","Krall","Kranj","Krax","Kreel","Krej","Kremp","Krey","Krile","Krinch","Kroff","Kroll","Krompf","Kuest","Kull","Kulm","Kuon","Kuum","Kvon","Kwask","Kwaz","Kyre","Lach","Laev","Lan","Lantz","Larnste","Lartz","Laur","Lawrg","Layje","Leet","Lenx","Leth","Liln","Liss","Lod","Loec","Lonn","Loord","Loosk","Lound","Luhr","Lumbb","Lurs","Lyrr","Lysk","Maarth","Maec","Maelv","Magh","Mald","Mant","Manth","Mantz","Marb","Mard","Mayxe","Meand","Meeth","Melg","Meln","Merrt","Merzh","Mesp","Mirsp","Mirx","Miskt","Ml","Mointh","Mool","Moork","Moorthe","Mord","Morl","Moskt","Mox","Mulse","Murlk","Murste","Myrrhne","Naall","Naar","Naaz","Naer","Naik","Naine","Nairx","Nalm","Nanx","Naois","Naphk","Nar","Narct","Narrm","Naulk","Naxx","Naze","Nelq","Nem","Nemn","Nerrz","Ngal","Nime","Nirft","Nisp","Nithe","Noerth","Nolgh","Nool","Noom","Norb","Norle","Noth","Nraeve","Nulth","Nurb","Nuss","Nyalg","Nyalk","Nym","Nynx","Olth","Omm","Omn","Ooon","Ord","Orld","Ornce","Oth","Ounde","Ourne","Paaz","Palch","Parn","Parth","Parzt","Path","Pelk","Pell","Pesm","Phad","Phairn","Phant","Phlarn","Phong","Photz","Phral","Phul","Pirz","Pjanth","Plange","Plaz","Plegg","Plind","Plomb","Plorze","Plumf","Pluun","Pnidd","Poile","Pome","Pould","Praige","Presk","Prike","Prokk","Prook","Prya","Pryle","Prynne","Psarn","Ptenx","Pulge","Pume","Quaan","Quaar","Quagh","Quaild","Quaisth","Qual","Qualt","Quanst","Quanz","Quaoph","Quarl","Quast","Quech","Qued","Quelg","Quelm","Querk","Quigg","Quilg","Quol","Quonj","Quool","Quorze","Quune","Quynd","Raask","Rahm","Raine","Raisth","Ralce","Rald","Rast","Raunt","Raupt","Rax","Raxt","Rayche","Raz","Reelce","Reendt","Relth","Relz","Rez","Rhath","Rhaze","Rhiss","Rhom","Rhorn","Rhyll","Rifk","Rilm","Rilx","Rimsk","Rimth","Riss","Rith","Rix","Rodr","Rodst","Roen","Rogg","Rolm","Rolx","Roult","Rull","Rulm","Rult","Rumche","Runce","Ruor","Ruusque","Ruz","Ryke","Rynx","Ryond","Rythe","Saar","Saech","Saedd","Sairgh","San","Sange","Sarg","Sark","Sarl","Sarn","Sarpt","Skroine","Scroot","Scrylte","Scryme","Sculp","Scuss","Scyrth","Sdor","Seelt","Seif","Sen","Senthe","Sfite","Shad","Shar","Sharg","Sharm","Sharn","Sheb","Sheel","Shenn","Shenx","Sherth","Shilm","Shind","Shont","Shren","Shune","Shurm","Shuuth","Shyang","Skarn","Skart","Skeen","Skerr","Skorle","Skraf","Skrafe","Skrib","Skrift","Skroi","Skyre","Slaar","Slanc","Slark","Slarm","Slask","Slaunce","Slaur","Sleer","Slemt","Slike","Slith","Sloif","Slorg","Slorn","Sluff","Slynd","Smeke","Smete","Smink","Smold","Snabe","Snard","Snarr","Sneath","Snurch","Soick","Solm","Sool","Soorve","Sorl","Sorm","Sorn","Sosz","Sounx","Sparll","Splynd","Sprake","Squalj","Sran","Srend","Sroon","Stalb","Starl","Stelk","Strangg","Strix","Strom","Strowl","Stuhr","Styche","Styre","Suntz","Suule","Suusht","Svinse","Swaerk","Swyst","Syle","Syoll","Taede","Tael","Tak","Tal","Tanj","Targ","Targh","Tark","Tarl","Tath","Taus","Tavv","Taze","Tchel","Tcherm","Tchoum","Tebs","Teelk","Teern","Teirn","Telg","Telk","Terb","Terre","Tez","Thaad","Thaarn","Thad","Thaed","Tham","Thand","Thang","Thapp","Thard","Thark","Thask","Thaugh","Thaum","Thaurn","Thawn","Thax","Theed","Thesk","Thevv","Theyz","Thirrf","Tholk","Thorm","Thosk","Thoure","Thrak","Thralf","Thrand","Thrasp","Thrawl","Thrawn","Thrax","Thrilce","Thrizz","Throck","Thromb","Throsp","Thull","Thuu","Tln","Toal","Tog","Tol","Tolg","Tolm","Tooz","Torb","Torje","Torm","Torr","Torsk","Torth","Trahl","Treel","Treesk","Trell","Trem","Treys","Trild","Trilse","Trinx","Trojj","Tronf","Trost","Troyne","Trulm","Tsai","Tsang","Tselm","Tsleg","Tspoy","Tsrome","Tthann","Tull","Tvash","Twez","Twillx","Tyae","Tyfe","Tyog","Tzank","Tzoy","Ulm","Urst","Vaar","Vaersl","Vaist","Valg","Valtch","Vand","Vansh","Var","Vard","Varl","Vask","Vass","Vath","Vaulx","Vaus","Vaxx","Vayze","Veb","Veed","Veeth","Vegg","Vek","Velb","Venk","Venth","Verle","Vesp","Veth","Vilt","Vipt","Virl","Virx","Visk","Viss","Vist","Vith","Vlack","Vlax","Vleft","Vloongh","Vohm","Volg","Vool","Voon","Voor","Vor","Vorg","Vorl","Vorque","Vorse","Vort","Vrahk","Vrain","Vramp","Vreng","Vrilx","Vrosk","Vroyce","Vuul","Wertz","Wheld","Whimk","Whirx","Whoord","Wix","Woise","Wome","Woorn","Worrb","Wrahz","Wraime","Wrax","Wrhye","Wrold","Wrost","Wurlp","Wyast","Wye","Wynv","Wyrn","Xaayr","Xaen","Xaif","Xain","Xalm","Xan","Xarle","Xas","Xau","Xean","Xelb","Xenve","Xerth","Xill","Xin","Xinsce","Xis","Xive","Xix","Xord","Xoth","Xush","Xyle","Xysc","Yad","Yagre","Yaim","Yand","Yarl","Yauce","Yeb","Yeerk","Yend","Yenj","Yest","Yhalm","Yhe","Yhem","Yifth","Yilb","Yivv","Yoort","Yoth","Yrr","Yund","Yush","Yuun","Zaar","Zahn","Zaidh","Zaift","Zaile","Zaive","Zand","Zanq","Zao","Zaon","Zaoth","Zar","Zash","Zeft","Zeige","Zek","Zell","Zelm","Zelth","Zend","Zha","Zhash","Zhayce","Zherl","Zhirth","Zhool","Zhorm","Zhuul","Zil","Zilge","Zinn","Zixt","Zlante","Zlaque","Zlar","Zold","Zook","Zool","Zoor","Zor","Zorl","Zorn","Zoth","Zoul","Zreethe","Zull","Zusque","Zwerl","Zynx","Zyx"],two:["Aahdret","Aarlen","Aasren","Aastrasl","Aban","Abbith","Ablif","Aboas","Abrance","Abrax","Abryn","Abyok","Acear","Acfyst","Achekk","Achelse","Achlarg","Achren","Achriss","Ackvold","Acram","Acu","Adaon","Addanc","Adeil","Adire","Adlay","Adlen","Adlon","Admel","Adoin","Adon","Adrek","Adreln","Adrich","Adrilc","Adurthe","Aduush","Aealim","Aeddan","Aedha","Aedir","Aedlynx","Aeiran","Aelis","Aelma","Aemon","Aenet","Aenthu","Aeprox","Aeren","Aerind","Aerkoon","Aerkour","Aerlithe","Aeron","Aeryle","Aethlyr","Aethon","Afenk","Affraig","Afraaj","Agburz","Ageen","Aghil","Aghill","Aglin","Agroth","Agwyn","Agyorl","Ahmr","Aia","Aiaia","Aibmab","Aidajn","Aiden","Aidon","Aigol","Ailcaer","Aink","Ainzu","Airmid","Aislinn","Aislithe","Aiza","Aizan","Ajaak","Ajnaic","Akaal","Akar","Akem","Akhtar","Akif","Akii","Akir","Aklo","Akon","Akoorb","Akrain","Akshooth","Akthrain","Akvar","Alao","Alarre","Albaize","Albin","Albrif","Aldende","Aldlor","Aldlum","Aldon","Aldor","Aldreb","Aldred","Aldren","Aldryn","Aldtas","Alenthe","Alfan","Algus","Alif","Aling","Aljic","Aljric","Allaire","Allar","Almaer","Almeir","Almen","Alodd","Alsob","Altin","Altur","Alver","Alya","Amact","Amair","Ambard","Ambeln","Ambril","Ameste","Amfik","Amkir","Ammdar","Ammek","Amoyl","Amphoth","Amrath","Amren","Amyrg","Amzar","Anach","Anar","Anaz","Ancharl","Anclaar","Anctash","Andell","Andjez","Andon","Andore","Andorh","Andrad","Andreth","Androlg","Andrys","Andval","Anghra","Anglame","Angleem","Anglock","Anglor","Angmor","Angtai","Anhlaw","Anigg","Anin","Anjak","Anjos","Anken","Ansher","Ansoj","Anson","Antar","Antarn","Anthor","Antrim","Antriq","Antrisp","Anvar","Anvyen","Anxrin","Anzire","Aopharz","Aophim","Aquill","Ara","Araar","Aradh","Arak","Aran","Araste","Araz","Arbal","Archam","Archech","Archite","Arcus","Ardann","Ardesh","Ardlen","Ardoth","Ardune","Ardwar","Ardwil","Ardwile","Areest","Arell","Argin","Argorm","Argrath","Arhnaal","Aribe","Arick","Arjhag","Arkal","Arkharn","Arklow","Arkrog","Arlan","Arlbeth","Arldon","Arlya","Armast","Armorn","Armyze","Arna","Arnhor","Arnid","Arnlor","Arnrost","Aroinz","Arrah","Arrhod","Arshel","Artheen","Arthex","Artor","Artus","Arun","Arvel","Arvilk","Arvol","Arvox","Arweld","Aryem","Aryft","Aryon","Aryph","Aryus","Arzang","Arzi","Asberl","Ascelle","Aschar","Aschka","Asco","s","Asgar","Asgorn","Ashan","Ashane","Ashbarl","Ashed","Ashild","Ashlann","Ashnyn","Ashord","Ashtah","Ashur","Askar","Aspand","Asrai","Astei","Astem","Astha","Astran","Astrin","Atang","Atar","Atdeel","Ateng","Athald","Athar","Athcroj","Athlas","Athlos","Athmar","Athquom","Atlampt","Atlank","Atmaas","Atmeh","Atmog","Atox","Atraaf","Atrend","Atsal","Attor","Atyar","Atyre","Auchstyr","Auchur","Aucir","Audric","Aundan","Aunxar","Aurawn","Aureth","Auxid","Avane","Avarr","Averq","Avoon","Avorn","Awndale","Axaane","Axos","Aya","Aydras","Ayen","Ayin","Ayir","Ayla","Aylmer","Ayrish","Ayshun","Ayshung","Azal","Azash","Azeal","Azen","Azgoth","Azhrarn","Azlon","Azlyn","Azmael","Azorn","Azoth","Azra","Azraq","Azrean","Azreck","Azter","Azzay","Babdar","Baccruz","Baelil","Bahar","Baiar","Baiern","Baikaen","Baiposk","Bakan","Bakra","Balain","Balaz","Baldhur","Baldrim","Balgurr","Balkar","Balok","Balour","Banek","Banffoge","Bannheld","Bannor","Baraell","Bardel","Barduy","Baren","Barim","Barind","Barldsy","Barlom","Barlon","Barltan","Barnar","Barood","Baros","Barrenc","Barrin","Bartain","Basfric","Basim","Basmol","Bassinth","Bassto","Bastarre","Batrosque","Bayven","Bayzell","Bazan","Bazit","Beclaan","Bedane","Bedese","Beejlam","Begnus","Belan","Belaz","Belcoir","Beleth","Belgaun","Belic","Beljan","Bellin","Bellom","Belmul","Belnarth","Belor","Belorn","Belot","Belrain","Belstos","Belthan","Belthis","Belwilg","Bengol","Bol","Beolj","Beras","Berclad","Bercol","Berik","Berild","Berim","Berith","Berlyne","Berrec","Bersem","Bershar","Bertrenk","Berzik","Bethmel","Beyash","Beyus","Bezgrael","Bezpar","Bhoorva","Biferb","Biilar","Bildesh","Billosh","Bilmar","Bindle","Biraad","Birain","Bireln","Birta","Bisel","Bjanni","Blauthike","Bleran","Bleskran","Blonjerg","Blorvind","Blunyc","Bodvar","Bod","Boggrah","Bolaoz","Bolthorn","Borale","Boren","Borgald","Borin","Borlaith","Borlas","Borlid","Borlo","Borngah","Borzer","Boshan","Bothar","Botro","Bouphar","Bowjen","Boyarl","Braagen","Bracca","Braeklarn","Bragen","Brahan","Brakkon","Brala","Brali","Brallu","Bralma","Brandar","Brandec","Brangwej","Branthu","Brantys","Branvaol","Branzan","Brascand","Brasslin","Braxen","Braxtor","Brealij","Bredhal","Breedast","Bregem","Brehen","Breitsoj","Brelkrov","Brenen","Brenlan","Brestej","Brethil","Bretta","Brevlyn","Brevta","Brielle","Brindax","Brindence","Brintu","Brinys","Brislyn","Brithael","Brithric","Brobal","Brohnin","Brona","Broosin","Broxus","Brufod","Brundelx","Bryapka","Brynit","Buckrald","Bulvet","Burcan","Burrgaut","Bwermolc","Byeloor","Bylys","Byrkast","Byzar","Cadairn","Caddax","Cadel","Cadfrel","Cadrach","Cadreth","Caecyn","Caedfer","Caelis","Caerron","Caillean","Caiphul","Cairon","Caldel","Calensch","Calkdaev","Calmic","Calnor","Calunn","Calyz","Calzan","Camain","Cambree","Camdlon","Camsar","Candla","Candrak","Canelb","Cangmor","Canthar","Cantrasc","Caopha","Caostri","Caranth","Carbrod","Cardelv","Carfheen","Carlasc","Carlinx","Carnax","Carnly","Carnool","Caroin","Carquel","Carthis","Caskeil","Castlon","Cathlaid","Caveesm","Cavorn","Cavosse","Cavris","Caynarv","Cayrin","Cazberr","Cazyach","Cedrim","Cedrisk","Ceilerse","Celbarb","Cemtruo","Cenyth","Ceraik","Cercyon","Cerdun","Cerlint","Cermor","Cernon","Cerra","Cessair","Cevir","Ceylinn","Chadan","Chadlor","Chadzik","Chaemor","Chagor","Chalar","Challem","Challeth","Chalvir","Chambarr","Changtsai","Chanoth","Chanti","Chal","Charatze","Charnyx","Charresh","Charyd","Chaska","Chaulet","Chavir","Chayim","Chazane","Chazgel","Cheldor","Chelim","Chelprey","Chelshrike","Chendil","Chenean","Chenoa","Cherla","Chessene","Chevonde","Chezil","Chial","Chian","Chigran","Chimu","Chimzil","Chirril","Chirthiz","Chitrind","Chlangi","Chlodig","Chlorild","Chordash","Chorrin","Chrezel","Chungaez","Chunjan","Chyvil","Cidran","Cilmar","Cinctraic","Ciraf","Cirkin","Cirnak","Cista","Civar","Ciwan","Clafaug","Clarinn","Cleedis","Clendlim","Clenvred","Cligra","Cloosag","Cloralt","Cox","Cobord","Cobrynth","Coddry","Cogarn","Coimarn","Colgrim","Colyss","Comnlan","Conjerb","Conjin","Coram","Corbrod","Cordin","Corem","Coreme","Corill","Corince","Cormast","Corrysm","Corsolle","Couran","Coyzan","Cramog","Craxan","Craydarth","Craye","Creidah","Crennex","Crestarl","Crestry","Creydai","Crezel","Crilayth","Crixbine","Crochell","Crolas","Cromough","Croquarne","Cuddry","Cuhaid","Cullyn","Curik","Curin","Curlask","Cusheal","Cusheth","Cuttray","Cyanril","Cydace","Cylenn","Cynquil","Cyrand","Cyrib","Cyrvemth","Czarai","Dabthan","Dacil","Daeglev","Daelden","Dafor","Daghand","Dagharz","Dagir","Dahiil","Daikoon","Dailenn","Dakul","Dakvon","Dalain","Dalanc","Dalcraw","Dalga","Dalgirth","Dalith","Dalman","Dalraev","Dalsar","Dalvai","Dalvoc","Dalwyn","Damaal","Damar","Damesk","Damrir","Danchel","Dandar","Dandroan","Danfis","Dangrim","Dankin","Dantlee","Daotar","Daphrin","Daplurn","Dara","Darach","Darake","Daran","Darax","Darbeel","Darcer","Darga","Darglin","Darinth","Darjek","Darjii","Darlist","Darlith","Darmont","Darmore","Darnath","Darnein","Darnime","Daron","Darool","Darsid","Darsiiv","Darsin","Darvane","Darven","Darzed","Darzha","Dashgu","Dasig","Dastor","Dastryn","Daugas","Daulaz","Davar","Daveld","Davix","Davlit","Davras","Davrou","Davrune","Dawfoke","Daxon","Dayko","Daysase","Daytar","Deaclynd","Debfin","Dechru","Deenos","Delaur","Delcold","Deldrak","Deleea","Delente","Delgath","Delgaun","Delmar","Delna","Delrean","Delser","Demgris","Deneth","Dengar","Denlorn","Derdain","Derfel","Dergast","Derild","Derlin","Derlor","Deroh","Deron","Derroll","Dersarre","Derthark","Devolt","Devreed","Dhakos","Dhornen","Dhoumene","Dhranak","Dhyana","Dialn","Dibdrek","Dilfar","Dilgid","Dilquay","Dilvak","Dinoor","Diorne","Diran","Dirim","Dirkalt","Dirmalk","Dirrach","Dirrahk","Dirvus","Distar","Disten","Distran","Ditrenth","Divos","Djarmon","Djehla","Djelha","Djira","Djola","Dolljan","Dolthar","Dolvith","Domede","Domen","Domin","Domnux","Domon","Domvit","Domwren","Donet","Donlaze","Doran","Dorath","Dorgand","Dorgath","Dorhar","Dorin","Dornath","Dornbain","Dorok","Dorsan","Dorspaich","Dortoom","Dorvai","Dostaan","Doussa","Dowflox","Dozrig","Dozthuk","Drabsnar","Dradoi","Dradus","Draegra","Drakhor","Drakhri","Drakirn","Drakkan","Dralar","Dramah","Dramfer","Draogat","Drassonne","Drauphor","Draven","Draxok","Drayley","Drayven","Drazvec","Drebyss","Dreezhan","Drefest","Dreggol","Dreintor","Drellefe","Drenfust","Drengar","Drethlec","Drevark","Dreynel","Drezael","Drezaem","Drilant","Drimmis","Drinda","Dringle","Drion","Drissa","Dristirk","Drocolg","Drogan","Drohulse","Droilfin","Drokoag","Dronasp","Druchor","Drunal","Drusilf","Dryduos","Duarn","Duergan","Dulith","Dulkarn","Dulkast","Dunry","Durnik","Durzin","Duskim","Duubown","Dvorast","Dwendlim","Dwyvach","Dygard","Dylenx","Dymnash","Dynqua","Dynroth","Dyoni","Dyshim","Dyskrahn","Dytheus","Dyvim","Dyzant","Dzoraug","Easval","Ebane","Ebur","Echael","Echross","Eclane","Edcyl","Eddar","Eddax","Eddor","Edeth","Edhil","Edrun","Eduu","Eehatt","Eelek","Eelgren","Eerban","Eglarth","Egron","Ehilm","Ehlmat","Ehlreth","Eidon","Eidrinn","Eilif","Einar","Eirecht","Eithn","Ejence","Ekvarl","Elaen","Eland","Elath","Eldin","Eldix","Eldrab","Eldron","Eldru","Elek","Elem","Elfreth","Elgroth","Elkin","Elkleth","Ellern","Ellrass","Elmral","Elnume","Elod","Elran","Elriph","Elu","Elvrit","Elyx","Elzast","Emal","Emberle","Emdel","Emerl","Emgar","Emton","Enban","Encarth","Endrade","Endril","Enferth","Englin","Enkim","Ennek","Enris","Enrost","Enskel","Ensorn","Envess","Enzhai","Ephelt","Ephraj","Ephti","Ephyre","Eppent","Eppin","Erbmaj","Erdlan","Ergar","Ergoth","Ergron","Erhil","Erijn","Ermon","Ermor","Eron","Errain","Errone","Erson","Erwat","Erxab","Escande","Esceft","Esdrix","Esghar","Eshrik","Eshuur","Eskarn","Eslyn","Esris","Essa","Estrag","Estorl","Estrif","Esyfe","Ethrene","Euross","Evelj","Evinth","Evith","Evorn","Evska","Ewlon","Eyphra","Eythor","Ezail","Ezmi","Ezri","Fabolde","Fadar","Faendyre","Faesten","Faffle","Fafnalg","Faiorg","Falbin","Falcarn","Falgar","Falhehn","Fali","Falldrijn","Falsfeen","Falslen","Falume","Fanchel","Faran","Fardoth","Fardron","Farglid","Farhaude","Farleit","Farli","Farmolj","Farnek","Farngold","Farngor","Faroon","Farosh","Farrain","Farscall","Farsun","Farunst","Farzdoy","Fasthes","Fautell","Favuld","Favvaz","Fayel","Faygrenn","Faylaol","Faylynn","Fayol","Fazhal","Fazzur","Feeming","Feikry","Feirrex","Felinx","Felnar","Felor","Felstar","Felthund","Felvrand","Femigg","Fendahl","Fendrabe","Fenew","Fenic","Fenist","Fenleith","Fennus","Fenrald","Fenzil","Feorth","Ferman","Fermern","Fernath","Ferndel","Fernhol","Fernool","Fernosk","Ferram","Ferthel","Fervigg","Ferwend","Fesru","Fethlan","Feyan","Feyern","Fhorat","Fiantz","Fictyr","Figgin","Fiiya","Filtarg","Fingril","Finstar","Firca","Firga","Firin","Firon","Fiskroll","Fissworx","Flauleck","Flayna","Flestrin","Fletchen","Flikir","Flingrel","Flitan","Flixis","Foarad","Fodusk","Fogrin","Fohdon","Folstin","Fomkrin","Fontand","Foozan","Foragh","Forang","Foraujh","Forbulse","Foren","Forjisk","Formki","Fornoar","Foros","Forroosk","Forstine","Fortrelce","Forvael","Fozgiel","Frama","Franaard","Frannon","Frashtol","Frayja","Freasand","Fremmoun","Frillox","Friston","Frixeen","Frolin","Frondir","Fronost","Fronubb","Froscele","Frowal","Fruwasp","Ftoomi","Fulshin","Fulume","Fumpsil","Furtloft","Fusraul","Fylin","Fylssa","Fyojhkor","Fynn","Fyza","Gaatel","Gadan","Gadoc","Gadra","Gadri","Gaenlea","Gaerlind","Gaerris","Gafael","Gaisherl","Gajiste","Gakaal","Galaart","Galach","Galaij","Galan","Galbaaz","Galchan","Galdoir","Galenx","Galind","Gallarg","Gallasp","Galmad","Galron","Galsdor","Galvrix","Gambrax","Gamitz","Gamkya","Ganaek","Gandril","Ganerth","Ganerve","Ganix","Gankor","Ganock","Gareck","Gareld","Garhaft","Garlan","Garol","Garon","Garos","Garpast","Garras","Garron","Garstrang","Garstrith","Garthag","Garthaun","Garven","Gathen","Gaunmar","Gaurbal","Gavrok","Gawend","Gaxtor","Gazwylg","Gearna","Geaxa","Gebrence","Gebrow","Gechart","Gechrak","Gedreth","Geerharg","Gehed","Gelan","Gelann","Geldol","Gelwik","Gemal","Gemelf","Genglar","Gerant","Gerin","Gerlant","Geroind","Gerreint","Gerren","Gesin","Gethen","Gezdrey","Ghaachev","Gharlane","Ghatar","Ghatha","Ghellence","Gherent","Gherlan","Ghirra","Ghomnir","Ghralence","Giaj","Gilboch","Gildor","Gildren","Gildrift","Gilflin","Gilir","Gilith","Gillyn","Gilmir","Gilmirst","Gilnar","Gilorn","Gilos","Gilva","Gilvar","Gimeld","Gimlej","Gimnel","Ginnen","Ginorsh","Girbeaux","Girin","Girzan","Gisgin","Githeld","Githew","Gitlan","Gitril","Gittos","Gizralle","Glaeloth","Glaernex","Glaraum","Glasdray","Glasquel","Glaury","Glayant","Gleada","Glebur","Glethlot","Gleyden","Glianth","Glidnimm","Glimanthe","Glirice","Glirrish","Gloisur","Glowan","Glufjyn","Glyngal","Glynzel","Glystraine","Gnasthor","Gnasthra","Gnivlah","Gnohesk","Gnorri","Gnospret","Gobar","Goklod","Golluer","Gomar","Gondrift","Gonjal","Gorad","Gorgost","Gorin","Gorinssk","Gorklu","Gorlis","Gormane","Gornik","Gorshay","Goryon","Gossparl","Gothel","Grachar","Graequil","Graghan","Grahault","Grainim","Granik","Granlon","Gravec","Greavdal","Greelar","Greethrin","Greforn","Grehuse","Grekith","Gremdahl","Grendax","Grennath","Grenslae","Grenvin","Greorle","Grevam","Greyfell","Griam","Grian","Griea","Griffix","Grifnid","Grindan","Grishulf","Gristis","Griswald","Grittu","Grivalx","Groxx","Grombul","Grondar","Grortam","Grulbest","Grussex","Grydon","Gryemox","Grykar","Grypha","Guhan","Guhlnor","Gulla","Gulzund","Gunshird","Gunthal","Gunthar","Gunzhur","Gurdam","Gurjan","Gustay","Guthril","Gwacyn","Gwaihir","Gweddyn","Gweien","Gwenca","Gwendald","Gwepfrath","Gwesder","Gwildor","Gwithra","Gwomyr","Gwyran","Gwythinst","Gyn","Gylrath","Gyrb","Gyriss","Gyrlaen","Gyrlath","Gysankh","Gyseyt","Gystral","Haakrim","Haarstrin","Habmarl","Hadan","Hadar","Hadarg","Hado","Hadrim","Hadron","Haestan","Haefgan","Hafthir","Hagith","Hagra","Haidelth","Haijiss","Hainen","Hakhoim","Haklar","Haklor","Hakpard","Hala","Halbex","Halborn","Haldor","Haloth","Halperle","Halsan","Halt","Halvner","Hamba","Hamisk","Hanastre","Handra","Hanil","Hanierth","Hanith","Hantar","Hanthryn","Hapvar","Haral","Harave","Harchyl","Harfare","Hargan","Harnir","Harntil","Harnyrse","Harpann","Harran","Harrelm","Harstar","Hartaz","Harthan","Harthex","Harthran","Hartrond","Harvas","Harvel","Harzelle","Haspid","Hasrick","Hatchiss","Hatrasd","Havin","Havrel","Hawklin","Hawkram","Hawkran","Hawkreld","Hawleet","Hawljin","Hawtran","Haxas","Hazgarl","Hazkar","Hazrond","Hazvelc","Hazyrg","Hazzal","Hearroj","Hedin","Heenarg","Heengul","Hefpyre","Heinvroh","Helaz","Heldix","Helflitz","Helir","Helsdal","Helsur","Helvem","Hembra","Heram","Herisk","Herndre","Herrul","Herthose","Herym","Herzick","Hespek","Hesrel","Hessun","Hetcroft","Hethar","Hethra","Heurhyl","Hexil","Hezron","Heztor","Hibriss","Hienn","Hiffelk","Hifforn","Hifryn","Hildred","Hilix","Hiljin","Hilxin","Himlon","Himon","Himvli","Hinthan","Hinzay","Hireal","Hirrean","Hisrilf","Hisvran","Hizar","Hizron","Hjalmar","Hjeldin","Hjordrik","Hlyrmis","Hobtalg","Hoesgald","Holay","Holgar","Hollox","Holthan","Homli","Honturg","Hophand","Hoprig","Horan","Horglin","Horjak","Horlask","Hormatz","Horond","Horros","Horthoon","Horzak","Hotath","Hothcog","Hothcol","Hrasha","Hrasquer","Hrelar","Hresheuth","Hrinspire","Hroleur","Hrnir","Hrossa","Hrostar","Hsaptren","Humbuss","Humquor","Hunard","Hundar","Hurcad","Hurgal","Hurnod","Hurrisk","Hursin","Hurvin","Hurym","Hussuln","Huusim","Hyarante","Hyfryn","Hylar","Hyssome","Hyxley","Hyzail","Hyzen","Ibchol","Ibizt","Ibrolg","Ica","Ictar","Iduun","Ighai","Ignale","Ignire","Igraa","Igresk","Iijind","Iithkin","Ijeng","Ikalss","Ikeen","Ikkrish","Ikly","Ildel","Ildelft","Ildin","Ildis","Ildnarr","Illa","Illyis","Ilnim","Ilruhn","Ilsuor","Ilthoss","Iltrilt","Iltrogh","Ilva","Ilvar","Ilxar","Ilyag","Imcanx","Imcolg","Imdiv","Imhas","Immak","Immoyr","Imnarl","Impag","Imrib","Imrift","Imtsith","Indlech","Indloth","Indlut","Indred","Ingarh","Ingelk","Ingen","Inghar","Ingolm","Ingrald","Inilv","Inis","Innluu","Inoke","Inslar","Iom","Ipshoom","Iraiz","Iras","Irauld","Iraunt","Irbry","Irchel","Irex","Irglas","Irlen","Irough","Irrash","Irrax","Irsai","Iruste","Irwick","Irxeath","Isbard","Ishan","Ishenx","Ishgan","Ishkar","Ishlak","Ishshan","Ishya","Islarch","Ismlok","Isorn","Isphek","Issa","Isstan","Itaaq","Ithend","Ithkaar","Ithome","Ivaade","Ivaire","Ivind","Ivool","Ivorn","Ivral","Ivran","Ivrax","Ivyd","Ivyod","Ixan","Ixaq","Ixor","Iygin","Izinth","Izleng","Izmisk","Iztra","Izvire","Jaadis","Jaagix","Jaalmez","Jaalon","Jaaluth","Jablant","Jacor","Jadir","Jado","Jadoorm","Jaedan","Jaelyss","Jagan","Jaggol","Jagrid","Jahir","Jahrgrim","Jaidu","Jaldeer","Jalmid","Jalom","Jama","Janam","Janan","Jandix","Janlay","Jano","Janrass","Jantust","Janu","Japloon","Jarad","Jarilz","Jariz","Jarlew","Jarlith","Jarngor","Jarra","Jartak","Jartusk","Jarveen","Jarvil","Jarvix","Jarzad","Jasir","Jasphar","Jaswen","Jaussig","Jautan","Javen","Javert","Javrik","Javtir","Jaxal","Jaxel","Jaylence","Jazanne","Jazraal","Jazrel","Jazrode","Jebhart","Jedra","Jeeldor","Jeelteg","Jehzehr","Jelthar","Jekkar","Jelantru","Jelday","Jeldor","Jelym","Jenbow","Jendarr","Jenkisk","Jerdys","Jerec","Jerel","Jerim","Jessel","Jetashe","Jethrik","Jeven","Jevist","Jezreel","Jezzar","Jezzra","Jhebdaeg","Jheexadh","Jheluth","Jherrox","Jhinarr","Jhinith","Jhorin","Jhourlann","Jhumpoust","Jhuvar","Jiaf","Jianc","Jiglak","Jihalg","Jilsa","Jiltarn","Jinnow","Jintlorn","Jinvik","Jiral","Jirnon","Jirnost","Jisa","Jithrast","Jixile","Joamorsk","Jobel","Jolrant","Jolsir","Jomec","Jomsut","Jondar","Jooskan","Jorad","Jorael","Joram","Joran","Jorel","Jornic","Joron","Jorvim","Joskyl","Jossak","Jostib","Jothal","Jovaine","Joysair","Jugeen","Juldrake","Julix","Julphra","Jultus","Jungro","Junnar","Jurin","Jurinn","Jurret","Jushdak","Justix","Juthcot","Juxpire","Jynyx","Jyvlex","Kaanpell","Kadjix","Kaerjeld","Kaggoth","Kagolm","Kahlan","Kahmahr","Kaiya","Kaklo","Kaldrak","Kalduk","Kalen","Kaliss","Kallak","Kalshai","Kalthen","Kalvek","Kalvran","Kalxin","Kaman","Kamlant","Kamon","Kander","Kangmir","Kangmor","Kanliin","Kanpo","Kantar","Kanthrix","Kantran","Kanven","Kaplull","Karchad","Karchen","Karchoy","Karcist","Karect","Kareeb","Kargon","Karjin","Karjus","Karkrust","Karnek","Karrax","Karrim","Karsa","Karstall","Kartol","Kasel","Kashir","Kashtuul","Kaspim","Kaspin","Kassar","Katan","Kathak","Kathar","Kathasp","Kathor","Kattelg","Kattra","Kaukris","Kavar","Kavarl","Kavath","Kavis","Kavor","Kayesp","Kayris","Kazarn","Keanca","Kedern","Keerlin","Keermeth","Kegryn","Keigtril","Kekkan","Kelar","Keldar","Kelgus","Kelkor","Kelmar","Kelner","Kelrac","Kelshiir","Kelver","Kelvon","Kelvyath","Kember","Kembriss","Kemoy","Kenshlin","Keraan","Kerdal","Kered","Kerrol","Kersenct","Keru","Kerzard","Kesdric","Kesnahr","Kespeth","Kesrack","Kesrick","Kethdjal","Kethrak","Kevlad","Kexy","Kezven","Khadar","Khadys","Khalart","Khaldan","Khalir","Kheverl","Khondru","Khordov","Khrissa","Khrithra","Khrosa","Khudrax","Khugweb","Kian","Kibbath","Kibha","Kidash","Kiirmu","Kijmin","Kikrasht","Kilas","Kilat","Kilgand","Kilisp","Kilmin","Kimda","Kinduhr","Kinorm","Kinzroft","Kipplob","Kirdon","Kirklen","Kiroum","Kirrax","Kirun","Kirskar","Kirzav","Kisarld","Kishin","Kismer","Kismerle","Kisprimn","Kiston","Kisvord","Kithert","Kithorsk","Kithund","Kithvor","Kivan","Kivooz","Kivoum","Kixime","Kizmay","Kjeldor","Kjindar","Koabon","Kofoum","Koino","Kolbect","Kolchash","Kolduk","Kolthya","Kolvram","Konvain","Korak","Korban","Kordale","Koren","Koreth","Korghil","Korix","Korlisk","Kornor","Kornud","Korok","Korrik","Korsal","Korseng","Kortael","Kortenj","Korthoon","Koruk","Korusk","Korvar","Kosjourn","Kothar","Koxir","Kozzir","Kraatin","Krallorn","Krana","Krangar","Kranorn","Krantheer","Krantor","Kredhal","Kregnux","Krelgar","Krentomzh","Kressen","Krexnahr","Krillon","Krissenq","Krold","Krotald","Krotar","Krotem","Kruchaen","Krynerl","Kugar","Kuldrah","Kulik","Kulleest","Kulxel","Kunatht","Kurdghar","Kurgnar","Kuruz","Kurvos","Kushish","Kydra","Kyladz","Kylcrum","Kylix","Kyllam","Kymen","Kyrake","Kyrmo","Kyrsha","Kyshi","Kysho","Laabrun","Laarskim","Laconde","Lal","Lagu","Lailaske","Laithare","Lakis","Lalan","Lalit","Lalun","Lampor","Lanaar","Landish","Landreth","Langbar","Lanreex","Lanscitt","Lanteld","Lantis","Lantos","Lanvilt","Lanycth","Lanzee","Lanzept","Larbrun","Laresm","Larid","Larind","Larkrosp","Lasquor","Lathir","Lathmarc","Latra","Laudrin","Laxar","Laydor","Layek","Lazelle","Ledmai","Leela","Leena","Leerank","Leesclar","Leggwyt","Leghast","Lehun","Leistorn","Lembarl","Lemgaar","Lemtarn","Lendra","Lensith","Lenzeel","Lephais","Lephern","Leqquan","Lerdeln","Lerlya","Lermest","Lerquint","Lestin","Letek","Lexan","Lextraa","Leystorne","Lherache","Lhusark","Liance","Libourne","Lidrill","Lilir","Lilnid","Liltar","Limdal","Limhoth","Limka","Limson","Lindarl","Lindlorn","Linlaith","Linmer","Linor","Linspar","Lintan","Lintra","Liosse","Liphrodd","Lirram","Lishran","Liskeel","Lissar","Lisstar","Lisstra","Liston","Lisvorn","Litheem","Lithrad","Littwyst","Lixelle","Lixeth","Lixter","Lizki","Lobror","Logas","Lohmi","Loiarl","Loomar","Loorin","Loorzig","Loraem","Loral","Lorbis","Lorrhin","Lorrin","Lorvra","Lothilv","Louwend","Lovoz","Loxzor","Luast","Lubist","Lucenne","Lufraut","Lumas","Lumfa","Lunzar","Lurand","Lurash","Lurin","Luscan","Lutril","Luzfel","Lyanec","Lyem","Lylix","Lyra","Lyrin","Lyron","Maaga","Macra","Macrad","Maefon","Maegwin","Maerraent","Magalph","Maghan","Maglone","Magmarl","Magnyck","Mahhri","Mahrik","Maidah","Maidak","Mairish","Maisa","Maisan","Majan","Makamb","Makisp","Malak","Malasc","Malber","Malboe","Malda","Maldock","Malfar","Malgrah","Malheme","Malinsp","Malkorf","Malnurb","Malthen","Maltheus","Malthgri","Malthor","Malvisp","Malwer","Malzh","Mandrask","Manggrim","Mankril","Manthi","Manton","Mal","Mapyn","Marack","Maraide","Marasp","Marath","Marax","Marclaw","Marcoorg","Mardhrene","Mardix","Mardur","Mareft","Marhalk","Marhart","Marjaan","Markryn","Marlath","Marlock","Marnec","Maroosh","Marost","Marrek","Marrhal","Marrhan","Marril","Marslin","Marslai","Martheel","Marul","Marvold","Marwhool","Mascrox","Maskrulp","Masplern","Masply","Masquoor","Masryn","Massac","Mastram","Mastrith","Mastruse","Mathgi","Mathlin","Mattraw","Matzin","Maularn","Maundrib","Maurdax","Maustere","Mavasce","Mavic","Mavkert","Mavour","Maxil","Mayern","Maylern","Maylin","Mayrime","Mazzyott","Medarm","Meder","Medist","Meeratz","Meffroa","Mefron","Meglos","Megwen","Mejea","Mekosp","Melaunce","Meldresc","Meleas","Melib","Melisk","Meljarn","Melkur","Melleg","Mellore","Melnayl","Melnyth","Melshiv","Melslem","Melviig","Mendra","Mengisp","Menksoor","Menna","Mephyr","Merdim","Merewn","Merkal","Merkan","Merley","Mermold","Mermoth","Merngar","Merophe","Merresh","Merrest","Merrost","Merryn","Mershun","Mersic","Mersna","Merssan","Merthyr","Merweld","Mesrah","Mesrawn","Mestorl","Mestrin","Methnos","Metrosq","Mevid","Mezard","Mhoran","Mhordaal","Mhovair","Mhurdaal","Mhyrrail","Mianth","Mibris","Micrum","Mida","Midor","Mifrax","Migglin","Mijar","Mijhyk","Mikird","Mileern","Milzrik","Mimur","Minom","Minvra","Minyal","Miraad","Mirach","Mircheld","Mirdain","Mirdij","Mirdole","Mireth","Mirglish","Mirhaz","Mirikke","Mirja","Mirjanth","Mirjenx","Mirkaise","Mirkin","Mirla","Mirrash","Mirrin","Mirrym","Mirtrax","Miryash","Mishaar","Mishim","Miskin","Miskul","Misrach","Miszlar","Mithbrin","Mithlerb","Mitrel","Mivarch","Mivrid","Miwarl","Mixtry","Mizarl","Mizma","Mizrab","Mlenjas","Mlocber","Mlodach","Moda","Mogorn","Moirulse","Molez","Mollith","Molnyx","Molrin","Molvigg","Molvind","Mommur","Monmar","Moondar","Mooneld","Moorith","Moorlow","Moormish","Moran","Morax","Morcal","Morchiss","Mordak","Mordlaw","Mordoc","Mordyle","Moreth","Morgath","Morgleeg","Morglin","Morgmar","Morgrim","Morhain","Morix","Morktar","Morla","Morlig","Morlosc","Mornith","Morrhan","Morsklon","Morssen","Mortan","Morthyld","Morvaen","Moryak","Moshaol","Mosyerl","Moyank","Mozoorb","Mrossard","Mubfusc","Mubur","Mudanc","Mudaz","Muhlenk","Muilt","Mungin","Munin","Murgaist","Murhsan","Mustile","Muuthas","Mygon","Myndax","Myrii","Myrnar","Myronce","Myrrim","Myrvarth","Myrya","Mysind","Mysmak","Naadem","Naadra","Naafa","Naalvad","Naasjerth","Nabdoor","Nabol","Nadar","Nadhil","Nadin","Nagai","Naghir","Nagist","Nagvar","Nahar","Nahoul","Naia","Naidel","Naidis","Naidule","Naidusk","Naion","Naisnim","Naithool","Nakrea","Nalbis","Naldecc","Nalkleth","Nalray","Namail","Namat","Namoin","Namvert","Nandrulg","Namphruk","Nantarth","Nak","Napolx","Naras","Nardalg","Naren","Narev","Nargath","Narjath","Narkrisst","Naron","Narqui","Narsok","Narthold","Nartolth","Narvi","Narvik","Nasank","Nasir","Natchai","Natchren","Natein","Nathlim","Nathor","Nathraq","Nautcheb","Navai","Navairnz","Navar","Navesm","Nazaarl","Ndola","Nebcherl","Nebron","Nectesce","Neelrix","Neepmire","Nefhorn","Negert","Negort","Nelat","Nelbron","Nelesck","Nelynn","Nemstere","Nemweal","Nenaire","Nengret","Nephard","Nephog","Neri","Nerish","Neruus","Nerveer","Nesbin","Neshkem","Nesser","Nestra","Nesvan","Nethelb","Netskra","Nevlyn","Newhar","Nexoz","Nextar","Nexxar","Neywode","Nezuel","Nezzdak","Niand","Nibine","Nibor","Niconde","Nictroi","Nida","Nifeld","Nigil","Nigrl","Nijim","Nijis","Nikusp","Nilgorm","Nilnoi","Nimbol","Nimir","Nimon","Nimrede","Nindiss","Nireal","Nirel","Nirhain","Nirhath","Nirloge","Nirnir","Nisherj","Nishla","Nishmir","Nishran","Nissac","Nissal","Nithilt","Nithlom","Nitra","Nivenk","Nivgrom","Nixin","Nizoon","Nizten","Nogaarn","Nokelm","Nolfig","Noloq","Nolthar","Noorlim","Norahl","Nordell","Nordran","Norfroib","Norin","Noroj","Norstoj","Novvulse","Noxit","Nrial","Nuad","Nubweft","Nuendo","Nuhar","Nulka","Nulvilch","Nummag","Nurgan","Nurrzek","Nuscolg","Nushla","Nuuzsal","Nuxile","Nuzain","Nyankra","Nyassaed","Nybron","Nyconth","Nydaur","Nyeon","Nylray","Nynaeve","Nyra","Nyren","Nysra","Oaffleg","Oakine","Oalilse","Oalyn","Oarine","Obron","Obtin","Ocarg","Oedjert","Oeglath","Oejos","Oenu","Oerusk","Oggran","Ogmarx","Ogstlang","Ohmir","Ohmoul","Ohrool","Ohwhon","Ohya","Olanc","Olbrod","Olcind","Oldaar","Oldac","Oleird","Olesk","Olgeerd","Olisch","Olix","Olney","Olthang","Oluode","Olvoor","Omag","Omazd","Ombaast","Omdret","Omfelx","Omkraum","Omoq","Omron","Onchorl","Ondar","Onilsh","Oninsp","Onolk","Onvrix","Oonglax","Ooxaith","Opaor","Opchel","Opild","Opmar","Opult","Oqueln","Orasch","Orayl","Orbern","Orbohst","Orbweft","Ordol","Orgoch","Orgrool","Orhomb","Orinde","Orisse","Orix","Orjasp","Orkuuz","Orli","Orlim","Ormdrad","Ormerd","Ormuuz","Ornault","Ornith","Oroon","Orpax","Orrisk","Orsind","Orskog","Ortain","Orthmar","Ortholt","Orthroy","Ortkuz","Orvulse","Orwelt","Orxlorn","Osgleft","Oshraal","Osphel","Ospin","Osresp","Ossiz","Ossvule","Osthandl","Othast","Ottlan","Ovaile","Ovar","Owal","Owelft","Owlin","Ouxroul","Oxdren","Oxiv","Oxoor","Ozur","Padath","Palaor","Palew","Palifte","Palvem","Palzac","Pamar","Paminsk","Panarre","Pancraf","Pandak","Pandire","Paneesh","Pangaz","Paono","Paraerg","Parbha","Pargask","Pargus","Parmist","Parnon","Paroul","Parrsath","Paslaive","Paxilp","Pazot","Peaflod","Pelas","Pelase","Pelcourj","Pellin","Pelnos","Pelvest","Pemnarsc","Pendoir","Pendra","Pengarth","Pengron","Peraule","Percaal","Perdin","Perdis","Perisk","Perlask","Perral","Perreld","Perrinx","Perthald","Perzec","Pevel","Pexul","Pezloch","Phaithor","Phaleg","Phanstern","Phaovonce","Pharan","Phargon","Pharvis","Phatuum","Phayra","Phenquor","Phesjan","Phinerc","Phinna","Phinra","Phislid","Phlomel","Pholgon","Phondath","Phynynx","Phyzent","Pidnubb","Pilark","Pilkarn","Pirkrod","Pittheus","Planget","Plitkin","Pluroign","Pnakord","Poddle","Pohlon","Pohnoor","Poroon","Porsthil","Portlusce","Praamon","Praarin","Prabaar","Pravdile","Pressar","Presta","Pretil","Prilsorn","Pritantte","Pritjan","Prollel","Proter","Prothoon","Psattor","Psirrim","Pteron","Pulaaz","Pulisk","Pumish","Purrdiste","Puuhilsk","Puvas","Pyalvar","Pyra","Pyrafe","Pyreyn","Pyrjus","Pyular","Pyzzim","Qraatin","Quaestrin","Quagel","Quagrith","Quave","Quaman","Quamrith","Quanar","Quanthon","Quantra","Quanvire","Quardan","Quargom","Quarnos","Quarouth","Quasha","Queageth","Quedrech","Queeden","Queeyat","Quekal","Quelade","Queldrim","Quelges","Quelneth","Quelthar","Quembras","Quenna","Querkez","Querlo","Queryl","Quesan","Quesparl","Quesrol","Quevros","Queygo","Quiddel","Quidre","Quigmoss","Quilmose","Quinaut","Quindle","Quinga","Quinid","Quintarl","Quirrak","Quirvell","Quisrym","Quizlo","Quolbin","Quondoon","Quuddreus","Quyssa","Raaxis","Raband","Raberm","Rablaen","Rabuur","Raccyx","Racere","Radalt","Raddel","Radeld","Ran","Rass","Raethel","Raevact","Rafain","Rafam","Rafarn","Rafmarth","Raftwen","Rafur","Ragdra","Ragen","Rago","Rahaz","Raina","Rare","Raishauer","Raistlig","Raistoc","Rajan","Rajin","Raju","Rakeeg","Rakhan","Rakhaz","Rakheer","Rakkim","Rakspire","Rakthvi","Ralik","Ralir","Ralise","Ralith","Ralkeev","Ralvord","Ramat","Ramath","Ranax","Randar","Randor","Ranghen","Rangvair","Rani","Ranid","Ranousse","Ranthur","Rank","Ranyem","Rascha","Rascrag","Raslak","Rasmoth","Rastagg","Rastak","Ratai","Rater","Rathdome","Rathgor","Rathlede","Rathor","Raudal","Raudell","Ravann","Ravoe","Ravthek","Raxar","Raxen","Razdan","Razdel","Razul","Rebesc","Reddom","Redlac","Redleth","Reeval","Reevast","Regwelf","Relem","Rellskar","Rellzer","Relmnar","Relmund","Relthar","Remerst","Remist","Renair","Rendkett","Rendlorn","Renjik","Renlaw","Renna","Renquil","Resfrith","Reskem","Resna","Ressif","Restid","Retheer","Retor","Retraaj","Reuzor","Revas","Reyga","Reyna","Rezbain","Rezhar","Rhamaine","Rhandain","Rhavee","Rhaxdan","Rhenea","Rheya","Rhila","Rhiorn","Rhobban","Rhodelx","Rhojann","Rhylash","Riaal","Riak","Ribos","Ridun","Ridya","Rience","Rifdos","Rifgild","Rigar","Riklak","Riksul","Rila","Rillif","Rillu","Rilmorn","Rimchoze","Rimnaaj","Rimsall","Ringool","Rinquel","Rinthmaw","Ripurth","Risnys","Ristang","Riswod","Rivalke","Rivarsh","Rivcol","Riveld","Riverle","Rivlin","Rivoold","Rivrook","Rivvid","Rixel","Rixju","Rizhad","Rizzek","Rok","Roakey","Roandat","Robforz","Rocaltz","Rodan","Rodhar","Role","Roll","Roethord","Rofloef","Rokeel","Rolthar","Rlyat","Rontayn","Roolenth","Roqual","Rorkar","Rothar","Roujat","Roweal","Roxhaast","Royanse","Royskyar","Rubarj","Rubiss","Rudrisk","Ruidh","Rukhjan","Rukuz","Rulbowe","Rulmool","Rumael","Rupaic","Rupsey","Rurik","Rusgar","Rusis","Ruther","Ruusul","Ruvad","Ruwen","Ryalas","Rygarn","Rynell","Rynrys","Rysta","Sabak","Sabal","Sabfane","Sabhel","Sabon","Sabrok","Sador","Sadrouth","Saerdon","Saerulse","Safrence","Safrine","Sagard","Saglamne","Saia","Saihail","Saijax","Salir","Sallese","Samand","Samar","Sambrea","Samler","Sanald","Sanan","Sanar","Sandice","Sangol","Sankor","Sanpalk","Sanrind","Sanrow","Sansal","Santlor","Santrul","Saphyx","Sarbrid","Sarcyn","Sardrum","Sarel","Sarex","Sarfinn","Sargash","Sarik","Sarla","Sarlyn","Sarmuld","Sarnax","Sarode","Saroon","Sarthath","Sarthay","Saruul","Sarvan","Sateer","Sathla","Saudraal","Saugrib","Savak","Savar","Savaunce","Savay","Savot","Savryn","Saxar","Scamire","Scarloth","Scaroth","Scarvlin","Schabith","Scharay","Sclava","Scolath","Scradast","Scrilisp","Searan","Seckba","Sedrim","Seethenn","Segrold","Seheitt","Sejar","Selar","Seldar","Selgren","Selith","Selkind","Selnor","Selris","Selthen","Sember","Sembrith","Semer","Semisk","Sena","Sendrej","Sendure","Sengeld","Senrin","Senther","Sentix","Seonce","Sephrone","Seplacc","Seprism","Seraan","Seranth","Seray","Serdu","Sereste","Serlarc","Sermer","Seroz","Serrof","Serryx","Sersoom","Sertase","Seskel","Sethar","Sethchell","Sethjen","Sethran","Sfal","Sfennec","Sferaj","Sforakh","Shabrum","Shadar","Shagold","Shahile","Shaifarl","Shalun","Shalvir","Shamad","Shanfa","Sharaq","Sharaz","Sharrak","Sharrel","Sharva","Sharzik","Shastor","Shathak","Shaxa","Shaydayl","Sheerah","Shembis","Shenesk","Shetrax","Shezael","Shiaf","Shialk","Shila","Shilex","Shimar","Shimglor","Shimren","Shintar","Shirak","Shivan","Shiza","Sholmeg","Shruuminth","Shryffin","Shudleet","Shurik","Shurrug","Shyden","Shylath","Siade","Sibvir","Sidron","Sierl","Sila","Silcharn","Sildeed","Silgast","Silgool","Siljenk","Silmat","Silon","Silphane","Silruum","Silure","Silvasp","Silvryn","Simbrul","Sindhi","Siol","Siralk","Sithirg","Sium","Skaaro","Skagra","Skarazk","Skarloch","Skayla","Skedrea","Skeltrin","Skilon","Skorafe","Skurin","Slanslar","Slanthar","Slarood","Slaskren","Slavgar","Slazor","Sleekla","Sleshkeg","Sleynux","Slijash","Slorac","Slurvaum","Smarag","Smerdis","Smialv","Snargai","Snayrod","Sneitad","Snurlix","Sobeck","Sodarg","Solael","Solbar","Soldine","Solis","Solohe","Solok","Solos","Soltar","Sombrid","Sophald","Sorak","Sorgas","Sormtor","Sorquoon","Sorren","Sorven","Sorza","Sotar","Soveh","Soydil","Spalant","Spandrell","Sparveld","Sperax","Spereld","Spirach","Splinvek","Sprimaine","Squamgreve","Srajsken","Sraknis","Sramine","Srebold","Sreeva","Srendix","Srennant","Sriddoth","Sroika","Sroweb","Sryxla","Stajesce","Stalfess","Starklyn","Staygus","Steeglorn","Stengos","Stereth","Steylin","Sthygron","Stielle","Stirgan","Stornrafe","Strakhan","Strakkar","Streggen","Struquil","Stryast","Strylax","Subreen","Suggner","Sujaim","Sulgra","Sulji","Sulmsy","Sulnseir","Sundoth","Sunjeade","Surast","Surigg","Surjan","Surpy","Susstark","Susteelk","Susur","Sutekh","Suukeeg","Suulkas","Suunall","Suvael","Suvrin","Svringal","Swarflig","Swarro","Swendril","Swiez","Syanor","Sybra","Sylfrix","Sylvine","Sylvyn","Symnar","Syphtar","Syrag","Syran","Syssahz","Syzaash","Taarna","Tabrind","Tachel","Tacrine","Tadra","Taedel","Taennyn","Taeral","Taeya","Tagor","Taher","Tahrjun","Taiwine","Talanth","Talar","Taldar","Taleeg","Taled","Talesm","Talgan","Talgraine","Talgyr","Talisk","Talith","Talor","Talthran","Talune","Talven","Talver","Tamar","Tamnuz","Tamone","Tamoorn","Tamriss","Tanchilt","Tandro","Tanha","Tanisk","Tanlin","Tanndo","Tanoor","Tanry","Tanr","Tanzel","Tanzlor","Taosar","Taoyot","Taran","Tarath","Tarax","Tarcen","Tareth","Tarik","Tarin","Tarisk","Tarith","Tarkand","Tarkrog","Tarlmar","Tarnor","Taron","Taroyn","Tarqu","Tarxas","Tasharg","Tashforn","Tashlex","Tashu","Tashuul","Tasrak","Tasselt","Tasvoor","Taulin","Taval","Tavan","Tavon","Taxlon","Tayerl","Taylin","Tayrsil","Tazen","Tazine","Tchasko","Tealryn","Teawar","Tebish","Tedra","Teekah","Teekug","Teerlin","Tefaz","Tefleer","Tegan","Tegglyn","Tegoth","Teiresh","Teirna","Telaer","Telast","Telcarn","Telett","Telglas","Telgrest","Telkarr","Tellan","Telnar","Telnoom","Telsar","Telva","Telzley","Temorg","Tempros","Tened","Tenelle","Tenjal","Tenlor","Tenna","Tensfar","Tentil","Teode","Terare","Terglaw","Tergon","Terlkin","Terlyn","Ternasse","Terragg","Terris","Tershar","Terslond","Tesin","Teslan","Tevrin","Teyvrilt","Thabou","Thadrum","Thaiduk","Thaki","Thalarn","Thalax","Thaldok","Thamin","Thandart","Thandrov","Thandusc","Thangor","Tharbad","Tharbolt","Tharij","Tharis","Tharjun","Tharkesh","Tharquist","Tharsna","Tharxac","Thaskam","Thaval","Thavarl","Thawlton","Thaxid","Thaxis","Thaxmool","Thaxnar","Thayvudd","Theandra","Thebek","Thelbor","Theleb","Thelin","Thelred","Themnon","Theras","Therbur","Therrak","Therras","Therrat","Thervoh","Thesi","Thesstor","Thibkern","Thimmoz","Thinhla","Thiob","Thios","Thirlain","Thirrild","Thomilt","Thondrac","Thorgeir","Thornix","Thorskal","Thorztar","Thorzyl","Thoskold","Thoye","Thranor","Thraxil","Thremek","Thremix","Thrindish","Thrinyr","Thrykar","Thryxeer","Thugar","Thuldudge","Thulsa","Thurdis","Thuvgalt","Thyra","Thyzlont","Tiaft","Tiak","Tian","Ticham","Tiffrod","Tihan","Tika","Tilal","Tilir","Timaas","Timak","Timdos","Tira","Tiralle","Tirhthri","Tirkan","Tirnor","Tirouv","Tirvil","Tislim","Tisreth","Tisseth","Tithesb","Tivaln","Tlembic","Tlichgo","Tlishat","Tobar","Todyc","Toglank","Tokath","Tokkreft","Tokraz","Tolgarm","Toma","Tonom","Torak","Torang","Torbelt","Torbold","Torden","Toreth","Torghai","Tormir","Torsund","Torthar","Torvin","Torxar","Toscrah","Tourrhok","Tovak","Tovis","Toxathe","Tozjroch","Traalyr","Traken","Tramorn","Trantain","Trantle","Trasven","Travech","Trazom","Tredek","Treeplin","Treffaun","Trefoin","Treizeng","Tremas","Treof","Treslont","Tressak","Trevarq","Trevul","Tricoj","Tridusk","Trilinn","Trisgil","Tristak","Trithax","Triveark","Trizdoth","Troiom","Tromest","Tronvel","Troulden","Trujko","Tsarlit","Tsavan","Tsodjan","Tsojwar","Tsorak","Tuane","Tuchror","Tudlech","Tuezinth","Tugan","Tulkas","Tulsoorm","Tuntix","Turan","Turmasc","Turmis","Turvoost","Turweld","Turzeal","Tuuraj","Tvejasp","Twenja","Twinaile","Twixtib","Tyasaj","Tydwyk","Tylark","Tylith","Tylnen","Tymarl","Tymdrak","Tyrbast","Tyrdon","Tyreen","Tyrgyre","Tyrinx","Tyrlon","Tyrum","Tzichrism","Tzilen","Tziphrin","Udraam","Ufang","Ufoin","Ulak","Ulfade","Ullfrax","Ulli","Ulmyst","Ulos","Ulphar","Ulsplasm","Umbrask","Umbresk","Umchor","Umleer","Ummice","Undreet","Unfegg","Ungax","Unstric","Unstrix","Untveld","Unza","Uqbar","Urdaa","Urdain","Urdal","Urdryce","Urlyn","Urrind","Urthryn","Urtond","Urwoon","Urzvir","Ushnee","Usquik","Ussart","Ussfaal","Ussit","Usstrilt","Ustar","Ustiln","Ustlin","Ustor","Ustorne","Ustrelm","Usxald","Uthmal","Uthnor","Uvorne","Uzfron","Uztum","Vacla","Vadein","Vadrelj","Vadri","Vadru","Vaeddyn","Vaelythe","Varn","Vagar","Vaigthlu","Vaitarr","Valan","Valaz","Valbard","Valek","Valen","Valeth","Valgaard","Valgar","Valgarv","Valka","Valkarth","Valken","Valkesh","Valkis","Valkyr","Valmisce","Valreque","Valtarb","Valthoth","Valyn","Vamert","Vamfade","Vanache","Vanek","Vanger","Vannak","Vannyn","Vanra","Vantsled","Vanyar","Vaona","Varat","Varda","Vareth","Varga","Varka","Varlik","Varmon","Varmyr","Varna","Varnac","Varnar","Varnax","Varnaz","Varos","Varrow","Varsta","Vartoor","Vasaav","Vascais","Vasrind","Vathan","Vathar","Vathek","Vaudric","Vayas","Vaydir","Vayi","Vazar","Vazdo","Vexe","Veena","Vegreth","Vekil","Velaunce","Veldan","Veldin","Velex","Velkind","Velnard","Velsant","Velsard","Velsin","Vembrex","Venast","Vendik","Vengkuld","Venklar","Vennec","Vennsor","Venscoth","Ventorl","Venzra","Veor","Verek","Verisse","Verla","Verlis","Vernar","Vernat","Vernil","Veror","Verren","Vertence","Vervitz","Verwantz","Verxain","Verzod","Veskin","Veswinch","Veyen","Vherla","Viaxx","Vibsoom","Vibur","Vilgrax","Vilraj","Vilsa","Vilthod","Viltor","Viltorc","Vingverd","Virainth","Viran","Virdla","Viscanth","Visharn","Viskrek","Vissir","Vistar","Vistarl","Vithmard","Viux","Vixa","Vixai","Vixlim","Vlastov","Vlitchek","Vluisc","Vlustra","Volcilde","Voldor","Volnir","Vomquind","Vonir","Voozale","Vordnaz","Vorgan","Vorplen","Vorrmor","Vorshak","Vortice","Vosklune","Votorn","Votrax","Voxarl","Vozkoog","Vratund","Vreeleth","Vregom","Vrithon","Vrumtuun","Vryxnir","Vuespra","Vuestri","Vulpix","Vuranc","Vurick","Vurog","Vuron","Vuubul","Vynda","Vyrnael","Vywyn","Vzoris","Wadziq","Waeytef","Wairbren","Walgwim","Wallibt","Walscrin","Wanelj","Wanjok","Wannach","Wanruum","Wanthim","Warbosk","Warell","Warisk","Warthan","Waryn","Wastur","Waylra","Waznak","Weardlon","Wedjeeg","Wedra","Weftig","Weftorb","Weitvan","Welfrede","Welmek","Welndar","Wemsin","Wendath","Weppel","Werclam","Werin","Weshap","Weskin","Westra","Wevkinz","Wextri","Whilfig","Whilmor","Wicrore","Wileert","Wilnim","Wilven","Wilzech","Wirreth","Wirzanth","Wistril","Witrix","Witrost","Wizlow","Wolcharn","Wolkoon","Wolnihr","Worlit","Wraxil","Wrybeck","Wryplax","Wryxerg","Wubneft","Wulfrit","Wurflense","Wusheig","Wuunal","Wuxorn","Wychnor","Wylvin","Wyndbrel","Wyndra","Wyrgon","Wyrsis","Wysholt","Wyvrax","Wyxef","Xadair","Xaedra","Xaelinth","Xaharl","Xaidis","Xaitchek","Xaldreth","Xalkhas","Xalla","Xallath","Xameld","Xanax","Xanbarg","Xandar","Xandrix","Xanille","Xanna","Xanos","Xanrei","Xanthon","Xarafe","Xarakh","Xarek","Xasim","Xaudrin","Xavest","Xavin","Xawnis","Xaxul","Xayide","Xeebract","Xeerha","Xejem","Xela","Xeldon","Xellosp","Xenerge","Xenir","Xephar","Xerra","Xerxisp","Xerys","Xexal","Xhagrim","Xhaibar","Xhomdroll","Xhorald","Xigil","Xion","Xiplin","Xiri","Xirrip","Xloris","Xoncarg","Xopon","Xoris","Xormeer","Xothun","Xovro","Xudeet","Xulan","Xundrahl","Xustral","Xys","Xyst","Xybeuth","Xycort","Xydorn","Xydra","Xygbenth","Xyhaek","Xykrog","Xylance","Xylarz","Xylvorm","Xymoyl","Xytrin","Yaalder","Yaathab","Yadarl","Yaddith","Yadel","Yadreth","Yadurk","Yaglaid","Yagmoon","Yaklar","Yaklin","Yako","Yakthoob","Yammoth","Yamphut","Yandorn","Yath","Yarat","Yarel","Yari","Yarin","Yarnis","Yarram","Yastoz","Yaten","Yatheg","Yavarre","Yavood","Yavroun","Yazlar","Ycore","Yeafosk","Yeifolk","Yeldoj","Yeldrai","Yeoft","Yeoun","Yerdeen","Yergal","Yerkel","Yernoold","Yethler","Yewrapt","Yexil","Yezrik","Yhemnis","Yhemog","Yhoudeh","Yiash","Yildiz","Yilkeyr","Yimzuuem","Yinaun","Yiod","Yirod","Yivthi","Ymar","Ymarl","Yodkin","Yojra","Yombris","Yoorzamph","Yoppulse","Yorim","Yorlask","Yorrak","Yoskan","Yosneth","Yothir","Yottoa","Yrdirr","Yrgash","Yrgil","Yrinth","Yrlmar","Yrvoor","Yuklat","Yuleng","Yurisp","Yuvib","Yuzan","Yween","Zaalit","Zabal","Zabil","Zadko","Zadom","Zadool","Zaelken","Zaery","Zaffar","Zagrosk","Zahur","Zaihra","Zalethe","Zalmic","Zalthen","Zamar","Zamewl","Zamind","Zamog","Zamray","Zanak","Zaneer","Zangor","Zanqua","Zantain","Zanthu","Zantir","Zantyen","Zanurb","Zarak","Zaranthe","Zardal","Zardence","Zardirm","Zardox","Zargoi","Zaric","Zarlon","Zarmarl","Zarouk","Zarphaut","Zarquar","Zarquemf","Zarros","Zarthule","Zastor","Zatarl","Zatheen","Zathras","Zathu","Zatoum","Zausric","Zavach","Zavak","Zavel","Zaviv","Zaxweer","Zayarn","Zaydrim","Zebor","Zebulse","Zedresk","Zefteel","Zehain","Zehirn","Zekal","Zeldaph","Zelgad","Zelgen","Zelisp","Zelked","Zelmarth","Zelminx","Zelvant","Zembis","Zendarg","Zentos","Zeraa","Zerai","Zerakl","Zermish","Zerric","Zervid","Zesdick","Zessain","Zethrel","Zhaizald","Zhakoor","Zhalore","Zhantaine","Zhapris","Zharmele","Zharvek","Zhassa","Zhawend","Zhaya","Zheral","Zhirek","Zhirem","Zhiroq","Zhirquis","Zhogri","Zhomrach","Zhoreb","Zhrana","Zigmoth","Zikuyth","Zilar","Zilmork","Zincir","Zindor","Ziorn","Zirin","Zishuun","Zislun","Zisurgh","Zlant","Zlatos","Zofram","Zoides","Zojan","Zohldrom","Zolfran","Zoltaft","Zomra","Zondar","Zoorkon","Zopine","Zorac","Zorith","Zorlan","Zorthal","Zosarde","Zrufend","Zugdin","Zugoth","Zuril","Zusdhrun","Zuukan","Zvegnaz","Zyjin","Zyla","Zylaax","Zylyn","Zyrel","Zyrelx","Zytan","Zyxim"],three:["Aathoklaa","Abalore","Abeli","Abreyxorn","Abrisen","Acaena","Acamar","Acarnod","Ackia","Acozer","Acravel","Actinor","Adalon","Adalrik","Adanac","Adasho","Adelin","Adelir","Adembal","Aderak","Aderel","Aderyn","Adhara","Adhirman","Adia","Adian","Adiol","Aditu","Adlaron","Admarlen","Adnirrin","Adnoren","Adracea","Adraeran","Adraewyth","Adrasta","Adrena","Adriphaas","Aelarim","Aerissa","Aeruin","Aetharyn","Aexien","Afaellan","Agador","Agaki","Agari","Agella","Agerquon","Agetan","Agexa","Aginor","Agior","Agnaska","Agraia","Agrasline","Agrasol","Agrias","Agristair","Ahina","Ahorra","Aidaron","Aililry","Ainnatic","Aioula","Aircristir","Aistomar","Ajasonde","Akajur","Akashic","Akasta","Akenchi","Akhrida","Akiina","Akirga","Akirku","Akritas","Akura","Akvaron","Alamak","Alanik","Alanyx","Alardan","Alaris","Alarynd","Alathen","Alatvair","Alaxa","Alaztyr","Albara","Albaral","Alberist","Alberon","Alceon","Alceor","Alchica","Aldachur","Aldaka","Aldamir","Aldirim","Aldrella","Aleasna","Aleaxa","Aleena","Aleidar","Alembis","Alera","Aleva","Alfanar","Alhana","Alidar","Aliet","Alifyan","Alinaeus","Alindra","Alixa","Aljarik","Alkaios","Allindren","Allomir","Alloran","Almarisc","Almeron","Almiel","Alnavor","Alshagrel","Altavan","Altorlan","Altria","Alucard","Alzamar","Alzarin","Amadis","Amadix","Amafer","Amaja","Amakelb","Amanster","Amaremne","Amarette","Amatin","Amazya","Ambrezul","Amelis","Amerill","Amether","Amethi","Amharad","Amilin","Aminak","Amintor","Amlieth","Amolithe","Amorin","Ampenden","Amramyr","Anandra","Anara","Anartig","Anashea","Anatsath","Ancelyn","Ancifer","Andaraan","Andistair","Andolan","Andrasha","Andula","Aneelen","Anfara","Anferas","Anfesef","Angalli","Angemon","Anghyrud","Anhalus","Anici","Anina","Ankrista","Annoxin","Anraculd","Anroana","Ansivlan","Ansuki","Antalyaar","Antarlest","Anterra","Antesri","Anthlamar","Antraneyk","Anzera","Apelnin","Aphithea","Apporrosh","Aquiel","Aquorren","Aradek","Aragaj","Araglas","Arajist","Arakbaal","Arakhreen","Arakin","Araldar","Aralik","Aramil","Aranat","Aranis","Arathorb","Araxis","Arbadrul","Arbalac","Arbalon","Arbitan","Arboran","Arcastor","Archolach","Ardalanx","Ardanos","Ardatha","Ardaxil","Ardelin","Ardilex","Ardiseng","Ardissa","Aregel","Arenith","Arestel","Arfandas","Argethlam","Arghesos","Argion","Argol","Argolin","Arhanen","Ariann","Arianth","Aribeth","Arien","Arion","Arioth","Ariseph","Arismacht","Aristea","Arivid","Arkadit","Arkaris","Arkavyn","Arkissar","Arkurel","Arlana","Arleano","Arleost","Arlomma","Arokair","Arolant","Arozan","Arpiax","Arrashad","Arrelask","Arrenol","Arriam","Arridor","Arrivid","Arrosas","Arrossai","Arshashi","Arshavir","Artithea","Artlexu","Arura","Arvanor","Arvirask","Aryion","Arzeela","Ascarleth","Ascaveen","Ascomeld","Asgarath","Asherild","Ashikri","Ashilja","Ashnisci","Ashrodu","Asilun","Asius","Aslior","Asmacul","Asmictir","Aspaleed","Asparind","Asphodal","Aspolyme","Asquilla","Astaedi","Astalon","Aste","Astinus","Astraa","Asurzel","Atalis","Atazra","Athana","Atheran","Athermoj","Athina","Athnolan","Athrasomb","Athrilas","Atlavan","Atorin","Atralan","Atraxon","Atrujal","Attanir","Atticog","Aturin","Atyoto","Aurever","Aurian","Auridra","Aurina","Aurion","Auxebaz","Avalzaunt","Avandir","Avarath","Avasceen","Avenaar","Aveole","Averdal","Avereem","Avernide","Avssd","Avesur","Avori","Avriax","Avronil","Awennes","Axanar","Axarun","Aximil","Ayaren","Ayesra","Azaka","Azakour","Azanakh","Azanor","Azarmax","Azatta","Azella","Azergal","Azfotha","Azilos","Azmarbi","Azmeren","Azolem","Azraxel","Azriaz","Azrienne","Aztira","Azuva","Azuzu","Baeglyndven","Bahnshiath","Bakailis","Bakiar","Balandix","Balanjik","Balathol","Balazar","Balderon","Baledor","Baloward","Baltarreg","Bandibras","Banira","Banjasah","Banjicoy","Banrodi","Bantirgen","Baraca","Barahir","Baramei","Barbardon","Barixid","Barjazan","Barolio","Barsimmern","Bartosca","Barzolo","Basfui","Basidrix","Baslayan","Basliard","Batiax","Baudefloy","Bayazin","Bayidon","Bazakel","Baziran","Bebrae","Becheton","Bedivere","Behamkai","Belaraz","Belarba","Belathgert","Beldara","Beldaran","Belegern","Belensarl","Belgarath","Belida","Belimu","Belinzith","Belistra","Belithin","Bellarix","Bellinus","Belloram","Belmalar","Belmatar","Benalath","Beorilf","Beoshar","Berazan","Berefex","Berethan","Beriam","Berlemdo","Bermulan","Berterin","Besagren","Bestagar","Bethalus","Beztevil","Bilamarj","Birictzin","Birimi","Birrtezir","Bisuneh","Bithritrilb","Blascarro","Bolod","Bozye","Bolangi","Bolgodar","Boradrend","Borvazan","Bordvedo","Boridorn","Borivig","Boroqual","Borosov","Boruja","Breldiar","Breyugar","Brindelvix","Brinzindis","Brirelin","Brofothin","Bruyefol","Bundetlan","Burangald","Byjagan","Caadausid","Cadrillan","Cadxiel","Caglaree","Caladon","Caladra","Calandol","Calandra","Calara","Caldiza","Calial","Calian","Calibarz","Caliburr","Calimen","Calinor","Calinthor","Caliroon","Calrohir","Calvari","Calyreg","Camorba","Camrenard","Candelisce","Candralta","Canteril","Capsia","Caradin","Caraman","Carano","Carastac","Cardannor","Cardriman","Carejjar","Carenac","Caribros","Carvirras","Casliet","Cassira","Castivin","Cathloda","Cauluden","Cavrello","Cazago","Cazrogatz","Cedethea","Cedruin","Celasli","Celedrax","Celeldrir","Celenorb","Celephais","Celimbsel","Celissar","Celmiac","Celria","Cemendur","Ceomyr","Cerastes","Cerdotur","Cereden","Ceremeb","Cerindar","Cernaia","Cerrivald","Cerrlemere","Cervetar","Chakjalom","Chalberyn","Chandalla","Charizar","Charovis","Chasergha","Chatony","Chavrenard","Chayuleth","Chedynas","Chemedis","Cherinra","Cheshinif","Chesifith","Chexotah","Chiranin","Chirophanx","Chirystrad","Chissaera","Choriaal","Chrystara","Cialrak","Ciarna","Ciliath","Cillegra","Cimpelis","Cirial","Cirilar","Cisidor","Claraven","Clarian","Clymerice","Colperat","Colverslyne","Conridas","Coramur","Corcoran","Cordago","Corisur","Cormannon","Coromis","Corraemer","Corstanis","Coyasal","Cramorul","Crayeera","Credori","Cresbaral","Crodelan","Cromora","Crondowys","Cruirmox","Crysindlyn","Cthasia","Cubrucol","Curtifer","Cveralisk","Cyarium","Cynalis","Cynara","Cyrilla","Cyrissil","Daakrasef","Dabnavar","Dacarin","Dagaldsain","Dagorla","Daiavend","Dakkiah","Dakokan","Dalarthra","Dalimir","Dallandra","Dallibren","Dalmaxen","Damarel","Damia","Damisen","Dammarlet","Damria","Danatren","Danbrelaj","Daqualor","Daragard","Darandril","Darani","Darimpelg","Darioj","Darisimp","Darnien","Daruda","Darusor","Darvenel","Darvien","Dasanay","Dasyani","Dathanja","Daurot","Daximyr","Dazaroth","Deglavar","Dekreon","Delalea","Delandim","Delaquoth","Delcardes","Delgadjas","Delgari","Deliard","Delitra","Delmonda","Delonos","Delsinar","Demelsvre","Deminar","Demithea","Dendera","Denivra","Deowrix","Deralten","Derian","Derisurm","Derokain","Descelet","Desnema","Desthia","Destrino","Devabril","Devaia","Devaren","Deviscind","Devyna","Dezelglim","Dharijor","Diagur","Diamel","Diastul","Diazrax","Diniwirn","Dional","Diony","Dismarntir","Distana","Distiva","Diurmad","Divior","Dolva","Dokessin","Dolitan","Dolskior","Domagren","Domovoy","Doniale","Donivesh","Dorana","Doravin","Doraxa","Dorether","Dorgrian","Dorianth","Dorosard","Drafarna","Draglios","Dralgamor","Drelbaran","Dreleon","Dreower","Drusmirak","Druycalid","Durathor","Duruis","Dusoto","Duvalin","Dvereya","Dygardo","Eberyn","Ecarnis","Echengar","Echredrisk","Edalcor","Edamar","Edaris","Edeera","Edeiric","Edelan","Edromon","Eemonil","Eermiaw","Efelin","Efiath","Egarun","Egeanin","Eglashor","Eglathorm","Ehlmargis","Eilinud","Einnara","Ekisha","Elaara","Eladain","Elanja","Elanlir","Elantir","Elardoand","Elayess","Elbasant","Elbrian","Elcaros","Eldikohl","Eldimyr","Eldivren","Eleaseth","Eleniin","Elerasc","Eleril","Elesfar","Elexna","Elhanter","Elharta","Elhiri","Eliaazh","Elindel","Elion","Elispesh","Elissim","Elistan","Eljendril","Ellamoin","Ellanath","Ellendar","Ellidyr","Elmeric","Elmradra","Elnavor","Elno","Elorix","Elriseth","Elrodin","Elrowan","Elsandar","Elverus","Elzirtha","Emeresc","Emistar","Emparyn","Emral","Enchasol","Endelaer","Endeltrad","Endoyarl","Endremen","Engkalat","Enifrax","Enliack","Ennorath","Enore","Ensocand","Enzoray","Eolair","Eolglyu","Eomer","Eosin","Eowine","Eralith","Erbarax","Erdegron","Ered","Ereboen","Eregin","Ereia","Ereidan","Ereinid","Eresbor","Ergamarl","Erian","Erihim","Erijin","Erilind","Erilyth","Erimewn","Eriptil","Erizael","Erjesko","Erkollo","Erlata","Erliskan","Ermentej","Ermiod","Ermizard","Erobor","Erraxam","Errixi","Ersazern","Erudin","Eruna","Escaloth","Eshorden","Eskedar","Eslenix","Esmeril","Essamor","Esselin","Estelorn","Estulman","Esyorna","Ethayan","Ethilrist","Ettellarn","Euralen","Eurayo","Evarul","Evedben","Eveltur","Evenor","Everan","Everard","Evidor","Evrilet","Ewugan","Exior","Exorric","Ezirith","Ezpirasp","Ezrabar","Fabliain","Faerlasdar","Fafmalan","Fahorjom","Falamund","Falazarm","Faldian","Faledra","Falias","Faliorn","Fallonar","Falmalin","Famaril","Famiryah","Farammil","Faranar","Farathar","Farazwen","Farendal","Farezar","Farias","Farinda","Farovlem","Farreflan","Farrian","Fassander","Fassiral","Fathanor","Fathimlas","Favular","Fayenned","Felacroy","Felectos","Felendos","Felentir","Felinstrod","Felladin","Fellathor","Fellazoor","Felmarus","Felvia","Fenhalut","Fenkkara","Feollan","Feraanty","Ferazhin","Ferdithir","Ferena","Ferescha","Feridmir","Feridoth","Ferilken","Ferkiel","Fermandra","Fermazeth","Ferozak","Ferrandry","Ferrinox","Fertimqui","Fesanor","Fesmaran","Fethijorn","Fethorval","Fezmirath","Fiaminch","Fiantzin","Fiathna","Fiensar","Fierex","Filigal","Filrena","Finaefin","Findegil","Finmanal","Finrhabar","Fiollix","Fionlex","Fiorag","Fiori","Fiosthan","Firandaal","Firimar","Firmrius","Fivrenesse","Flaco","Fluimorl","Foshroud","Fomorisk","Fonesco","Fontaera","Forambad","Forizuld","Foront","Forrandir","Foxilkin","Fozdollo","Fraajior","Fragadin","Frelaf","Frinilex","Frosserthil","Frugansey","Fuareece","Fulinas","Fulmerack","Fumorak","Furalor","Fusial","Gadino","Gaffindur","Gaherist","Gaianac","Galassad","Galedrej","Galeeya","Galeia","Galendil","Galhambraj","Galhandvis","Galiel","Galjiu","Gallaia","Galorin","Galrion","Galthien","Galtyran","Galvaris","Gambrefax","Gamorrand","Ganatus","Ganelon","Ganoraz","Ganscion","Ganzadahl","Garagrim","Garalden","Garathgen","Garduil","Gardulkar","Garemo","Garflion","Garlenon","Garriech","Garziot","Gastenmil","Gatlatas","Gatzeiros","Gavendra","Gavilen","Gefandrall","Gelsgiath","Genteras","Gerergol","Gerexi","Geskrivus","Gevanarth","Ghiella","Gidyrrha","Gildanar","Gilennan","Gilfangron","Giljrian","Giltsanos","Gimika","Gipideur","Girazi","Giridal","Giridyne","Giriel","Girkirath","Gisorath","Gisriral","Gisselek","Givirtrik","Gizarak","Gizbion","Gizherae","Gledrion","Gleocyn","Gleyander","Gliranna","Glirfingril","Goibhniu","Golexar","Golo","Gonscevin","Gontomir","Goranna","Gorazky","Gordalis","Gorias","Gorion","Goronwy","Goronyr","Gorova","Gorthokon","Graginar","Graliath","Gredanost","Griarnix","Griotam","Grissejan","Grolliax","Gualat","Guilmarn","Gulifrith","Gurnarok","Gwyrion","Gydrian","Gymnivus","Gyrelyest","Hacoulede","Hadowrak","Hafranel","Haielva","Haijannod","Hajandin","Hakatri","Halibarn","Halios","Haliwyn","Halveron","Halvia","Hamadar","Hamancen","Hamavand","Hanamere","Haneran","Hanorayn","Hanrassu","Hantaira","Haplana","Haprissa","Harana","Harandash","Harezek","Hargranar","Harigran","Harnahad","Harobel","Harondar","Harromarl","Harsinna","Hartien","Hartazan","Hasalgar","Hasprion","Hathlizu","Hathvoril","Hautilim","Hautulin","Hauxpomel","Haxmaraun","Haxmaspar","Haxmered","Hazalet","Hazazel","Hazharat","Haziran","Hedrapake","Heereos","Hekeren","Helbathil","Helobaine","Helphegad","Helziatz","Hemgarel","Henalur","Herecharn","Heriganj","Heriol","Hessevet","Hethica","Heuleanar","Hexavren","Hexelin","Hiabaid","Hiassveil","Hifridil","Higlaia","Hilio","Himurlem","Hintyrit","Hirodrix","Hizirin","Hokryhn","Holmarun","Horbajir","Horlabo","Hralfecca","Hrioncet","Hulterna","Hurjal","Huvatal","Hyaliptar","Hyarantar","Hydrestin","Hylamet","Hylarel","Hylissa","Hyphorond","Hyraskel","Hyrkhalla","Hyzaspes","Iahaun","Iarlen","Iasho","Ibekon","Ibgali","Ibrana","Ibriax","Ibriole","Icanaar","Icavra","Icera","Ichandrik","Ichindar","Idarlan","Iffalon","Igjaru","Ijevthla","Ikarin","Ikirkar","Ilabrem","Ilairam","Ilarnin","Ildezir","Ilenfal","Ilfangir","Ilfinir","Ilgaeldar","Ilikir","Ilimvair","Ilkern","Ilkyarzim","Illana","Illara","Illiarn","Illsuin","Illuanc","Illurdan","Ilkaroque","Ilnitelg","Ilrehjan","Ilumaar","Ilvelisk","Imaia","Imajin","Imashla","Imaydra","Imedet","Imikeer","Imilxime","Imisard","Immelanx","Immoreth","Immornam","Imnatris","Imrahran","Imravog","Imrazixt","Imzia","Inayiss","Indreju","Ingrenux","Inhectin","Inidar","Inifael","Inifox","Ininay","Inisdex","Inisfail","Inkiljist","Inkotai","Innok","Inora","Insallasc","Intaphka","Inzellene","Ioga","Iolan","Iombar","Iosaz","Iosdil","Iperi","Iphara","Ipholar","Ipolok","Iptasor","Irankar","Irathar","Ireneemp","Irial","Irian","Iriboth","Iriga","Irmaskor","Irmistib","Irphilin","Irriosce","Irshirkur","Isaelsu","Isamar","Isarma","Isbexa","Isencal","Isgremnir","Ishmira","Ishnitra","Isiki","Iskarrine","Iskimi","Iskiret","Isodrost","Isotu","Isromant","Isrotha","Issakra","Issanthal","Issevex","Issimrak","Istengrem","Istensanth","Isthentild","Istheol","Isthgiol","Istidom","Istijed","Istroval","Isuxnen","Itharna","Ithelus","Ithimryr","Ithineg","Ithober","Iventhax","Ivrishel","Iwranda","Ixambel","Ixanthis","Ixarine","Ixcavar","Ixium","Iyenna","Iyiskek","Izpiizzi","Jabarla","Jablomeed","Jaelmura","Jafila","Jagadis","Jagaroch","Jahaurin","Jakalar","Jakarhul","Jakendar","Jakharral","Jakronib","Jalaran","Jalatha","Jaleana","Jaligar","Jalisharn","Jalnio","Jalvochin","Jance","Jandagar","Jandenor","Janien","Janniel","Jaralor","Jarantin","Jaratryne","Jardilan","Jarien","Jarioth","Jaronris","Jascelat","Jascenant","Jaslani","Jassolind","Jatherfar","Jathlabra","Jathzoril","Jaukulmar","Jaurelin","Javennae","Javrezac","Jazaeron","Jejaneel","Jeleeya","Jelerish","Jelgrion","Jemadar","Jemkoleng","Jeoric","Jeoster","Jeprana","Jertezan","Jervida","Jessabra","Jevalor","Jevedic","Jevorin","Jevrian","Jhessala","Jhinilak","Jianthi","Jidesa","Jifrusni","Jijinjic","Jilarna","Jilitha","Jillaro","Jingaran","Jiriselk","Jiruik","Jivessla","Jivizet","Jixannil","Jizuret","Josra","Joplezno","Jorian","Joriel","Jorodrin","Josafyre","Jothaugan","Jothera","Jozranal","Jranahaz","Juarin","Jumeon","Juramanx","Jussondrel","Juxeccan","Juzawik","Kacinzen","Kadishir","Kahora","Kairaku","Kajabor","Kajua","Kalandrin","Kaledath","Kalvaro","Kamisu","Kamundam","Kandonak","Kandorin","Kapasin","Karal","Karamis","Karanchir","Kardarkar","Kardotha","Karela","Karezthame","Karimeg","Karogan","Kasiran","Kasluna","Kastana","Kastaut","Kasthukras","Kathanal","Katryzaj","Katumar","Kazellor","Kazun","Kedrinal","Kelemon","Kelmerveld","Kelraiog","Kelvixa","Kemmergen","Kerannix","Kerason","Kerasun","Kerendul","Kerfina","Kernamald","Keroona","Kerrekril","Kerrihaude","Kestramel","Kexranea","Khadera","Khalidr","Kharisden","Khelaret","Khorenym","Khosilin","Khuraram","Khurkula","Kiarak","Kiaskek","Kifadli","Kinbulser","Kinjeon","Kintarna","Kioxug","Kireoj","Kirias","Kiriok","Kirithul","Kirrevi","Kiuspou","Kizarlon","Klandisar","Klirundon","Kodoki","Korachon","Korasal","Kortien","Korvaron","Kotajad","Kothenai","Kovaia","Kozanga","Krasgalad","Krienna","Krisilal","Krytelgaz","Kuiju","Kydomor","Kylara","Kylinsra","Kymelin","Kymorel","Kyrembra","Kyvaran","Kyveler","Laaraban","Lacoumox","Lacrion","Ladamur","Ladestro","Laesina","Lafera","Lagaram","Lagova","Lahanolt","Laklanot","Lalaia","Lalthilan","Lamidris","Lamifer","Lamizjax","Lampralur","Lamrella","Lanisor","Lanival","Lanstre","Lantakrel","Lantamar","Lanumel","Lappeleme","Laprimal","Larana","Laranel","Larilect","Larion","Larquinip","Lascynthis","Lasirusk","Lataffin","Lattremond","Lazadon","Ledmial","Legaaruksh","Lelatha","Leledish","Lendela","Lendoweer","Leodaan","Leojith","Leoptrin","Leptenar","Leptredin","Leranorb","Lessefren","Lethrian","Levasim","Lhyrrhana","Liamar","Liambra","Liammeck","Lianairn","Liansra","Lianvrin","Liarxa","Liavec","Liembra","Lilasta","Lilkauki","Lilthia","Limbria","Linargan","Linnaker","Lionus","Liossoor","Liquemar","Liroitzin","Lisimbra","Lissara","Lissflorel","Lithuir","Lithyulin","Litoefer","Liydala","Lizenna","Lizinra","Llanaanu","Lora","Logano","Lorana","Lorenvra","Loriant","Lozeneth","Luciet","Lucimer","Lunzia","Lurepusc","Luspilkir","Luthirring","Luuranoth","Lydalay","Lymandal","Lynaya","Lyndr","Lynxias","Lypilla","Lyraloss","Lyrian","Lyrossa","Lyrozi","Lythian","Lythratole","Lyzeary","Maalkeyan","Maceon","Madaluur","Madiglim","Madora","Maerleetlas","Maeronyx","Mafranic","Magezatt","Magithel","Maglethom","Magylin","Mahelas","Majaelith","Makana","Malasse","Malaioc","Malambard","Malandor","Malasire","Malasquor","Malavok","Malbrosac","Maldagon","Malechan","Malestrin","Malgadarn","Malhantis","Malhemar","Malidryth","Malifrin","Malisken","Mallaran","Maloroc","Malsanon","Mamvier","Mandrezool","Manjalem","Mannanon","Mantragan","Mandat","Mapiran","Mardieth","Maridan","Maridisp","Marindro","Marinus","Marivik","Marliok","Marmaranx","Marmeron","Marniel","Marreldix","Marsarok","Marsineh","Martanzix","Maruis","Mashalla","Masira","Massoran","Mathannil","Matzirik","Maunestin","Mavira","Maxander","Maxtibel","Mazegus","Mazesra","Mazian","Mazivel","Medarinn","Medrahar","Medvergaal","Mehalet","Mejarlan","Mekeesha","Melamnir","Melapis","Melasdar","Melikkhaz","Meliune","Melliorn","Melorond","Memisaire","Menalor","Mendobarl","Menelvaour","Meodas","Meraleph","Merama","Meramel","Meranshu","Meraudax","Meriag","Meridyn","Meriel","Merilec","Merinar","Merinard","Merivran","Merkalo","Merlience","Merresil","Merscianthe","Mertamet","Mesegrim","Metrofa","Mevedet","Mewreddan","Mezedan","Mezerel","Mezlehet","Mezlethil","Mezrian","Mezrenain","Mezvorax","Mialdere","Mialorn","Midela","Mierah","Mikramil","Milicseth","Minaxa","Minrioth","Miranei","Mirantilb","Mirelith","Mirenta","Miriel","Mirieth","Mirintha","Mirion","Mirreschade","Mirrsomi","Misella","Misiplum","Misirim","Mithelos","Molroc","Mobrias","Moieddin","Moisiane","Molhanni","Mondestin","Moramin","Morannel","Morilimth","Morleved","Mormindar","Morofar","Morozam","Morrixan","Mosbelo","Movellan","Moxfiel","Mrankali","Mredisu","Mujeket","Mulciner","Mumivor","Murbahir","Murias","Murinja","Mustesra","Mylbdenir","Mylenost","Myllara","Myloryx","Myractus","Myrmelesc","Myrrhismir","Myrstica","Myruken","Myvior","Naadien","Nabronyb","Naska","Nagarax","Naiagard","Najikim","Nambolar","Namezlith","Namien","Nappolanc","Naramant","Naranlob","Naraven","Narecan","Naretha","Narfalax","Narimas","Narisdaat","Narissa","Narotham","Narothun","Narrabhar","Narseldax","Nasmerul","Nateera","Nathogan","Natrifer","Nauthzegam","Naveiruz","Navislorn","Navithesk","Nefaroyn","Negula","Nelibar","Nelphina","Nelthenti","Nelveren","Nemarhaz","Nemisen","Nereitra","Nerevaunt","Nerian","Nerida","Neryonid","Netharna","Nethol","Neveena","Nexian","Nexlio","Niascynth","Nidoran","Nienra","Niggollo","Nilchauntif","Nilmio","Nimandest","Nimfiralth","Nimiax","Ninozain","Niomakh","Nisamon","Nisaqua","Nissafen","Nitharna","Nithikin","Nitoda","Nivilan","Nizamar","Nizared","Noldiruth","Nolteera","Nooranda","Norian","Norvandrel","Noumander","Novrima","Noxalwan","Nuanvi","Nuarban","Nujriha","Nulagdi","Nuskuron","Nyrana","Nysorat","Obatzi","Obelnid","Ocmias","Odimos","Offenalke","Ogola","Ohranjat","Ojavi","Ojilinx","Okalder","Okpala","Oktavisp","Olamar","Olbenos","Oldarane","Oldrinben","Olican","Ollascet","Olnefkin","Olondin","Olonthos","Oloru","Oloxem","Olybris","Omaldras","Omaphel","Omarna","Omarthis","Omberdal","Ombriand","Ommarisk","Omosdur","Omziec","Onaldrus","Oneira","Onfivlen","Oniack","Onjedrit","Onoxim","Oolevran","Oomia","Oorandehle","Oquilda","Oradrad","Orbasdron","Orbeleez","Orbitan","Orchellor","Orebus","Oremex","Orenai","Orennem","Oridyr","Oriob","Oristkel","Orithreyn","Orivaen","Orlantsu","Orliend","Orlopem","Orluan","Ormadzel","Ormarit","Ormion","Ornulaa","Orodel","Oromrath","Orovar","Orovune","Orpirrhis","Orreminsk","Ortazan","Osgoran","Oskana","Osmoril","Osoyrir","Ossfenness","Otargol","Othaldon","Otralinx","Oujanglor","Ouraia","Ovarasc","Ovelleau","Oveselm","Ovranoj","Ovrenor","Oxavar","Oxavart","Oxrul","Ozatris","Ozgethern","Ozmirall","Ozringol","Palabell","Palarna","Palegain","Palidral","Palimbrust","Palinor","Panafig","Pandaxes","Pandelee","Pandeleur","Paomelna","Pardyereyk","Pargascir","Parlion","Paskorran","Pastengral","Pavadahl","Pavandor","Paxijanc","Paxilla","Pazaleeb","Peladon","Peledor","Pelendur","Peleod","Pelezef","Peliast","Pelizon","Pellingale","Pelmercest","Pelmergol","Pelsiffra","Penengvik","Peradal","Peraga","Perendan","Perendor","Peridor","Peripril","Perisgrim","Peristaad","Perligon","Pernian","Perridex","Persimmid","Perushka","Peslivar","Petreban","Phaidonaz","Phaneon","Pharethyn","Phariol","Pharnioth","Phascalon","Phesian","Phiarusk","Philizim","Phiniak","Phiressa","Phoosrotex","Phoseter","Phramberzond","Phranzulet","Piapiar","Pievalp","Pillia","Pioma","Pirigal","Pirilaud","Pirinweal","Piritosk","Pision","Pishior","Pithibryl","Piynameer","Plamias","Plenchiel","Poinellay","Poinembet","Polassar","Polorrum","Porodo","Porsenna","Potadu","Priligrel","Progneti","Ptamriad","Ptelian","Pteraphon","Pulsavra","Pyrenda","Pyrtolosc","Pytholtus","Pytrigon","Quaeleon","Quagrana","Qualbian","Qualhassan","Quanack","Quandiel","Queegani","Quenteri","Quentezard","Queoddry","Queridra","Quero","Quersemel","Quilium","Quilverex","Quinibus","Quisifrix","Quolatha","Quolessip","Quoranl","Quyzacorm","Raascia","Racassar","Rackafel","Radasman","Radelon","Radula","Raiveral","Rajiten","Rajurno","Rakmyrral","Rakshilan","Ralanzur","Ralisimp","Ralmanor","Ralystra","Ramura","Ranessin","Ranicroy","Ranifice","Ranomar","Rasaleth","Rashemba","Rassdolim","Rasseglin","Rassfydel","Rastilon","Ravathene","Ravenor","Raverail","Ravimo","Raxia","Razamor","Raziel","Renkal","Reepifer","Regalorj","Regimir","Reldorin","Releza","Relikin","Relion","Rellevirk","Relliapt","Relundar","Rendeptir","Renzelath","Reonin","Requiek","Rescorance","Resmenalse","Retalkin","Rethia","Revenal","Rezmyra","Rhakotis","Rhendalin","Rhiacind","Rhimaya","Rhimeren","Rhisala","Rhomiscele","Rhydolin","Rhylar","Riasine","Riatar","Riatha","Rickata","Rigisil","Rigonav","Riimara","Rilatha","Rilidtai","Rilmara","Rilmorban","Rinxfantir","Riodan","Riolarn","Riolba","Riscintell","Risgana","Risia","Risrinam","Rithotarl","Rixian","Rizifire","Rocapeste","Rodifel","Rodion","Ronen","Rokefyre","Romela","Romenom","Rondolla","Rophelon","Rophendir","Rosmarlind","Roudth","Rovlerac","Rozeeldin","Rugiel","Ruhria","Rumilan","Runian","Rusaadi","Rusalmna","Rusitholk","Ruvasarn","Ruvatro","Ryzile","Rynian","Rynristas","Rynyris","Ryxarro","Sabrazsa","Sabriel","Sabtimon","Sadabel","Sadeera","Sadonel","Safarrinx","Saffinka","Sagamir","Saguil","Sanda","Sajaerix","Salaarus","Salathir","Salclias","Salina","Salinen","Salioct","Salitlan","Salmorin","Salrissa","Samalend","Samerlan","Sancial","Sannsara","Sanorye","Sanpellin","Sanseran","Sanzhara","Saqavar","Sarandere","Saraxa","Sardanak","Sarendril","Sargadal","Sariya","Sarkinos","Sarkozan","Sarlian","Sarmasar","Saro","Sarozak","Sarrier","Sarrofo","Sarsicaul","Sartenna","Sarupha","Saschalon","Sathlatta","Satrothan","Savma","Savretos","Savria","Scathanar","Scesefna","Sebandune","Selamvra","Selestor","Selial","Selidro","Selior","Selmiar","Selnara","Selnia","Selsabar","Selverel","Semarsen","Semdalice","Semmagel","Semurquan","Sendara","Senoster","Seorra","Sepiroth","Seprenal","Sepria","Serakel","Serambast","Seramir","Serefic","Serrios","Sertumen","Servelen","Serydran","Seskandal","Sevandir","Sevandor","Severique","Severlesk","Sevlasn","Seytarin","Sfaeriqua","Sferalan","Sferio","Shaikala","Shalimed","Shameera","Shanatherl","Shanderzoth","Sharajsha","Sharbremil","Shardovan","Sharretal","Shaxen","Shehallem","Shekkazad","Sherethis","Sherina","Sherotha","Shevrian","Shibema","Shiennith","Shildakor","Shimjian","Sholgonda","Shragonach","Shrymaroyne","Shurakai","Shushila","Sialtaan","Sianar","Siandar","Siandor","Siannem","Sidanzar","Siendred","Sientij","Sientrib","Siflana","Sigilla","Sildengold","Silifer","Silistel","Silivis","Silmriel","Silvarak","Silvronom","Simara","Simblio","Simirling","Simisthir","Simrana","Simusha","Sindaract","Sindiris","Sindiroq","Sinhadak","Sinira","Sinoprin","Siortlen","Sioshorl","Sirelu","Sirenel","Sirgamesc","Sirifrix","Sirinar","Sisimar","Sisimbra","Siugorn","Sjalara","Skalidra","Skelalack","Skelogha","Skelother","Skesira","Slanarra","Slanria","Slenlior","Slevindralsk","Slyrmegnel","Sofrego","Sofurin","Soleddin","Solfellan","Soliroq","Solliot","Solmerip","Soltharan","Somagar","Sondaardrel","Sondrelen","Soomerak","Soquallin","Sorasta","Sormian","Sozmerold","Srandelix","Sravoorin","Steraval","Sthinalel","Stiaver","Stivernach","Sudevim","Sufranar","Suilim","Sujorgni","Sukratak","Sulathaag","Sulethri","Suliane","Sulien","Sulimo","Sulkanar","Sulkari","Sulron","Surmaris","Suruay","Suzamil","Svialdan","Swangoren","Sweiborla","Sylvetane","Symaril","Syriolg","Syzirept","Szivistri","Taalivex","Tabusaad","Tadasli","Tafashic","Tainbara","Taladere","Talareme","Talarin","Talertus","Talien","Taliess","Talieux","Talion","Talislance","Talmora","Taloxar","Taloxi","Talunon","Tamavold","Tamias","Tamioj","Tamlivran","Tamnithir","Tanafin","Tanakord","Tanier","Tanjalas","Tanjara","Tanseral","Tanviu","Tarakus","Taramag","Taramos","Tardelin","Tariaj","Tarkenthos","Tarmesorn","Tarmioc","Taroya","Tasardy","Taslhiot","Tassafert","Tassiran","Taumonar","Taveli","Tavista","Tayaren","Tenyn","Tegana","Tegleron","Teirajan","Teirishir","Telarna","Telcyra","Teldrua","Telegris","Telendys","Teleura","Telnarzim","Temeris","Temeslin","Temmosus","Temontel","Tenadas","Tenidrist","Teotsir","Terasiln","Terejoen","Terena","Terquaelen","Terrenus","Terthelej","Terthyrkrim","Tervan","Tesmarrak","Tevala","Tezarim","Thadarin","Thalafer","Thalaras","Thalira","Thalladyle","Thameera","Thamiel","Thanalar","Tharamoon","Tharnia","Tharomyl","Tharoval","Thellikkin","Thelodin","Thereski","Thieras","Thieryn","Thirindon","Thithrama","Thitrivar","Thixagen","Thlenedern","Thlunarna","Thoorana","Thrabanquo","Thumithar","Thurmatoth","Thuuvanar","Tiabrell","Tiachul","Tianan","Tiaosut","Tiaxa","Tiazan","Tiefkol","Tifulgar","Tigrana","Tirages","Tiregam","Tirelev","Tirion","Tirlimist","Tirrasthu","Tissawane","Titia","Tivadul","Tiveran","Tivriex","Tiyagar","Tizvian","Tolarim","Tolarmej","Tolenka","Tolibell","Toramus","Torbera","Torgassin","Torlion","Tormitran","Torosh","Toroman","Torquenyx","Torresind","Torsamant","Torzundus","Tothirnal","Tralien","Tralquien","Traviod","Tredestin","Trellium","Trenaevis","Trilajo","Trinezhan","Triolus","Trisdestrin","Troviawn","Trydaron","Trysadon","Tsacramal","Tsalkoril","Tuilleth","Tulio","Tuniger","Turmalin","Turobel","Turvesin","Twanalor","Twillessin","Tylastreen","Tyldora","Tylenea","Tyradin","Tyrathis","Tyrtyra","Tzaroli","Ualosk","Ubdakon","Udanax","Udanib","Udefoin","Udrahart","Udria","Ufanort","Ufial","Ugivor","Uilda","Uilric","Uixet","Ukinorn","Ulanthas","Ulember","Ulendal","Ullifan","Ulnavell","Ulnaxdra","Ulrepin","Ulronce","Umaspin","Umbraheed","Umbrina","Umerac","Umeri","Umikrel","Umistal","Undalryn","Unedrinj","Unkalisk","Unstoffel","Urar","Urghazkoy","Urhankren","Urimnor","Urjalum","Urjaya","Urmalgis","Urrelor","Urzunift","Uscrumine","Usegar","Ushamtar","Usigul","Uskanast","Ussala","Ussolec","Ustaleaugh","Uthudain","Utorel","Uveena","Uxavis","Uxinor","Uxuvi","Uzileth","Uziprost","Uzirin","Uzisloj","Vacrux","Vakrissa","Valabar","Valadan","Valagarth","Valandrib","Valarend","Valarom","Valaxis","Valdera","Valfoxel","Valina","Valion","Valistes","Vallia","Valmerac","Valphanar","Valserna","Valterla","Valthom","Vanamon","Vanara","Vanathil","Vandelex","Vanegrin","Vangrahzmid","Vantarad","Varamanx","Varamid","Varamis","Varcantis","Varchimas","Varkellit","Varlandel","Varral","Varrakel","Vashlion","Vasmarro","Vaudirek","Vayemis","Vedaraf","Veezpro","Velaila","Velanac","Velija","Velina","Velior","Velissa","Velozma","Velvermeld","Vendramyr","Veneska","Venithros","Venmarenc","Vercazlyde","Vereedra","Verenice","Vereska","Verethest","Verissrad","Verolant","Verowa","Vervadesce","Ververine","Veslomere","Vetrengarr","Vettemis","Vhiallon","Viastin","Viastra","Videla","Videssos","Viero","Vilirast","Vilrokin","Vilscelyn","Viomer","Virandisp","Virenar","Virensa","Virjauruk","Virosanne","Virthuren","Vismarun","Visperime","Vixuad","Vixul","Vizina","Vladilesk","Vlarobaal","Voiop","Vojeera","Voldisterre","Volkazen","Volmaran","Voluru","Vonidar","Voozcoreme","Voranor","Vorchazel","Vorelgin","Vorien","Vornica","Vornovas","Vorquemand","Vorunir","Vorvadoss","Vosmerrel","Vossari","Vozmarald","Vrepimus","Vrilestamn","Vristamor","Vuthar","Walspinore","Wandalar","Wanestka","Wantorak","Wardlanof","Warlwier","Warrigel","Wascramin","Wasmot","Watreyan","Wazerac","Wedonal","Welmerel","Wendower","Werrelet","Werscunok","Weverin","Wexavin","Whallifrond","Whearius","Whibmistle","Wianna","Wicardod","Widzoonaev","Wignaja","Wiinecot","Winian","Wodhrian","Woringel","Woxethoon","Wrodlian","Wurzemand","Wyliath","Xadamos","Xadogar","Xaisuruk","Xalorof","Xanafel","Xanalver","Xanbiah","Xania","Xantenmec","Xanxia","Xaraata","Xargusull","Xarthia","Xeelafarl","Xeelona","Xegessem","Xelica","Xemeret","Xemindar","Xenia","Xeralisk","Xerdelisse","Xerechron","Xhalsadan","Xhanazlet","Xhodrovan","Xibalba","Xiifrani","Ximahlto","Ximakran","Ximodi","Xirian","Xirijasp","Xonon","Xomdiral","Xorandor","Xoryalan","Xyaria","Yaimondar","Yakovar","Yakthodah","Yalduvar","Yaliath","Yallarna","Yallorind","Yalveron","Yamala","Yamindra","Yandelar","Yandrahla","Yaralet","Yarial","Yarillo","Yarzolept","Yashengzeb","Yathagault","Yathoric","Yathorlak","Ybalil","Ybranar","Yeltranal","Yeluz","Yemanthal","Yemboloth","Yerdien","Yesgolod","Yevjarel","Yfremoon","Ygristan","Yhantur","Yldejaste","Ymarisce","Ymbria","Yncaarim","Yohonough","Yonraloth","Yoplossa","Yoredan","Yormexoon","Yranthis","Yratos","Yrcanos","Yronthol","Yrwelos","Yryloth","Ythlyra","Ythribond","Yurnada","Yusperal","Yuzigral","Zaamontel","Zadamun","Zadipan","Zadrowane","Zagrenxa","Zaharbif","Zajrenja","Zakiwya","Zalagi","Zalanath","Zalazar","Zalberek","Zalremy","Zamberel","Zamblezur","Zamora","Zamordax","Zamorla","Zanatir","Zanestra","Zangabal","Zanindil","Zanreynad","Zantifer","Zanzinel","Zaraana","Zaranave","Zaranax","Zarfhaano","Zarimarth","Zathmandar","Zayzazi","Zazamanc","Zazumel","Zazwinoon","Zebalan","Zefaeran","Zefrondus","Zelemorn","Zelgadis","Zellinet","Zelmarine","Zelprothon","Zemanthel","Zemirtol","Zenaxa","Zenilyeth","Zenithral","Zenorsha","Zentrigar","Zeosard","Zephiron","Zequiel","Zeranoj","Zhelavon","Zhemaeta","Ziacalt","Zifidin","Zilkorlaz","Ziraldra","Zirdarbis","Zirzihin","Zolmar","Zondrik","Zovar","Zochiad","Zodolin","Zoltaren","Zominor","Zoramus","Zoranji","Zorashad","Zorayas","Zorestrel","Zorewyr","Zoroma","Zoromesh","Zosmindo","Zotaquaan","Zotheera","Zozminod","Zubvuysa","Zulaeram","Zulpirek","Zurenkin","Zurliban","Zydaraf","Zylarthen","Zyramythe","Zytavirk"],more:["Abadapnyr","Abrethendar","Acrasian","Adario","Adieseth","Adilikor","Adinalar","Adriaxa","Afelanidd","Aforvalon","Agiora","Agreliwin","Aguidran","Aguilla","Aikikia","Akitarka","Alanahetra","Alarion","Alartia","Alarurigu","Alcidio","Aldarian","Alelakon","Aleshmara","Aletorim","Aleuworust","Alianala","Alicindra","Allessanya","Alorassanz","Amafeyan","Amathenar","Amdaramast","Amiria","Amriffien","Anaumiantis","Anelofar","Angetenar","Angurvidel","Animeldio","Anixido","Ankitarla","Ansamanthion","Ansimantar","Anspiladri","Antillia","Aphiana","Aptolcater","Aptrinuptium","Aquilia","Aradlum","Araledek","Aramanzom","Aramestor","Arania","Arazederu","Arazynxa","Ardzefurith","Arezia","Arhilian","Arianroth","Ariaria","Ariaxoc","Arismaspia","Ariyava","Armalisrah","Aroxian","Arrolian","Arsevalin","Artalien","Aruzustin","Arzangiran","Asalirin","Asarlia","Asicia","Aslambarash","Aslerion","Asthania","Asuricorm","Atarana","Athiana","Athlebasia","Athoriel","Atiaran","Aulurien","Avalenar","Avanimmerl","Avelembai","Aviathar","Axajaxas","Azeledim","Azgelazgus","Aziria","Barosathlom","Barylophar","Bazkalia","Beledira","Belintraia","Belrablion","Borosiyan","Bradullio","Brodalcaflar","Cajarrida","Calanes","Calasapia","Caldiloran","Caleria","Calgalcandar","Calidundarios","Calliwelleran","Calmamelis","Caratrothis","Carthazian","Casrinian","Cassrimello","Cauditrice","Cerelama","Chaestebalon","Chalirio","Chalthanesh","Chisirion","Cinariyan","Cinnarath","Cirthavion","Coberul","Coxitaq","Corancon","Coreliad","Corrilisan","Cossario","Crotimian","Cuidurjau","Cymoria","Dajuvius","Dakrolidur","Dameraxia","Daraviel","Daraztheon","Darsimala","Darsurion","Dassalpian","Daxxihidil","Delrinian","Demasaran","Demeriolet","Devaloka","Diamerune","Dicadoran","Didoria","Dinrudromon","Dirinnia","Dolohies","Dophinrian","Dornatentorl","Drevixibrind","Drexorvion","Duralica","Dyskilian","Elisen","Etinor","Ebriany","Eclaramon","Efarion","Efiranlas","Egajia","Eglaharant","Eglantarask","Elantargin","Elarial","Eleglorross","Elianna","Elisdriel","Elivint","Ellyria","Elortal","Eltaria","Elverion","Elysia","Emelesis","Emelsyna","Enstarlamyn","Entalaroth","Epimissia","Erejitha","Eremiess","Erengazor","Erigia","Erivalda","Escalinian","Escamorid","Eschurioz","Esmerashard","Esnaramik","Etheriasa","Etianor","Etybrinel","Ezaltarem","Ezellohar","Faedulias","Falastien","Falerio","Falyrias","Farsemnithal","Favaijeness","Felarica","Felmarien","Feresilmar","Fiarazio","Fiespegar","Fimalemuen","Finactias","Fiormezath","Firvintilis","Flamorriwisp","Flaxifyglar","Fozekov","Folsalino","Frixalissa","Fusafandra","Fuvusarooz","Gaflorinos","Galathanax","Galdviara","Galirrhyalen","Gambrimanthus","Ganthelios","Ganvarathimyr","Garlinian","Gauribanon","Gazaforen","Gelurum","Gemaleon","Ghondaliom","Giavicel","Gikishika","Gorvonia","Halremsolath","Hanciara","Harfelengol","Hatuina","Hazrathsimoon","Hazrinivra","Herazibrax","Hiabezur","Hidolebni","Hipalonin","Hizzlechaltezeme","Hlantremir","Hovancomi","Hurania","Hyfentio","Ibaletri","Idriella","Ierendi","Igadiax","Iglithebem","Ilanayom","Ilerida","Ilirsiya","Ilizio","Illemestri","Ilminaris","Impelia","Inikia","Inthenereon","Ionellza","Iongua","Iophroster","Iptameela","Irgasia","Iskarnia","Iuzator","Ixiosyne","Izmirodon","Jachoriax","Jakanuin","Jalanochlan","Jaleduin","Jandrebliash","Jaralectan","Jarchesmadis","Javethiel","Jelanjaztor","Jemalkhiri","Jemarixtesen","Jirchesmiod","Juaxmanar","Jurelisma","Kadarion","Kagilia","Kalenizin","Kalienlod","Kalpalanin","Kandathama","Kanthamio","Karania","Kardamordax","Karethezam","Karisempatur","Karriasal","Karthassily","Kastrevelda","Katanmaral","Kemeroxel","Keolotrest","Keremelar","Kerisiar","Khalatulajax","Khrysarlion","Kikianik","Kiralizur","Kishidega","Koquilgion","Kryslaria","Lalarian","Lamamelis","Lamdiraka","Lamirila","Lamotridac","Lantessorax","Larasajan","Laschiantria","Lauaxeta","Laziarlan","Lemesprie","Leoniax","Lepeduin","Lialasia","Liquilioss","Lirrissia","Locramal","Ludurafet","Luithiole","Lyzalian","Lyzeoldir","Maheriel","Majezrel","Malabderas","Malantiggar","Malasteon","Malevila","Malyremeth","Manariasc","Maranduax","Marassumar","Maresedin","Marillia","Marzaranax","Mathranislom","Maudrosnia","Mayulisas","Medricaeldo","Meliabrak","Meliadoul","Melidium","Meliofard","Melismond","Melkandoro","Melozathel","Melusinnia","Mereniax","Meresinapt","Mermiculex","Metebelvis","Mianjira","Milinderra","Mirelassar","Mirianis","Mirtagarkarit","Mothyalond","Momelsia","Morasina","Morciana","Moriliem","Morilioth","Muathazaglimid","Mylakhrion","Myrraxion","Myrristica","Naburios","Nanieroj","Narasia","Narjiona","Narragazkara","Narzelduin","Nemmaridus","Nempifermal","Nerovius","Nevalrimyr","Nevinlemnus","Nichoriam","Nimrathelet","Nissebaral","Niziliom","Nohbirrian","Octramadus","Ohirial","Okarbia","Okpralio","Olemerrin","Oloscendivarn","Onnurian","Opacalia","Orathiris","Orbicritis","Orialex","Oriastus","Orissanat","Ormallivir","Ormeria","Orrizia","Orroptio","Orthaxifer","Orviliach","Otolvian","Pactinasa","Palzyriax","Panaxcrador","Panthioleed","Paolalian","Pelemurto","Pelluxia","Pemelojurg","Pemulinaan","Perjauruan","Phayzelobion","Phomechelian","Phorissital","Piartamisk","Piroutta","Pluzemelar","Pomivarnon","Pyrvinrian","Quanamelis","Quarlusian","Quelidia","Quelizantor","Querrulian","Quetradendith","Rajanthesina","Rakanamet","Ramantasset","Ranasceleb","Rasanathan","Rathelemen","Ravannifer","Reondoresin","Rhazazarak","Rhiadirask","Roxifalcor","Rozalroth","Rulia","Rudliptalin","Rufomella","Rulinian","Runevara","Ruzultrejest","Rylissilin","Saboorakel","Sadonakai","Saegdondakhar","Salletifian","Sandurion","Sanoreya","Sapelintir","Sarantimar","Sarathia","Sarpemethen","Sarrabhluil","Sartenia","Saterbia","Scarliherin","Scoramant","Semnegarius","Serejarand","Seremnaria","Seriastis","Serilia","Seriona","Shadarabar","Sharadjelamir","Sharajamar","Shelarinisse","Shelmorian","Sireelia","Sirezvia","Siriena","Sirulia","Sorolonex","Soromyrium","Sorosilmar","Sphallurian","Sreltaneema","Sulparia","Suularaba","Sylixia","Tallosia","Tamarien","Tapromethyna","Tarachien","Taralian","Tarsmiria","Tasambekeer","Tayenias","Telaswiral","Telaznemor","Temilion","Teniliak","Tercyrian","Thetalia","Thorosiaz","Tiaskelu","Tifalius","Tinzlactiash","Tiriala","Tirunriyek","Tivamtemar","Toraxoran","Torellian","Tormosian","Trystaria","Tsaliveren","Tsardatsira","Tuivoreth","Ugalius","Uguesilar","Uirugan","Ulakrugir","Ulkarien","Ullibunda","Ultharnarath","Umasdalen","Umicia","Unaramand","Unlasnulkai","Unorrehod","Unuvia","Upalumo","Urasin","Uttosembuluz","Uxulinak","Valarindio","Valarion","Valaronai","Valeauviej","Varcassian","Veladamar","Velorian","Venzafurome","Vercerenos","Veridia","Vialora","Vilcarien","Vimbrodelthion","Vincarian","Virunia","Vistramisorn","Vreniriab","Vruthalidrom","Vyjeremanx","Vyrania","Werzamerand","Wiernamal","Wrosceltiar","Wyjezinelb","Xacuahatl","Xaeximinar","Xalaibisad","Xalisuri","Xaralien","Xaralyna","Xarilia","Xasseldasene","Xavanimar","Xemelenos","Xilvemzarad","Xiomriest","Xorlanterond","Xorosia","Yamidala","Yamovelhas","Yannavalka","Yarbithresin","Yarmidrian","Yavilana","Yazarrahaj","Yetlioro","Yormanien","Yssarion","Yzaniva","Zabarianx","Zaharsian","Zalrevliaf","Zanzarathool","Zatakruan","Zaulizanir","Zavalliar","Zavalniax","Zekundaloth","Zekundemar","Zelissinfra","Zelobindio","Ziandela","Zicarecem","Zimenaechu","Zofelliara","Zoramatoth","Zulaaria","Zuralion","Zuruxeno","Zuzusilmar","Zwimolio","Zwyclemon","Zyrissalantisar"]}};var kf="[object Symbol]",Sf="[\\ud800-\\udfff]",Mf="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",Cf="[^\\ud800-\\udfff]",Pf="(?:\\ud83c[\\udde6-\\uddff]){2}",Of="[\\ud800-\\udbff][\\udc00-\\udfff]",Df="(?:"+Mf+"|"+"\\ud83c[\\udffb-\\udfff])"+"?",If="[\\ufe0e\\ufe0f]?",Rf=If+Df+("(?:\\u200d(?:"+[Cf,Pf,Of].join("|")+")"+If+Df+")*"),Nf="(?:"+[Cf+Mf+"?",Mf,Pf,Of,Sf].join("|")+")",Lf=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+Nf+Rf,"g"),Ff=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Bf="object"==typeof e&&e&&e.Object===Object&&e,Uf="object"==typeof self&&self&&self.Object===Object&&self,zf=Bf||Uf||Function("return this")();function Hf(e){return Ff.test(e)}function jf(e){return Hf(e)?function(e){return e.match(Lf)||[]}(e):function(e){return e.split("")}(e)}var Vf=Object.prototype.toString,Gf=zf.Symbol,Kf=Gf?Gf.prototype:void 0,Wf=Kf?Kf.toString:void 0;function Yf(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&Vf.call(e)==kf}(e))return Wf?Wf.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function Xf(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:function(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(r=r>n?n:r)<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}(e,t,r)}function qf(e){return null==e?"":Yf(e)}var Zf,Jf=(Zf="toUpperCase",function(e){var t=Hf(e=qf(e))?jf(e):void 0,r=t?t[0]:e.charAt(0),i=t?Xf(t,1).join(""):e.slice(1);return r[Zf]()+i}),Qf=function(e){return Jf(qf(e).toLowerCase())},$f=9007199254740991,ep="[object Arguments]",tp="[object Function]",rp="[object GeneratorFunction]",ip=/^(?:0|[1-9]\d*)$/;function np(e,t){return function(e,t){for(var r=-1,i=e?e.length:0,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}(t,(function(t){return e[t]}))}var ap,op,sp=Object.prototype,lp=sp.hasOwnProperty,hp=sp.toString,up=sp.propertyIsEnumerable,cp=Math.floor,dp=(ap=Object.keys,op=Object,function(e){return ap(op(e))}),fp=Math.random;function pp(e,t){var r=yp(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&vp(e)}(e)&&lp.call(e,"callee")&&(!up.call(e,"callee")||hp.call(e)==ep)}(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var a in e)!t&&!lp.call(e,a)||n&&("length"==a||gp(a,i))||r.push(a);return r}function mp(e){if(r=(t=e)&&t.constructor,i="function"==typeof r&&r.prototype||sp,t!==i)return dp(e);var t,r,i,n=[];for(var a in Object(e))lp.call(e,a)&&"constructor"!=a&&n.push(a);return n}function gp(e,t){return!!(t=null==t?$f:t)&&("number"==typeof e||ip.test(e))&&e>-1&&e%1==0&&e<t}var yp=Array.isArray;function vp(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=$f}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?hp.call(e):"";return t==tp||t==rp}(e)}var bp=function(e){var t,r,i,n=vp(e)?e:(t=e)?np(t,function(e){return vp(e)?pp(e):mp(e)}(t)):[],a=n.length;return a>0?n[(r=0,i=a-1,r+cp(fp()*(i-r+1)))]:void 0},xp=1/0,_p=NaN,Tp=/^\s+|\s+$/g,Ep=/^[-+]0x[0-9a-f]+$/i,Ap=/^0b[01]+$/i,wp=/^0o[0-7]+$/i,kp=parseInt,Sp="object"==typeof e&&e&&e.Object===Object&&e,Mp="object"==typeof self&&self&&self.Object===Object&&self,Cp=Sp||Mp||Function("return this")(),Pp=Object.prototype.toString,Op=Cp.Symbol,Dp=Op?Op.prototype:void 0,Ip=Dp?Dp.toString:void 0;function Rp(e){if("string"==typeof e)return e;if(Lp(e))return Ip?Ip.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Np(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Lp(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==Pp.call(e)}function Fp(e){return e?(e=function(e){if("number"==typeof e)return e;if(Lp(e))return _p;if(Np(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Np(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Tp,"");var r=Ap.test(e);return r||wp.test(e)?kp(e.slice(2),r?2:8):Ep.test(e)?_p:+e}(e))===xp||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}var Bp=function(e,t,r){var i;e=null==(i=e)?"":Rp(i),t=Rp(t);var n,a,o,s=e.length,l=r=void 0===r?s:(n=function(e){var t=Fp(e),r=t%1;return t==t?r?t-r:t:0}(r),a=0,o=s,n==n&&(void 0!==o&&(n=n<=o?n:o),void 0!==a&&(n=n>=a?n:a)),n);return(r-=t.length)>=0&&e.slice(r,l)==t},Up=function(e){return void 0===e&&(e=10),Math.floor(Math.random()*e)+1},zp=function(e){return["a","e","i","o","u"].includes(e)},Hp=function(e){var t=wf.names.vileAndCrude[e];return Qf(bp(t))+bp(t)},jp=function(e){return e+"Suffixes"};Af.goblin=function(){return Hp("small")};Af.orc=function(){return Hp("medium")};Af.ogre=function(){return Hp("large")};Af.cavePerson=function(e){var t=wf.names.primitive,r=Qf(bp(t.names)),i=Up(10);return"male"===e?(i>3&&(r=r+"-"+Qf(bp(t.names))),i>8&&(r=r+"-"+Qf(bp(t.names)))):"female"===e&&(i>5&&(r=r+"-"+Qf(bp(t.names))),r=r+"-"+Qf(bp(t.suffixes))),r};Af.dwarf=function(e){var t=wf.names.doughty,r=Qf(bp(t.syllables)),i=Up(10);return"male"===e?i>7?r+=zp(r.slice(-1))?"r":"i":r=""+r+bp(t.maleSuffixes):"female"===e&&(i>7?r+=zp(r.slice(-1))?"ra":"a":r=""+r+bp(t.femaleSuffixes)),r};Af.halfling=function(e){var t=wf.names.homely,r=Qf(bp(t.syllables)),i=Up(10);return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),i>6&&(r=r+" "+bp(wf.names.familyName.english)),r};Af.gnome=function(e){var t=Qf(bp(wf.names.doughty.syllables)),r=Up(10);return wf.names.homely[jp(e)]&&(t=""+t+bp(wf.names.homely[jp(e)])),r>6&&(t=t+" "+bp(wf.names.familyName.scottish)),t};Af.elf=function(e){var t=wf.names.fairAndNoble,r=""+Qf(bp(t.elfPrefixes))+bp(t.middle);return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.highelf=function(e){var t=wf.names.fairAndNoble,r=""+Qf(bp(t.alternativeElfPrefixes))+bp(t.middle);return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.fairy=function(e){var t=wf.names.fairy,r=Qf(bp(t.prefixes));return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.highfairy=function(e){var t=wf.names.alternateFairy,r=Qf(bp(t.prefixes));return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.darkelf=function(e){var t=wf.names.elegantEvil,r=Qf(bp(t.prefixesDarkElves));return Up(10)>2&&(r=""+r+bp(t.middle)),t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.drow=function(e){var t=wf.names.elegantEvil,r=Qf(bp(t.prefixesAlternateDarkElves));return Up(10)>2&&(r=""+r+bp(t.middle)),t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.halfdemon=function(e){var t=wf.names.malevolent,r=Qf(bp(t.prefixes));return t[jp(e)]&&(r=""+r+bp(t[jp(e)])),r};Af.demon=function(){var e=Object.keys(wf.names.infernal),t=Up(3)-1,r=Up(2)-1,i=e[t],n=e.filter((function(e){return e!==i}))[r];return""+Qf(bp(wf.names.infernal[i]))+bp(wf.names.infernal[n])};Af.dragon=function(e){var t=wf.names.draconic,r=Qf(bp(t.prefixes)),i=bp(t.suffixes);return"female"===e&&("bazius"===i?i="bazia":Bp(i,"os")?i+="sa":i="is"),r+i};Af.angel=function(e){var t=wf.names.empyreal,r=Up(12),i=Qf(bp(t.prefixes));if(1===r){if("female"===e){var n=i.lastIndexOf("a");i=i.substr(0,n)+"e"+i.substr(n+1)}i=""+Qf(bp(t.titles))+i}else t[jp(e)]&&(i=""+i+bp(t[jp(e)]));return i};Af.human=function(e){var t=Up(20);if(t<3)return bp(wf.names.human.one);if(t<12)return bp(wf.names.human.two);if(t<17)return bp(wf.names.human.three);if(17===t)return bp(wf.names.human.more);if(18===t&&e)return bp(wf.names.human.one)+" "+bp(wf.names.human.two);if(19===t&&e)return bp(wf.names.human.two)+" "+bp(wf.names.human.one);if(20===t&&e){var r=Object.keys(wf.names.human);return bp(wf.names.human[bp(r)])+" "+bp(wf.names.human[bp(r)])}return bp(wf.names.human[bp(Object.keys(wf.names.human))])};var Vp=["cavePerson","dwarf","halfling","gnome","elf","highelf","fairy","highfairy","darkelf","drow","halfdemon","dragon","angel"],Gp=["demon","human","goblin","ogre","orc"],Kp={otherRaces:Gp,racesWithGender:Vp,sorted:function(){return Vp.concat(Gp).sort()}};Ef.allRaces=Kp;Ef.generateName=function(e,t){void 0===t&&(t={});var r=t.gender,i=t.allowMultipleNames;if(Vp.includes(e)&&void 0!==r)switch(e){case"angel":return Af.angel(r);case"cavePerson":return Af.cavePerson(r);case"darkelf":return Af.darkelf(r);case"dragon":return Af.dragon(r);case"drow":return Af.drow(r);case"dwarf":return Af.dwarf(r);case"elf":return Af.elf(r);case"fairy":return Af.fairy(r);case"gnome":return Af.gnome(r);case"halfdemon":return Af.halfdemon(r);case"halfling":return Af.halfling(r);case"highelf":return Af.highelf(r);case"highfairy":return Af.highfairy(r)}switch(e){case"demon":return Af.demon();case"goblin":return Af.goblin();case"human":return Af.human(i);case"ogre":return Af.ogre();case"orc":return Af.orc()}return new Error("Must provide a gender!")};var Wp=Ef.allRaces;Tf.allRaces=Wp;var Yp=Ef.generateName;function Xp(){let e=function(e,t,r){const i={mapId:t,name:e+" 1",numPortalsIn:1,subBranches:[]};for(let n=1;n<r;n++){let r=i;for(;r.subBranches.length>0;)r=r.subBranches[0];r.subBranches.push({mapId:t+n,name:e+` ${n+1}`,numPortalsIn:3,subBranches:[]})}return i}("Tartarus",0,5);for(let t=4;t<5;t++){const r=qp(e,t);r&&(r.items=[Ed])}return{demonName:Tf.nameByRace("demon"),wizardName:Tf.nameByRace("elf",{gender:"female"}),dungeon:e}}function qp(e,t){if(e.mapId===t)return e;let r;for(const i of e.subBranches||[])if(r=r||qp(i,t),r)return r}Tf.nameByRace=Yp;class Zp extends class{get topologyMap(){return this._topologyMap}constructor(e,t){this.mapId=e,this.config=t,this.itemProbabilities=t.itemProbabilities,this.creatureProbabilities=t.creatureProbabilities,this.lootProbabilities=t.lootProbabilities,this.doorProbabilities=mg.computeLevelProbabilities(t.doorProbabilities,e),this.wallLightProbabilities=mg.computeLevelProbabilities(t.wallLightProbabilities,e),this.keyProbabilities=mg.computeLevelProbabilities(t.keyProbabilities,e),this.rng=new U}build(e){this.digMap(e);let t=new Rc,[r]=e.actorList.filter((e=>e.isA(vf))),[i]=e.actorList.filter((e=>e.isA(yf)));this.createBranchDrops(),r=r||e.actorList.filter((e=>e.isA(Ed)))[0],this._topologyMap=t.buildTopologyMap(e,r.pos),t.findDungeonExits(i.pos,r.pos),t.buildPuzzle(this._topologyMap.getObjectId(i.pos),this._topologyMap.getObjectId(r.pos)),this.applyPuzzle(),this.createWallTorches(e,this.config.minTorches,this.config.maxTorches),this.fixWallItems(e),this.createLoot()}digMap(e){}dig(e,t,r,i,n){if(i<t){let e=i;i=t,t=e}if(n<r){let e=n;n=r,r=e}0===t&&(t=1),0===r&&(r=1),i===e.w-1&&i--,n===e.h-1&&n--;for(let a=t;a<=i;a++)for(let t=r;t<=n;t++)e.isWall(a,t)&&e.setFloor(a,t)}createRoom(e,t,r,i,n,a){if(this.dig(e,r,i,n,a),t){let[t]=e.actorList.filter((({name:e})=>e==yf));t||(t=mg.create(this.mapId,yf)),t.pos.x=Math.floor((r+n)/2),t.pos.y=Math.floor((i+a)/2)}else{this.createMonsters(r,i,n,a,e),this.createItems(r,i,n,a,e);let t=e.actorList.filter((({name:e})=>e==vf)),o=e.actorList.filter((({name:e})=>e==yf));const s=qp(ny().storyConfig.dungeon,this.mapId);if(t.length===3*s.subBranches.length&&o.length<s.numPortalsIn){const e=mg.create(this.mapId,yf);e.pos.x=Math.floor((r+n)/2),e.pos.y=Math.floor((i+a)/2)}else{let e;e=t.length<3*s.subBranches.length?mg.create(this.mapId,vf):t[t.length-1],e&&(e.pos.x=Math.floor((r+n)/2),e.pos.y=Math.floor((i+a)/2))}}}createDoor(e){let t=this.rng.getRandomChance(this.doorProbabilities),r=mg.create(this.mapId,t);r&&(r.register(),r.moveTo(e.x,e.y))}getDoor(e){let t=Gc.getActors(this.mapId).filter((t=>t.pos.equals(e)&&t.isA("door[s]")));return t&&0===t.length?void 0:t[0]}findVDoorPosition(e,t,r,i){let n=r<i?r:i,a=r<i?i:r;do{if(this.isAVDoorPosition(e,t,n))return new C(t,n);n++}while(n!==a+1)}findHDoorPosition(e,t,r,i){let n=t<r?t:r,a=t<r?r:t;do{if(this.isAHDoorPosition(e,n,i))return new C(n,i);n++}while(n!==a+1)}isADoorPosition(e,t,r){return this.isAHDoorPosition(e,t,r)||this.isAVDoorPosition(e,t,r)}findFloorTile(e,t,r,i,n){let a=new C(Math.floor(e+r/2),Math.floor(t+i/2));for(;n.isWall(a.x,a.y);)a.x++,a.x===e+r&&(a.x=e,a.y++,a.y===t+i&&(a.y=t));return a}isEmptyCell(e,t,r){return!!e.canWalk(t,r)&&0===e.actorList.filter((e=>e.pos.x===t&&e.pos.y===r&&e.isA("item[s]"))).length}isAHDoorPosition(e,t,r){return e.isWall(t,r-1)&&e.isWall(t,r+1)&&this.isEmptyCell(e,t,r)&&this.isEmptyCell(e,t+1,r)&&this.isEmptyCell(e,t-1,r)}isAVDoorPosition(e,t,r){return e.isWall(t-1,r)&&e.isWall(t+1,r)&&this.isEmptyCell(e,t,r)&&this.isEmptyCell(e,t,r+1)&&this.isEmptyCell(e,t,r-1)}createActor(e){let t=this.rng.getRandomChance(e);if(void 0!==t)return mg.create(this.mapId,t,void 0,void 0)}createMonsters(e,t,r,i,n){let a=mg.createRandomActors(this.creatureProbabilities,this.mapId);for(let o of a){let a;for(a=0;a<100;a++){let a=this.rng.getNumber(e,r),s=this.rng.getNumber(t,i);if(n.canWalk(a,s)){o.moveTo(a,s);break}}a>=100&&console.log("CANT",o.name)}}createWallTorches(e,t,r){let i=this.rng.getNumber(t,r);for(;i>0;){let t=this.createActor(this.wallLightProbabilities);if(t){let r=this.rng.getNumber(0,e.w-1),i=this.rng.getNumber(0,e.h-1);t.moveTo(r,i),t.register()}i--}}findWallWithAdjacentFloor(e,t){let r=!1,i=t.x,n=t.y;for(;!r;){if(i===e.w-1?(i=0,n===e.h-1?n=0:n+=1):i+=1,i===t.x&&n===t.y)return;if(void 0!==e.isWallWithAdjacentFloor(i,n)){0===e.actorList.filter((e=>e.pos.x===i&&e.pos.y===n)).length&&(r=!0,t.moveTo(i,n))}}}fixWallItems(e){for(let t of e.actorList)t.wallActor&&!e.isWallWithAdjacentFloor(t.pos.x,t.pos.y)&&(this.findWallWithAdjacentFloor(e,t.pos),t.moveTo(t.pos.x,t.pos.y),t.light&&(t.light.position=t.pos))}createItems(e,t,r,i,n){let a=mg.createRandomActors(this.itemProbabilities,this.mapId);for(let o of a)if(o.wallActor){let n=this.rng.getNumber(e,r),a=this.rng.getNumber(t,i);o.moveTo(n,a)}else{let a;for(a=0;a<100;a++){let a=this.rng.getNumber(e,r),s=this.rng.getNumber(t,i);if(n.canWalk(a,s)){o.moveTo(a,s);break}}a>=100&&console.log("CANT",o.name)}}applyPuzzle(){for(let e of this._topologyMap.puzzle){if(this.rng.getNumber(0,1)>.06)continue;let t=this._topologyMap.getConnector(e.connectorId),r=this.getDoor(t.pos);if(!r)throw"Error : connector "+t.id+" with no door";let i=this._topologyMap.getRandomPositionInSector(e.keySectorId,this.rng),n=this.createActor(this.keyProbabilities);n&&(n.moveTo(i.x,i.y),n.register(),mg.setLock(r,n))}}createBranchDrops(){for(const e of function(e,t){const r=qp(e,t);return r&&r.monsters||[]}(ny().storyConfig.dungeon,this.mapId).concat(function(e,t){const r=qp(e,t);return r&&r.items||[]}(ny().storyConfig.dungeon,this.mapId))){const t=mg.create(this.mapId,e);for(let e=0;e<100;e++){const e=this.rng.getNumber(0,Gc.mapDb[this.mapId].w),r=this.rng.getNumber(0,Gc.mapDb[this.mapId].h);if(t.map.canWalk(e,r)){t.moveTo(e,r),t.register();break}}}}createLoot(){let[e]=Gc.getActors(this.mapId).filter((({name:e})=>e==yf)),t=this._topologyMap.getObjectId(e.pos);for(let e of this._topologyMap.sectors)if(e.id!==t&&e.isDeadEnd()){let t=mg.createRandomActor(this.mapId,this.config.lootContainerType);if(t){let r=this._topologyMap.getRandomPositionInSector(e.id,this.rng);t.moveTo(r.x,r.y);let i=mg.createRandomActors(this.lootProbabilities,this.mapId);for(let e of i)e.moveTo(r.x,r.y),e.pickable.pick(e,t,!1,!0);let n=mg.createRandomActors(this.creatureProbabilities,this.mapId);for(let r of n){let i=this._topologyMap.getRandomPositionInSector(e.id,this.rng);if(r.moveTo(i.x,i.y),r.ai.behaviorTree=mg.getBehaviorTree(this.config.guardAI),!t)throw new Error("No container found!");r.ai.targetId=t.id}}}}}{firstRoom=!0;potentialDoorPos=[];constructor(e,t){super(e,t)}digMap(e){let t=new fh(0,0,e.w,e.h);t.splitRecursive(void 0,8,this.config.roomMinSize,1.5),t.traverseInvertedLevelOrder(this.visitNode.bind(this),e),this.createDoors(e)}createRandomRoom(e,t){if(!e.parent)return;let r,i,n,a,o=e.parent.horiz,s=this.config.roomMinSize;o?(n=this.rng.getNumber(s,e.w-1),a=this.rng.getNumber(s,e.h-2),r=e===e.parent.leftChild?this.rng.getNumber(e.x+1,e.x+e.w-n):this.rng.getNumber(e.x,e.x+e.w-n),i=this.rng.getNumber(e.y+1,e.y+e.h-a)):(n=this.rng.getNumber(s,e.w-2),a=this.rng.getNumber(s,e.h-1),i=e===e.parent.leftChild?this.rng.getNumber(e.y+1,e.y+e.h-a):this.rng.getNumber(e.y,e.y+e.h-a),r=this.rng.getNumber(e.x+1,e.x+e.w-n)),this.createRoom(t,this.firstRoom,r,i,r+n-1,i+a-1),this.firstRoom=!1}connectChildren(e,t){if(!e.leftChild||!e.rightChild)return;let r=e.leftChild,i=e.rightChild,n=this.findFloorTile(r.x,r.y,r.w,r.h,t),a=this.findFloorTile(i.x,i.y,i.w,i.h,t);this.dig(t,n.x,n.y,n.x,a.y),this.dig(t,n.x,a.y,a.x,a.y);let o=this.findVDoorPosition(t,n.x,n.y,a.y);o||(o=this.findHDoorPosition(t,n.x,a.x,a.y)),o&&this.potentialDoorPos.push(o)}createDoors(e){for(let t of this.potentialDoorPos)this.isADoorPosition(e,t.x,t.y)&&this.createDoor(t)}visitNode(e,t){let r=t;return e.isLeaf()?this.createRandomRoom(e,r):this.connectChildren(e,r),ch.CONTINUE}}class Jp extends su{enableEvents=!0;forceNextTurn=!1;constructor(e,t){super(),this.renderer=e,this.persister=t}get rng(){return this._rng}onInit(){vu.registerEventListener(this,bu[bu.MODAL_SHOW]),vu.registerEventListener(this,bu[bu.MODAL_HIDE]),this._rng=new U,this.addChild(this.renderer),function(e){for(let t of e)yu(t)}([{name:Ac[Ac.MOVE_WEST],positiveButton:A.DOM_VK_LEFT,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_WEST],positiveButton:A.DOM_VK_NUMPAD4,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_WEST],positiveButton:A.DOM_VK_H,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_EAST],positiveButton:A.DOM_VK_RIGHT,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_EAST],positiveButton:A.DOM_VK_NUMPAD6,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_EAST],positiveButton:A.DOM_VK_L,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_NORTH],positiveButton:A.DOM_VK_UP,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_NORTH],positiveButton:A.DOM_VK_NUMPAD8,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_NORTH],positiveButton:A.DOM_VK_K,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_SOUTH],positiveButton:A.DOM_VK_DOWN,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_SOUTH],positiveButton:A.DOM_VK_NUMPAD2,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_SOUTH],positiveButton:A.DOM_VK_J,type:k.KEY_OR_BUTTON},{name:Ac[Ac.WAIT],positiveButton:A.DOM_VK_5,type:k.KEY_OR_BUTTON},{name:Ac[Ac.WAIT],positiveButton:A.DOM_VK_NUMPAD5,type:k.KEY_OR_BUTTON},{name:Ac[Ac.WAIT],positiveButton:A.DOM_VK_SPACE,type:k.KEY_OR_BUTTON},{name:Ac[Ac.GRAB],positiveButton:A.DOM_VK_G,type:k.KEY_OR_BUTTON},{name:Ac[Ac.USE_ITEM],positiveButton:A.DOM_VK_I,type:k.KEY_OR_BUTTON},{name:Ac[Ac.SACRIFICE_ITEM],positiveButton:A.DOM_VK_S,type:k.KEY_OR_BUTTON},{name:Ac[Ac.SACRIFICE_ITEM],positiveButton:A.DOM_VK_P,type:k.KEY_OR_BUTTON},{name:Ac[Ac.DROP_ITEM],positiveButton:A.DOM_VK_D,type:k.KEY_OR_BUTTON},{name:Ac[Ac.THROW_ITEM],positiveButton:A.DOM_VK_T,type:k.KEY_OR_BUTTON},{name:Ac[Ac.VALIDATE],positiveButton:A.DOM_VK_ENTER,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTOEXPLORE],positiveButton:A.DOM_VK_O,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTOFIGHT],positiveButton:A.DOM_VK_U,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTOFIGHT],positiveButton:A.DOM_VK_TAB,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTOUP],positiveButton:A.DOM_VK_LESSTHAN,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTOUP],positiveButton:A.DOM_VK_COMMA,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTODOWN],positiveButton:A.DOM_VK_MORETHAN,type:k.KEY_OR_BUTTON},{name:Ac[Ac.AUTODOWN],positiveButton:A.DOM_VK_PERIOD,type:k.KEY_OR_BUTTON},{name:Ac[Ac.VALIDATE],positiveButton:A.DOM_VK_RETURN,type:k.KEY_OR_BUTTON},{name:Ac[Ac.CANCEL],positiveButton:A.DOM_VK_ESCAPE,type:k.KEY_OR_BUTTON},{name:Ac[Ac.FIRE],positiveButton:A.DOM_VK_F,type:k.KEY_OR_BUTTON},{name:Ac[Ac.ZAP],positiveButton:A.DOM_VK_Z,type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_DOWN],positiveButton:">",type:k.KEY_OR_BUTTON},{name:Ac[Ac.MOVE_UP],positiveButton:"<",type:k.KEY_OR_BUTTON}])}onTerm(){super.onTerm(),vu.unregisterEventListener(this,bu[bu.MODAL_SHOW]),vu.unregisterEventListener(this,bu[bu.MODAL_HIDE])}onModalShow(e){vg.currentScheduler.pause()}onModalHide(e){vg.currentScheduler.resume()}async onUpdate(e){if((this.forceNextTurn||void 0===Vu.getActiveModal()&&void 0!==kc())&&(this.forceNextTurn=!1,vg.currentScheduler.resume()),vg.currentScheduler.isPaused())return;let t=vg.specialActors[gg.PLAYER];if(t){let e=t.mapId,r=t.pos.x,i=t.pos.y;await vg.currentScheduler.run(),t.mapId===e&&t.pos.x===r&&t.pos.y===i||(this.map.setDirty(),this.map.computeFov(t.pos.x,t.pos.y,1+t.xpHolder.xpLevel),this.map.updateScentField(t.pos.x,t.pos.y))}}}let Qp;var $p;let em;var tm;let rm;var im;let nm;var am;let om;var sm;let lm;var hm;let um;var cm;let dm;var fm;($p=Qp||(Qp={}))[$p.INSTANT_HEALTH=1]="INSTANT_HEALTH",$p[$p.TELEPORT=2]="TELEPORT",$p[$p.CONDITION=3]="CONDITION",$p[$p.MAP_REVEAL=4]="MAP_REVEAL",$p[$p.EVENT=5]="EVENT",(tm=em||(em={}))[tm.SINGLE=1]="SINGLE",tm[tm.DOOR=2]="DOOR",tm[tm.TOGGLE=3]="TOGGLE",tm[tm.LEVER=4]="LEVER",(im=rm||(rm={}))[im.CONFUSED=1]="CONFUSED",im[im.STUNNED=2]="STUNNED",im[im.FROZEN=3]="FROZEN",im[im.HEALTH_VARIATION=4]="HEALTH_VARIATION",im[im.OVERENCUMBERED=5]="OVERENCUMBERED",im[im.DETECT_LIFE=6]="DETECT_LIFE",(am=nm||(nm={}))[am.WEARER=1]="WEARER",am[am.WEARER_INVENTORY=2]="WEARER_INVENTORY",am[am.ACTOR_ON_CELL=3]="ACTOR_ON_CELL",am[am.CLOSEST_ENEMY=4]="CLOSEST_ENEMY",am[am.SELECTED_ACTOR=5]="SELECTED_ACTOR",am[am.ACTORS_IN_RANGE=6]="ACTORS_IN_RANGE",am[am.SELECTED_RANGE=7]="SELECTED_RANGE",(sm=om||(om={}))[sm.ITEM=1]="ITEM",sm[sm.MONSTER=2]="MONSTER",sm[sm.PLAYER=3]="PLAYER",(hm=lm||(lm={}))[hm.NONE=0]="NONE",hm[hm.LINEAR=1]="LINEAR",hm[hm.NORMAL=2]="NORMAL",hm[hm.INVERSE_SQUARE=3]="INVERSE_SQUARE",(cm=um||(um={}))[cm.ADDITIVE=1]="ADDITIVE",cm[cm.MAX=2]="MAX",(fm=dm||(dm={}))[fm.DESTRUCTIBLE=1]="DESTRUCTIBLE",fm[fm.ATTACKER=2]="ATTACKER",fm[fm.AI=3]="AI",fm[fm.PICKABLE=4]="PICKABLE",fm[fm.CONTAINER=5]="CONTAINER",fm[fm.EQUIPMENT=6]="EQUIPMENT",fm[fm.RANGED=7]="RANGED",fm[fm.MAGIC=8]="MAGIC",fm[fm.ACTIVABLE=9]="ACTIVABLE",fm[fm.LOCKABLE=10]="LOCKABLE",fm[fm.LIGHT=11]="LIGHT",fm[fm.XP_HOLDER=12]="XP_HOLDER",fm[fm.AMMO=13]="AMMO";class pm{static create(e){switch(e.type){case rm.HEALTH_VARIATION:return new mm(e);case rm.STUNNED:return new gm(e);case rm.FROZEN:return new vm(e);case rm.DETECT_LIFE:return new ym(e);default:return new pm(e)}}static condNames=[void 0,"confused","stunned","frozen","regeneration","overencumbered","life detection"];constructor(e){e&&(this.initialTime=e.nbTurns,this._time=e.nbTurns,this._type=e.type,this._noDisplay=e.noDisplay||!1,this.name=e.name,this.onlyIfActive=e.onlyIfActive||!1,this._noCorpse=e.noCorpse||!1)}get type(){return this._type}get time(){return this._time}get noCorpse(){return this._noCorpse}get noDisplay(){return this._noDisplay}getName(){return this._noDisplay?void 0:this.name?this.name:pm.condNames[this._type]}onApply(e){}onRemove(e){}update(e){return!(this._time>0)||(this._time--,this._time>0)}}class mm extends pm{constructor(e){super(e),e&&e.amount&&(this.hpPerTurn=0===e.nbTurns?e.amount:e.amount/e.nbTurns)}update(e){return e.destructible&&(this.onlyIfActive&&e.activable&&!e.activable.isActive()||(this.hpPerTurn>0?e.destructible.heal(e,this.hpPerTurn):this.hpPerTurn<0&&e.destructible.takeRawDamage(e,-this.hpPerTurn))),super.update(e)}}class gm extends pm{constructor(e){super(e)}update(e){if(!super.update(e)){if(this.type!==rm.STUNNED)return!1;this._type=rm.CONFUSED,this._time=3}return!0}}class ym extends pm{constructor(e){super(e),e&&e.range&&(this.range=e.range)}}class vm extends pm{constructor(e){super(e)}onApply(e){this.originalColor=e.col,e.col=uc}onRemove(e){e.col=this.originalColor}update(e){let t=(this._time-1)/this.initialTime;return e.col=M.add(M.multiply(uc,t),M.multiply(this.originalColor,1-t)),super.update(e)}}class bm{constructor(e){e&&(this._method=e.method,this._range=e.range,this._radius=e.radius,this.actorType=e.actorType)}get method(){return this._method}get range(){if(!this._range)throw new Error("They have no range!");return this._range}get radius(){if(!this._radius)throw new Error("They have no radius!");return this._radius}selectTargets(e,t,r){let i=[];switch(this._method){case nm.WEARER:i.push(t);break;case nm.ACTOR_ON_CELL:r&&(i=vg.list.filter((e=>e.pos.equals(r)&&e.isA("creature[s]"))));break;case nm.CLOSEST_ENEMY:let e=vg.findClosestEnemy(r||t.pos,this.range);e&&i.push(e);break;case nm.ACTORS_IN_RANGE:i=vg.list.filter((e=>e.isA("creature[s]")&&C.distance(r||t.pos,e.pos)<this.range));break;case nm.WEARER_INVENTORY:if(!t.container)break;if(t.container.getContent(this.actorType,!0,i),1===i.length)break;if(i.length>1&&(i=[],t.ai&&t.ai.inventoryItemPicker))return new Promise((e=>{t.ai.inventoryItemPicker&&t.ai.inventoryItemPicker.pickItemFromInventory("select an item",t,this.actorType).then((t=>{i.push(t),e(i)}))}));break;case nm.SELECTED_ACTOR:if(t.ai&&t.ai.tilePicker)return new Promise((e=>{t.ai.tilePicker&&t.ai.tilePicker.pickATile("Left-click a target creature,\nor right-click to cancel.",new C(t.pos.x,t.pos.y),this._range,this._radius).then((t=>{e(this.onTileSelected(t))}))}));break;case nm.SELECTED_RANGE:if(t.ai&&t.ai.tilePicker)return new Promise((async e=>{if(t.ai.tilePicker){const r=await t.ai.tilePicker.pickATile("Left-click a target tile,\nor right-click to cancel.",new C(t.pos.x,t.pos.y),this._range,this._radius);e(this.onTileSelected(r))}}))}return new Promise((e=>{e(i)}))}onTileSelected(e){switch(this._method){case nm.SELECTED_ACTOR:return vg.list.filter((t=>t.pos.equals(e)&&t.isA("creature[s]")));case nm.SELECTED_RANGE:return vg.list.filter((t=>t.isA("creature[s]")&&C.distance(e,t.pos)<this.radius))}return[]}}let xm;var _m;(_m=xm||(xm={}))[_m.SUCCESS=0]="SUCCESS",_m[_m.FAILURE=1]="FAILURE",_m[_m.SUCCESS_AND_STOP=2]="SUCCESS_AND_STOP",_m[_m.FAILURE_AND_STOP=3]="FAILURE_AND_STOP";class Tm{static booleanToEffectResult(e,t){return e?t?xm.SUCCESS_AND_STOP:xm.SUCCESS:t?xm.FAILURE_AND_STOP:xm.FAILURE}}class Em extends Tm{_amount=0;canResurrect=!1;_singleActor=!1;get amount(){return this._amount}get singleActor(){return this._singleActor}constructor(e){super(),e&&(this._amount=e.amount,this.successMessage=e.successMessage,this.failureMessage=e.failureMessage,void 0!==e.canResurrect&&(this.canResurrect=e.canResurrect),void 0!==e.singleActor&&(this._singleActor=e.singleActor))}applyTo(e,t,r=1){return t.destructible?this._amount>0&&(this.canResurrect||!t.destructible.isDead())?this.applyHealingEffectTo(e,t,r):this.applyWoundingEffectTo(e,t,r):xm.FAILURE}applyHealingEffectTo(e,t,r=1){let i=t.destructible.heal(t,r*this._amount),n=t.getWearer(),a=Tm.booleanToEffectResult(!1,this._singleActor);return i>0&&this.successMessage?(lc.info(Mc(this.successMessage,t,n,i)),a=Tm.booleanToEffectResult(!0,this._singleActor)):i<=0&&this.failureMessage&&lc.info(Mc(this.failureMessage,t)),a}applyWoundingEffectTo(e,t,r=1){if(t.destructible.isDead())return xm.FAILURE;let i=t.destructible.computeRealDefence(t),n=t.getWearer(),a=-this._amount+r-i;if(t.destructible.hp<=a){const e=Math.floor(t.destructible.xp/2);if(e){const r="[The actor2] [is2] dead. [The actor1] absorb[s] "+e+" life.",i=vg.specialActors[gg.PLAYER];lc.warn(Mc(r,i,t)),i.destructible.heal(i,e),i.xpHolder.addXp(i,e)}}a>0&&this.successMessage?lc.info(Mc(this.successMessage,t,n,a)):a<=0&&this.failureMessage&&lc.info(Mc(this.failureMessage,t,n));return Tm.booleanToEffectResult(t.destructible.takeRawDamage(t,a)||!0,this._singleActor)}}class Am extends Tm{constructor(e){super(),this.successMessage=e}applyTo(e,t,r=1){let i,n;return[i,n]=Gc.current.findRandomWamlkableCell(),t.moveTo(i,n),this.successMessage&&lc.info(Mc(this.successMessage,t)),xm.SUCCESS_AND_STOP}}class wm extends Tm{constructor(e){super(),e&&(this.eventType=e.eventType,this.eventData=e.eventData)}setEventData(e){this.eventData={...this.eventData,...e}}applyTo(e,t,r=1){return vu.publishEvent(this.eventType,this.eventData),xm.SUCCESS}}class km extends Tm{singleActor=!1;constructor(e,t){super(),this.message=t,e&&(this.conditionDef=e.condition,this.singleActor=e.singleActor||!1)}applyTo(e,t,r=1){return t.ai?(t.ai.addCondition(pm.create(this.conditionDef),t),this.message&&lc.info(Mc(this.message,t)),Tm.booleanToEffectResult(!0,this.singleActor)):xm.FAILURE}}class Sm extends Tm{applyTo(e,t,r=1){return t===vg.specialActors[gg.PLAYER]?(Gc.current.reveal(),xm.SUCCESS):xm.FAILURE}}class Mm{get effect(){return this._effect}get coef(){return this._coef}constructor(e,t,r,i=!1){this._effect=e,this.targetSelector=t,this.message=r,this.destroyOnEffect=i}async apply(e,t,r,i=1){this._coef=i,this.targetSelector,this._coef=i;const n=await this.targetSelector.selectTargets(e,t,r);return this.applyEffectToActorList(e,t,n),n.length>0}applyEffectToActorList(e,t,r){let i=!1;this.message&&lc.info(Mc(this.message,t));for(let t of r){let r=this._effect.applyTo(e,t,this._coef);if(r!==xm.SUCCESS&&r!==xm.SUCCESS_AND_STOP||(i=!0),r===xm.SUCCESS_AND_STOP||r===xm.FAILURE_AND_STOP)break}this.destroyOnEffect&&i&&t&&t.container&&e.destroy()}}function Cm(e){if(Gc.current.isWall(e.x,e.y))return!1;for(let t of vg.list)if(t.pos.equals(e))return!1;return!0}function Pm({x:e,y:t}){for(const r of Gc.currentActors)if(r.pos.x===e&&r.pos.y===t&&r.isA(bf)){if(r.lock&&r.lock.isLocked()&&!vg.player.contains(r.lock.keyId,!0))continue;return!0}return!1}function Om({x:e,y:t}){for(const r of Gc.currentActors)if(r.pos.x===e&&r.pos.y===t){if(!Gc.current.isExplored(e,t))continue;if(r.isA(bf)){if(r.lock&&r.lock.isLocked()&&!vg.player.contains(r.lock.keyId,!0))continue;if(Gc.current.isAdjacentUnexplored(e,t))return!0}}return!1}function Dm({x:e,y:t}){for(const r of vg.list)if(Gc.current.isInFov(r.pos.x,r.pos.y)&&r.pos.x===e&&r.pos.y===t&&r.isA(yd)&&!r.destructible.isDead())return!0;return!1}function Im(e){return!Gc.current.isWall(e.x,e.y)&&!function(e){if(Gc.current.isWall(e.x,e.y))return!0;for(let t of vg.list)if(t.pos.equals(e)&&t.blocks)return!0;return!1}(e)&&(!Gc.current.isExplored(e.x,e.y)||Gc.current.isAdjacentUnexplored(e.x,e.y,!0))}function Rm({x:e,y:t}){for(const r of Gc.currentActors)if(!r.getWearer()&&r.pos.x===e&&r.pos.y===t){if(!Gc.current.isExplored(e,t))continue;if(r.isA(yf))return!0}return!1}function Nm({x:e,y:t}){for(const r of Gc.currentActors)if(!r.getWearer()&&r.pos.x===e&&r.pos.y===t){if(!Gc.current.isExplored(e,t))continue;if(r.isA(vf))return!0}return!1}function Lm({x:e,y:t}){for(const r of Gc.currentActors)if(!r.getWearer()&&r.pos.x===e&&r.pos.y===t){if(!Gc.current.isExplored(e,t))continue;const i=e=>!!e.pickable;if(i(r)||r.isA(Sd)&&r.container.containsCriteria(i,!0))return!0}return!1}function Fm(e,t){if(t.isAdjacent(e.pos,!1))return[t];return new gh(Gc.current.w,Gc.current.h,(function(e,r){return r.equals(t)||Pm(r)||Gc.current.canWalk(r.x,r.y)?1:0}),void 0,!1).getPath(e.pos,t,200)}function Bm(e,t){const r=Fm(e,t);if(r)return r.pop()}function Um(e){return Vm(e,Cm)}function zm(e){return Vm(e,Im)}function Hm(e){return Vm(e,Om)}function jm(e){return Vm(e,Dm)}function Vm(e,t){let r=[];if(t(e))return e;r.push(e);const i={};for(;r.length>0;){let e=r.shift();if(e&&t(e))return e;if(!e||!Gc.current.canWalk(e.x,e.y)&&!Pm(e)||i[e.toString()])continue;i[e.toString()]=!0;let n=e.getAdjacentCells(Gc.current.w,Gc.current.h,!1);for(let e of n)r.push(e)}}class Gm{defence=0;xp=0;constructor(e,t){t&&(this.hp=t.hp,this._maxHp=t._maxHp,this.defence=t.defence,this.corpseChar=t.corpseChar,this.corpseName=t.corpseName,this.deathMessage=t.deathMessage,this.xp=t.xp,this.qualifiers=t.qualifiers,this.loot=t.loot),e&&(e.healthPoints&&(this.hp=e.healthPoints,this._maxHp=e.healthPoints),e.defence&&(this.defence=e.defence),e.corpseName&&(this.corpseName=e.corpseName),e.corpseChar&&(this.corpseChar=e.corpseChar),e.deathMessage&&(this.deathMessage=e.deathMessage),e.xp&&(this.xp=e.xp),e.qualifiers&&(this.qualifiers=e.qualifiers),e.loot&&(this.loot=e.loot))}get maxHp(){return this._maxHp}gainMaxHP(e){this.hp+=e,this._maxHp+=e}isDead(){return this.hp<=0}getQualifiedName(e,t=1){if(this.isDead()||void 0===this.qualifiers)return e.getname(t);let r=Math.floor(this.qualifiers.length*this.hp/this._maxHp);return r===this.qualifiers.length&&(r=this.qualifiers.length-1),e.getname(t)+(this.qualifiers[r]?", "+this.qualifiers[r]:"")}computeDamage(e,t){const r=(100-Math.min(100,this.computeRealDefence(e)))/100;return Math.ceil(Math.max(0,t**r))}computeRealDefence(e){let t=this.defence;if(e.xpHolder&&(t+=e.xpHolder.xpLevel),e.container){let r=e.container.size();for(let i=0;i<r;i++){let r=e.container.get(i);r&&r.equipment&&r.equipment.isEquipped()&&(t+=r.equipment.getdefenceBonus())}}return t}takeRawDamage(e,t){if(this.isDead())return!1;if(t>0){if(this.hp-=t,this.isDead())return this.hp=0,this.die(e),!0}else t=0;return!1}heal(e,t){let r=this.isDead();return this.hp+=t,this.hp>this._maxHp&&(t-=this.hp-this._maxHp,this.hp=this._maxHp),r&&this.hp>0&&this.resurrect(e),t}die(e){if(this.deathMessage){let t=e.getWearer();t&&lc.info(Mc(this.deathMessage,e,t))}this.loot&&this.dropLoot(e);const{x:t,y:r}=e.pos;if(this.corpseName){const i=Um(new C(t,r));i&&e.moveTo(i.x,i.y)}else e.moveTo(-1,-1);for(const i of e.container.getContent(void 0))i.pickable.drop(i,e,void 0,Um(new C(t,r)));this.corpseName?(this.swapNameAndCorpseName(e),this.wasBlocking=e.blocks,this.wasTransparent=e.transparent,e.blocks=!1,e.transparent||(e.map.setTransparent(e.pos.x,e.pos.y,!0),e.transparent=!0)):e.destroy()}swapNameAndCorpseName(e){if(this.corpseName){let t=e.name;e.name=this.corpseName,this.corpseName=t}if(this.corpseChar){let t=e.ch;e.ch=this.corpseChar,this.corpseChar=t}}resurrect(e){this.swapNameAndCorpseName(e),e.blocks=this.wasBlocking,e.transparent=this.wasTransparent,e.transparent||e.map.setTransparent(e.pos.x,e.pos.y,!1),e.activable&&(e.equipment&&!e.equipment.isEquipped()||e.activable.activate(e))}dropLoot(e){let t=mg.createRandomActors(this.loot,0);for(let r of t)r.pickable.pick(r,e,!1)}}class Km{_attackTime=dc;constructor(e){e&&(this.power=e.hitPoints,this._attackTime=e.attackTime)}get attackTime(){return this._attackTime}attack(e,t){if(t.destructible&&!t.destructible.isDead()){const r=e.powerBonus;let i=Math.max(0,t.destructible.computeDamage(t,this.power+r)),n="[The actor1] attack[s] [the actor2]",a=nc.INFO,o=0;if(i>=t.destructible.hp){n+=" and kill[s] [it2] !",a=nc.WARN;const r=Math.floor(t.destructible.xp/2);e.xpHolder&&r&&(n+="\n[The actor2] [is2] dead. [The actor1] absorb[s] "+r+" life.",o=r,e.destructible.heal(e,r))}else i>0?(n+=" for "+i+" hit points.",a=nc.WARN):n+=" but it has no effect!";if(lc.log(a,Mc(n,e,t)),t.destructible.takeRawDamage(t,i),o>0){if(!t.destructible.isDead())throw new Error;e.xpHolder.addXp(e,o)}}}}class Wm{_capacity=0;actorIds=[];_slotActors=[];get capacity(){return this._capacity}constructor(e,t){this.__listener=t,e&&(this._capacity=e.capacity,this.filter=e.filter,this._slots=e.slots)}getQualifiedName(e,t=1){if(0===this.actorIds.length)return"empty "+e.getname(t);if(this.filter)return this.getCapacityQualifier()+e.getname(t);let r={};for(let e of this.actorIds){let t=vg.fromId(e);if(t)for(let e of t.getClasses()){if(mg.getActorDef(e).containerQualifier){let t=r[e]||0;r[e]=t+1}}}let i,n=1;for(let e in r)r.hasOwnProperty(e)&&r[e]>n&&(n=r[e],i=e);return n>.75*this.actorIds.length&&i?this.getCapacityQualifier()+e.getname(t)+" of "+mg.getActorTypeName(i,2):this.getCapacityQualifier()+e.getname(t)}getContent(e,t=!1,r){void 0===r&&(r=[]);for(let i=0,n=this.size();i<n;++i){let n=this.get(i);n&&(e&&!n.isA(e)||r.push(n),t&&n.container&&n.container.getContent(e,t,r))}return r}getSlots(){return this._slots}getSlotActors(){return this._slotActors}size(){return this.actorIds.length}setListener(e){this.__listener=e}get(e){return vg.fromId(this.actorIds[e])}containsCriteria(e,t){for(let t=0,r=this.size();t<r;t++)if(e(vg.idMap[this.actorIds[t]]))return!0;if(t)for(let t=0,r=this.size();t<r;t++){let r=vg.fromId(this.actorIds[t]);if(r&&r.container&&r.container.containsCriteria(e,!0))return!0}return!1}contains(e,t){for(let t=0,r=this.size();t<r;t++)if(e===this.actorIds[t])return!0;if(t)for(let t=0,r=this.size();t<r;t++){let r=vg.fromId(this.actorIds[t]);if(r&&r.container&&r.container.contains(e,!0))return!0}return!1}hasSlot(e){return this._slots&&-1!==this._slots.indexOf(e)}getFromSlot(e){let t=this._slots?this._slots.indexOf(e):-1;if(-1!==t)return vg.fromId(this._slotActors[t])}equip(e,t,r){let i=this._slots?this._slots.indexOf(r):-1;return-1!==i&&(this._slotActors[i]=t.id,t.pickable.pick(t,e,!1,!0),!0)}shouldAutoEquip(e,t){if(!this._slots||!t.equipment||!t.equipment.getSlots()||e.destructible&&e.destructible.isDead())return!1;let r=t.equipment.getSlots(),i=!1;for(let n=0,a=r.length;n<a&&!i;++n)t.equipment.tryEquipOnSlot(e,r[n])&&(i=!0);if(!i)return!1;let n=t.getInventoryQualifier();if(n)for(let e of this._slotActors){let t=vg.fromId(e);if(t&&t.isA(n))return console.log(n),!1}return!0}unequip(e){let t=this._slotActors?this._slotActors.indexOf(e.id):-1;if(-1!==t)return this._slotActors[t]=void 0,this._slots?this._slots[t]:void 0}isSlotEmpty(e){let t=this._slots?this._slots.indexOf(e):-1;if(-1===t)return!1;if(this._slotActors[t])return!1;if(e===fc||e===pc){if(this.getFromSlot(bc))return!1}else if(e===bc&&(this.getFromSlot(pc)||this.getFromSlot(fc)))return!1;return!0}canContain(e){if(!e||!e.pickable)return!1;if(this.filter){let t=!1;for(let r of this.filter)if(e.isA(r)){t=!0;break}if(!t)return!1}return this.computeTotalWeight()+e.pickable.weight<=this._capacity}computeTotalWeight(){let e=0;for(let t of this.actorIds){let r=vg.fromId(t);r&&r.pickable&&(e+=r.pickable.weight)}return e}add(e,t){return!!this.canContain(e)&&(this.actorIds.push(e.id),this.__listener&&this.__listener.onAdd(e.id,this,t),!0)}remove(e,t){let r=this.actorIds.indexOf(e);-1!==r&&(this.actorIds.splice(r,1),this.__listener&&this.__listener.onRemove(e,this,t))}getCapacityQualifier(){return this.computeTotalWeight()/this._capacity>.8?"almost full ":""}}class Ym{_destroyedWhenThrown=!1;get weight(){return this._weight}get onThrowEffect(){return this.onThrowEffector?this.onThrowEffector.effect:void 0}get destroyedWhenThrown(){return this._destroyedWhenThrown}get containerId(){return this._containerId}constructor(e){e&&(this._weight=e.weight,this.price=e.price,e.destroyedWhenThrown&&(this._destroyedWhenThrown=e.destroyedWhenThrown),e.onUseEffector&&(this.onUseEffector=mg.createEffector(e.onUseEffector)),e.onThrowEffector&&(this.onThrowEffector=mg.createEffector(e.onThrowEffector)))}getOnThrowEffector(){return this.onThrowEffector}getOnUseEffector(){return this.onUseEffector}setOnUseEffect(e,t,r,i=!1){this.onUseEffector=new Mm(e,t,r,i)}setOnThrowEffect(e,t,r,i=!1){this.onThrowEffector=new Mm(e,t,r,i)}pick(e,t,r,i){if(this._containerId!==t.id&&t.container&&t.container.add(e,t)){if(this._containerId){let r=vg.fromId(this._containerId);r&&e.pickable.drop(e,r,t,void 0,void 0,void 0,i)}return this._containerId=t.id,e.moveTo(t.pos.x,t.pos.y),!r||!t.isA("creature[s]")||t.destructible&&t.destructible.isDead()||lc.info(Mc("[The actor1] pick[s] up [the actor2].",t,e)),i||(e.equipment&&t.isPlayer()&&t.container.shouldAutoEquip(t,e)?e.equipment.equip(e,t):e.equipment&&e.activable&&e.activable.isActive()&&e.activable.deactivate(e)),!0}return!1}drop(e,t,r,i,n="drop",a=!1,o){let s=vg.fromId(this._containerId);s&&s.container.remove(e.id,t),r||(this._containerId=void 0,e.pos.x=i?i.x:t.pos.x,e.pos.y=i?i.y:t.pos.y,e.register()),!o&&e.equipment&&e.equipment.unequip(e,t,!0),a&&lc.info(t.getThename()+" "+n+t.getVerbEnd()+e.getthename())}async use(e,t){return this.onUseEffector?await this.onUseEffector.apply(e,t):e.equipment?(e.equipment.use(e,t),!1):(e.activable&&await e.activable.activate(e),!0)}async throw(e,t,r,i,n){if(i||(i=e.computeThrowRange(t)),t.ai.tilePicker){const a=await t.ai.tilePicker.pickATile("Left-click where to throw the "+e.name+",\nor right-click to cancel.",new C(t.pos.x,t.pos.y),i);await this.throwOnPos(e,t,r,a,n)}}async throwOnPos(e,t,r,i,n=1){e.pickable.drop(e,t,void 0,i,"throw",!r),e.pickable.onThrowEffector&&(await e.pickable.onThrowEffector.apply(e,t,i,n),e.pickable.destroyedWhenThrown&&e.destroy())}}class Xm{equipped=!1;defenceBonus=0;constructor(e){e&&(this.slots=e.slots,e.defence&&(this.defenceBonus=e.defence))}isEquipped(){return this.equipped}getSlots(){return this.slots}getdefenceBonus(){return this.defenceBonus}use(e,t){this.equipped?this.unequip(e,t):this.equip(e,t)}canUseSlot(e){return this.slots&&-1!==this.slots.indexOf(e)}tryEquipOnSlot(e,t){if(!e.container.hasSlot(t))return!1;if(e.container.getFromSlot(t))return!1;if(t===bc){if(e.container.getFromSlot(fc))return!1;if(e.container.getFromSlot(pc))return!1}else if((t===fc||t===pc)&&e.container.getFromSlot(bc))return!1;return!0}equipOnSlot(e,t,r){let i=t.container.getFromSlot(r);if(i)i.equipment.unequip(i,t);else if(r===bc){let e=t.container.getFromSlot(fc);e&&e.equipment.unequip(e,t);let r=t.container.getFromSlot(pc);r&&r.equipment.unequip(r,t)}else if(r===fc||r===pc){let e=t.container.getFromSlot(bc);e&&e.equipment.unequip(e,t)}this.equipped=!0,t.container.equip(t,e,r),t===vg.specialActors[gg.PLAYER]&&lc.warn(Mc("[The actor1] equip[s] [the actor2] on [its] "+r,t,e)),e.activable&&!e.activable.isActive()&&e.activable.activate(e)}equip(e,t){if(this.slots){if(this.slots.length>1)for(let r of this.slots)if(this.tryEquipOnSlot(t,r))return void this.equipOnSlot(e,t,r);this.equipOnSlot(e,t,this.slots[0])}else lc.error(Mc("Error! Cannot equip [the actor1]",e))}unequip(e,t,r=!1){this.equipped=!1;let i=t.container.unequip(e);i&&!r&&t===vg.specialActors[gg.PLAYER]&&lc.warn(Mc("[The actor1] unequip[s] [the actor2] from [its] "+i,t,e)),!r&&e.activable&&e.activable.deactivate(e)}}class qm{get loadTime(){return this._loadTime}get damageCoef(){return this._damageCoef}get projectileType(){return this._projectileType}get projectile(){return this.projectileId?vg.fromId(this.projectileId):void 0}get range(){return this._range}constructor(e){e&&(this._damageCoef=e.damageCoef,this._projectileType=e.projectileType,this._loadTime=e.loadTime,this._range=e.range)}async fire(e,t){let r=this.findCompatibleProjectile(e);return r?(this.projectileId=r.id,lc.info(Mc("[The actor1] fire[s] [a actor2].",e,r)),await r.pickable.throw(r,e,!0,this._range,e.xpHolder?e.xpHolder.xpLevel+4:0),!0):(e===vg.specialActors[gg.PLAYER]&&lc.warn("No "+this._projectileType+" available."),!1)}findCompatibleProjectile(e){let t;if(e.container&&(t=e.container.getFromSlot(xc),!t||!t.isA(this._projectileType))){t=void 0;let r=e.container.size();for(let i=0;i<r;++i){let r=e.container.get(i);if(r&&r.isA(this._projectileType)){t=r;break}}}return t}}class Zm{get charges(){return this._charges}constructor(e){e&&(this.maxCharges=e.charges,this._charges=e.charges,this.onFireEffector=mg.createEffector(e.onFireEffect))}async zap(e,t){if(0===this._charges)return lc.info(Mc("[The actor1's] "+e.name+" is uncharged",t)),!1;if(this.onFireEffector){const r=await this.onFireEffector.apply(e,t);return r&&this.doPostZap(e,t),r}return!1}doPostZap(e,t){this._charges--,this._charges>0?lc.info("Remaining charges : "+this._charges):lc.info(Mc("[The actor1's] "+e.name+" is uncharged",t))}}class Jm{active=!1;constructor(e){e&&this.init(e)}init(e){e&&(this.activateMessage=e.activateMessage,this.deactivateMessage=e.deactivateMessage,this.type=e.type,e.onActivateEffector&&(this.onActivateEffector=mg.createEffector(e.onActivateEffector)),e.activeByDefault&&(this.active=!0))}isActive(){return this.active}activate(e,t){if(e.lock&&e.lock.isLocked()){let r=e.lock.keyId;if(!(t&&t.container&&t.container.contains(r,!0)))return lc.info(Mc("[The actor1] is locked and needs a key.",e)),!1;{e.lock.unlock(r),t.container.remove(r,t);let i=vg.fromId(r);i&&i.destroy(),lc.info(Mc("[The actor1] unlock[s] [the actor2].",t,e))}}return(!e.destructible||!e.destructible.isDead())&&(this.active=!0,this.displayState(e),this.type!==em.SINGLE?e.light&&vu.publishEvent(Ec,e):this.active=!1,this.onActivateEffector&&t&&this.onActivateEffector.apply(e,t),!0)}deactivate(e){return this.active=!1,this.displayState(e),e.light&&vu.publishEvent(Ec,e),!0}switchLever(e,t){return this.active?this.deactivate(e):this.activate(e,t)}displayState(e){this.isActive()?this.activateMessage&&lc.info(Mc(this.activateMessage,e)):this.deactivateMessage&&lc.info(Mc(this.deactivateMessage,e))}}class Qm extends Jm{constructor(e){super(e)}activate(e,t){let r=void 0!==this.actorId?vg.fromId(this.actorId):void 0;return!(!r||!r.activable)&&r.activable.activate(r,t)}deactivate(e,t){let r=void 0!==this.actorId?vg.fromId(this.actorId):void 0;return!(!r||!r.activable)&&r.activable.deactivate(r)}switchLever(e,t){let r=void 0!==this.actorId?vg.fromId(this.actorId):void 0;return!(!r||!r.activable)&&r.activable.switchLever(r,t)}}class $m{locked=!0;constructor(e){this._keyId=e}isLocked(){return this.locked}get keyId(){return this._keyId}unlock(e){return this._keyId===e&&(this.locked=!1,!0)}lock(){this.locked=!0}}class eg extends Jm{constructor(e){super(e),e&&(this.seeThrough=e.seeThrough)}activate(e,t){if(super.activate(e,t)){let t=e.map;return e.ch="`",e.blocks=!1,e.transparent=!0,t.setWalkable(e.pos.x,e.pos.y,!0),t.setTransparent(e.pos.x,e.pos.y,!0),!0}return!1}deactivate(e){let t=e.map;return t.canWalk(e.pos.x,e.pos.y)?(super.deactivate(e),e.ch="+",e.blocks=!0,e.transparent=this.seeThrough,t.setWalkable(e.pos.x,e.pos.y,!1),t.setTransparent(e.pos.x,e.pos.y,this.seeThrough),!0):(lc.info(Mc("Cannot close [the actor1]",e)),!1)}}const tg="player",rg="path",ig="pathFinder";class ng extends Hh{constructor(e=!0){super(),this.useDiagonals=e}tick(e){let t=e.userData,r=vg.specialActors[gg.PLAYER];return r.pos.isAdjacent(t.pos,this.useDiagonals)?(t.ai.moveToCell(t,r.pos,!0),Mh.SUCCESS):Mh.FAILURE}}class ag extends Hh{constructor(e,t=0,r=!0){super(),this.targetContextKey=e,this.minRange=t,this.allowDiagonals=r}tick(e){let t=Gc.current,r=e.userData,i=e.context.get(rg,e.tree.id,this.id);if(t.isInFov(r.pos.x,r.pos.y)){let n;if(n=this.targetContextKey===td?vg.fromId(r.ai.targetId):e.context.get(this.targetContextKey),!n)throw new Error("Could not find "+this.targetContextKey+" registered!");if(!n.pos.isAdjacent(r.pos,!1)&&C.taxiDistance(n.pos,r.pos)>this.minRange){if(!i||0===i.length||i[0].x!==n.pos.x||i[0].y!==n.pos.y){let a=e.context.get(ig);a||(a=new gh(t.w,t.h,(function(e,r){return t.canWalk(r.x,r.y)?1:0}),void 0,this.allowDiagonals),e.context.set(ig,a)),i=a.getPath(r.pos,n.pos),e.context.set(rg,i,e.tree.id,this.id)}return i?(this.followPath(r,i),Mh.RUNNING):(r.wait(r.ai.walkTime),Mh.SUCCESS)}return Mh.SUCCESS}return i&&i.length>0?(this.followPath(r,i),Mh.RUNNING):Mh.FAILURE}followPath(e,t){let r=t.pop();r&&e.ai.moveToCell(e,r,!1)}}class og extends Hh{constructor(e){super(),this.scentThreshold=e}tick(e){let t=e.userData,r=vg.specialActors[gg.PLAYER],i=Math.abs(t.pos.x-r.pos.x),n=Math.abs(t.pos.y-r.pos.y);if(i<=1&&n<=1)return Mh.SUCCESS;let a=this.findHighestScentCell(t);return a?(t.ai.moveToCell(t,a,!1),Mh.RUNNING):Mh.FAILURE}findHighestScentCell(e){let t,r=0,i=Gc.current,n=e.pos.getAdjacentCells(i.w,i.h);for(let e of n)if(!i.isWall(e.x,e.y)){let n=i.getScent(e.x,e.y);n>i.currentScentValue-this.scentThreshold&&n>r&&(r=n,t=e)}return t}}class sg extends Hh{tick(e){let t=e.userData;return t.wait(t.ai.walkTime),Mh.SUCCESS}}const lg="CHILD_STATUS";class hg{get context(){return this.__context||(this.__context=new Rh,this.__context.set(tg,vg.specialActors[gg.PLAYER])),this.__context}get behaviorTree(){return this.__behaviorTree}set behaviorTree(e){this.__behaviorTree=e,e&&(this.behaviorTreeName=e.name)}constructor(e,t,r,i){this._walkTime=e,this.setPickers(t,r,i)}postLoad(){void 0!==this.behaviorTreeName&&(this.__behaviorTree=mg.getBehaviorTree(this.behaviorTreeName))}setPickers(e,t,r){this.__tilePicker=e,this.__inventoryItemPicker=t,this.__lootHandler=r}getConditionTimeMultiplier(){let e=1;return this.hasCondition(rm.OVERENCUMBERED)&&(e*=1.5),this.hasCondition(rm.FROZEN)&&(e*=3),e}get tilePicker(){return this.__tilePicker}get inventoryItemPicker(){return this.__inventoryItemPicker}get lootHandler(){return this.__lootHandler}get conditions(){return this._conditions}get walkTime(){return this._walkTime}set walkTime(e){this._walkTime=e}async update(e){if(this._conditions)for(let t=0,r=this._conditions.length;t<r;++t){let i=this._conditions[t];i.onlyIfActive&&e.activable&&!e.activable.isActive()||i.update(e)||(i.onRemove(e),this._conditions.splice(t,1),t--,r--)}}addCondition(e,t){this._conditions||(this._conditions=[]),this._conditions.push(e),e.onApply(t)}removeCondition(e){if(this._conditions)for(let t=0,r=this._conditions.length;t<r;++t)if(this._conditions[t].type===e){this._conditions.splice(t,1);break}}getConditionDescription(e){if(!this._conditions)return;let t=0;for(;t<this._conditions.length;){let r=this._conditions[t];if(r.getName()&&!(r.noDisplay||r.noCorpse&&e.destructible&&e.destructible.isDead()))return r.getName();t++}}hasActiveConditions(){let e=this._conditions?this._conditions.length:0;for(let t=0;t<e;t++)if(this._conditions[t].time>0)return!0;return!1}getCondition(e){let t=this._conditions?this._conditions.length:0;for(let r=0;r<t;r++)if(this._conditions[r].type===e)return this._conditions[r]}hasCondition(e){return void 0!==this.getCondition(e)}onAdd(e,t,r){}onRemove(e,t,r){}moveToCell(e,t,r){let i=t.x-e.pos.x,n=t.y-e.pos.y,a=i>0?1:i<0?-1:0,o=n>0?1:n<0?-1:0;this.move(e,a,o,r)}move(e,t,r,i){let n=e.pos.x,a=e.pos.y,o=e.map;0!==t&&(i?!o.isWall(n+t,a):o.canWalk(n+t,a))?n+=t:0!==r&&(i?!o.isWall(n,a+r):o.canWalk(n,a+r))&&(a+=r),this.moveOrAttack(e,n,a,i)}tryActivate(e){let t=vg.list.filter((t=>(t.activable&&!t.pickable||t.container&&(!t.pickable||void 0===t.pickable.containerId))&&t.pos.equals(e.pos)&&t!==e));return t.length>0&&(this.activateActors(e,t),!0)}moveOrAttack(e,t,r,i=!0){if(e.isA(bd)&&e.pos.x===t&&e.pos.y===r)return e.scheduler.pause(),!1;if(this.hasCondition(rm.STUNNED))return e.wait(this._walkTime),!1;if(this.hasCondition(rm.CONFUSED)&&(t=e.pos.x+U.default.getNumber(-1,1),r=e.pos.y+U.default.getNumber(-1,1)),t===e.pos.x&&r===e.pos.y)return e.wait(this._walkTime),!1;if(e.map.isWall(t,r))return this.hasCondition(rm.CONFUSED)?e.wait(this._walkTime):e.scheduler.pause(),!1;let n=e.map.actorList.filter((e=>e.pos.x===t&&e.pos.y===r&&e.isA(md)&&!e.destructible.isDead()));if(n.length>0){if(i){let t=e.getAttacker();return t.attack(e,n[0]),e.wait(t.attackTime),!1}return e.wait(this._walkTime),!0}return n=e.map.actorList.filter((e=>e.pos.x===t&&e.pos.y===r&&e.isA("door[s]")&&!e.activable.isActive())),n.length>0?(n[0].activable.activate(n[0],e),e.wait(this._walkTime),!1):e.map.canWalk(t,r)?(e.wait(this._walkTime),e.moveTo(t,r),!0):(e.wait(this._walkTime),!1)}activateActors(e,t){let r=!1,i=[];for(let n of t)n.activable?(n.activable.switchLever(n,e),r=!0):n.container&&i.push(n);if(i.length>0&&this.lootHandler)for(const t of i){const i=t.pos.clone();t.moveTo(-1,-1);for(const r of t.container.getContent(void 0))r.pickable.drop(r,e,void 0,Um(i));t.destroy(),r=!0}r?e.wait(this._walkTime):e.scheduler.pause()}checkOverencumberedCondition(e,t){!this.hasCondition(rm.OVERENCUMBERED)&&e.computeTotalWeight()>=.9*e.capacity?this.addCondition(pm.create({nbTurns:-1,type:rm.OVERENCUMBERED,noCorpse:!0}),t):this.hasCondition(rm.OVERENCUMBERED)&&e.computeTotalWeight()<.9*e.capacity&&this.removeCondition(rm.OVERENCUMBERED)}}class ug extends hg{constructor(e){super(e,void 0,void 0,void 0)}async update(e){await super.update(e),e.wait(this.walkTime)}}class cg extends hg{constructor(e,t,r,i){super(e,t,r,i)}async update(e){let t=kc();if(void 0!==t)if(await super.update(e),this.hasCondition(rm.STUNNED)||e.destructible&&e.destructible.isDead())e.wait(this.walkTime);else switch(t){case Ac.AUTOFIGHT:this.autoFight(e);break;case Ac.AUTODOWN:this.autoStairsDown(e);break;case Ac.AUTOUP:this.autoStairsUp(e);break;case Ac.AUTOEXPLORE:this.autoExplore(e);break;case Ac.MOVE_NORTH:case Ac.MOVE_SOUTH:case Ac.MOVE_EAST:case Ac.MOVE_WEST:let r=Sc(t);const i=e.pos.x+r.x,n=e.pos.y+r.y;Gc.current.canWalk(i,n)||!Cm(new C(i,n))?this.moveOrAttack(e,i,n):e.scheduler.pause();break;case Ac.WAIT:e.wait(this.walkTime);break;case Ac.GRAB:case Ac.SACRIFICE_ITEM:case Ac.USE_ITEM:case Ac.DROP_ITEM:case Ac.THROW_ITEM:case Ac.FIRE:case Ac.ZAP:this.hasCondition(rm.CONFUSED)||await this.handleAction(e,t);break;case Ac.MOVE_UP:case Ac.MOVE_DOWN:default:e.scheduler.pause()}else e.scheduler.isPaused()||e.scheduler.pause()}autoStairsDown(e){let t=Vm(e.pos,Nm);if(t&&t.equals(e.pos))return this.tryActivate(e);if(t){const r=Bm(e,t);if(r)return this.moveToCell(e,r,!0),!0}return e.scheduler.pause(),!1}autoStairsUp(e){let t=Vm(e.pos,Rm);if(t&&t.equals(e.pos))return this.tryActivate(e);if(t){const r=Bm(e,t);if(r)return this.moveToCell(e,r,!0),!0}return e.scheduler.pause(),!1}findEnemyAt(e){for(const t of Gc.current.actorList)if(t.isA(md)&&t.pos.equals(e))return t}autoExplore(e){const t=jm(e.pos);if(t){const r=this.findEnemyAt(t),i=vg.player.destructible.computeDamage(vg.player,r.meleePower),n=Math.ceil(r.destructible.hp/r.destructible.computeDamage(r,vg.player.meleePower)),a=i*(n-1);return lc.error(Mc("You cannot explore, you see [a actor1].",r)),a<=0?lc.error(Mc("Combat might be safe.",r)):lc.error(Mc("Combat will cause "+a+"+ damage and give "+Math.floor(r.destructible.xp/2)+" XP.",r)),void e.scheduler.pause()}let r=Vm(e.pos,Lm);if(r&&r.equals(e.pos))return void(this.pickupItem(e)?e.wait(this.walkTime):e.scheduler.pause());const i=t=>{if(t){const r=Fm(e,t);if(r)return r}};let n=[i(zm(e.pos)),i(r),i(Hm(e.pos))].filter((e=>e));n.sort(((e,t)=>(e||[]).length<(t||[]).length?-1:(e||[]).length>(t||[]).length?1:0));const a=t=>{if(t){const r=t.pop();if(r)return this.moveToCell(e,r,!0),!0}return!1},o=a(n[0])||a(n[1])||a(n[2]);o||0!==n.length?o||e.scheduler.pause():this.autoStairsDown(e)}autoFight(e){const t=jm(e.pos);t?this.moveToCell(e,t,!0):e.scheduler.pause()}moveOrAttack(e,t,r){if(!super.moveOrAttack(e,t,r))return!1;let i=new C(e.pos.x,e.pos.y);return vg.describeCell(i),!0}async handleAction(e,t){switch(e.scheduler.pause(),t){case Ac.GRAB:this.pickupItem(e)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause();break;case Ac.USE_ITEM:if(this.inventoryItemPicker){const t=await this.inventoryItemPicker.pickItemFromInventory("use an item",e);if(!t)return void e.scheduler.pause();await this.useItem(e,t)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause()}break;case Ac.SACRIFICE_ITEM:if(this.inventoryItemPicker){const t=await this.inventoryItemPicker.pickItemFromInventory("sacrifice an item",e);if(!t)return void e.scheduler.pause();await this.sacrificeItem(e,t)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause()}break;case Ac.DROP_ITEM:if(this.inventoryItemPicker){const t=await this.inventoryItemPicker.pickItemFromInventory("drop an item",e);if(!t)return void e.scheduler.pause();await this.dropItem(e,t)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause()}break;case Ac.THROW_ITEM:if(this.inventoryItemPicker){const t=await this.inventoryItemPicker.pickItemFromInventory("throw an item",e);if(!t)return void e.scheduler.pause();await this.throwItem(e,t)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause()}break;case Ac.FIRE:await this.fire(e)?(e.wait(this.walkTime),e.scheduler.resume()):e.scheduler.pause();break;case Ac.ZAP:await this.zap(e)&&(e.wait(this.walkTime),e.scheduler.resume())}}async fire(e){let t=e.container.getFromSlot(fc);if(t&&t.ranged||(t=e.container.getFromSlot(bc)),t&&t.ranged||(t=e.container.getFromSlot(pc)),!t||!t.ranged){const r=new qm({damageCoef:1,projectileType:"dart[s]",loadTime:0,range:9});return await r.fire(e,t)}return await t.ranged.fire(e,t)}async zap(e){let t=e.container.getFromSlot(fc);return t&&t.magic||(t=e.container.getFromSlot(bc)),t&&t.magic||(t=e.container.getFromSlot(pc)),t&&t.magic?await t.magic.zap(t,e):(lc.error("You have no magic item equipped."),!1)}async useItem(e,t){if(t.pickable){if(await t.pickable.use(t,e)||!e.isA(bd))return!0}return!1}async sacrificeItem(e,t){if(t.pickable){if(t.pickable.price>0)return t.destroy(),e.xpHolder.addXp(e,t.pickable.price),!0;lc.warn(Mc("You cannot sacrifice [the actor1].",t))}return!1}dropItem(e,t){if(t.pickable){const r=Um(e.pos);return t.pickable.drop(t,e,void 0,r,void 0,!0),!0}return!1}async throwItem(e,t){return!!t.pickable&&(await t.pickable.throw(t,vg.specialActors[gg.PLAYER],!1),!0)}pickupItem(e){let t=!1,r=!1;for(let i of vg.list)if(i.pickable&&i.pos.equals(e.pos)&&void 0===i.pickable.containerId&&(t=!0,e.container.canContain(i))){i.pickable.pick(i,e,!0),r=!0;break}return t?!!r||(lc.warn("Your inventory is full."),!1):!!this.tryActivate(e)||(lc.warn("There's nothing to pick up here."),!1)}}class dg extends hg{constructor(e,t){super(e,void 0,void 0,void 0),t&&t.behaviorTree&&(this.behaviorTree=t.behaviorTree)}async update(e){await super.update(e),e.destructible&&e.destructible.isDead()?e.wait(this.walkTime):this.behaviorTree?this.behaviorTree.tick(this.context,e):e.wait(this.walkTime)}}class fg{_xpLevel=1;_xp=0;demonicFavorXp=0;demonicFavorLevel=1;constructor(e){e&&(this.baseLevel=e.baseLevel,this.newLevel=e.newLevel)}get xpLevel(){return this._xpLevel}get xp(){return this._xp}getNextLevelXp(){return this.baseLevel+this._xpLevel*this.newLevel}getNextDemonicLevelXp(){return this.baseLevel+this._xpLevel*this.newLevel}addXp(e,t){this._xp+=t;let r=this.getNextLevelXp();this._xp>=r&&(this._xpLevel++,this._xp-=r,e.destructible.gainMaxHP(10),lc.error(Mc("[The actor1's] battle skills grow stronger! [The actor1] reached level "+this.xpLevel,e)))}addDemonicFavor(e,t){this.demonicFavorXp+=t;let r=this.getNextDemonicLevelXp();this.demonicFavorXp>=r?(this.demonicFavorLevel++,this.demonicFavorXp-=r,lc.error(Mc(`[The actor1's] is now favor level ${this.demonicFavorLevel} with ${ny().storyConfig.demonName}!`,e))):lc.error(Mc(`[The actor1] gain[s] favor with ${ny().storyConfig.demonName}!`,e))}}class pg{constructor(e){this._options=e}get options(){return this._options}get position(){return this.pos}set position(e){this.pos=e}setRange(e){switch(this._options.range=e,this._options.falloffType){case lm.LINEAR:this.rangeFactor1=1/(e*e);break;case lm.NORMAL:this.rangeFactor1=1/(1+e*e*.05),this.rangeFactor2=1/(1-this.rangeFactor1);break;case lm.NONE:this.rangeFactor1=0,this.rangeFactor2=0;break;default:throw new Error("UNEXPECTED FALLOF TYPE")}}computeIntensityVariation(e){if(!this._options.intensityVariationPattern)return 1;let t;return this.patternTime||void 0===this._options.intensityVariationLength||(this.patternTime=U.default.getNumber(0,this._options.intensityVariationLength)),t="noise"===this._options.intensityVariationPattern?this.computeNoiseIntensityVariation(e):this.computePatternIntensityVariation(e),1-(this._options.intensityVariationRange||1)+t*(this._options.intensityVariationRange||1)}computeIntensity(e){switch(void 0===this.rangeFactor1&&this.setRange(this._options.range),this._options.falloffType){case lm.LINEAR:return 1-e*this.rangeFactor1;case lm.INVERSE_SQUARE:return 1/(1+e);case lm.NORMAL:return(1/(1+.05*e)-this.rangeFactor1)*this.rangeFactor2;case lm.NONE:return 1;default:throw new Error("UNEXPECTED FALLOFF TYPE!")}}computeNoiseIntensityVariation(e){return this.__noise||(this.__noise=new yh(U.default)),this.patternTime+=e/(this._options.intensityVariationLength||1),.5*(this.__noise.get1D(this.patternTime,1)+1)}computePatternIntensityVariation(e){if(void 0===this._options.intensityVariationPattern)return 0;for(this.patternTime+=e;this.patternTime>(this._options.intensityVariationLength||1);)this.patternTime-=this._options.intensityVariationLength||1;let t=this._options.intensityVariationPattern.length,r=t*this.patternTime/(this._options.intensityVariationLength||1),i=Math.floor(r),n=r-i,a=(i+1)%t;return((1-n)*(this._options.intensityVariationPattern.charCodeAt(i)-48)+n*(this._options.intensityVariationPattern.charCodeAt(a)-48))/9}}class mg{static registerBehaviorTree(e){let t=N(e.name);mg.btTrees[t]=e}static registerActorDef(e){mg.actorDefs[e.name]=e,mg.actorTypes.push(e.name)}static getActorDef(e){let t=mg.actorDefs[e];return void 0===t&&(console.log((new Error).stack),lc.warn("WARN: unknown actor type "+e)),t}static getActorTypes(){return mg.actorTypes}static computeLevelProbabilities(e,t){let r={};for(let i of e.classProb)i.clazz&&("number"==typeof i.prob?r[i.clazz]=i.prob:r[i.clazz]=mg.getValueForLevel(i.prob,t));return r}static createRandomActors(e,t){let r=mg.getRandomCountFromMap(e),i=[],n=mg.computeLevelProbabilities(e,t);for(;r>0;){let e=vg.lootRng.getRandomChance(n);if(e&&"undefined"!==e){let r=this.createRandomActor(t,e);r&&i.push(r)}r--}return i}static createRandomActor(e,t){let r=mg.getActorDef(t);if(r){r.abstract&&(t=mg.getRandomActorClass(t));let i=mg.create(e,t);return i&&i.register(),i}return console.log((new Error).stack),void lc.warn("WARN : unknown actor type "+t)}static create(e,t,r,i,n){if(mg.actorDefs[t])return mg.createActor(e,mg.actorDefs[t],r,i,n);mg.unknownClasses[t]||(console.log((new Error).stack),lc.warn("WARN : unknown actor type "+t),mg.unknownClasses[t]=!0)}static createInContainer(e,t){for(let r of t){let t=mg.create(e.mapId,r);t&&(t.register(),t.pickable&&t.pickable.pick(t,e,!1))}}static createEffector(e){return new Mm(mg.createEffect(e.effect),mg.createTargetSelector(e.targetSelector),e.message,e.destroyOnEffect)}static load(e){return new Promise((t=>{e.loadFromKey(Tc).then((e=>{mg.seq=e,t()}))}))}static save(e){e.saveToKey(Tc,mg.seq)}static deleteSavedGame(e){e.deleteKey(Tc)}static setLock(e,t){e.lock=new $m(t.id)}static getActorTypeName(e,t){let r=mg.getActorDef(e);return r?1===t?-1!==r.name.indexOf("[s]")?r.name.replace("[s]",""):-1!==r.name.indexOf("[es]")?r.name.replace("[es]",""):r.name:-1!==r.name.indexOf("[s]")?r.name.replace("[s]","s"):-1!==r.name.indexOf("[es]")?r.name.replace("[es]","es"):void 0===r.pluralName?r.name:r.pluralName:(lc.error("Unknown actor type "+e),"")}static getBehaviorTree(e){let t=N(e);return mg.btTrees[t]}static seq=1;static unknownClasses={};static actorDefs={};static actorTypes=[];static btTrees={};static getValueForLevel(e,t){for(let r=e.length-1;r>=0;--r)if(t>=e[r][0])return e[r][1];return 0}static getRandomCountFromMap(e){return void 0!==e.maxCount?vg.lootRng.getNumber(e.minCount||0,e.maxCount):void 0!==e.countProb?vg.lootRng.getRandomChance(e.countProb):0}static getConcreteActorClass(e,t){t=t||[];for(let r in mg.actorDefs)if(mg.actorDefs.hasOwnProperty(r)){let i=mg.actorDefs[r];i.prototypes&&-1!==i.prototypes.indexOf(e)&&(i.abstract?mg.getConcreteActorClass(r,t):t.push(r))}return t}static getRandomActorClass(e){let t=mg.getConcreteActorClass(e);return t[vg.lootRng.getNumber(0,t.length-1)]}static createActor(e,t,r,i,n){let a=new vg(e,t.name+"|"+mg.seq);return mg.seq++,mg.populateActor(a,t,r,i,n),a.name=mg.getActorTypeName(t.name,1),a.pluralName=mg.getActorTypeName(t.name,2),a.charCode||lc.critical("ERROR : no character defined for actor type "+t.name),a}static populateActor(e,t,r,i,n){if(t.prototypes)for(let a of t.prototypes)mg.actorDefs[a]?mg.populateActor(e,mg.actorDefs[a],r,i,n):mg.unknownClasses[a]||(lc.warn("WARN : unknown actor class "+a),mg.unknownClasses[a]=!0);if(e.init(t),t.pickable&&(e.pickable=new Ym(t.pickable)),t.ai&&(e.ai=mg.createAi(e,t.ai,r,i,n)),t.attacker&&(e.attacker=new Km(t.attacker)),t.destructible&&(e.destructible=new Gm(t.destructible,e.destructible)),t.light&&(e.light=new pg(t.light)),t.equipment&&(e.equipment=new Xm(t.equipment)),t.ranged&&(e.ranged=new qm(t.ranged)),t.magic&&(e.magic=new Zm(t.magic)),t.xpHolder&&(e.xpHolder=new fg(t.xpHolder)),t.container&&(e.container=new Wm(t.container,e.ai)),t.activable)if(e.activable)e.activable.init(t.activable);else switch(t.activable.type){case em.SINGLE:case em.TOGGLE:e.activable=new Jm(t.activable);break;case em.DOOR:e.activable=new eg(t.activable);break;case em.LEVER:e.activable=new Qm(t.activable)}}static createTargetSelector(e){return new bm(e)}static createEffect(e){switch(e.type){case Qp.CONDITION:return new km(e,e.successMessage);case Qp.INSTANT_HEALTH:return new Em(e);case Qp.MAP_REVEAL:return new Sm;case Qp.TELEPORT:return new Am(e.successMessage);case Qp.EVENT:default:return new wm(e)}}static createCondition(e){return pm.create(e)}static createAi(e,t,r,i,n){let a;switch(t.type){case om.ITEM:a=new ug(t.walkTime);break;case om.MONSTER:a=new dg(t.walkTime,e.ai);break;case om.PLAYER:default:a=new cg(t.walkTime,r,i,n)}if(t.conditions)for(let r of t.conditions)a.addCondition(mg.createCondition(r),e);return t.treeName&&(a.behaviorTree=mg.getBehaviorTree(t.treeName)),a}}let gg;var yg;(yg=gg||(gg={}))[yg.PLAYER=1]="PLAYER";class vg extends class{_nextActionTime=0;getNextActionTime(){return this._nextActionTime}wait(e){this._nextActionTime+=e}}{static specialActors={};static scheduler=new vh;static lootRng=new U;static idMap={};static fromId(e){if(void 0!==e)return vg.idMap[e]}get map(){return Gc.mapDb[this.mapId]}static get player(){return vg.specialActors[gg.PLAYER]}static get list(){return Gc.currentActors}static getScheduler(e){return this.scheduler}static get currentScheduler(){return vg.scheduler}static resetCurrentScheduler(){vg.scheduler=new vh}get scheduler(){return vg.scheduler}changeMap(e){return function(e,t){const r=e.indexOf(t);-1!==r&&e.splice(r,1)}(Gc.getActors(this.mapId),this),Gc.getActors(e).push(this),this.mapId=e,Gc.getActors(this.mapId)}static findClosestEnemy(e,t){let r,i=1e8;for(let n of vg.list)if(n!==vg.specialActors[gg.PLAYER]&&n.isA("creature[s]")&&!n.destructible.isDead()){let a=C.distance(e,n.pos);a<i&&(void 0===t||a<t||0===t)&&(i=a,r=n)}return r}static load(e){return new Promise((t=>{e.loadFromKey(_c).then((e=>{Gc.actorsDb=e;for(let e of Gc.actorsDb){0;for(let t of e){let e;t.isA("player")&&(e=gg.PLAYER),void 0!==e&&(vg.specialActors[e]=t)}}t()}))}))}static deleteSavedGame(e){e.deleteKey(_c)}static describeCell(e,t=!1){for(let r of vg.list.filter((r=>r.pos.x===e.x&&r.pos.y===e.y&&(t||r!==vg.specialActors[gg.PLAYER])&&(!r.pickable||void 0===r.pickable.containerId))))lc.info(r.getTheresaname()+" here.")}blocks=!1;transparent=!0;fovOnly=!0;wallActor=!1;classes=[];features={};_singular=!0;get id(){return this._id}get readableId(){return this._readableId}constructor(e,t){super(),void 0!==e&&void 0!==t&&(this.mapId=e,this._pos=new C,this._readableId=t,this._id=N(this._readableId),vg.idMap[this._id]=this,lc.isDebugEnabled()&&lc.debug("new actor "+this.readableId+"["+this._id.toString(16)+"]"),Gc.getActors(e).push(this))}register(){this.ai&&vg.getScheduler(this.mapId).add(this),!this.light||this.activable&&!this.activable.isActive()||vu.publishEvent(Ec,this),this.moveTo(this.pos.x,this.pos.y)}postLoad(){vg.idMap[this._id]=this,this.ai&&vg.getScheduler(this.mapId).rawAdd(this),!this.light||this.activable&&!this.activable.isActive()||vu.publishEvent(Ec,this),this.moveTo(this.pos.x,this.pos.y),this.ai&&this.container&&this.container.setListener(this.ai)}getAttacker(){if(this.container)for(let e=0,t=this.container.size();e<t;++e){let t=this.container.get(e);if(t&&t.equipment&&t.equipment.isEquipped()&&t.attacker)return t.attacker}return this.attacker}destroy(){let e=this.getWearer();if(e&&e.container.remove(this.id,e),this.ai&&vg.getScheduler(this.mapId).remove(this),this.activable&&this.activable.isActive()&&this.light&&this.activable.deactivate(this),this.container){let e=this.container.size();for(;e>0;){let t=this.container.get(0);t&&t.destroy(),--e}}delete vg.idMap[this._id];let t=vg.list.indexOf(this);-1!==t&&vg.list.splice(t,1)}equals(e){return this._id===e._id}init(e){if(e&&(e.ch&&(this._ch=e.ch.charCodeAt(0)),e.name&&(this.type=e.name),void 0!==e.color&&(this.col=e.color),void 0!==e.plural&&(this._singular=!e.plural),void 0!==e.blockWalk&&(this.blocks=e.blockWalk),void 0!==e.blockSight&&(this.transparent=!e.blockSight),e.wallActor&&(this.wallActor=e.wallActor),void 0!==e.displayOutOfFov&&(this.fovOnly=!e.displayOutOfFov),e.prototypes))for(let t of e.prototypes)this.classes.push(t)}get pos(){return this._pos}moveTo(e,t){if(this.transparent?this._pos.moveTo(e,t):(this.map.setTransparent(this.pos.x,this.pos.y,!0),this._pos.moveTo(e,t),this.map.setTransparent(this.pos.x,this.pos.y,!1)),this.container)for(let r=0,i=this.container.size();r<i;++r){let i=this.container.get(r);i&&i.moveTo(e,t)}}computeThrowRange(e){let t=this.pickable.weight,r=t<.5?3:15/t;return this.equipment&&this.equipment.canUseSlot(xc)&&(r*=2.5),r}isA(e){return this.type===e||-1!==this.classes.indexOf(e)}getClasses(){return this.classes}isPlayer(){return this===vg.specialActors[gg.PLAYER]}get ch(){return String.fromCharCode(this._ch)}get charCode(){return this._ch}set ch(e){this._ch=e.charCodeAt(0)}isSingular(){return this._singular}setSingular(e){this._singular=e}isStackable(){return!this.destructible&&(!this.equipment||!this.equipment.isEquipped()||this.equipment.canUseSlot(xc))}hasFeature(e){return void 0!==this.features[e]}getWearer(){if(this.pickable&&this.pickable.containerId)return vg.idMap[this.pickable.containerId]}get destructible(){return this.features[dm.DESTRUCTIBLE]}set destructible(e){this.features[dm.DESTRUCTIBLE]=e}get attacker(){return this.features[dm.ATTACKER]}set attacker(e){this.features[dm.ATTACKER]=e}get ai(){return this.features[dm.AI]}set ai(e){this.features[dm.AI]=e}get pickable(){return this.features[dm.PICKABLE]}set pickable(e){this.features[dm.PICKABLE]=e}get container(){return this.features[dm.CONTAINER]}set container(e){this.features[dm.CONTAINER]=e}get equipment(){return this.features[dm.EQUIPMENT]}set equipment(e){this.features[dm.EQUIPMENT]=e}get ranged(){return this.features[dm.RANGED]}set ranged(e){this.features[dm.RANGED]=e}get magic(){return this.features[dm.MAGIC]}set magic(e){this.features[dm.MAGIC]=e}get activable(){return this.features[dm.ACTIVABLE]}set activable(e){this.features[dm.ACTIVABLE]=e}get lock(){return this.features[dm.LOCKABLE]}set lock(e){this.features[dm.LOCKABLE]=e}get light(){return this.features[dm.LIGHT]}set light(e){this.features[dm.LIGHT]=e}get powerBonus(){return this.xpHolder?this.xpHolder.demonicFavorLevel+2*this.xpHolder.xpLevel:0}get meleePower(){const e=this.getAttacker();return this.powerBonus+(e?e.power:0)}get defence(){return this.destructible.computeRealDefence(this)}get xpHolder(){return this.features[dm.XP_HOLDER]}set xpHolder(e){this.features[dm.XP_HOLDER]=e}isInContainer(){return this.pickable&&void 0!==this.pickable.containerId}contains(e,t){return this.container&&this.container.contains(e,t)}getname(e=1){let t=e>1?this.pluralName:this.name;return this.isPlayer()?"you":this.ai&&this.ai.hasCondition(rm.FROZEN)?"frozen "+t:t}getaname(){if(this.isPlayer())return"you";if(!this.isSingular())return" "+this.getname();let e=this.getname();return(-1!=="aeiou".indexOf(e[0])?" an ":" a ")+e}getAname(){if(this.isPlayer())return"You";if(!this.isSingular())return this.getname();let e=this.getname();return(-1!=="aeiou".indexOf(e[0])?"An ":"A ")+e}getTheresaname(){return"There"+(this.isSingular()?"'s":" are")+this.getaname()}getthename(e=1){return this.isPlayer()?" you":1===e?" the "+this.getname():" "+e+" "+this.getname(e)}getThename(e=1){return this.isPlayer()?"You":1===e?"The "+this.getname():" "+e+" "+this.getname(e)}getThenames(){return this.isPlayer()?"Your ":this.getThename()+"'s "}getthenames(){return this.isPlayer()?" your ":this.getthename()+"'s "}getits(){return this.isPlayer()?" your ":" its "}getit(){return this.isPlayer()?" you":" it"}getis(){return this.isPlayer()?" are":this.isSingular()?" is":" are"}getVerbEnd(){return this.isPlayer()?"":this.isSingular()?"s":""}getInventoryQualifier(){let e=this;for(let t of e.getClasses()){if(mg.getActorDef(t).containerQualifier)return t}}getDescription(e=1){let t=this.container&&!this.isA("creature[s]")?this.container.getQualifiedName(this,e):this.destructible?this.destructible.getQualifiedName(this,e):this.getname(e);if(this.magic&&(this.magic.charges>0?t+=", "+this.magic.charges+" charges":t+=", uncharged"),this.ai){let e=this.ai.getConditionDescription(this);e&&(t+=", "+e)}return t}async update(){this.ai&&await this.ai.update(this)}}class bg{constructor(e,t){this._color=e,this._text=t}get text(){return this._text}get color(){return this._color}darkenColor(){this._color=M.multiply(this._color,.8)}}class xg extends Gu{static MESSAGE_X=22;messages=[];mouseLookText="";init(e,t){super.init(e,t),this.moveToBottomLeft(),this.messageHeight=t-1,vu.registerEventListener(this,y)}onTerm(){super.onTerm(),vu.registerEventListener(this,y)}onLog(e){if(e.level===nc.DEBUG)return;let t,r=e.text.split("\n");this.messages.length+r.length>this.messageHeight&&this.messages.splice(0,this.messages.length+r.length-this.messageHeight);for(let e of this.messages)e.darkenColor();switch(e.level){default:case nc.INFO:t=15658734;break;case nc.WARN:t=16753920;break;case nc.ERROR:case nc.CRITICAL:t=qc}for(let e of r)this.messages.push(new bg(t,e))}onUpdate(e){if(!Gc.current)return;let t=wu();if(Gc.current.contains(t.x,t.y)&&Gc.current.isExplored(t.x,t.y)){let e=vg.list.filter((e=>e.pos.equals(t)));this.handleMouseLook(e,t)}}onRender(e){let t=vg.specialActors[gg.PLAYER];if(void 0===t)return;this.console.clearBack(0),this.console.clearText(),this.console.print(0,0,this.mouseLookText);const r=2*t.destructible.hp>=t.destructible.maxHp;this.renderBar(1,1,20,"Health ",t.destructible.hp,t.destructible.maxHp,r?4161343:16727871,r?2047775:8339263),this.renderBar(1,2,20,"Level "+t.xpHolder.xpLevel+": ",t.xpHolder.xp,t.xpHolder.getNextLevelXp(),10436607,4128895),this.console.print(1,3,"Power "+t.meleePower),this.console.print(10,3,"Defence "+t.defence),this.console.print(1,5,ny().dungeonDetails.name),this.console.print(1,6,"Capacity "+t.container.computeTotalWeight().toFixed(1)+"/"+t.container.capacity),this.renderConditions(t.ai.conditions),this.renderMessages(),super.onRender(e)}clear(){this.messages=[],this.mouseLookText=""}renderConditions(e){if(e)for(let t=0,r=e.length;t<r&&t<4;++t){let r=e[t];this.renderBar(1,4+t,20,r.getName(),r.time,r.initialTime,4169535,32575,!1)}}handleMouseLook(e,t){let r=e.length;this.mouseLookText="";let i=vg.specialActors[gg.PLAYER];if(i){let t=i.ai.getCondition(rm.DETECT_LIFE),n=t?t.range:0;for(let t=0;t<r;++t){let r=e[t];if(!r.isInContainer()&&Gc.current.renderer.getActorRenderMode(r,n)!==Nc.NONE)if(t>0&&(this.mouseLookText+=","),r===i)this.mouseLookText="you";else if(r.destructible){const e=i.destructible.computeDamage(i,r.meleePower),t=Math.ceil(r.destructible.hp/r.destructible.computeDamage(r,i.meleePower));this.mouseLookText+=Gc.current.renderer.canIdentifyActor(r)?r.getDescription()+" "+e+" threat / "+(1===t?"1 hit left ":t+" hits left "):"?"}else this.mouseLookText+=Gc.current.renderer.canIdentifyActor(r)?r.getDescription():""}}}renderMessages(){for(let e=0;e<this.messages.length;++e){let t=this.messages[e];this.console.print(xg.MESSAGE_X,e+1,t.text,t.color)}}renderBar(e,t,r,i,n,a,o,s,l=!0){this.console.clearBack(s,e,t,r,1);let h=Math.floor(n/a*r);h>0&&this.console.clearBack(o,e,t,h,1);let u=i||"";l&&-1!==a&&(i&&(u+=" "),u+=Math.floor(n)+"/"+Math.floor(a)),this.console.print(e+Math.floor((r-u.length)/2),t,u)}}class _g extends Vu{static CATEGORIES=[kd,Hd,Td,Fd];constructor(e){super(),this.numberSelector=e}onInit(){super.onInit(),this.itemPanel=this.addChild(new tc({minHeight:16,minWidth:30}))}initFromContainer(e,t,r,i){this.owner=e,this.rootActor=e,this.itemClassFilter=i,this.resolve=t,this.autoHideWidget=r,this.buildStackedInventory(this.owner.container,i),this.show()}onUpdate(e){Yu.isDragging()||(this.buildStackedInventory(this.rootActor.container,this.itemClassFilter),this.itemPanel.initHierarchy())}displayParentContainer(){if(this.rootActor.pickable){let e=vg.fromId(this.rootActor.pickable.containerId);e&&this.setRootActor(e)}}computeItemLabel(e,t=1,r=""){let i=e.ch+" ";return t>1&&(i+=t+" "),i+=e.getDescription(t),r+i}addItemToStack(e){for(let t of this.inventory)if(t[0].name===e.name)return t.push(e),!0;return!1}buildStackedInventory(e,t){this.inventory=[];for(let r=0,i=e.size();r<i;++r){let i=e.get(r);if(i&&(!t||i.isA(t))){if(!(i.isStackable()&&this.addItemToStack(i))){let e=[];e.push(i),this.inventory.push(e)}}}this.inventory.sort(this.compareActors.bind(this)),this.createButtons()}compareActors(e,t){let r=this.getActorSortLevel(e[0],_g.CATEGORIES)-this.getActorSortLevel(t[0],_g.CATEGORIES);return 0!==r?Math.sign(r):e[0].name.localeCompare(t[0].name)}getActorSortLevel(e,t){let r=0;for(;r<t.length&&!e.isA(t[r]);)r++;return r}createButtons(){this.itemPanel.clearChildren(),this.itemPanel.addChild(new Xu({data:this.rootActor,dropCallback:this.onDrop.bind(this)})).addChild(new Zu({callback:this.selectItem.bind(this),eventData:this.rootActor,label:this.computeItemLabel(this.rootActor),postRender:this.postRenderItem.bind(this)}));for(let e of this.inventory){let t=e[0];if(!t.equipment||!t.equipment.isEquipped()){let r=this.itemPanel;t.container&&(r=this.itemPanel.addChild(new Xu({data:t,dropCallback:this.onDrop.bind(this)}))),r.addChild(new Yu({data:e})).addChild(new Zu({autoHideWidget:this.autoHideWidget,callback:this.selectItem.bind(this),eventData:t,label:this.computeItemLabel(t,e.length," "),postRender:this.postRenderItem.bind(this)}))}}}onDrop(e,t,r){let i=e.getOptions().data,n=r;i.length>1?this.numberSelector.selectNumber("How many?",0,i.length,1).then((e=>{this.onDropItem(i,n,e)})):this.onDropItem(i,n,1)}onDropItem(e,t,r){let i=e[0];if(i.pickable.containerId===t.id){let i=vg.fromId(t.pickable.containerId);if(i)return void this.removeItemsFromContainer(e,i,t,r)}else 0===this.putItemsInContainer(e,t,r,t!==this.owner)&&(t===this.owner?lc.warn(Mc("You cannot take [the actor1].",i)):lc.warn(Mc("You cannot put [the actor1] in [the actor2].",i,t)))}removeItemsFromContainer(e,t,r,i){let n=0;for(let r=0;r<i;++r)e[r].pickable.pick(e[r],t,!1)&&n++;1===n?(this.owner.wait(10),vu.publishEvent(cd,fd.NEXT_TURN),lc.info(Mc("You remove [the actor1] from [the actor2].",e[0],r))):n>1&&(this.owner.wait(10),vu.publishEvent(cd,fd.NEXT_TURN),lc.info(Mc("You remove"+e[0].getthename(n)+" from [the actor1].",r)))}putItemsInContainer(e,t,r,i){let n=0;for(let i=0;i<r;++i)e[i].pickable.pick(e[i],t,!1)&&n++;return i&&(1===r?(this.owner.wait(10),vu.publishEvent(cd,fd.NEXT_TURN),lc.info(Mc("You put [the actor1] in [the actor2].",e[0],t))):r>1&&(this.owner.wait(10),lc.info(Mc("You put"+e[0].getthename(r)+" in [the actor1].",t)))),n}postRenderItem(e,t,r,i,n){e.fore[t][r]=i.eventData.col,e.fore[t+1][r]=i.eventData.col}setRootActor(e){this.rootActor=e}selectItem(e){if(Yu.resetDrag(),e.container)e===this.rootActor?this.displayParentContainer():this.setRootActor(e);else if(this.resolve)return this.resolve(e),!0;return!1}}class Tg extends Vu{constructor(){super()}onInit(){super.onInit(),this.itemPanel=this.addChild(new tc({}))}initFromContainer(e,t,r){this.owner=e,this.resolve=t,this.autoHideWidget=r,this.createButtons()&&this.show()}onUpdate(e){Yu.isDragging()||(this.createButtons(),this.itemPanel.initHierarchy())}createButtons(){this.itemPanel.clearChildren();let e=this.owner.container.getSlots();if(!e||0===e.length)return!1;this.slotWidth=this.getSlotsWidth(this.owner.container);for(let t of e){let e=this.owner.container.getFromSlot(t);if(e){let r=this.itemPanel;e.container&&(r=this.itemPanel.addChild(new Xu({data:e,dropCallback:this.onDrop.bind(this)}))),r.addChild(new Yu({data:e})).addChild(new Zu({autoHideWidget:this.autoHideWidget,callback:this.selectItem.bind(this),eventData:e,label:this.computeEquippedItemLabel(t,this.slotWidth,e,1),postRender:this.postRenderEquippedItem.bind(this)}))}else this.itemPanel.addChild(new Zu({autoHideWidget:this.autoHideWidget,label:this.computeEquippedItemLabel(t,this.slotWidth,void 0,1),postRender:this.postRenderEquippedItem.bind(this)}))}return!0}onDrop(e,t,r){let i=e.getOptions().data,n=r;if(i.pickable.pick(i,n,!1))return this.owner.wait(10),vu.publishEvent(cd,fd.NEXT_TURN),void(n!==this.owner&&lc.info(Mc("You put [the actor1] in [the actor2].",i,n)));n===this.owner?lc.warn(Mc("You cannot take [the actor1].",i)):lc.warn(Mc("You cannot put [the actor1] in [the actor2].",i,n))}postRenderEquippedItem(e,t,r,i,n){let a=i.eventData;a&&(e.fore[t+this.slotWidth+2][r]=a.col),e.text[t+this.slotWidth][r]=H,e.fore[t+this.slotWidth][r]=Lu().color.foregroundDisabled}getSlotsWidth(e){let t=0,r=e.getSlots();if(r)for(let e of r)e.length>t&&(t=e.length);return t}computeEquippedItemLabel(e,t,r,i){let n=e;if(r){let a=2+t-e.length;for(;a>0;)n+=" ",a--;n+=r.ch+" ",i>1&&(n+=i+" "),n+=r.getDescription(i)}return n}selectItem(e){return Yu.resetDrag(),this.resolve&&this.resolve(e),!0}}class Eg extends Vu{constructor(e,t={}){super(),this.numberSelector=e,this.frameOption=t}onInit(){super.onInit(),this.frame=this.addChild(new $u(this.frameOption));let e=this.frame.addChild(new tc({}));this.containerPanel=e.addChild(new _g(this.numberSelector)),this.equipmentSeparator=e.addChild(new Ku("Equipment")),this.slotsPanel=e.addChild(new Tg)}initForCreature(e,t,r,i){this.resolve=t,this.owner=e,this.setFrameTitle(e.getthename()+" "),this.containerPanel.initFromContainer(e,t,r,i),this.slotsPanel.initFromContainer(e,t,r),void 0===e.container.getSlots()?(this.slotsPanel.hide(),this.equipmentSeparator.hide()):(this.slotsPanel.show(),this.equipmentSeparator.show()),this.show()}onCancel(){this.resolve(void 0)}onUpdate(e){super.onUpdate(e),this.setFrameFooter(Math.floor(10*this.owner.container.computeTotalWeight())/10+"/"+this.owner.container.capacity)}setFrameTitle(e){this.frame.getOptions().title=e}getFrameTitle(){return this.frame.getOptions().title}setFrameFooter(e){this.frame.getOptions().footer=e}}class Ag extends Eg{currentCreature=0;constructor(e,t={}){super(e,t)}onInit(){super.onInit(),this.nextItemButton=this.addChild(new Zu({callback:this.nextCreature.bind(this),label:">"})),this.nextItemButton.setZOrder(this.getZOrder()+1),this.nextItemButton.setExpandFlag(I.NONE),this.prevItemButton=this.addChild(new Zu({callback:this.prevCreature.bind(this),label:"<"})),this.prevItemButton.setZOrder(this.getZOrder()+1),this.prevItemButton.setExpandFlag(I.NONE)}getCurrentContainer(){return this.creatures[this.currentCreature]}initForCreatures(e,t,r,i){this.creatures=Array.isArray(e)?e:[e],this.resolve=t,this.autoHideWidget=r,this.itemClassFilter=i,this.setCurrentCreature(0)}setCurrentCreature(e){if(this.currentCreature=e,super.initForCreature(this.creatures[e],this.resolve,this.autoHideWidget,this.itemClassFilter),this.creatures.length>1){let t=this.creatures[e].getthename()+" "+(e+1)+"/"+this.creatures.length+" ";this.setFrameTitle(t),this.nextItemButton.hide(),this.prevItemButton.hide(),this.computeBoundingBox(),this.nextItemButton.moveTo(Math.floor((this.boundingBox.w+t.length)/2)-1,0),this.prevItemButton.moveTo(Math.floor((this.boundingBox.w-t.length)/2),0),this.prevItemButton.show(),this.nextItemButton.show()}else this.nextItemButton.hide(),this.prevItemButton.hide()}nextCreature(e){return this.setCurrentCreature((this.currentCreature+1)%this.creatures.length),!0}prevCreature(e){return this.setCurrentCreature(0===this.currentCreature?this.creatures.length-1:this.currentCreature-1),!0}}class wg extends Vu{constructor(e){super(),this.numberSelector=e,this.setModal()}onInit(){super.onInit();let e=this.addChild(new ec({cancelAction:this.onCancel.bind(this)}));this.panel=e.addChild(new Eg(this.numberSelector,{leftButton:{label:"Close",autoHideWidget:this}})),this.hide()}pickItemFromInventory(e,t,r){return new Promise((i=>{this.panel.initForCreature(t,i,this,r),this.panel.setFrameTitle(e+" - ESC to close"),this.show()}))}onRender(e){this.center()}onCancel(){return Yu.resetDrag(),this.panel.onCancel(),!0}}class kg extends Vu{constructor(e){super(),this.numberSelector=e,this.setModal()}onInit(){super.onInit(),this.hide();let e=this.addChild(new ec({cancelAction:this.onCancel.bind(this)})).addChild(new rc({}));this.looterPanel=e.addChild(new Eg(this.numberSelector,{leftButton:{label:"Close",autoHideWidget:this}})),this.lootedPanel=e.addChild(new Ag(this.numberSelector,{rightButton:{label:"Take all",callback:this.takeAll.bind(this)}}))}hasLoot(e){for(const t of e)return t.container.computeTotalWeight()>0}lootContainer(e,t){if(!this.hasLoot(a.isArray(t)?t:[t]))return lc.warn("There's nothing to loot!"),void e.scheduler.pause();this.looter=e,this.looted=t,this.looterPanel.initForCreature(e,this.onSelectLooterItem.bind(this)),this.lootedPanel.initForCreatures(t,this.onSelectLootedItem.bind(this)),this.show()}onRender(e){this.center()}takeAll(e){let t=this.lootedPanel.getCurrentContainer();for(;t.container.size()>0;){let e=t.container.get(0);if(!e.pickable.pick(e,this.looter,!0))return!0}return!0}onSelectLooterItem(e){e.pickable.pick(e,this.lootedPanel.getCurrentContainer(),!0)}onSelectLootedItem(e){e.pickable.pick(e,this.looter,!0)}onCancel(){return Yu.resetDrag(),!0}}class Sg extends Vu{enableEvents=!0;tilePos=new C;tileIsValid=!1;constructor(){super(),this.hide(),this.setModal()}pickATile(e,t,r,i){return new Promise((n=>{this.resolve=n,this.origin=t,this.range=r,this.radius=i,this.tileIsValid=!0;let a=vg.specialActors[gg.PLAYER];this.tilePos.x=a.pos.x,this.tilePos.y=a.pos.y,this.show(),lc.warn(e)}))}onRender(e){e.contains(this.tilePos)&&(e.text[this.tilePos.x][this.tilePos.y]=this.tileIsValid?"+".charCodeAt(0):"x".charCodeAt(0),e.fore[this.tilePos.x][this.tilePos.y]=this.tileIsValid?65280:16720418);let t=!(!this.range||!this.origin),r=!!this.radius;if(t||r){let i=new C;for(i.x=0;i.x<Gc.current.w;++i.x)for(i.y=0;i.y<Gc.current.h;++i.y){let n=!this.origin||!t||C.distance(this.origin,i)<=(this.range||0),a=!(!this.tileIsValid||!r)&&C.distance(this.tilePos,i)<=(this.radius||0)?1.2:n?1:.8;1!==a&&(e.back[i.x][i.y]=M.multiply(e.back[i.x][i.y],a),e.fore[i.x][i.y]=M.multiply(e.fore[i.x][i.y],a))}}}onUpdate(e){this.handleMouseMove(),this.handleMouseClick(),this.checkKeyboardInput()}checkKeyboardInput(){if(kc()===Ac.CANCEL)return this.hide(),void Su();let e=kc();if(void 0!==e){let t=Sc(e);switch(-1===t.y&&this.tilePos.y>0?(this.tilePos.y--,Su()):1===t.y&&this.tilePos.y<Gc.current.h-1&&(this.tilePos.y++,Su()),-1===t.x&&this.tilePos.x>0?(this.tilePos.x--,Su()):1===t.x&&this.tilePos.x<Gc.current.w-1&&(this.tilePos.x++,Su()),e){case Ac.CANCEL:this.hide(),Su(),this.resolve(void 0);break;case Ac.VALIDATE:this.tileIsValid&&(this.hide(),Su(),this.resolve(this.tilePos))}}this.tileIsValid=this.checkTileValidity()}handleMouseClick(){ku(T.LEFT)?this.tileIsValid&&(this.hide(),this.resolve(this.tilePos)):ku(T.RIGHT)&&(this.hide(),this.resolve(void 0))}handleMouseMove(){if(xu.hasMoved){let e=wu();this.tilePos.x=e.x,this.tilePos.y=e.y,this.tileIsValid=this.checkTileValidity()}}checkTileValidity(){return!!Gc.current.isInFov(this.tilePos.x,this.tilePos.y)&&!(this.origin&&this.range&&C.distance(this.origin,this.tilePos)>this.range)}}class Mg extends Vu{constructor(){super(),this.setModal()}onInit(){super.onInit();let e=this.addChild(new ec({cancelAction:this.onCancel.bind(this)}));this.frame=e.addChild(new $u({}));let t=this.frame.addChild(new tc({}));this.label=t.addChild(new qu({label:"0"})),this.slider=t.addChild(new Ju({maxValue:0,minValue:0})),t.addChild(new Zu({autoHideWidget:this,callback:this.onPressOk.bind(this),label:"Ok",textAlign:Nu.CENTER})),this.hide()}onRender(e){this.center()}onUpdate(e){super.onUpdate(e),this.label.getOptions().label=Math.floor(this.slider.getValue()).toFixed(0)}selectNumber(e,t,r,i){return new Promise((n=>{this.resolve=n,this.frame.getOptions().title=e,this.slider.getOptions().minValue=t,this.slider.getOptions().maxValue=r,this.slider.setValue(void 0===i?t:i),this.show()}))}onPressOk(e){return this.resolve(Math.floor(this.slider.getValue())),!0}onCancel(){return!0}}class Cg extends Vu{constructor(){super(),this.showOnEventType(ld),this.hide();let e=this.addChild(new ec({})).addChild(new $u({})).addChild(new tc({}));e.addChild(new Zu({autoHideWidget:this,callback:e=>(lu.getRunningScene().logSceneGraph(),!0),label:"Resume game",textAlign:Nu.CENTER})),e.addChild(new Zu({autoHideWidget:this,eventType:ud,label:"New game",textAlign:Nu.CENTER})),ru.debug&&e.addChild(new Zu({autoHideWidget:this,eventType:hd,label:"debug",textAlign:Nu.CENTER}))}onRender(e){this.center()}onUpdate(e){}}class Pg extends Vu{constructor(){super(),this.showOnEventType(hd),this.hide();let e=this.addChild(new ec({})).addChild(new $u({})).addChild(new tc({}));e.addChild(this.mapRenderModeButton("dbg map transp",Uc.TRANSPARENCY)),e.addChild(this.mapRenderModeButton("dbg map light",Uc.LIGHTMAP)),e.addChild(this.mapRenderModeButton("dbg map fov",Uc.FOV)),e.addChild(this.mapRenderModeButton("dbg map all",Uc.ALL_SEEING_EYE)),e.addChild(this.mapRenderModeButton("dbg map normal",Uc.NORMAL)),e.addChild(new Zu({autoHideWidget:this,callback:e=>(lu.getRunningScene().logSceneGraph(),!0),label:"log scene graph"}))}onRender(e){this.center()}onUpdate(e){}mapRenderModeButton(e,t){return new Zu({autoHideWidget:this,callback:e=>(Gc.current.renderer.setRenderMode(t),!0),label:e})}}const Og=14762305,Dg=14762305,Ig=16777215,Rg=3769690,Ng=8642636,Lg=14483312,Fg=16752752,Bg=2719929,Ug=3709183,zg=11713730,Hg=12533683,jg=16760630,Vg=6826882,Gg=8642636,Kg=[{name:"worker ant",attack:8,defence:4,color:Dg,healthPoints:165,character:"a",experienceModifier:10},{name:"queen ant",attack:20,defence:14,color:Og,healthPoints:715,character:"a",experienceModifier:10},{name:"soldier ant",attack:20,defence:12,color:Ig,healthPoints:250,character:"a",experienceModifier:10},{name:"formicid",attack:15,defence:3,color:Rg,healthPoints:420,character:"a",experienceModifier:10},{name:"entropy weaver",attack:17,defence:7,color:Lg,healthPoints:715,character:"a",experienceModifier:10},{name:"bat",attack:1,defence:1,color:zg,healthPoints:35,character:"b",experienceModifier:4},{name:"fire bat",attack:6,defence:1,color:Og,healthPoints:225,character:"b",experienceModifier:8},{name:"bennu",attack:27,defence:6,color:jg,healthPoints:770,character:"b",experienceModifier:0},{name:"caustic shrike",attack:36,defence:8,color:Ng,healthPoints:1080,character:"b",experienceModifier:15},{name:"shard shrike",attack:21,defence:2,color:Ug,healthPoints:1050,character:"b",experienceModifier:12},{name:"centaur",attack:10,defence:3,color:Fg,healthPoints:220,character:"c",experienceModifier:10},{name:"centaur warrior",attack:16,defence:4,color:jg,healthPoints:550,character:"c",experienceModifier:12},{name:"yaktaur",attack:20,defence:4,color:Dg,healthPoints:440,character:"c",experienceModifier:9},{name:"yaktaur captain",attack:30,defence:5,color:Og,healthPoints:770,character:"c",experienceModifier:9},{name:"faun",attack:23,defence:2,color:Rg,healthPoints:500,character:"c",experienceModifier:8},{name:"satyr",attack:25,defence:2,color:Ng,healthPoints:660,character:"c",experienceModifier:10},{name:"black draconian",attack:20,defence:9,color:Bg,healthPoints:980,character:"d",experienceModifier:10},{name:"yellow draconian",attack:20,defence:9,color:jg,healthPoints:980,character:"d",experienceModifier:10},{name:"green draconian",attack:20,defence:9,color:Rg,healthPoints:980,character:"d",experienceModifier:10},{name:"purple draconian",attack:20,defence:8,color:Vg,healthPoints:980,character:"d",experienceModifier:10},{name:"red draconian",attack:20,defence:9,color:Og,healthPoints:980,character:"d",experienceModifier:10},{name:"white draconian",attack:20,defence:9,color:Ig,healthPoints:980,character:"d",experienceModifier:10},{name:"grey draconian",attack:25,defence:16,color:zg,healthPoints:980,character:"d",experienceModifier:10},{name:"draconian monk",attack:35,defence:-3,color:Bg,healthPoints:1200,character:"q",experienceModifier:10},{name:"draconian shifter",attack:15,defence:-1,color:Lg,healthPoints:960,character:"q",experienceModifier:10},{name:"draconian annihilator",attack:15,defence:-1,color:Ug,healthPoints:800,character:"q",experienceModifier:10},{name:"draconian knight",attack:27,defence:3,color:Gg,healthPoints:1120,character:"q",experienceModifier:10},{name:"draconian scorcher",attack:15,defence:-1,color:Og,healthPoints:800,character:"q",experienceModifier:10},{name:"elf",attack:10,defence:3,color:Og,healthPoints:360,character:"e",experienceModifier:10},{name:"deep elf high priest",attack:14,defence:3,color:Ng,healthPoints:495,character:"e",experienceModifier:15},{name:"wandering mushroom",attack:20,defence:5,color:Fg,healthPoints:440,character:"f",experienceModifier:10},{name:"deathcap",attack:33,defence:5,color:Hg,healthPoints:520,character:"f",experienceModifier:6},{name:"thorn hunter",attack:27,defence:9,color:Ig,healthPoints:975,character:"f",experienceModifier:14},{name:"shambling mangrove",attack:41,defence:13,color:Og,healthPoints:910,character:"f",experienceModifier:12},{name:"vine stalker",attack:10,defence:2,color:Rg,healthPoints:360,character:"f",experienceModifier:10},{name:"hobgoblin",attack:5,defence:2,color:Fg,healthPoints:55,character:"g",experienceModifier:10},{name:"gnoll",attack:9,defence:2,color:jg,healthPoints:130,character:"g",experienceModifier:10},{name:"gnoll shaman",attack:10,defence:2,color:Ig,healthPoints:195,character:"g",experienceModifier:10},{name:"gnoll sergeant",attack:11,defence:2,color:Gg,healthPoints:260,character:"g",experienceModifier:10},{name:"deep dwarf",attack:10,defence:2,color:Ug,healthPoints:275,character:"g",experienceModifier:10},{name:"jackal",attack:3,defence:2,color:Fg,healthPoints:55,character:"h",experienceModifier:10},{name:"hound",attack:6,defence:2,color:jg,healthPoints:165,character:"h",experienceModifier:10},{name:"howler monkey",attack:8,defence:1,color:Ng,healthPoints:185,character:"h",experienceModifier:15},{name:"warg",attack:18,defence:4,color:Ig,healthPoints:325,character:"h",experienceModifier:12},{name:"wolf",attack:12,defence:4,color:zg,healthPoints:220,character:"h",experienceModifier:12},{name:"hog",attack:14,defence:2,color:Hg,healthPoints:330,character:"h",experienceModifier:10},{name:"hell hound",attack:13,defence:6,color:Gg,healthPoints:275,character:"h",experienceModifier:10},{name:"doom hound",attack:45,defence:6,color:Rg,healthPoints:1100,character:"h",experienceModifier:10},{name:"raiju",attack:11,defence:4,color:Lg,healthPoints:385,character:"h",experienceModifier:12},{name:"hell hog",attack:20,defence:2,color:Og,healthPoints:595,character:"h",experienceModifier:10},{name:"polar bear",attack:20,defence:7,color:Ug,healthPoints:455,character:"h",experienceModifier:12},{name:"black bear",attack:15,defence:2,color:Bg,healthPoints:270,character:"h",experienceModifier:9},{name:"spriggan",attack:15,defence:1,color:zg,healthPoints:245,character:"i",experienceModifier:10},{name:"spriggan druid",attack:18,defence:1,color:Rg,healthPoints:440,character:"i",experienceModifier:10},{name:"spriggan berserker",attack:27,defence:2,color:Og,healthPoints:540,character:"i",experienceModifier:10},{name:"spriggan air mage",attack:16,defence:1,color:Lg,healthPoints:490,character:"i",experienceModifier:10},{name:"spriggan defender",attack:30,defence:3,color:jg,healthPoints:675,character:"i",experienceModifier:10},{name:"swamp drake",attack:20,defence:3,color:Fg,healthPoints:300,character:"k",experienceModifier:20},{name:"rime drake",attack:14,defence:3,color:Bg,healthPoints:330,character:"k",experienceModifier:22},{name:"wind drake",attack:14,defence:3,color:Ig,healthPoints:600,character:"k",experienceModifier:6},{name:"lindwurm",attack:20,defence:8,color:Og,healthPoints:495,character:"k",experienceModifier:13},{name:"death drake",attack:18,defence:6,color:zg,healthPoints:765,character:"k",experienceModifier:10},{name:"leopard gecko",attack:5,defence:1,color:jg,healthPoints:55,character:"l",experienceModifier:16},{name:"iguana",attack:15,defence:5,color:Bg,healthPoints:165,character:"l",experienceModifier:13},{name:"basilisk",attack:20,defence:3,color:Vg,healthPoints:360,character:"l",experienceModifier:10},{name:"wyvern",attack:20,defence:5,color:Ng,healthPoints:275,character:"l",experienceModifier:15},{name:"komodo dragon",attack:34,defence:7,color:Og,healthPoints:440,character:"l",experienceModifier:10},{name:"merfolk",attack:22,defence:4,color:Og,healthPoints:550,character:"m",experienceModifier:4},{name:"merfolk siren",attack:19,defence:4,color:Gg,healthPoints:405,character:"m",experienceModifier:10},{name:"water nymph",attack:12,defence:2,color:Vg,healthPoints:400,character:"m",experienceModifier:10},{name:"bog body",attack:25,defence:1,color:Rg,healthPoints:390,character:"n",experienceModifier:16},{name:"necrophage",attack:8,defence:2,color:zg,healthPoints:275,character:"n",experienceModifier:12},{name:"ghoul",attack:30,defence:4,color:Dg,healthPoints:1470,character:"n",experienceModifier:10},{name:"orc",attack:5,defence:0,color:Og,healthPoints:70,character:"o",experienceModifier:15},{name:"orc wizard",attack:5,defence:1,color:Vg,healthPoints:150,character:"o",experienceModifier:10},{name:"orc priest",attack:6,defence:1,color:Rg,healthPoints:150,character:"o",experienceModifier:10},{name:"orc knight",attack:25,defence:2,color:Gg,healthPoints:675,character:"o",experienceModifier:9},{name:"orc warlord",attack:32,defence:3,color:Lg,healthPoints:1125,character:"o",experienceModifier:11},{name:"orc sorcerer",attack:7,defence:5,color:Hg,healthPoints:315,character:"o",experienceModifier:12},{name:"orc high priest",attack:7,defence:1,color:Ng,healthPoints:550,character:"o",experienceModifier:10},{name:"slave",attack:10,defence:2,color:Ig,healthPoints:275,character:"p",experienceModifier:10},{name:"death knight",attack:28,defence:2,color:Rg,healthPoints:800,character:"p",experienceModifier:12},{name:"vault guard",attack:25,defence:1,color:Gg,healthPoints:715,character:"p",experienceModifier:10},{name:"vault sentinel",attack:15,defence:1,color:Ug,healthPoints:520,character:"p",experienceModifier:10},{name:"vault warden",attack:36,defence:1,color:Og,healthPoints:880,character:"p",experienceModifier:12},{name:"imperial myrmidon",attack:30,defence:1,color:Lg,healthPoints:750,character:"p",experienceModifier:12},{name:"servant of whispers",attack:10,defence:1,color:Bg,healthPoints:800,character:"p",experienceModifier:10},{name:"ironheart beastmaster",attack:30,defence:1,color:Fg,healthPoints:550,character:"p",experienceModifier:10},{name:"Killer Klown",attack:30,defence:10,color:Vg,healthPoints:1500,character:"p",experienceModifier:17},{name:"rat",attack:3,defence:1,color:Fg,healthPoints:25,character:"r",experienceModifier:1},{name:"quokka",attack:5,defence:2,color:Ig,healthPoints:55,character:"r",experienceModifier:10},{name:"river rat",attack:10,defence:5,color:Ng,healthPoints:110,character:"r",experienceModifier:13},{name:"hell rat",attack:20,defence:7,color:Og,healthPoints:165,character:"r",experienceModifier:10},{name:"porcupine",attack:16,defence:2,color:Bg,healthPoints:160,character:"r",experienceModifier:26},{name:"giant cockroach",attack:2,defence:3,color:Fg,healthPoints:50,character:"s",experienceModifier:10},{name:"scorpion",attack:10,defence:5,color:jg,healthPoints:180,character:"s",experienceModifier:13},{name:"emperor scorpion",attack:30,defence:20,color:zg,healthPoints:1190,character:"s",experienceModifier:13},{name:"death scarab",attack:33,defence:7,color:Bg,healthPoints:320,character:"s",experienceModifier:12},{name:"tarantella",attack:19,defence:3,color:Hg,healthPoints:280,character:"s",experienceModifier:6},{name:"jumping spider",attack:20,defence:6,color:Ug,healthPoints:320,character:"s",experienceModifier:8},{name:"wolf spider",attack:25,defence:3,color:Ig,healthPoints:550,character:"s",experienceModifier:4},{name:"redback",attack:18,defence:2,color:Og,healthPoints:270,character:"s",experienceModifier:5},{name:"demonic crawler",attack:16,defence:10,color:Ng,healthPoints:585,character:"s",experienceModifier:4},{name:"orb spider",attack:5,defence:3,color:Vg,healthPoints:420,character:"s",experienceModifier:20},{name:"crocodile",attack:20,defence:4,color:Fg,healthPoints:275,character:"t",experienceModifier:16},{name:"alligator",attack:30,defence:5,color:Ug,healthPoints:720,character:"t",experienceModifier:10},{name:"snapping turtle",attack:30,defence:16,color:Rg,healthPoints:600,character:"t",experienceModifier:10},{name:"alligator snapping turtle",attack:50,defence:19,color:Ng,healthPoints:1440,character:"t",experienceModifier:10},{name:"fire crab",attack:15,defence:9,color:Og,healthPoints:520,character:"t",experienceModifier:25},{name:"ghost crab",attack:20,defence:9,color:zg,healthPoints:585,character:"t",experienceModifier:25},{name:"apocalypse crab",attack:15,defence:11,color:Ig,healthPoints:520,character:"t",experienceModifier:13},{name:"ugly thing",attack:17,defence:4,color:Vg,healthPoints:660,character:"u",experienceModifier:6},{name:"very ugly thing",attack:27,defence:6,color:Vg,healthPoints:990,character:"u",experienceModifier:10},{name:"will-o-wisp",attack:12,defence:4,color:zg,healthPoints:180,character:"v",experienceModifier:8},{name:"worm",attack:12,defence:1,color:Og,healthPoints:180,character:"w",experienceModifier:3},{name:"swamp worm",attack:26,defence:3,color:Fg,healthPoints:350,character:"w",experienceModifier:3},{name:"tyrant leech",attack:35,defence:5,color:Dg,healthPoints:600,character:"w",experienceModifier:8},{name:"dart slug",attack:3,defence:1,color:Gg,healthPoints:100,character:"w",experienceModifier:40},{name:"torpor snail",attack:25,defence:8,color:Rg,healthPoints:600,character:"w",experienceModifier:20},{name:"elephant slug",attack:40,defence:2,color:Ig,healthPoints:1300,character:"w",experienceModifier:2},{name:"unseen horror",attack:12,defence:5,color:Vg,healthPoints:385,character:"x",experienceModifier:12},{name:"ancient zyme",attack:16,defence:6,color:Rg,healthPoints:520,character:"x",experienceModifier:8},{name:"worldbinder",attack:8,defence:12,color:Gg,healthPoints:400,character:"x",experienceModifier:13},{name:"killer bee",attack:10,defence:2,color:Fg,healthPoints:165,character:"y",experienceModifier:11},{name:"queen bee",attack:20,defence:10,color:Hg,healthPoints:385,character:"y",experienceModifier:14},{name:"vampire mosquito",attack:13,defence:2,color:zg,healthPoints:275,character:"y",experienceModifier:10},{name:"hornet",attack:18,defence:6,color:jg,healthPoints:330,character:"y",experienceModifier:13},{name:"meliai",attack:14,defence:2,color:Rg,healthPoints:245,character:"y",experienceModifier:6},{name:"spark wasp",attack:33,defence:9,color:Lg,healthPoints:660,character:"y",experienceModifier:12},{name:"ghost moth",attack:18,defence:8,color:Vg,healthPoints:715,character:"y",experienceModifier:18},{name:"wight",attack:8,defence:4,color:Rg,healthPoints:165,character:"z",experienceModifier:16},{name:"skeletal warrior",attack:25,defence:15,color:Gg,healthPoints:650,character:"z",experienceModifier:10},{name:"ancient champion",attack:50,defence:15,color:Lg,healthPoints:700,character:"z",experienceModifier:24},{name:"flying skull",attack:14,defence:10,color:Ig,healthPoints:210,character:"z",experienceModifier:10},{name:"angel",attack:25,defence:10,color:Ig,healthPoints:1020,character:"A",experienceModifier:10},{name:"cherub",attack:15,defence:10,color:Ug,healthPoints:765,character:"A",experienceModifier:10},{name:"seraph",attack:50,defence:10,color:Hg,healthPoints:2125,character:"A",experienceModifier:10},{name:"daeva",attack:25,defence:10,color:jg,healthPoints:1190,character:"A",experienceModifier:12},{name:"profane servitor",attack:25,defence:10,color:Dg,healthPoints:1530,character:"A",experienceModifier:10},{name:"cyclops",attack:35,defence:5,color:jg,healthPoints:495,character:"C",experienceModifier:17},{name:"ettin",attack:45,defence:9,color:Fg,healthPoints:660,character:"C",experienceModifier:12},{name:"fire giant",attack:30,defence:8,color:Dg,healthPoints:960,character:"C",experienceModifier:13},{name:"frost giant",attack:35,defence:9,color:Ug,healthPoints:1040,character:"C",experienceModifier:11},{name:"stone giant",attack:45,defence:12,color:zg,healthPoints:880,character:"C",experienceModifier:10},{name:"titan",attack:55,defence:10,color:Vg,healthPoints:1100,character:"C",experienceModifier:12},{name:"juggernaut",attack:80,defence:20,color:Ng,healthPoints:2500,character:"C",experienceModifier:12},{name:"iron giant",attack:65,defence:18,color:Gg,healthPoints:1800,character:"C",experienceModifier:10},{name:"fire dragon",attack:20,defence:10,color:Og,healthPoints:900,character:"D",experienceModifier:12},{name:"ice dragon",attack:17,defence:10,color:Ig,healthPoints:900,character:"D",experienceModifier:10},{name:"steam dragon",attack:12,defence:5,color:Bg,healthPoints:300,character:"D",experienceModifier:29},{name:"swamp dragon",attack:20,defence:7,color:Fg,healthPoints:675,character:"D",experienceModifier:11},{name:"acid dragon",attack:15,defence:5,color:Rg,healthPoints:275,character:"D",experienceModifier:16},{name:"quicksilver dragon",attack:25,defence:10,color:Lg,healthPoints:880,character:"D",experienceModifier:14},{name:"iron dragon",attack:40,defence:20,color:Gg,healthPoints:1170,character:"D",experienceModifier:14},{name:"storm dragon",attack:25,defence:13,color:Ug,healthPoints:1050,character:"D",experienceModifier:13},{name:"golden dragon",attack:40,defence:15,color:jg,healthPoints:1530,character:"D",experienceModifier:26},{name:"shadow dragon",attack:25,defence:15,color:Vg,healthPoints:1275,character:"D",experienceModifier:12},{name:"bone dragon",attack:30,defence:20,color:zg,healthPoints:1800,character:"D",experienceModifier:12},{name:"pearl dragon",attack:35,defence:10,color:jg,healthPoints:1170,character:"D",experienceModifier:16},{name:"earth elemental",attack:40,defence:14,color:Fg,healthPoints:450,character:"E",experienceModifier:13},{name:"water elemental",attack:22,defence:4,color:Bg,healthPoints:420,character:"E",experienceModifier:12},{name:"air elemental",attack:15,defence:2,color:Ig,healthPoints:330,character:"E",experienceModifier:6},{name:"iron elemental",attack:40,defence:20,color:Ig,healthPoints:1080,character:"E",experienceModifier:13},{name:"cane toad",attack:26,defence:6,color:jg,healthPoints:385,character:"F",experienceModifier:16},{name:"goliath frog",attack:30,defence:15,color:zg,healthPoints:600,character:"F",experienceModifier:10},{name:"hippogriff",attack:12,defence:2,color:Fg,healthPoints:435,character:"H",experienceModifier:8},{name:"manticore",attack:26,defence:5,color:Dg,healthPoints:495,character:"H",experienceModifier:10},{name:"minotaur",attack:35,defence:6,color:Og,healthPoints:780,character:"H",experienceModifier:10},{name:"sphinx",attack:25,defence:5,color:zg,healthPoints:880,character:"H",experienceModifier:12},{name:"harpy",attack:19,defence:2,color:Rg,healthPoints:385,character:"H",experienceModifier:9},{name:"mutant beast",attack:27,defence:8,color:Vg,healthPoints:825,character:"H",experienceModifier:11},{name:"ancestor",attack:27,defence:5,color:Lg,healthPoints:1,character:"R",experienceModifier:1},{name:"knight",attack:27,defence:5,color:Lg,healthPoints:1,character:"R",experienceModifier:1},{name:"battlemage",attack:27,defence:5,color:Lg,healthPoints:1,character:"R",experienceModifier:1},{name:"hexer",attack:27,defence:5,color:Lg,healthPoints:1,character:"R",experienceModifier:1},{name:"ooze",attack:5,defence:1,color:zg,healthPoints:120,character:"J",experienceModifier:3},{name:"slime creature",attack:22,defence:1,color:Rg,healthPoints:605,character:"J",experienceModifier:3},{name:"kobold",attack:4,defence:2,color:Fg,healthPoints:35,character:"K",experienceModifier:10},{name:"big kobold",attack:7,defence:3,color:jg,healthPoints:275,character:"K",experienceModifier:7},{name:"kobold demonologist",attack:4,defence:2,color:Vg,healthPoints:390,character:"K",experienceModifier:18},{name:"lich",attack:20,defence:10,color:zg,healthPoints:800,character:"L",experienceModifier:18},{name:"ancient lich",attack:25,defence:20,color:Ig,healthPoints:1080,character:"L",experienceModifier:24},{name:"revenant",attack:26,defence:8,color:Gg,healthPoints:810,character:"L",experienceModifier:18},{name:"halazid warlock",attack:20,defence:8,color:Rg,healthPoints:750,character:"L",experienceModifier:10},{name:"mummy",attack:20,defence:3,color:zg,healthPoints:195,character:"M",experienceModifier:21},{name:"guardian mummy",attack:30,defence:6,color:jg,healthPoints:455,character:"M",experienceModifier:13},{name:"greater mummy",attack:35,defence:10,color:Ig,healthPoints:1950,character:"M",experienceModifier:24},{name:"mummy priest",attack:30,defence:8,color:Dg,healthPoints:650,character:"M",experienceModifier:20},{name:"naga",attack:17,defence:6,color:Rg,healthPoints:275,character:"N",experienceModifier:13},{name:"naga mage",attack:17,defence:6,color:Vg,healthPoints:385,character:"N",experienceModifier:14},{name:"naga sharpshooter",attack:17,defence:6,color:zg,healthPoints:720,character:"N",experienceModifier:14},{name:"naga ritualist",attack:14,defence:6,color:Fg,healthPoints:600,character:"N",experienceModifier:14},{name:"naga warrior",attack:28,defence:6,color:Bg,healthPoints:1e3,character:"N",experienceModifier:11},{name:"nagaraja",attack:27,defence:6,color:Hg,healthPoints:825,character:"N",experienceModifier:15},{name:"ogre",attack:17,defence:1,color:Fg,healthPoints:275,character:"O",experienceModifier:9},{name:"two-headed ogre",attack:20,defence:3,color:Og,healthPoints:550,character:"O",experienceModifier:15},{name:"ogre mage",attack:12,defence:1,color:Vg,healthPoints:550,character:"O",experienceModifier:16},{name:"tengu",attack:10,defence:2,color:Ug,healthPoints:225,character:"Q",experienceModifier:10},{name:"tengu conjurer",attack:10,defence:2,color:Bg,healthPoints:315,character:"Q",experienceModifier:13},{name:"tengu warrior",attack:16,defence:2,color:Gg,healthPoints:600,character:"Q",experienceModifier:13},{name:"tengu reaver",attack:27,defence:2,color:Hg,healthPoints:850,character:"Q",experienceModifier:13},{name:"efreet",attack:17,defence:10,color:Dg,healthPoints:385,character:"R",experienceModifier:12},{name:"rakshasa",attack:20,defence:6,color:jg,healthPoints:660,character:"R",experienceModifier:15},{name:"dryad",attack:10,defence:6,color:Ng,healthPoints:520,character:"R",experienceModifier:10},{name:"adder",attack:5,defence:1,color:Ng,healthPoints:110,character:"S",experienceModifier:10},{name:"water moccasin",attack:10,defence:2,color:Fg,healthPoints:275,character:"S",experienceModifier:11},{name:"black mamba",attack:20,defence:4,color:Bg,healthPoints:385,character:"S",experienceModifier:12},{name:"sea snake",attack:26,defence:2,color:Lg,healthPoints:650,character:"S",experienceModifier:10},{name:"anaconda",attack:6,defence:4,color:zg,healthPoints:605,character:"S",experienceModifier:10},{name:"guardian serpent",attack:26,defence:6,color:Ig,healthPoints:440,character:"S",experienceModifier:10},{name:"shock serpent",attack:20,defence:2,color:Ug,healthPoints:550,character:"S",experienceModifier:12},{name:"mana viper",attack:23,defence:3,color:Vg,healthPoints:495,character:"S",experienceModifier:10},{name:"troll",attack:20,defence:3,color:Fg,healthPoints:385,character:"T",experienceModifier:10},{name:"iron troll",attack:40,defence:20,color:Gg,healthPoints:880,character:"T",experienceModifier:10},{name:"deep troll",attack:30,defence:10,color:jg,healthPoints:700,character:"T",experienceModifier:9},{name:"deep troll earth mage",attack:27,defence:12,color:Vg,healthPoints:480,character:"T",experienceModifier:10},{name:"deep troll shaman",attack:27,defence:8,color:Ig,healthPoints:480,character:"T",experienceModifier:12},{name:"vampire",attack:15,defence:10,color:Dg,healthPoints:330,character:"V",experienceModifier:11},{name:"vampire knight",attack:33,defence:10,color:Gg,healthPoints:715,character:"V",experienceModifier:16},{name:"vampire mage",attack:15,defence:10,color:Vg,healthPoints:550,character:"V",experienceModifier:15},{name:"jiangshi",attack:27,defence:10,color:jg,healthPoints:650,character:"V",experienceModifier:10},{name:"phantom",attack:10,defence:3,color:Bg,healthPoints:385,character:"W",experienceModifier:5},{name:"shadow",attack:14,defence:7,color:Vg,healthPoints:240,character:"W",experienceModifier:18},{name:"silent spectre",attack:15,defence:5,color:Gg,healthPoints:440,character:"W",experienceModifier:10},{name:"wraith",attack:15,defence:10,color:zg,healthPoints:330,character:"W",experienceModifier:14},{name:"shadow wraith",attack:35,defence:7,color:Hg,healthPoints:550,character:"W",experienceModifier:15},{name:"freezing wraith",attack:16,defence:12,color:Ug,healthPoints:440,character:"W",experienceModifier:10},{name:"eidolon",attack:35,defence:12,color:Fg,healthPoints:715,character:"W",experienceModifier:14},{name:"phantasmal warrior",attack:39,defence:12,color:Ng,healthPoints:495,character:"W",experienceModifier:13},{name:"thrashing horror",attack:17,defence:5,color:jg,healthPoints:495,character:"X",experienceModifier:10},{name:"tentacled monstrosity",attack:22,defence:5,color:Rg,healthPoints:1265,character:"X",experienceModifier:10},{name:"Orb Guardian",attack:45,defence:13,color:Vg,healthPoints:825,character:"X",experienceModifier:20},{name:"tentacled starspawn",attack:40,defence:5,color:Lg,healthPoints:880,character:"X",experienceModifier:20},{name:"starspawn tentacle",attack:3,defence:8,color:Lg,healthPoints:220,character:"w",experienceModifier:10},{name:"starcursed mass",attack:16,defence:10,color:Bg,healthPoints:1500,character:"X",experienceModifier:12},{name:"dream sheep",attack:13,defence:2,color:Gg,healthPoints:220,character:"Y",experienceModifier:10},{name:"yak",attack:18,defence:4,color:Fg,healthPoints:385,character:"Y",experienceModifier:9},{name:"death yak",attack:30,defence:9,color:jg,healthPoints:770,character:"Y",experienceModifier:8},{name:"catoblepas",attack:36,defence:10,color:Vg,healthPoints:770,character:"Y",experienceModifier:8},{name:"elephant",attack:20,defence:8,color:Rg,healthPoints:675,character:"Y",experienceModifier:9},{name:"dire elephant",attack:40,defence:13,color:Bg,healthPoints:1125,character:"Y",experienceModifier:8},{name:"hellephant",attack:45,defence:13,color:Og,healthPoints:1700,character:"Y",experienceModifier:10},{name:"apis",attack:40,defence:9,color:Ig,healthPoints:1200,character:"Y",experienceModifier:8},{name:"ice beast",attack:5,defence:5,color:Ug,healthPoints:275,character:"Y",experienceModifier:13},{name:"sky beast",attack:5,defence:3,color:Lg,healthPoints:275,character:"Y",experienceModifier:13},{name:"simulacrum",attack:6,defence:10,color:Ug,healthPoints:110,character:"Z",experienceModifier:9},{name:"small simulacrum",attack:6,defence:10,color:Ug,healthPoints:110,character:"Z",experienceModifier:9},{name:"large zombie",attack:23,defence:8,color:jg,healthPoints:330,character:"Z",experienceModifier:9},{name:"large simulacrum",attack:14,defence:10,color:Lg,healthPoints:275,character:"Z",experienceModifier:9},{name:"spectral thing",attack:20,defence:8,color:Rg,healthPoints:440,character:"Z",experienceModifier:11},{name:"kraken",attack:50,defence:20,color:Hg,healthPoints:2080,character:"X",experienceModifier:6},{name:"tentacle",attack:29,defence:5,color:Hg,healthPoints:480,character:"w",experienceModifier:10},{name:"octopode",attack:24,defence:1,color:Lg,healthPoints:560,character:"x",experienceModifier:10},{name:"lava snake",attack:7,defence:2,color:Og,healthPoints:165,character:"S",experienceModifier:17},{name:"salamander",attack:17,defence:5,color:Og,healthPoints:640,character:"N",experienceModifier:10},{name:"salamander mystic",attack:10,defence:5,color:jg,healthPoints:650,character:"N",experienceModifier:10},{name:"player illusion",attack:5,defence:1,color:Ig,healthPoints:140,character:"@",experienceModifier:15},{name:"dancing weapon",attack:30,defence:10,color:Vg,healthPoints:150,character:"(",experienceModifier:10},{name:"spectral weapon",attack:6,defence:5,color:Rg,healthPoints:150,character:"(",experienceModifier:11},{name:"eldritch tentacle",attack:30,defence:13,color:Vg,healthPoints:1200,character:"w",experienceModifier:10},{name:"demonspawn",attack:10,defence:3,color:Fg,healthPoints:330,character:"6",experienceModifier:10},{name:"monstrous demonspawn",attack:20,defence:3,color:zg,healthPoints:1e3,character:"6",experienceModifier:10},{name:"gelid demonspawn",attack:20,defence:6,color:Bg,healthPoints:550,character:"6",experienceModifier:10},{name:"infernal demonspawn",attack:20,defence:6,color:Dg,healthPoints:550,character:"6",experienceModifier:10},{name:"torturous demonspawn",attack:20,defence:3,color:Vg,healthPoints:550,character:"6",experienceModifier:10},{name:"crimson imp",attack:4,defence:3,color:Dg,healthPoints:135,character:"5",experienceModifier:13},{name:"quasit",attack:3,defence:5,color:zg,healthPoints:150,character:"5",experienceModifier:13},{name:"white imp",attack:4,defence:4,color:Ig,healthPoints:110,character:"5",experienceModifier:10},{name:"ufetubus",attack:5,defence:2,color:Lg,healthPoints:70,character:"5",experienceModifier:28},{name:"iron imp",attack:12,defence:6,color:Gg,healthPoints:165,character:"5",experienceModifier:14},{name:"shadow imp",attack:6,defence:3,color:Vg,healthPoints:110,character:"5",experienceModifier:11},{name:"rust devil",attack:12,defence:10,color:Fg,healthPoints:440,character:"4",experienceModifier:15},{name:"orange demon",attack:15,defence:3,color:Og,healthPoints:520,character:"4",experienceModifier:12},{name:"red devil",attack:19,defence:7,color:Dg,healthPoints:315,character:"4",experienceModifier:13},{name:"hellwing",attack:10,defence:16,color:zg,healthPoints:455,character:"4",experienceModifier:12},{name:"ice devil",attack:16,defence:12,color:Ig,healthPoints:440,character:"4",experienceModifier:11},{name:"chaos spawn",attack:19,defence:7,color:Vg,healthPoints:330,character:"4",experienceModifier:12},{name:"sun demon",attack:30,defence:10,color:jg,healthPoints:550,character:"3",experienceModifier:14},{name:"soul eater",attack:25,defence:18,color:Vg,healthPoints:605,character:"3",experienceModifier:13},{name:"smoke demon",attack:8,defence:5,color:zg,healthPoints:385,character:"3",experienceModifier:15},{name:"neqoxec",attack:15,defence:4,color:Hg,healthPoints:330,character:"3",experienceModifier:12},{name:"ynoxinul",attack:12,defence:3,color:Lg,healthPoints:330,character:"3",experienceModifier:13},{name:"sixfirhy",attack:15,defence:2,color:Ug,healthPoints:385,character:"3",experienceModifier:6},{name:"shadow demon",attack:21,defence:7,color:Vg,healthPoints:550,character:"2",experienceModifier:13},{name:"green death",attack:32,defence:5,color:Rg,healthPoints:715,character:"2",experienceModifier:14},{name:"blizzard demon",attack:25,defence:10,color:Ug,healthPoints:660,character:"2",experienceModifier:16},{name:"balrug",attack:60,defence:5,color:Dg,healthPoints:770,character:"2",experienceModifier:12},{name:"cacodemon",attack:30,defence:11,color:jg,healthPoints:975,character:"2",experienceModifier:16},{name:"hell beast",attack:28,defence:5,color:Fg,healthPoints:840,character:"2",experienceModifier:17},{name:"hellion",attack:10,defence:5,color:Og,healthPoints:385,character:"2",experienceModifier:12},{name:"reaper",attack:45,defence:15,color:zg,healthPoints:770,character:"2",experienceModifier:14},{name:"lorocyproca",attack:40,defence:10,color:Bg,healthPoints:770,character:"2",experienceModifier:14},{name:"tormentor",attack:8,defence:12,color:Hg,healthPoints:385,character:"2",experienceModifier:10},{name:"Ice Fiend",attack:25,defence:15,color:Ig,healthPoints:990,character:"1",experienceModifier:17},{name:"Shadow Fiend",attack:25,defence:12,color:Vg,healthPoints:1050,character:"1",experienceModifier:13},{name:"Hell Sentinel",attack:40,defence:25,color:Fg,healthPoints:1425,character:"1",experienceModifier:10},{name:"Executioner",attack:30,defence:10,color:zg,healthPoints:660,character:"1",experienceModifier:18},{name:"Orb Demon",attack:20,defence:10,color:Ug,healthPoints:1500,character:"1",experienceModifier:15},{name:"saltling",attack:20,defence:15,color:Ig,healthPoints:270,character:"8",experienceModifier:10},{name:"peacekeeper",attack:25,defence:20,color:jg,healthPoints:450,character:"8",experienceModifier:10},{name:"iron golem",attack:35,defence:15,color:Gg,healthPoints:1350,character:"8",experienceModifier:10},{name:"crystal guardian",attack:35,defence:22,color:Rg,healthPoints:640,character:"8",experienceModifier:10},{name:"toenail golem",attack:20,defence:8,color:Dg,healthPoints:585,character:"8",experienceModifier:10},{name:"electric golem",attack:15,defence:5,color:Lg,healthPoints:1350,character:"8",experienceModifier:12},{name:"ushabti",attack:30,defence:9,color:Fg,healthPoints:455,character:"8",experienceModifier:10},{name:"gargoyle",attack:20,defence:18,color:zg,healthPoints:270,character:"9",experienceModifier:26},{name:"war gargoyle",attack:30,defence:22,color:Gg,healthPoints:520,character:"9",experienceModifier:18},{name:"molten gargoyle",attack:20,defence:14,color:Dg,healthPoints:315,character:"9",experienceModifier:18},{name:"pandemonium lord",attack:5,defence:1,color:Vg,healthPoints:1710,character:"&",experienceModifier:14},{name:"death cob",attack:35,defence:10,color:jg,healthPoints:910,character:"z",experienceModifier:10},{name:"Mennas",attack:30,defence:15,color:Lg,healthPoints:1520,character:"A",experienceModifier:18},{name:"Nessos",attack:16,defence:4,color:Vg,healthPoints:720,character:"c",experienceModifier:18},{name:"Chuck",attack:45,defence:14,color:Ig,healthPoints:1170,character:"C",experienceModifier:10},{name:"Polyphemus",attack:45,defence:10,color:Rg,healthPoints:1520,character:"C",experienceModifier:10},{name:"Antaeus",attack:75,defence:28,color:Lg,healthPoints:6820,character:"C",experienceModifier:10},{name:"Tiamat",attack:60,defence:30,color:Vg,healthPoints:3850,character:"d",experienceModifier:10},{name:"Bai Suzhen",attack:24,defence:14,color:Ug,healthPoints:1850,character:"d",experienceModifier:16},{name:"Xtahua",attack:40,defence:15,color:Dg,healthPoints:2200,character:"D",experienceModifier:18},{name:"the Serpent of Hell",attack:35,defence:16,color:Dg,healthPoints:2805,character:"D",experienceModifier:21},{name:"the Serpent of Hell",attack:35,defence:20,color:Bg,healthPoints:2805,character:"D",experienceModifier:21},{name:"the Serpent of Hell",attack:35,defence:30,color:Dg,healthPoints:3230,character:"D",experienceModifier:16},{name:"the Serpent of Hell",attack:35,defence:16,color:Dg,healthPoints:3230,character:"D",experienceModifier:18},{name:"Bai Suzhen",attack:30,defence:22,color:jg,healthPoints:1850,character:"D",experienceModifier:18},{name:"Duvessa",attack:10,defence:2,color:Bg,healthPoints:360,character:"e",experienceModifier:15},{name:"Ijyb",attack:4,defence:2,color:Bg,healthPoints:240,character:"g",experienceModifier:8},{name:"Robin",attack:5,defence:1,color:Lg,healthPoints:160,character:"g",experienceModifier:10},{name:"Grum",attack:20,defence:2,color:Og,healthPoints:400,character:"g",experienceModifier:19},{name:"Crazy Yiuf",attack:9,defence:2,color:Vg,healthPoints:195,character:"g",experienceModifier:10},{name:"Jorgrun",attack:20,defence:2,color:Hg,healthPoints:1200,character:"g",experienceModifier:18},{name:"Natasha",attack:10,defence:2,color:Vg,healthPoints:150,character:"h",experienceModifier:10},{name:"Arachne",attack:30,defence:3,color:Lg,healthPoints:2040,character:"H",experienceModifier:10},{name:"Asterion",attack:35,defence:4,color:Ug,healthPoints:1275,character:"H",experienceModifier:15},{name:"the Enchantress",attack:26,defence:1,color:Hg,healthPoints:975,character:"i",experienceModifier:35},{name:"Sonja",attack:9,defence:2,color:Dg,healthPoints:300,character:"K",experienceModifier:40},{name:"Menkaure",attack:25,defence:3,color:Vg,healthPoints:240,character:"M",experienceModifier:48},{name:"Khufu",attack:35,defence:10,color:Og,healthPoints:2430,character:"M",experienceModifier:20},{name:"Ilsuiw",attack:10,defence:5,color:Ng,healthPoints:1520,character:"m",experienceModifier:10},{name:"Vashnia",attack:25,defence:6,color:Lg,healthPoints:1600,character:"N",experienceModifier:27},{name:"Erolcha",attack:20,defence:3,color:Ug,healthPoints:540,character:"O",experienceModifier:50},{name:"Urug",attack:30,defence:2,color:Dg,healthPoints:700,character:"o",experienceModifier:14},{name:"Nergalle",attack:6,defence:9,color:Ig,healthPoints:600,character:"o",experienceModifier:12},{name:"Saint Roka",attack:35,defence:3,color:Ug,healthPoints:1980,character:"o",experienceModifier:15},{name:"Sojobo",attack:28,defence:2,color:Ng,healthPoints:1500,character:"Q",experienceModifier:20},{name:"Azrael",attack:17,defence:10,color:Og,healthPoints:880,character:"R",experienceModifier:12},{name:"Mara",attack:30,defence:10,color:Hg,healthPoints:1440,character:"R",experienceModifier:35},{name:"Aizul",attack:25,defence:8,color:Hg,healthPoints:1400,character:"S",experienceModifier:10},{name:"Purgy",attack:9,defence:1,color:Rg,healthPoints:350,character:"T",experienceModifier:10},{name:"moon troll",attack:40,defence:20,color:Lg,healthPoints:1800,character:"T",experienceModifier:10},{name:"Jory",attack:40,defence:10,color:Og,healthPoints:1800,character:"V",experienceModifier:13},{name:"Gastronok",attack:40,defence:2,color:Vg,healthPoints:1500,character:"w",experienceModifier:16},{name:"Nellie",attack:45,defence:13,color:Hg,healthPoints:2400,character:"Y",experienceModifier:8},{name:"Murray",attack:20,defence:30,color:Og,healthPoints:1610,character:"z",experienceModifier:15},{name:"Ignacio",attack:20,defence:10,color:Hg,healthPoints:2520,character:"1",experienceModifier:14},{name:"Grinder",attack:11,defence:3,color:Bg,healthPoints:390,character:"5",experienceModifier:11},{name:"Donald",attack:26,defence:3,color:Bg,healthPoints:840,character:"@",experienceModifier:20},{name:"Margery",attack:30,defence:4,color:Og,healthPoints:1650,character:"@",experienceModifier:15},{name:"Maurice",attack:10,defence:1,color:Rg,healthPoints:600,character:"@",experienceModifier:24},{name:"Nikola",attack:20,defence:1,color:Lg,healthPoints:1890,character:"@",experienceModifier:13},{name:"Mnoleg",attack:40,defence:10,color:Ng,healthPoints:3485,character:"&",experienceModifier:15},{name:"Lom Lobon",attack:40,defence:10,color:Ug,healthPoints:3895,character:"&",experienceModifier:15},{name:"Cerebov",attack:60,defence:30,color:Dg,healthPoints:6510,character:"&",experienceModifier:15},{name:"Gloorx Vloq",attack:45,defence:10,color:zg,healthPoints:3520,character:"&",experienceModifier:15},{name:"Geryon",attack:35,defence:15,color:Rg,healthPoints:3e3,character:"&",experienceModifier:15},{name:"Dispater",attack:50,defence:40,color:Vg,healthPoints:4480,character:"&",experienceModifier:15},{name:"Asmodeus",attack:50,defence:30,color:Og,healthPoints:4505,character:"&",experienceModifier:25},{name:"Ereshkigal",attack:40,defence:10,color:Ig,healthPoints:3510,character:"&",experienceModifier:15}];function Wg(e){const{name:t,attack:r,character:i,color:n,defence:a,healthPoints:o}=e;var s;o<=1||mg.registerActorDef({name:t+"[s]",ai:{type:om.MONSTER,walkTime:dc},attacker:{attackTime:dc,hitPoints:r},ch:i,color:n,destructible:{defence:a,healthPoints:Math.floor(o/5),loot:{classProb:[{clazz:wd,prob:1},{clazz:void 0,prob:3}]},xp:(s=e,Math.ceil(Math.sqrt(s.healthPoints*(s.attack+s.defence)/8)))},prototypes:[yd]})}bh.registerClass(pm),bh.registerClass(mm),bh.registerClass(ym),bh.registerClass(vm),bh.registerClass(gm),bh.registerClass(bm),bh.registerClass(Mm),bh.registerClass(vg),bh.registerClass(bg),bh.registerClass(xg),bh.registerClass(Ic),bh.registerClass(Dc),bh.registerClass(Oc),bh.registerClass(wm),bh.registerClass(Oc),bh.registerClass(km),bh.registerClass(Em),bh.registerClass(Sm),bh.registerClass(Am),bh.registerClass(Gm),bh.registerClass(Km),bh.registerClass(Jm),bh.registerClass(Wm),bh.registerClass(Ym),bh.registerClass(Xm),bh.registerClass(qm),bh.registerClass(Zm),bh.registerClass($m),bh.registerClass(eg),bh.registerClass(Qm),bh.registerClass(hg),bh.registerClass(fg),bh.registerClass(ug),bh.registerClass(dg),bh.registerClass(cg),bh.registerClass(pg),bh.registerClass(ag),bh.registerClass(og),bh.registerClass(sg),bh.registerClass(ng);const Yg="basic hostile",Xg="guard";mg.registerBehaviorTree(new Fh(Yg,new Xh([new Yh([new ag(tg,0,!1),new og(10),new Qh(new sg)]),new ng(!1)]))),mg.registerBehaviorTree(new Fh(Xg,new Yh([new class extends tu{constructor(e,t,r,i){super(e,Ph.GLOBAL,t,r,i)}internalTick(e){let t,r=e.userData;if(t=this.contextKey===td?vg.fromId(r.ai.targetId):e.context.get(this.contextKey),!t)return Mh.FAILURE;let i=C.distance(t.pos,r.pos),n=e.context.get(lg,e.tree.id,this.id);return n===Mh.RUNNING||this.valueMatches(i,this.value,this.operator)?(n=this.children[0].execute(e),e.context.set(lg,n,e.tree.id,this.id),n):Mh.FAILURE}}(td,15,Dh.GREATER,new ag(td,3,!1)),new class extends Hh{constructor(e){super(),this.tree=e}tick(e){return this.tree.tick(e.context,e.userData)}}(mg.getBehaviorTree(Yg))]))),mg.registerActorDef({name:md,abstract:!0,blockWalk:!0,destructible:{corpseChar:"%",qualifiers:["almost dead","badly wounded","wounded","lightly wounded",""]}}),mg.registerActorDef({name:gd,abstract:!0,container:{capacity:200,slots:[pc,fc,bc]},prototypes:[md]}),mg.registerActorDef({name:yd,abstract:!0,ai:{type:om.MONSTER,walkTime:dc,treeName:Yg},prototypes:[gd]}),mg.registerActorDef({name:vd,abstract:!0,ch:"@",container:{capacity:200,slots:[pc,fc,bc,xc,mc,vc,yc,gc]},prototypes:[gd]}),mg.registerActorDef({name:bd,ai:{type:om.PLAYER,walkTime:dc},attacker:{attackTime:dc,hitPoints:2},blockWalk:!1,color:16777215,destructible:{corpseName:"your cadaver",defence:0,healthPoints:25,xp:0},light:{color:16777215,falloffType:lm.NORMAL,range:8,renderMode:um.ADDITIVE},prototypes:[vd],xpHolder:{baseLevel:0,newLevel:25}}),mg.registerActorDef({name:_d,abstract:!0}),mg.registerActorDef({name:Td,abstract:!0,ch:"!",containerQualifier:!0,prototypes:[_d]}),mg.registerActorDef({name:Ad,abstract:!0,ch:"$",containerQualifier:!0,pickable:{price:1,weight:.05},plural:!0,prototypes:[_d]}),mg.registerActorDef({name:wd,color:$c,plural:!1,prototypes:[Ad]}),mg.registerActorDef({name:kd,abstract:!0,ch:"]"}),mg.registerActorDef({name:Sd,abstract:!0,color:10053171,prototypes:[kd,mf]}),mg.registerActorDef({name:Md,container:{capacity:5},prototypes:[Sd]}),mg.registerActorDef({name:Cd,container:{capacity:15},prototypes:[Sd]}),mg.registerActorDef({name:Pd,container:{capacity:20},prototypes:[Sd]}),mg.registerActorDef({name:Od,container:{capacity:30},prototypes:[Sd]}),mg.registerActorDef({name:Dd,abstract:!0,color:Zc,pickable:{price:-1,weight:.2},prototypes:[kd,_d]}),mg.registerActorDef({name:Id,abstract:!0,containerQualifier:!0,prototypes:[Td]}),mg.registerActorDef({name:Rd,color:ed,pickable:{destroyedWhenThrown:!0,onThrowEffector:{destroyOnEffect:!0,effect:{amount:3,failureMessage:"The potion explodes on [the actor1] but it has no effect",successMessage:"The potion explodes on [the actor1], healing [it] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.SELECTED_RANGE,radius:1}},onUseEffector:{destroyOnEffect:!0,effect:{amount:20,failureMessage:"[The actor1] drink[s] the health potion but it has no effect",successMessage:"[The actor1] drink[s] the health potion and regain[s] [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.WEARER}},price:20,weight:.5},prototypes:[Id]}),mg.registerActorDef({name:Nd,color:ed,pickable:{destroyedWhenThrown:!0,onThrowEffector:{destroyOnEffect:!0,effect:{amount:3,failureMessage:"The potion explodes on [the actor1] but it has no effect",successMessage:"The potion explodes on [the actor1], healing [it] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.SELECTED_RANGE,radius:1}},onUseEffector:{destroyOnEffect:!0,effect:{amount:100,failureMessage:"[The actor1] drink[s] the health potion but it has no effect",successMessage:"[The actor1] drink[s] the health potion and regain[s] [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.WEARER}},price:20,weight:.5},prototypes:[Id]}),mg.registerActorDef({name:Ld,color:ed,pickable:{destroyedWhenThrown:!0,onThrowEffector:{destroyOnEffect:!0,effect:{condition:{amount:6,name:"regeneration",nbTurns:12,type:rm.HEALTH_VARIATION},successMessage:"The potion explodes on [the actor1].\nLife is flowing through [it].",type:Qp.CONDITION},targetSelector:{method:nm.SELECTED_RANGE,radius:1}},onUseEffector:{destroyOnEffect:!0,effect:{condition:{amount:10,name:"regeneration",nbTurns:20,type:rm.HEALTH_VARIATION},successMessage:"[The actor1] drink[s] the regeneration potion and feel[s]\nthe life flowing through [it].",type:Qp.CONDITION},targetSelector:{method:nm.WEARER}},price:10,weight:.5},prototypes:[Id]}),mg.registerActorDef({name:Ed,ch:"%",color:Qc,containerQualifier:!0,pickable:{price:-1,weight:2},prototypes:[_d]}),mg.registerActorDef({name:Fd,abstract:!0,ch:"#",color:12899966,containerQualifier:!0,prototypes:[_d]}),mg.registerActorDef({name:Bd,pickable:{onUseEffector:{destroyOnEffect:!0,effect:{amount:-20,successMessage:"A lightning bolt strikes [the actor1] with a loud thunder!\nThe damage is [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.CLOSEST_ENEMY,range:5}},price:10,weight:.1},prototypes:[Fd]}),mg.registerActorDef({name:Ud,pickable:{onUseEffector:{destroyOnEffect:!0,effect:{amount:-12,successMessage:"[The actor1] get[s] burned for [value1] hit points.",type:Qp.INSTANT_HEALTH},message:"A fireball explodes, burning everything within 3 tiles.",targetSelector:{method:nm.SELECTED_RANGE,radius:3,range:10}},price:10,weight:.1},prototypes:[Fd]}),mg.registerActorDef({name:zd,pickable:{onUseEffector:{destroyOnEffect:!0,effect:{condition:{nbTurns:12,type:rm.CONFUSED,noCorpse:!0},successMessage:"[The actor1's] eyes look vacant,\nas [it] start[s] to stumble around!",type:Qp.CONDITION},targetSelector:{method:nm.SELECTED_ACTOR,range:5}},price:10,weight:.1},prototypes:[Fd]}),mg.registerActorDef({name:Hd,abstract:!0,containerQualifier:!0,prototypes:[_d]}),mg.registerActorDef({name:jd,abstract:!0,ch:"/",color:Qc,containerQualifier:!0,prototypes:[Hd]}),mg.registerActorDef({name:Vd,attacker:{attackTime:dc,hitPoints:3},equipment:{slots:[fc]},pickable:{onThrowEffector:{destroyOnEffect:!1,effect:{amount:-1,successMessage:"The sword hits [the actor1] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.ACTOR_ON_CELL}},price:1,weight:.5},prototypes:[jd]}),mg.registerActorDef({name:Gd,attacker:{attackTime:dc,hitPoints:4},equipment:{slots:[fc]},pickable:{onThrowEffector:{destroyOnEffect:!1,effect:{amount:-4,successMessage:"The sword hits [the actor1] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.ACTOR_ON_CELL}},price:5,weight:2},prototypes:[jd]}),mg.registerActorDef({name:Kd,attacker:{attackTime:dc,hitPoints:6},equipment:{slots:[fc]},pickable:{onThrowEffector:{destroyOnEffect:!1,effect:{amount:-6,successMessage:"The sword hits [the actor1] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.ACTOR_ON_CELL}},price:5,weight:3},prototypes:[jd]}),mg.registerActorDef({name:Wd,attacker:{attackTime:dc,hitPoints:9},equipment:{slots:[fc]},pickable:{onThrowEffector:{destroyOnEffect:!1,effect:{amount:-9,successMessage:"The sword hits [the actor1] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.ACTOR_ON_CELL}},price:15,weight:4},prototypes:[jd]}),mg.registerActorDef({name:Yd,attacker:{attackTime:dc,hitPoints:13},equipment:{slots:[fc]},pickable:{onThrowEffector:{destroyOnEffect:!1,effect:{amount:-13,successMessage:"The sword hits [the actor1] for [value1] hit points.",type:Qp.INSTANT_HEALTH},targetSelector:{method:nm.ACTOR_ON_CELL}},price:30,weight:4},prototypes:[jd]});const qg={onThrowEffector:{destroyOnEffect:!1,effect:{condition:{nbTurns:2,type:rm.STUNNED,noCorpse:!0},successMessage:"The shield hits [the actor1] and stuns [it]!",type:Qp.CONDITION},targetSelector:{method:nm.ACTOR_ON_CELL}},price:5,weight:5};mg.registerActorDef({name:Xd,abstract:!0,ch:"[",containerQualifier:!0,pickable:qg,prototypes:[_d]}),mg.registerActorDef({name:qd,abstract:!0,ch:"&",containerQualifier:!0,pickable:qg,prototypes:[_d]}),mg.registerActorDef({name:Zd,abstract:!0,ch:"&",containerQualifier:!0,pickable:qg,prototypes:[_d]}),mg.registerActorDef({name:Jd,abstract:!0,ch:'"',containerQualifier:!0,pickable:qg,prototypes:[_d]}),mg.registerActorDef({name:Qd,abstract:!0,ch:"^",containerQualifier:!0,pickable:qg,prototypes:[_d]});for(const[e,t]of[[Xd,pc],[qd,mc],[Zd,vc],[Jd,yc],[Qd,gc]])mg.registerActorDef({name:"wooden "+e,color:Zc,equipment:{defence:1,slots:[t]},prototypes:[e]}),mg.registerActorDef({name:"iron "+e,color:Jc,equipment:{defence:2,slots:[t]},prototypes:[e]}),mg.registerActorDef({name:"great"+e,color:Jc,equipment:{defence:3,slots:[t]},prototypes:[e]}),mg.registerActorDef({name:"power"+e,color:15658751,equipment:{defence:4,slots:[t]},prototypes:[e]});function Zg(e){return[{clazz:`wooden ${e}`,prob:[[0,4],[4,0]]},{clazz:`iron ${e}`,prob:[[1,2]]},{clazz:`great${e}`,prob:[[2,1]]},{clazz:`power${e}`,prob:[[3,1]]}]}mg.registerActorDef({name:hf,abstract:!0,ch:"\\",containerQualifier:!0,equipment:{slots:[xc]},prototypes:[Hd]}),mg.registerActorDef({name:df,abstract:!0,containerQualifier:!0,prototypes:[hf]}),mg.registerActorDef({name:ff,color:16765316,ch:"\\",pickable:{onThrowEffector:{destroyOnEffect:!0,effect:{amount:-2,successMessage:"The dart hits [the actor1] for [value1] damage.",type:Qp.INSTANT_HEALTH,singleActor:!0},targetSelector:{method:nm.ACTOR_ON_CELL}},price:10,weight:.1},prototypes:[df]}),mg.registerActorDef({name:uf,abstract:!0,containerQualifier:!0,prototypes:[hf]}),mg.registerActorDef({name:cf,color:Zc,pickable:{onThrowEffector:{destroyOnEffect:!0,effect:{amount:-2,successMessage:"The arrow hits [the actor1] for [value1] points.",type:Qp.INSTANT_HEALTH,singleActor:!0},targetSelector:{method:nm.ACTOR_ON_CELL}},price:10,weight:.1},prototypes:[uf]}),mg.registerActorDef({name:$d,abstract:!0,ch:")",color:Zc,pickable:{price:10,weight:2},prototypes:[Hd]}),mg.registerActorDef({name:ef,equipment:{slots:[bc]},prototypes:[$d],ranged:{damageCoef:4,loadTime:4,projectileType:uf,range:15}}),mg.registerActorDef({name:tf,equipment:{slots:[bc]},prototypes:[$d],ranged:{damageCoef:8,loadTime:6,projectileType:uf,range:30}}),mg.registerActorDef({name:xd,abstract:!0}),mg.registerActorDef({name:rf,abstract:!0,ch:"/",color:Zc,containerQualifier:!0,equipment:{slots:[fc]},pickable:{price:10,weight:.5},prototypes:[Hd]}),mg.registerActorDef({name:nf,magic:{charges:5,onFireEffect:{destroyOnEffect:!1,effect:{condition:{nbTurns:10,type:rm.FROZEN,noDisplay:!0},successMessage:"[The actor1] [is] covered with frost.",type:Qp.CONDITION},message:"[The actor1] zap[s] [its] wand.",targetSelector:{method:nm.SELECTED_ACTOR,range:5}}},prototypes:[rf]}),mg.registerActorDef({name:af,abstract:!0,ch:"/",color:Zc,containerQualifier:!0,equipment:{slots:[fc,pc]},pickable:{price:10,weight:3},prototypes:[Hd]}),mg.registerActorDef({name:of,pickable:{price:10,weight:.1,onUseEffector:{destroyOnEffect:!0,effect:{successMessage:"[The actor1] disappear[s] suddenly.",type:Qp.TELEPORT,singleActor:!0},message:"[The actor1] zap[s] [its] staff.",targetSelector:{method:nm.SELECTED_ACTOR,range:5}}},prototypes:[Fd]}),mg.registerActorDef({name:sf,pickable:{price:10,weight:.1,onUseEffector:{destroyOnEffect:!0,effect:{condition:{nbTurns:30,range:15,type:rm.DETECT_LIFE},successMessage:"[The actor1] [is] aware of life around [it].",type:Qp.CONDITION},message:"[The actor1] zap[s] [its] staff.",targetSelector:{method:nm.WEARER}}},prototypes:[Fd]}),mg.registerActorDef({name:lf,pickable:{onUseEffector:{destroyOnEffect:!0,effect:{type:Qp.MAP_REVEAL},message:"[The actor1] read[s] [its] scroll of mapping.",targetSelector:{method:nm.WEARER}},price:10,weight:.1},prototypes:[Fd]}),mg.registerActorDef({name:pf,ch:"-",color:$c,pickable:{price:-1,weight:.1},prototypes:[_d]}),mg.registerActorDef({name:mf,abstract:!0}),mg.registerActorDef({name:bf,abstract:!0,blockWalk:!0,ch:"+",displayOutOfFov:!0,prototypes:[mf]}),mg.registerActorDef({name:xf,activable:{activateMessage:"[The actor1] is open.",deactivateMessage:"[The actor1] is closed.",seeThrough:!1,type:em.DOOR},blockSight:!0,color:Zc,prototypes:[bf]}),mg.registerActorDef({name:_f,activable:{activateMessage:"[The actor1] is open.",deactivateMessage:"[The actor1] is closed.",seeThrough:!0,type:em.DOOR},blockSight:!1,color:Jc,prototypes:[bf]}),mg.registerActorDef({name:gf,abstract:!0,color:16777215,displayOutOfFov:!0,plural:!0,prototypes:[mf]}),mg.registerActorDef({name:yf,activable:{onActivateEffector:{destroyOnEffect:!1,effect:{eventData:{mapIdOffset:-1,portalType:vf,portalVariant:0},eventType:dd,type:Qp.EVENT},targetSelector:{method:nm.WEARER}},type:em.SINGLE},ch:"<",prototypes:[gf]}),mg.registerActorDef({name:vf,activable:{onActivateEffector:{destroyOnEffect:!1,effect:{eventData:{mapIdOffset:1,portalType:yf,portalVariant:0},eventType:dd,type:Qp.EVENT},targetSelector:{method:nm.WEARER}},type:em.SINGLE},ch:">",prototypes:[gf]}),function(){for(const e of Kg)Wg(e)}();let Jg={classProb:[{clazz:Bd,prob:[[3,10]]},{clazz:Ud,prob:16},{clazz:zd,prob:16},{clazz:Gd,prob:[[0,4],[4,0]]},{clazz:of,prob:4},{clazz:sf,prob:4},{clazz:Kd,prob:[[1,2],[2,0]]},{clazz:Wd,prob:[[2,1],[3,0]]},{clazz:Yd,prob:[[3,1],[4,2]]},...Zg(Qd),...Zg(Zd),...Zg(qd),...Zg(Jd),...Zg(Xd)],maxCount:4,minCount:1},Qg={classProb:[...Jg.classProb,{clazz:ff,prob:100},{clazz:Rd,prob:[[0,20],[4,15]]},{clazz:Nd,prob:[[4,15]]}],countProb:{0:50,1:40,2:10}};function $g(e,t,r,i){const n=[];for(const[a,o]of Object.entries(mg.actorDefs))o.destructible&&o.destructible.xp&&o.destructible.xp>=e&&o.destructible.xp<=t&&n.push({clazz:a,prob:[[r,30],[i,0]]});return n}let ey={creatureProbabilities:{classProb:[...$g(0,10,0,1),...$g(10,20,1,2),...$g(20,30,2,3),...$g(40,50,3,4),...$g(50,60,4,5),...$g(70,80,5,6),...$g(80,90,6,7),...$g(90,100,7,8),...$g(100,110,8,9)],maxCount:2},doorProbabilities:{classProb:[{clazz:xf,prob:80}]},itemProbabilities:Qg,keyProbabilities:{classProb:[{clazz:pf,prob:1}]},lootContainerType:Sd,lootProbabilities:Jg,maxTorches:0,minTorches:0,roomMinSize:4,wallLightProbabilities:{classProb:[]},guardAI:Xg};class ty extends Jp{_topologyMaps=[];dungeonLevel=1;constructor(){super(new jc(new Yc(new Wc)),new Eh),ey.noItem=void 0!==ru.noitem,ey.noMonster=void 0!==ru.nomonster}get map(){return Gc.current}get topologyMap(){return Gc.current.topology}onInit(){super.onInit()}createPlayer(){let e=mg.create(this.dungeonLevel,bd,this.playerTilePicker,this.playerInventoryPicker,this.playerLootHandler);if(!e)return void lc.critical("Missing actor type "+bd);vg.specialActors[gg.PLAYER]=e,e.register();let[t]=e.map.actorList.filter((e=>e.isA(yf)));e.moveTo(t.pos.x,t.pos.y),mg.createInContainer(e,[Vd,ff,ff,ff,ff,ff]),vg.describeCell(e.pos)}buildMap(e,t){t.init(e,sc.getConsole().width,sc.getConsole().height-7);let r=new Zp(e,ey);r.build(t),t.topology=r.topologyMap;let i=0,n=0;for(const r of t.actorList)if(r.isA(vf)){r.activable.onActivateEffector.effect.setEventData({portalVariant:i}),i++}else if(r.isA(yf)){0===e&&(r.name="moongate out of Tartarus",r.setSingular(!0));r.activable.onActivateEffector.effect.setEventData({portalVariant:n}),n++}return r.topologyMap}}class ry extends ty{storyConfig=Xp();onInit(){this.status=fd.INITIALIZING,super.onInit(),this.createGui(),vu.registerEventListener(this,dd),vu.registerEventListener(this,cd),vu.registerEventListener(this,ud),ru.clearsavegame?this.onNewGame():this.persister.loadFromKey(rd).then((e=>{e&&"18"===e.toString()?this.loadGame():this.onNewGame()}))}get dungeonDetails(){return qp(this.storyConfig.dungeon,this.dungeonLevel)}onTerm(){super.onTerm(),vu.unregisterEventListener(this,dd),vu.unregisterEventListener(this,cd),vu.unregisterEventListener(this,ud)}onUsePortal(e){const t=this.dungeonLevel+e.mapIdOffset;if(t<0)return void(vg.player.container.containsCriteria((e=>e.isA(Ed)),!0)?(lc.info(`You present the artefact to ${ny().storyConfig.demonName}... he grins...`),lc.info("You win!"),this.status=fd.VICTORY):(lc.warn("You consider leaving... your damnation would be assured."),lc.warn("You must obtain one of The Artefacts.")));this.ensureLevelGenerated(t);const r=Gc.getActors(t).filter((t=>t.name===e.portalType)),i=r[e.portalVariant]||r[0];this.queuedPortalUse=i.id}onChangeStatus(e){this.status=e,e===fd.DEFEAT&&lc.critical("You died!")}onNewGame(){this.deleteSavedGame(),this.dungeonLevel=0,this.storyConfig=Xp(),Gc.currentIndex=0,Gc.actorsDb=[[]],Gc.mapDb=[],this.status=fd.RUNNING,this.ensureLevelGenerated(this.dungeonLevel),this.createPlayer(),this.gui.status.clear();const e=U.default.getNumber(3,6)+U.default.getNumber(3,6);lc.critical('"You seek the artefacts more than your own life..."'),lc.critical('"Your greed is admirable."'),lc.warn(`The demon ${this.storyConfig.demonName} has flung you into Tartarus!`),lc.critical(`The descent is not gentle! You take ${e} damage!`),vg.player.destructible.takeRawDamage(vg.player,e)}onSaveGame(e){vg.specialActors[gg.PLAYER].destructible.isDead()?this.deleteSavedGame():(e.saveToKey(ad,this.dungeonLevel),e.saveToKey(id,vg.scheduler.currentTime),e.saveToKey(rd,"18"),e.saveToKey(nd,this.storyConfig),e.saveToKey(sd,Gc.mapDb),e.saveToKey(od,this.gui.status),mg.save(e))}async onUpdate(e){if(this.status===fd.INITIALIZING)return;if(this.status===fd.DEFEAT)return;let t=vg.player;if(this.queuedPortalUse)return this.gotoNextLevel(this.queuedPortalUse),this.queuedPortalUse=void 0,this.status=fd.RUNNING,void(t&&(this.map.setDirty(),this.map.computeFov(t.pos.x,t.pos.y,1+t.xpHolder.xpLevel),this.map.updateScentField(t.pos.x,t.pos.y)));if(t&&!t.destructible.isDead()){let r=t.scheduler.isPaused();this.status===fd.NEXT_TURN&&(this.forceNextTurn=!0,this.status=fd.RUNNING),await super.onUpdate(e),!r&&t.scheduler.isPaused()&&(this.persister.saveToKey(_c,Gc.actorsDb),this.onSaveGame(this.persister))}this.handleKeyboardInput();t&&t.destructible.isDead()&&this.status!==fd.DEFEAT&&vu.publishEvent(cd,fd.DEFEAT)}onRender(e){}createGui(){let e=new Mg;var t;this.gui={inventory:new wg(e),loot:new kg(e),mainMenu:new Cg,status:new xg,tilePicker:new Sg},ru.debug&&(this.gui.debugMenu=new Pg,this.addChild(this.gui.debugMenu)),this.gui.status.init(sc.getConsole().width,7),this.playerInventoryPicker=this.gui.inventory,this.playerTilePicker=this.gui.tilePicker,this.playerLootHandler=this.gui.loot,this.gui.inventory.resize(sc.getConsole().width,sc.getConsole().height-7),this.addChild(this.gui.status),this.addChild(this.gui.inventory),this.addChild(this.gui.mainMenu),this.addChild(this.gui.tilePicker),this.addChild(this.gui.loot),this.addChild(e),t={color:{background:Xc,backgroundActive:3684400,backgroundDisabled:Xc,foreground:16619295,foregroundActive:16768912,foregroundDisabled:6058315,titleForeground:16777215},input:{cancelAxisName:Ac[Ac.CANCEL],focusNextWidgetAxisName:Ac[Ac.MOVE_SOUTH],focusPreviousWidgetAxisName:Ac[Ac.MOVE_NORTH],validateAxisName:Ac[Ac.VALIDATE]}},Ru=t}async loadGame(){try{const e=await this.persister.loadFromKey(ad);this.dungeonLevel=e,Gc.currentIndex=e,bh.registerConstructor("Map",(()=>new Gc(this.renderer))),await this.persister.loadFromKey(sd,Gc.mapDb),await mg.load(this.persister),await vg.load(this.persister),this.storyConfig=await this.persister.loadFromKey(nd),vg.specialActors[gg.PLAYER].ai.setPickers(this.playerTilePicker,this.playerInventoryPicker,this.playerLootHandler),this.status=await this.persister.loadFromKey(od,this.gui.status),vg.resetCurrentScheduler(),vg.scheduler.currentTime=await this.persister.loadFromKey(id);for(const e of Gc.current.actorList)e.ai&&vg.scheduler.rawAdd(e)}catch(e){lc.critical("Error while loading game :"+e),this.onNewGame()}}deleteSavedGame(){this.persister.deleteKey(ad),this.persister.deleteKey(rd),this.persister.deleteKey(sd),mg.deleteSavedGame(this.persister),vg.deleteSavedGame(this.persister),this.persister.deleteKey(od)}ensureLevelGenerated(e){if(Gc.mapDb[e])return Gc.mapDb[e];const t=new Gc(this.renderer);for(;Gc.mapDb.length<e;)Gc.mapDb.push(void 0);return Gc.mapDb[e]=t,this.buildMap(e,t),t}gotoNextLevel(e){let t=vg.specialActors[gg.PLAYER],r=vg.fromId(e);if(r){t.changeMap(r.mapId);const e=Gc.getActors(r.mapId).filter((e=>!!e.ai));vg.resetCurrentScheduler(),vg.currentScheduler.addAll(e),this.dungeonLevel=r.mapId,Gc.currentIndex=r.mapId,t.moveTo(r.pos.x,r.pos.y),lc.warn("Level..."+(this.dungeonLevel+1)),this.renderer.initForNewMap()}}handleKeyboardInput(){void 0===Vu.getActiveModal()&&kc()===Ac.CANCEL&&(Su(),vu.publishEvent(ld))}}let iy;function ny(){return iy}let ay=!1;a((function(){let e;if(!ay){ay=!0;try{e=new ic,hc(e)}catch(e){return console.log("ERROR in "+e.fileName+":"+e.lineNumber+" : "+e.message),void console.log(e.stack)}try{const t=80,r=34;iy=new ry,e.run(iy,{consoleHeight:r,consoleWidth:t})}catch(e){lc.critical("ERROR in "+e.fileName+":"+e.lineNumber+" : "+e.message),lc.critical(e.stack)}}}))}();
//# sourceMappingURL=index.bd257dbe.js.map
